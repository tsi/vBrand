var requirejs,require,define;!function(global){function isFunction(t){return"[object Function]"===ostring.call(t)}function isArray(t){return"[object Array]"===ostring.call(t)}function each(t,e){if(t){var i;for(i=0;i<t.length&&(!t[i]||!e(t[i],i,t));i+=1);}}function eachReverse(t,e){if(t){var i;for(i=t.length-1;i>-1&&(!t[i]||!e(t[i],i,t));i-=1);}}function hasProp(t,e){return hasOwn.call(t,e)}function getOwn(t,e){return hasProp(t,e)&&t[e]}function eachProp(t,e){var i;for(i in t)if(hasProp(t,i)&&e(t[i],i))break}function mixin(t,e,i,s){return e&&eachProp(e,function(e,n){(i||!hasProp(t,n))&&(s&&"string"!=typeof e?(t[n]||(t[n]={}),mixin(t[n],e,i,s)):t[n]=e)}),t}function bind(t,e){return function(){return e.apply(t,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(t){throw t}function getGlobal(t){if(!t)return t;var e=global;return each(t.split("."),function(t){e=e[t]}),e}function makeError(t,e,i,s){var n=new Error(e+"\nhttp://requirejs.org/docs/errors.html#"+t);return n.requireType=t,n.requireModules=s,i&&(n.originalError=i),n}function newContext(t){function e(t){var e,i;for(e=0;t[e];e+=1)if(i=t[e],"."===i)t.splice(e,1),e-=1;else if(".."===i){if(1===e&&(".."===t[2]||".."===t[0]))break;e>0&&(t.splice(e-1,2),e-=2)}}function i(t,i,s){var n,o,r,a,l,h,c,d,u,p,f,g=i&&i.split("/"),m=g,v=k.map,y=v&&v["*"];if(t&&"."===t.charAt(0)&&(i?(m=getOwn(k.pkgs,i)?g=[i]:g.slice(0,g.length-1),t=m.concat(t.split("/")),e(t),o=getOwn(k.pkgs,n=t[0]),t=t.join("/"),o&&t===n+"/"+o.main&&(t=n)):0===t.indexOf("./")&&(t=t.substring(2))),s&&v&&(g||y)){for(a=t.split("/"),l=a.length;l>0;l-=1){if(c=a.slice(0,l).join("/"),g)for(h=g.length;h>0;h-=1)if(r=getOwn(v,g.slice(0,h).join("/")),r&&(r=getOwn(r,c))){d=r,u=l;break}if(d)break;!p&&y&&getOwn(y,c)&&(p=getOwn(y,c),f=l)}!d&&p&&(d=p,u=f),d&&(a.splice(0,u,d),t=a.join("/"))}return t}function s(t){isBrowser&&each(scripts(),function(e){return e.getAttribute("data-requiremodule")===t&&e.getAttribute("data-requirecontext")===w.contextName?(e.parentNode.removeChild(e),!0):void 0})}function n(t){var e=getOwn(k.paths,t);return e&&isArray(e)&&e.length>1?(e.shift(),w.require.undef(t),w.require([t]),!0):void 0}function o(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function r(t,e,s,n){var r,a,l,h,c=null,d=e?e.name:null,u=t,p=!0,f="";return t||(p=!1,t="_@r"+(I+=1)),h=o(t),c=h[0],t=h[1],c&&(c=i(c,d,n),a=getOwn(A,c)),t&&(c?f=a&&a.normalize?a.normalize(t,function(t){return i(t,d,n)}):i(t,d,n):(f=i(t,d,n),h=o(f),c=h[0],f=h[1],s=!0,r=w.nameToUrl(f))),l=!c||a||s?"":"_unnormalized"+(D+=1),{prefix:c,name:f,parentMap:e,unnormalized:!!l,url:r,originalName:u,isDefine:p,id:(c?c+"!"+f:f)+l}}function a(t){var e=t.id,i=getOwn(C,e);return i||(i=C[e]=new w.Module(t)),i}function l(t,e,i){var s=t.id,n=getOwn(C,s);!hasProp(A,s)||n&&!n.defineEmitComplete?(n=a(t),n.error&&"error"===e?i(n.error):n.on(e,i)):"defined"===e&&i(A[s])}function h(t,e){var i=t.requireModules,s=!1;e?e(t):(each(i,function(e){var i=getOwn(C,e);i&&(i.error=t,i.events.error&&(s=!0,i.emit("error",t)))}),s||req.onError(t))}function c(){globalDefQueue.length&&(apsp.apply($,[$.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function d(t){delete C[t],delete S[t]}function u(t,e,i){var s=t.map.id;t.error?t.emit("error",t.error):(e[s]=!0,each(t.depMaps,function(s,n){var o=s.id,r=getOwn(C,o);!r||t.depMatched[n]||i[o]||(getOwn(e,o)?(t.defineDep(n,A[o]),t.check()):u(r,e,i))}),i[s]=!0)}function p(){var t,e,i,o,r=1e3*k.waitSeconds,a=r&&w.startTime+r<(new Date).getTime(),l=[],c=[],d=!1,f=!0;if(!y){if(y=!0,eachProp(S,function(i){if(t=i.map,e=t.id,i.enabled&&(t.isDefine||c.push(i),!i.error))if(!i.inited&&a)n(e)?(o=!0,d=!0):(l.push(e),s(e));else if(!i.inited&&i.fetched&&t.isDefine&&(d=!0,!t.prefix))return f=!1}),a&&l.length)return i=makeError("timeout","Load timeout for modules: "+l,null,l),i.contextName=w.contextName,h(i);f&&each(c,function(t){u(t,{},{})}),a&&!o||!d||!isBrowser&&!isWebWorker||x||(x=setTimeout(function(){x=0,p()},50)),y=!1}}function f(t){hasProp(A,t[0])||a(r(t[0],null,!0)).init(t[1],t[2])}function g(t,e,i,s){t.detachEvent&&!isOpera?s&&t.detachEvent(s,e):t.removeEventListener(i,e,!1)}function m(t){var e=t.currentTarget||t.srcElement;return g(e,w.onScriptLoad,"load","onreadystatechange"),g(e,w.onScriptError,"error"),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function v(){var t;for(c();$.length;){if(t=$.shift(),null===t[0])return h(makeError("mismatch","Mismatched anonymous define() module: "+t[t.length-1]));f(t)}}var y,b,w,_,x,k={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},C={},S={},T={},$=[],A={},P={},I=1,D=1;return _={require:function(t){return t.require?t.require:t.require=w.makeRequire(t.map)},exports:function(t){return t.usingExports=!0,t.map.isDefine?t.exports?t.exports:t.exports=A[t.map.id]={}:void 0},module:function(t){return t.module?t.module:t.module={id:t.map.id,uri:t.map.url,config:function(){var e,i=getOwn(k.pkgs,t.map.id);return e=i?getOwn(k.config,t.map.id+"/"+i.main):getOwn(k.config,t.map.id),e||{}},exports:A[t.map.id]}}},b=function(t){this.events=getOwn(T,t.id)||{},this.map=t,this.shim=getOwn(k.shim,t.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},b.prototype={init:function(t,e,i,s){s=s||{},this.inited||(this.factory=e,i?this.on("error",i):this.events.error&&(i=bind(this,function(t){this.emit("error",t)})),this.depMaps=t&&t.slice(0),this.errback=i,this.inited=!0,this.ignore=s.ignore,s.enabled||this.enabled?this.enable():this.check())},defineDep:function(t,e){this.depMatched[t]||(this.depMatched[t]=!0,this.depCount-=1,this.depExports[t]=e)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var t=this.map;return this.shim?void w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return t.prefix?this.callPlugin():this.load()})):t.prefix?this.callPlugin():this.load()}},load:function(){var t=this.map.url;P[t]||(P[t]=!0,w.load(this.map.id,t))},check:function(){if(this.enabled&&!this.enabling){var t,e,i=this.map.id,s=this.depExports,n=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{n=w.execCb(i,o,s,n)}catch(r){t=r}else n=w.execCb(i,o,s,n);if(this.map.isDefine&&(e=this.module,e&&void 0!==e.exports&&e.exports!==this.exports?n=e.exports:void 0===n&&this.usingExports&&(n=this.exports)),t)return t.requireMap=this.map,t.requireModules=this.map.isDefine?[this.map.id]:null,t.requireType=this.map.isDefine?"define":"require",h(this.error=t)}else n=o;this.exports=n,this.map.isDefine&&!this.ignore&&(A[i]=n,req.onResourceLoad&&req.onResourceLoad(w,this.map,this.depMaps)),d(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var t=this.map,e=t.id,s=r(t.prefix);this.depMaps.push(s),l(s,"defined",bind(this,function(s){var n,o,c,u=this.map.name,p=this.map.parentMap?this.map.parentMap.name:null,f=w.makeRequire(t.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(s.normalize&&(u=s.normalize(u,function(t){return i(t,p,!0)})||""),o=r(t.prefix+"!"+u,this.map.parentMap),l(o,"defined",bind(this,function(t){this.init([],function(){return t},null,{enabled:!0,ignore:!0})})),c=getOwn(C,o.id),void(c&&(this.depMaps.push(o),this.events.error&&c.on("error",bind(this,function(t){this.emit("error",t)})),c.enable()))):(n=bind(this,function(t){this.init([],function(){return t},null,{enabled:!0})}),n.error=bind(this,function(t){this.inited=!0,this.error=t,t.requireModules=[e],eachProp(C,function(t){0===t.map.id.indexOf(e+"_unnormalized")&&d(t.map.id)}),h(t)}),n.fromText=bind(this,function(i,s){var o=t.name,l=r(o),c=useInteractive;s&&(i=s),c&&(useInteractive=!1),a(l),hasProp(k.config,e)&&(k.config[o]=k.config[e]);try{req.exec(i)}catch(d){return h(makeError("fromtexteval","fromText eval for "+e+" failed: "+d,d,[e]))}c&&(useInteractive=!0),this.depMaps.push(l),w.completeLoad(o),f([o],n)}),void s.load(t.name,f,n,k))})),w.enable(s,this),this.pluginMaps[s.id]=s},enable:function(){S[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(t,e){var i,s,n;if("string"==typeof t){if(t=r(t,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[e]=t,n=getOwn(_,t.id))return void(this.depExports[e]=n(this));this.depCount+=1,l(t,"defined",bind(this,function(t){this.defineDep(e,t),this.check()})),this.errback&&l(t,"error",bind(this,this.errback))}i=t.id,s=C[i],hasProp(_,i)||!s||s.enabled||w.enable(t,this)})),eachProp(this.pluginMaps,bind(this,function(t){var e=getOwn(C,t.id);e&&!e.enabled&&w.enable(t,this)})),this.enabling=!1,this.check()},on:function(t,e){var i=this.events[t];i||(i=this.events[t]=[]),i.push(e)},emit:function(t,e){each(this.events[t],function(t){t(e)}),"error"===t&&delete this.events[t]}},w={config:k,contextName:t,registry:C,defined:A,urlFetched:P,defQueue:$,Module:b,makeModuleMap:r,nextTick:req.nextTick,onError:h,configure:function(t){t.baseUrl&&"/"!==t.baseUrl.charAt(t.baseUrl.length-1)&&(t.baseUrl+="/");var e=k.pkgs,i=k.shim,s={paths:!0,config:!0,map:!0};eachProp(t,function(t,e){s[e]?"map"===e?(k.map||(k.map={}),mixin(k[e],t,!0,!0)):mixin(k[e],t,!0):k[e]=t}),t.shim&&(eachProp(t.shim,function(t,e){isArray(t)&&(t={deps:t}),!t.exports&&!t.init||t.exportsFn||(t.exportsFn=w.makeShimExports(t)),i[e]=t}),k.shim=i),t.packages&&(each(t.packages,function(t){var i;t="string"==typeof t?{name:t}:t,i=t.location,e[t.name]={name:t.name,location:i||t.name,main:(t.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),k.pkgs=e),eachProp(C,function(t,e){t.inited||t.map.unnormalized||(t.map=r(e))}),(t.deps||t.callback)&&w.require(t.deps||[],t.callback)},makeShimExports:function(t){function e(){var e;return t.init&&(e=t.init.apply(global,arguments)),e||t.exports&&getGlobal(t.exports)}return e},makeRequire:function(e,n){function o(i,s,l){var c,d,u;return n.enableBuildCallback&&s&&isFunction(s)&&(s.__requireJsBuild=!0),"string"==typeof i?isFunction(s)?h(makeError("requireargs","Invalid require call"),l):e&&hasProp(_,i)?_[i](C[e.id]):req.get?req.get(w,i,e,o):(d=r(i,e,!1,!0),c=d.id,hasProp(A,c)?A[c]:h(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+t+(e?"":". Use require([])")))):(v(),w.nextTick(function(){v(),u=a(r(null,e)),u.skipMap=n.skipMap,u.init(i,s,l,{enabled:!0}),p()}),o)}return n=n||{},mixin(o,{isBrowser:isBrowser,toUrl:function(t){var s,n=t.lastIndexOf("."),o=t.split("/")[0],r="."===o||".."===o;return-1!==n&&(!r||n>1)&&(s=t.substring(n,t.length),t=t.substring(0,n)),w.nameToUrl(i(t,e&&e.id,!0),s,!0)},defined:function(t){return hasProp(A,r(t,e,!1,!0).id)},specified:function(t){return t=r(t,e,!1,!0).id,hasProp(A,t)||hasProp(C,t)}}),e||(o.undef=function(t){c();var i=r(t,e,!0),n=getOwn(C,t);s(t),delete A[t],delete P[i.url],delete T[t],n&&(n.events.defined&&(T[t]=n.events),d(t))}),o},enable:function(t){var e=getOwn(C,t.id);e&&a(t).enable()},completeLoad:function(t){var e,i,s,o=getOwn(k.shim,t)||{},r=o.exports;for(c();$.length;){if(i=$.shift(),null===i[0]){if(i[0]=t,e)break;e=!0}else i[0]===t&&(e=!0);f(i)}if(s=getOwn(C,t),!e&&!hasProp(A,t)&&s&&!s.inited){if(!(!k.enforceDefine||r&&getGlobal(r)))return n(t)?void 0:h(makeError("nodefine","No define call for "+t,null,[t]));f([t,o.deps||[],o.exportsFn])}p()},nameToUrl:function(t,e,i){var s,n,o,r,a,l,h,c,d;if(req.jsExtRegExp.test(t))c=t+(e||"");else{for(s=k.paths,n=k.pkgs,a=t.split("/"),l=a.length;l>0;l-=1){if(h=a.slice(0,l).join("/"),o=getOwn(n,h),d=getOwn(s,h)){isArray(d)&&(d=d[0]),a.splice(0,l,d);break}if(o){r=t===o.name?o.location+"/"+o.main:o.location,a.splice(0,l,r);break}}c=a.join("/"),c+=e||(/^data\:|\?/.test(c)||i?"":".js"),c=("/"===c.charAt(0)||c.match(/^[\w\+\.\-]+:/)?"":k.baseUrl)+c}return k.urlArgs?c+((-1===c.indexOf("?")?"?":"&")+k.urlArgs):c},load:function(t,e){req.load(w,t,e)},execCb:function(t,e,i,s){return e.apply(s,i)},onScriptLoad:function(t){if("load"===t.type||readyRegExp.test((t.currentTarget||t.srcElement).readyState)){interactiveScript=null;var e=m(t);w.completeLoad(e.id)}},onScriptError:function(t){var e=m(t);return n(e.id)?void 0:h(makeError("scripterror","Script error for: "+e.id,t,[e.id]))}},w.require=w.makeRequire(),w}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(t){return"interactive"===t.readyState?interactiveScript=t:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.9",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(t,e,i,s){var n,o,r=defContextName;return isArray(t)||"string"==typeof t||(o=t,isArray(e)?(t=e,e=i,i=s):t=[]),o&&o.context&&(r=o.context),n=getOwn(contexts,r),n||(n=contexts[r]=req.s.newContext(r)),o&&n.configure(o),n.require(t,e,i)},req.config=function(t){return req(t)},req.nextTick="undefined"!=typeof setTimeout?function(t){setTimeout(t,4)}:function(t){t()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(t){req[t]=function(){var e=contexts[defContextName];return e.require[t].apply(e,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(t){var e=t.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return e.type=t.scriptType||"text/javascript",e.charset="utf-8",e.async=!0,e},req.load=function(t,e,i){var s,n=t&&t.config||{};if(isBrowser)return s=req.createNode(n,e,i),s.setAttribute("data-requirecontext",t.contextName),s.setAttribute("data-requiremodule",e),!s.attachEvent||s.attachEvent.toString&&s.attachEvent.toString().indexOf("[native code")<0||isOpera?(s.addEventListener("load",t.onScriptLoad,!1),s.addEventListener("error",t.onScriptError,!1)):(useInteractive=!0,s.attachEvent("onreadystatechange",t.onScriptLoad)),s.src=i,currentlyAddingScript=s,baseElement?head.insertBefore(s,baseElement):head.appendChild(s),currentlyAddingScript=null,s;if(isWebWorker)try{importScripts(i),t.completeLoad(e)}catch(o){t.onError(makeError("importscripts","importScripts failed for "+e+" at "+i,o,[e]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(t){return head||(head=t.parentNode),dataMain=t.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(t,e,i){var s,n;"string"!=typeof t&&(i=e,e=t,t=null),isArray(e)||(i=e,e=null),!e&&isFunction(i)&&(e=[],i.length&&(i.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(t,i){e.push(i)}),e=(1===i.length?["require"]:["require","exports","module"]).concat(e))),useInteractive&&(s=currentlyAddingScript||getInteractiveScript(),s&&(t||(t=s.getAttribute("data-requiremodule")),n=contexts[s.getAttribute("data-requirecontext")])),(n?n.defQueue:globalDefQueue).push([t,e,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("libs/require/require",function(){}),define("main.min",function(){}),function(){if(!window.console||!window.console.log){var t={};t.log=t.error=t.info=t.debug=t.warn=t.trace=t.dir=t.dirxml=t.time=t.timeEnd=t.assert=t.profile=function(){},window.console=t}window.console.group&&window.console.groupCollapsed&&window.console.groupEnd||(window.console.groupCollapsed=window.console.group=function(t){window.console.log(t)},window.console.groupEnd=function(){})}(),define("console.setup",function(){}),function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){function i(t){var e=t.length,i=Q.type(t);return"function"===i||Q.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t}function s(t,e,i){if(Q.isFunction(e))return Q.grep(t,function(t,s){return!!e.call(t,s,t)!==i});if(e.nodeType)return Q.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(ae.test(e))return Q.filter(e,t,i);e=Q.filter(e,t)}return Q.grep(t,function(t){return W.call(e,t)>=0!==i})}function n(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function o(t){var e=fe[t]={};return Q.each(t.match(pe)||[],function(t,i){e[i]=!0}),e}function r(){K.removeEventListener("DOMContentLoaded",r,!1),t.removeEventListener("load",r,!1),Q.ready()}function a(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Q.expando+Math.random()}function l(t,e,i){var s;if(void 0===i&&1===t.nodeType)if(s="data-"+e.replace(we,"-$1").toLowerCase(),i=t.getAttribute(s),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:be.test(i)?Q.parseJSON(i):i}catch(n){}ye.set(t,e,i)}else i=void 0;return i}function h(){return!0}function c(){return!1}function d(){try{return K.activeElement}catch(t){}}function u(t,e){return Q.nodeName(t,"table")&&Q.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function p(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function f(t){var e=ze.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function g(t,e){for(var i=0,s=t.length;s>i;i++)ve.set(t[i],"globalEval",!e||ve.get(e[i],"globalEval"))}function m(t,e){var i,s,n,o,r,a,l,h;if(1===e.nodeType){if(ve.hasData(t)&&(o=ve.access(t),r=ve.set(e,o),h=o.events)){delete r.handle,r.events={};for(n in h)for(i=0,s=h[n].length;s>i;i++)Q.event.add(e,n,h[n][i])}ye.hasData(t)&&(a=ye.access(t),l=Q.extend({},a),ye.set(e,l))}}function v(t,e){var i=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&Q.nodeName(t,e)?Q.merge([t],i):i}function y(t,e){var i=e.nodeName.toLowerCase();"input"===i&&Ce.test(t.type)?e.checked=t.checked:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}function b(e,i){var s,n=Q(i.createElement(e)).appendTo(i.body),o=t.getDefaultComputedStyle&&(s=t.getDefaultComputedStyle(n[0]))?s.display:Q.css(n[0],"display");return n.detach(),o}function w(t){var e=K,i=Be[t];return i||(i=b(t,e),"none"!==i&&i||(Ne=(Ne||Q("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=Ne[0].contentDocument,e.write(),e.close(),i=b(t,e),Ne.detach()),Be[t]=i),i}function _(t,e,i){var s,n,o,r,a=t.style;return i=i||He(t),i&&(r=i.getPropertyValue(e)||i[e]),i&&(""!==r||Q.contains(t.ownerDocument,t)||(r=Q.style(t,e)),Ue.test(r)&&je.test(e)&&(s=a.width,n=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=i.width,a.width=s,a.minWidth=n,a.maxWidth=o)),void 0!==r?r+"":r}function x(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function k(t,e){if(e in t)return e;for(var i=e[0].toUpperCase()+e.slice(1),s=e,n=Ze.length;n--;)if(e=Ze[n]+i,e in t)return e;return s}function C(t,e,i){var s=Ve.exec(e);return s?Math.max(0,s[1]-(i||0))+(s[2]||"px"):e}function S(t,e,i,s,n){for(var o=i===(s?"border":"content")?4:"width"===e?1:0,r=0;4>o;o+=2)"margin"===i&&(r+=Q.css(t,i+xe[o],!0,n)),s?("content"===i&&(r-=Q.css(t,"padding"+xe[o],!0,n)),"margin"!==i&&(r-=Q.css(t,"border"+xe[o]+"Width",!0,n))):(r+=Q.css(t,"padding"+xe[o],!0,n),"padding"!==i&&(r+=Q.css(t,"border"+xe[o]+"Width",!0,n)));return r}function T(t,e,i){var s=!0,n="width"===e?t.offsetWidth:t.offsetHeight,o=He(t),r="border-box"===Q.css(t,"boxSizing",!1,o);if(0>=n||null==n){if(n=_(t,e,o),(0>n||null==n)&&(n=t.style[e]),Ue.test(n))return n;s=r&&(X.boxSizingReliable()||n===t.style[e]),n=parseFloat(n)||0}return n+S(t,e,i||(r?"border":"content"),s,o)+"px"}function $(t,e){for(var i,s,n,o=[],r=0,a=t.length;a>r;r++)s=t[r],s.style&&(o[r]=ve.get(s,"olddisplay"),i=s.style.display,e?(o[r]||"none"!==i||(s.style.display=""),""===s.style.display&&ke(s)&&(o[r]=ve.access(s,"olddisplay",w(s.nodeName)))):(n=ke(s),"none"===i&&n||ve.set(s,"olddisplay",n?i:Q.css(s,"display"))));for(r=0;a>r;r++)s=t[r],s.style&&(e&&"none"!==s.style.display&&""!==s.style.display||(s.style.display=e?o[r]||"":"none"));return t}function A(t,e,i,s,n){return new A.prototype.init(t,e,i,s,n)}function P(){return setTimeout(function(){Xe=void 0}),Xe=Q.now()}function I(t,e){var i,s=0,n={height:t};for(e=e?1:0;4>s;s+=2-e)i=xe[s],n["margin"+i]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function D(t,e,i){for(var s,n=(ii[e]||[]).concat(ii["*"]),o=0,r=n.length;r>o;o++)if(s=n[o].call(i,e,t))return s}function M(t,e,i){var s,n,o,r,a,l,h,c,d=this,u={},p=t.style,f=t.nodeType&&ke(t),g=ve.get(t,"fxshow");i.queue||(a=Q._queueHooks(t,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,d.always(function(){d.always(function(){a.unqueued--,Q.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],h=Q.css(t,"display"),c="none"===h?ve.get(t,"olddisplay")||w(t.nodeName):h,"inline"===c&&"none"===Q.css(t,"float")&&(p.display="inline-block")),i.overflow&&(p.overflow="hidden",d.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(s in e)if(n=e[s],Je.exec(n)){if(delete e[s],o=o||"toggle"===n,n===(f?"hide":"show")){if("show"!==n||!g||void 0===g[s])continue;f=!0}u[s]=g&&g[s]||Q.style(t,s)}else h=void 0;if(Q.isEmptyObject(u))"inline"===("none"===h?w(t.nodeName):h)&&(p.display=h);else{g?"hidden"in g&&(f=g.hidden):g=ve.access(t,"fxshow",{}),o&&(g.hidden=!f),f?Q(t).show():d.done(function(){Q(t).hide()}),d.done(function(){var e;ve.remove(t,"fxshow");for(e in u)Q.style(t,e,u[e])});for(s in u)r=D(f?g[s]:0,s,d),s in g||(g[s]=r.start,f&&(r.end=r.start,r.start="width"===s||"height"===s?1:0))}}function E(t,e){var i,s,n,o,r;for(i in t)if(s=Q.camelCase(i),n=e[s],o=t[i],Q.isArray(o)&&(n=o[1],o=t[i]=o[0]),i!==s&&(t[s]=o,delete t[i]),r=Q.cssHooks[s],r&&"expand"in r){o=r.expand(o),delete t[s];for(i in o)i in t||(t[i]=o[i],e[i]=n)}else e[s]=n}function L(t,e,i){var s,n,o=0,r=ei.length,a=Q.Deferred().always(function(){delete l.elem}),l=function(){if(n)return!1;for(var e=Xe||P(),i=Math.max(0,h.startTime+h.duration-e),s=i/h.duration||0,o=1-s,r=0,l=h.tweens.length;l>r;r++)h.tweens[r].run(o);return a.notifyWith(t,[h,o,i]),1>o&&l?i:(a.resolveWith(t,[h]),!1)},h=a.promise({elem:t,props:Q.extend({},e),opts:Q.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:Xe||P(),duration:i.duration,tweens:[],createTween:function(e,i){var s=Q.Tween(t,h.opts,e,i,h.opts.specialEasing[e]||h.opts.easing);return h.tweens.push(s),s},stop:function(e){var i=0,s=e?h.tweens.length:0;if(n)return this;for(n=!0;s>i;i++)h.tweens[i].run(1);return e?a.resolveWith(t,[h,e]):a.rejectWith(t,[h,e]),this}}),c=h.props;for(E(c,h.opts.specialEasing);r>o;o++)if(s=ei[o].call(h,t,c,h.opts))return s;return Q.map(c,D,h),Q.isFunction(h.opts.start)&&h.opts.start.call(t,h),Q.fx.timer(Q.extend(l,{elem:t,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function F(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var s,n=0,o=e.toLowerCase().match(pe)||[];if(Q.isFunction(i))for(;s=o[n++];)"+"===s[0]?(s=s.slice(1)||"*",(t[s]=t[s]||[]).unshift(i)):(t[s]=t[s]||[]).push(i)}}function z(t,e,i,s){function n(a){var l;return o[a]=!0,Q.each(t[a]||[],function(t,a){var h=a(e,i,s);return"string"!=typeof h||r||o[h]?r?!(l=h):void 0:(e.dataTypes.unshift(h),n(h),!1)}),l}var o={},r=t===_i;return n(e.dataTypes[0])||!o["*"]&&n("*")}function O(t,e){var i,s,n=Q.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((n[i]?t:s||(s={}))[i]=e[i]);return s&&Q.extend(!0,t,s),t}function R(t,e,i){for(var s,n,o,r,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===s&&(s=t.mimeType||e.getResponseHeader("Content-Type"));if(s)for(n in a)if(a[n]&&a[n].test(s)){l.unshift(n);break}if(l[0]in i)o=l[0];else{for(n in i){if(!l[0]||t.converters[n+" "+l[0]]){o=n;break}r||(r=n)}o=o||r}return o?(o!==l[0]&&l.unshift(o),i[o]):void 0}function N(t,e,i,s){var n,o,r,a,l,h={},c=t.dataTypes.slice();if(c[1])for(r in t.converters)h[r.toLowerCase()]=t.converters[r];for(o=c.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!l&&s&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(r=h[l+" "+o]||h["* "+o],!r)for(n in h)if(a=n.split(" "),a[1]===o&&(r=h[l+" "+a[0]]||h["* "+a[0]])){r===!0?r=h[n]:h[n]!==!0&&(o=a[0],c.unshift(a[1]));break}if(r!==!0)if(r&&t["throws"])e=r(e);else try{e=r(e)}catch(d){return{state:"parsererror",error:r?d:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}function B(t,e,i,s){var n;if(Q.isArray(e))Q.each(e,function(e,n){i||Si.test(t)?s(t,n):B(t+"["+("object"==typeof n?e:"")+"]",n,i,s)});else if(i||"object"!==Q.type(e))s(t,e);else for(n in e)B(t+"["+n+"]",e[n],i,s)}function j(t){return Q.isWindow(t)?t:9===t.nodeType&&t.defaultView}var U=[],H=U.slice,q=U.concat,V=U.push,W=U.indexOf,G={},Y=G.toString,Z=G.hasOwnProperty,X={},K=t.document,J="2.1.1",Q=function(t,e){return new Q.fn.init(t,e)},te=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ee=/^-ms-/,ie=/-([\da-z])/gi,se=function(t,e){return e.toUpperCase()};Q.fn=Q.prototype={jquery:J,constructor:Q,selector:"",length:0,toArray:function(){return H.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:H.call(this)},pushStack:function(t){var e=Q.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return Q.each(this,t,e)},map:function(t){return this.pushStack(Q.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(H.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:V,sort:U.sort,splice:U.splice},Q.extend=Q.fn.extend=function(){var t,e,i,s,n,o,r=arguments[0]||{},a=1,l=arguments.length,h=!1;for("boolean"==typeof r&&(h=r,r=arguments[a]||{},a++),"object"==typeof r||Q.isFunction(r)||(r={}),a===l&&(r=this,a--);l>a;a++)if(null!=(t=arguments[a]))for(e in t)i=r[e],s=t[e],r!==s&&(h&&s&&(Q.isPlainObject(s)||(n=Q.isArray(s)))?(n?(n=!1,o=i&&Q.isArray(i)?i:[]):o=i&&Q.isPlainObject(i)?i:{},r[e]=Q.extend(h,o,s)):void 0!==s&&(r[e]=s));return r},Q.extend({expando:"jQuery"+(J+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===Q.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!Q.isArray(t)&&t-parseFloat(t)>=0},isPlainObject:function(t){return"object"!==Q.type(t)||t.nodeType||Q.isWindow(t)?!1:t.constructor&&!Z.call(t.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?G[Y.call(t)]||"object":typeof t},globalEval:function(t){var e,i=eval;t=Q.trim(t),t&&(1===t.indexOf("use strict")?(e=K.createElement("script"),e.text=t,K.head.appendChild(e).parentNode.removeChild(e)):i(t))},camelCase:function(t){return t.replace(ee,"ms-").replace(ie,se)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,s){var n,o=0,r=t.length,a=i(t);if(s){if(a)for(;r>o&&(n=e.apply(t[o],s),n!==!1);o++);else for(o in t)if(n=e.apply(t[o],s),n===!1)break}else if(a)for(;r>o&&(n=e.call(t[o],o,t[o]),n!==!1);o++);else for(o in t)if(n=e.call(t[o],o,t[o]),n===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(te,"")},makeArray:function(t,e){var s=e||[];return null!=t&&(i(Object(t))?Q.merge(s,"string"==typeof t?[t]:t):V.call(s,t)),s},inArray:function(t,e,i){return null==e?-1:W.call(e,t,i)},merge:function(t,e){for(var i=+e.length,s=0,n=t.length;i>s;s++)t[n++]=e[s];return t.length=n,t},grep:function(t,e,i){for(var s,n=[],o=0,r=t.length,a=!i;r>o;o++)s=!e(t[o],o),s!==a&&n.push(t[o]);return n},map:function(t,e,s){var n,o=0,r=t.length,a=i(t),l=[];if(a)for(;r>o;o++)n=e(t[o],o,s),null!=n&&l.push(n);else for(o in t)n=e(t[o],o,s),null!=n&&l.push(n);return q.apply([],l)},guid:1,proxy:function(t,e){var i,s,n;return"string"==typeof e&&(i=t[e],e=t,t=i),Q.isFunction(t)?(s=H.call(arguments,2),n=function(){return t.apply(e||this,s.concat(H.call(arguments)))},n.guid=t.guid=t.guid||Q.guid++,n):void 0},now:Date.now,support:X}),Q.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){G["[object "+e+"]"]=e.toLowerCase()});var ne=function(t){function e(t,e,i,s){var n,o,r,a,l,h,d,p,f,g;if((e?e.ownerDocument||e:B)!==M&&D(e),e=e||M,i=i||[],!t||"string"!=typeof t)return i;if(1!==(a=e.nodeType)&&9!==a)return[];if(L&&!s){if(n=ye.exec(t))if(r=n[1]){if(9===a){if(o=e.getElementById(r),!o||!o.parentNode)return i;if(o.id===r)return i.push(o),i}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(r))&&R(e,o)&&o.id===r)return i.push(o),i}else{if(n[2])return Q.apply(i,e.getElementsByTagName(t)),i;if((r=n[3])&&_.getElementsByClassName&&e.getElementsByClassName)return Q.apply(i,e.getElementsByClassName(r)),i}if(_.qsa&&(!F||!F.test(t))){if(p=d=N,f=e,g=9===a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(h=S(t),(d=e.getAttribute("id"))?p=d.replace(we,"\\$&"):e.setAttribute("id",p),p="[id='"+p+"'] ",l=h.length;l--;)h[l]=p+u(h[l]);f=be.test(t)&&c(e.parentNode)||e,g=h.join(",")}if(g)try{return Q.apply(i,f.querySelectorAll(g)),i}catch(m){}finally{d||e.removeAttribute("id")}}}return $(t.replace(le,"$1"),e,i,s)}function i(){function t(i,s){return e.push(i+" ")>x.cacheLength&&delete t[e.shift()],t[i+" "]=s}var e=[];return t}function s(t){return t[N]=!0,t}function n(t){var e=M.createElement("div");try{return!!t(e)}catch(i){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var i=t.split("|"),s=t.length;s--;)x.attrHandle[i[s]]=e}function r(t,e){var i=e&&t,s=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||Y)-(~t.sourceIndex||Y);if(s)return s;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function a(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function l(t){return function(e){var i=e.nodeName.toLowerCase();
return("input"===i||"button"===i)&&e.type===t}}function h(t){return s(function(e){return e=+e,s(function(i,s){for(var n,o=t([],i.length,e),r=o.length;r--;)i[n=o[r]]&&(i[n]=!(s[n]=i[n]))})})}function c(t){return t&&typeof t.getElementsByTagName!==G&&t}function d(){}function u(t){for(var e=0,i=t.length,s="";i>e;e++)s+=t[e].value;return s}function p(t,e,i){var s=e.dir,n=i&&"parentNode"===s,o=U++;return e.first?function(e,i,o){for(;e=e[s];)if(1===e.nodeType||n)return t(e,i,o)}:function(e,i,r){var a,l,h=[j,o];if(r){for(;e=e[s];)if((1===e.nodeType||n)&&t(e,i,r))return!0}else for(;e=e[s];)if(1===e.nodeType||n){if(l=e[N]||(e[N]={}),(a=l[s])&&a[0]===j&&a[1]===o)return h[2]=a[2];if(l[s]=h,h[2]=t(e,i,r))return!0}}}function f(t){return t.length>1?function(e,i,s){for(var n=t.length;n--;)if(!t[n](e,i,s))return!1;return!0}:t[0]}function g(t,i,s){for(var n=0,o=i.length;o>n;n++)e(t,i[n],s);return s}function m(t,e,i,s,n){for(var o,r=[],a=0,l=t.length,h=null!=e;l>a;a++)(o=t[a])&&(!i||i(o,s,n))&&(r.push(o),h&&e.push(a));return r}function v(t,e,i,n,o,r){return n&&!n[N]&&(n=v(n)),o&&!o[N]&&(o=v(o,r)),s(function(s,r,a,l){var h,c,d,u=[],p=[],f=r.length,v=s||g(e||"*",a.nodeType?[a]:a,[]),y=!t||!s&&e?v:m(v,u,t,a,l),b=i?o||(s?t:f||n)?[]:r:y;if(i&&i(y,b,a,l),n)for(h=m(b,p),n(h,[],a,l),c=h.length;c--;)(d=h[c])&&(b[p[c]]=!(y[p[c]]=d));if(s){if(o||t){if(o){for(h=[],c=b.length;c--;)(d=b[c])&&h.push(y[c]=d);o(null,b=[],h,l)}for(c=b.length;c--;)(d=b[c])&&(h=o?ee.call(s,d):u[c])>-1&&(s[h]=!(r[h]=d))}}else b=m(b===r?b.splice(f,b.length):b),o?o(null,r,b,l):Q.apply(r,b)})}function y(t){for(var e,i,s,n=t.length,o=x.relative[t[0].type],r=o||x.relative[" "],a=o?1:0,l=p(function(t){return t===e},r,!0),h=p(function(t){return ee.call(e,t)>-1},r,!0),c=[function(t,i,s){return!o&&(s||i!==A)||((e=i).nodeType?l(t,i,s):h(t,i,s))}];n>a;a++)if(i=x.relative[t[a].type])c=[p(f(c),i)];else{if(i=x.filter[t[a].type].apply(null,t[a].matches),i[N]){for(s=++a;n>s&&!x.relative[t[s].type];s++);return v(a>1&&f(c),a>1&&u(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(le,"$1"),i,s>a&&y(t.slice(a,s)),n>s&&y(t=t.slice(s)),n>s&&u(t))}c.push(i)}return f(c)}function b(t,i){var n=i.length>0,o=t.length>0,r=function(s,r,a,l,h){var c,d,u,p=0,f="0",g=s&&[],v=[],y=A,b=s||o&&x.find.TAG("*",h),w=j+=null==y?1:Math.random()||.1,_=b.length;for(h&&(A=r!==M&&r);f!==_&&null!=(c=b[f]);f++){if(o&&c){for(d=0;u=t[d++];)if(u(c,r,a)){l.push(c);break}h&&(j=w)}n&&((c=!u&&c)&&p--,s&&g.push(c))}if(p+=f,n&&f!==p){for(d=0;u=i[d++];)u(g,v,r,a);if(s){if(p>0)for(;f--;)g[f]||v[f]||(v[f]=K.call(l));v=m(v)}Q.apply(l,v),h&&!s&&v.length>0&&p+i.length>1&&e.uniqueSort(l)}return h&&(j=w,A=y),g};return n?s(r):r}var w,_,x,k,C,S,T,$,A,P,I,D,M,E,L,F,z,O,R,N="sizzle"+-new Date,B=t.document,j=0,U=0,H=i(),q=i(),V=i(),W=function(t,e){return t===e&&(I=!0),0},G="undefined",Y=1<<31,Z={}.hasOwnProperty,X=[],K=X.pop,J=X.push,Q=X.push,te=X.slice,ee=X.indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]===t)return e;return-1},ie="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",se="[\\x20\\t\\r\\n\\f]",ne="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",oe=ne.replace("w","w#"),re="\\["+se+"*("+ne+")(?:"+se+"*([*^$|!~]?=)"+se+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+oe+"))|)"+se+"*\\]",ae=":("+ne+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+re+")*)|.*)\\)|)",le=new RegExp("^"+se+"+|((?:^|[^\\\\])(?:\\\\.)*)"+se+"+$","g"),he=new RegExp("^"+se+"*,"+se+"*"),ce=new RegExp("^"+se+"*([>+~]|"+se+")"+se+"*"),de=new RegExp("="+se+"*([^\\]'\"]*?)"+se+"*\\]","g"),ue=new RegExp(ae),pe=new RegExp("^"+oe+"$"),fe={ID:new RegExp("^#("+ne+")"),CLASS:new RegExp("^\\.("+ne+")"),TAG:new RegExp("^("+ne.replace("w","w*")+")"),ATTR:new RegExp("^"+re),PSEUDO:new RegExp("^"+ae),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+se+"*(even|odd|(([+-]|)(\\d*)n|)"+se+"*(?:([+-]|)"+se+"*(\\d+)|))"+se+"*\\)|)","i"),bool:new RegExp("^(?:"+ie+")$","i"),needsContext:new RegExp("^"+se+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+se+"*((?:-\\d)?\\d*)"+se+"*\\)|)(?=[^-]|$)","i")},ge=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,ve=/^[^{]+\{\s*\[native \w/,ye=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,be=/[+~]/,we=/'|\\/g,_e=new RegExp("\\\\([\\da-f]{1,6}"+se+"?|("+se+")|.)","ig"),xe=function(t,e,i){var s="0x"+e-65536;return s!==s||i?e:0>s?String.fromCharCode(s+65536):String.fromCharCode(s>>10|55296,1023&s|56320)};try{Q.apply(X=te.call(B.childNodes),B.childNodes),X[B.childNodes.length].nodeType}catch(ke){Q={apply:X.length?function(t,e){J.apply(t,te.call(e))}:function(t,e){for(var i=t.length,s=0;t[i++]=e[s++];);t.length=i-1}}}_=e.support={},C=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},D=e.setDocument=function(t){var e,i=t?t.ownerDocument||t:B,s=i.defaultView;return i!==M&&9===i.nodeType&&i.documentElement?(M=i,E=i.documentElement,L=!C(i),s&&s!==s.top&&(s.addEventListener?s.addEventListener("unload",function(){D()},!1):s.attachEvent&&s.attachEvent("onunload",function(){D()})),_.attributes=n(function(t){return t.className="i",!t.getAttribute("className")}),_.getElementsByTagName=n(function(t){return t.appendChild(i.createComment("")),!t.getElementsByTagName("*").length}),_.getElementsByClassName=ve.test(i.getElementsByClassName)&&n(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),_.getById=n(function(t){return E.appendChild(t).id=N,!i.getElementsByName||!i.getElementsByName(N).length}),_.getById?(x.find.ID=function(t,e){if(typeof e.getElementById!==G&&L){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},x.filter.ID=function(t){var e=t.replace(_e,xe);return function(t){return t.getAttribute("id")===e}}):(delete x.find.ID,x.filter.ID=function(t){var e=t.replace(_e,xe);return function(t){var i=typeof t.getAttributeNode!==G&&t.getAttributeNode("id");return i&&i.value===e}}),x.find.TAG=_.getElementsByTagName?function(t,e){return typeof e.getElementsByTagName!==G?e.getElementsByTagName(t):void 0}:function(t,e){var i,s=[],n=0,o=e.getElementsByTagName(t);if("*"===t){for(;i=o[n++];)1===i.nodeType&&s.push(i);return s}return o},x.find.CLASS=_.getElementsByClassName&&function(t,e){return typeof e.getElementsByClassName!==G&&L?e.getElementsByClassName(t):void 0},z=[],F=[],(_.qsa=ve.test(i.querySelectorAll))&&(n(function(t){t.innerHTML="<select msallowclip=''><option selected=''></option></select>",t.querySelectorAll("[msallowclip^='']").length&&F.push("[*^$]="+se+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||F.push("\\["+se+"*(?:value|"+ie+")"),t.querySelectorAll(":checked").length||F.push(":checked")}),n(function(t){var e=i.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&F.push("name"+se+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||F.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),F.push(",.*:")})),(_.matchesSelector=ve.test(O=E.matches||E.webkitMatchesSelector||E.mozMatchesSelector||E.oMatchesSelector||E.msMatchesSelector))&&n(function(t){_.disconnectedMatch=O.call(t,"div"),O.call(t,"[s!='']:x"),z.push("!=",ae)}),F=F.length&&new RegExp(F.join("|")),z=z.length&&new RegExp(z.join("|")),e=ve.test(E.compareDocumentPosition),R=e||ve.test(E.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,s=e&&e.parentNode;return t===s||!(!s||1!==s.nodeType||!(i.contains?i.contains(s):t.compareDocumentPosition&&16&t.compareDocumentPosition(s)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},W=e?function(t,e){if(t===e)return I=!0,0;var s=!t.compareDocumentPosition-!e.compareDocumentPosition;return s?s:(s=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&s||!_.sortDetached&&e.compareDocumentPosition(t)===s?t===i||t.ownerDocument===B&&R(B,t)?-1:e===i||e.ownerDocument===B&&R(B,e)?1:P?ee.call(P,t)-ee.call(P,e):0:4&s?-1:1)}:function(t,e){if(t===e)return I=!0,0;var s,n=0,o=t.parentNode,a=e.parentNode,l=[t],h=[e];if(!o||!a)return t===i?-1:e===i?1:o?-1:a?1:P?ee.call(P,t)-ee.call(P,e):0;if(o===a)return r(t,e);for(s=t;s=s.parentNode;)l.unshift(s);for(s=e;s=s.parentNode;)h.unshift(s);for(;l[n]===h[n];)n++;return n?r(l[n],h[n]):l[n]===B?-1:h[n]===B?1:0},i):M},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==M&&D(t),i=i.replace(de,"='$1']"),!(!_.matchesSelector||!L||z&&z.test(i)||F&&F.test(i)))try{var s=O.call(t,i);if(s||_.disconnectedMatch||t.document&&11!==t.document.nodeType)return s}catch(n){}return e(i,M,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==M&&D(t),R(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==M&&D(t);var i=x.attrHandle[e.toLowerCase()],s=i&&Z.call(x.attrHandle,e.toLowerCase())?i(t,e,!L):void 0;return void 0!==s?s:_.attributes||!L?t.getAttribute(e):(s=t.getAttributeNode(e))&&s.specified?s.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],s=0,n=0;if(I=!_.detectDuplicates,P=!_.sortStable&&t.slice(0),t.sort(W),I){for(;e=t[n++];)e===t[n]&&(s=i.push(n));for(;s--;)t.splice(i[s],1)}return P=null,t},k=e.getText=function(t){var e,i="",s=0,n=t.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=k(t)}else if(3===n||4===n)return t.nodeValue}else for(;e=t[s++];)i+=k(e);return i},x=e.selectors={cacheLength:50,createPseudo:s,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(_e,xe),t[3]=(t[3]||t[4]||t[5]||"").replace(_e,xe),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return fe.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&ue.test(i)&&(e=S(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(_e,xe).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=H[t+" "];return e||(e=new RegExp("(^|"+se+")"+t+"("+se+"|$)"))&&H(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==G&&t.getAttribute("class")||"")})},ATTR:function(t,i,s){return function(n){var o=e.attr(n,t);return null==o?"!="===i:i?(o+="","="===i?o===s:"!="===i?o!==s:"^="===i?s&&0===o.indexOf(s):"*="===i?s&&o.indexOf(s)>-1:"$="===i?s&&o.slice(-s.length)===s:"~="===i?(" "+o+" ").indexOf(s)>-1:"|="===i?o===s||o.slice(0,s.length+1)===s+"-":!1):!0}},CHILD:function(t,e,i,s,n){var o="nth"!==t.slice(0,3),r="last"!==t.slice(-4),a="of-type"===e;return 1===s&&0===n?function(t){return!!t.parentNode}:function(e,i,l){var h,c,d,u,p,f,g=o!==r?"nextSibling":"previousSibling",m=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!l&&!a;if(m){if(o){for(;g;){for(d=e;d=d[g];)if(a?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[r?m.firstChild:m.lastChild],r&&y){for(c=m[N]||(m[N]={}),h=c[t]||[],p=h[0]===j&&h[1],u=h[0]===j&&h[2],d=p&&m.childNodes[p];d=++p&&d&&d[g]||(u=p=0)||f.pop();)if(1===d.nodeType&&++u&&d===e){c[t]=[j,p,u];break}}else if(y&&(h=(e[N]||(e[N]={}))[t])&&h[0]===j)u=h[1];else for(;(d=++p&&d&&d[g]||(u=p=0)||f.pop())&&((a?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++u||(y&&((d[N]||(d[N]={}))[t]=[j,u]),d!==e)););return u-=n,u===s||u%s===0&&u/s>=0}}},PSEUDO:function(t,i){var n,o=x.pseudos[t]||x.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[N]?o(i):o.length>1?(n=[t,t,"",i],x.setFilters.hasOwnProperty(t.toLowerCase())?s(function(t,e){for(var s,n=o(t,i),r=n.length;r--;)s=ee.call(t,n[r]),t[s]=!(e[s]=n[r])}):function(t){return o(t,0,n)}):o}},pseudos:{not:s(function(t){var e=[],i=[],n=T(t.replace(le,"$1"));return n[N]?s(function(t,e,i,s){for(var o,r=n(t,null,s,[]),a=t.length;a--;)(o=r[a])&&(t[a]=!(e[a]=o))}):function(t,s,o){return e[0]=t,n(e,null,o,i),!i.pop()}}),has:s(function(t){return function(i){return e(t,i).length>0}}),contains:s(function(t){return function(e){return(e.textContent||e.innerText||k(e)).indexOf(t)>-1}}),lang:s(function(t){return pe.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(_e,xe).toLowerCase(),function(e){var i;do if(i=L?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===E},focus:function(t){return t===M.activeElement&&(!M.hasFocus||M.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!x.pseudos.empty(t)},header:function(t){return me.test(t.nodeName)},input:function(t){return ge.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:h(function(){return[0]}),last:h(function(t,e){return[e-1]}),eq:h(function(t,e,i){return[0>i?i+e:i]}),even:h(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:h(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:h(function(t,e,i){for(var s=0>i?i+e:i;--s>=0;)t.push(s);return t}),gt:h(function(t,e,i){for(var s=0>i?i+e:i;++s<e;)t.push(s);return t})}},x.pseudos.nth=x.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[w]=a(w);for(w in{submit:!0,reset:!0})x.pseudos[w]=l(w);return d.prototype=x.filters=x.pseudos,x.setFilters=new d,S=e.tokenize=function(t,i){var s,n,o,r,a,l,h,c=q[t+" "];if(c)return i?0:c.slice(0);for(a=t,l=[],h=x.preFilter;a;){(!s||(n=he.exec(a)))&&(n&&(a=a.slice(n[0].length)||a),l.push(o=[])),s=!1,(n=ce.exec(a))&&(s=n.shift(),o.push({value:s,type:n[0].replace(le," ")}),a=a.slice(s.length));for(r in x.filter)!(n=fe[r].exec(a))||h[r]&&!(n=h[r](n))||(s=n.shift(),o.push({value:s,type:r,matches:n}),a=a.slice(s.length));if(!s)break}return i?a.length:a?e.error(t):q(t,l).slice(0)},T=e.compile=function(t,e){var i,s=[],n=[],o=V[t+" "];if(!o){for(e||(e=S(t)),i=e.length;i--;)o=y(e[i]),o[N]?s.push(o):n.push(o);o=V(t,b(n,s)),o.selector=t}return o},$=e.select=function(t,e,i,s){var n,o,r,a,l,h="function"==typeof t&&t,d=!s&&S(t=h.selector||t);if(i=i||[],1===d.length){if(o=d[0]=d[0].slice(0),o.length>2&&"ID"===(r=o[0]).type&&_.getById&&9===e.nodeType&&L&&x.relative[o[1].type]){if(e=(x.find.ID(r.matches[0].replace(_e,xe),e)||[])[0],!e)return i;h&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(n=fe.needsContext.test(t)?0:o.length;n--&&(r=o[n],!x.relative[a=r.type]);)if((l=x.find[a])&&(s=l(r.matches[0].replace(_e,xe),be.test(o[0].type)&&c(e.parentNode)||e))){if(o.splice(n,1),t=s.length&&u(o),!t)return Q.apply(i,s),i;break}}return(h||T(t,d))(s,e,!L,i,be.test(t)&&c(e.parentNode)||e),i},_.sortStable=N.split("").sort(W).join("")===N,_.detectDuplicates=!!I,D(),_.sortDetached=n(function(t){return 1&t.compareDocumentPosition(M.createElement("div"))}),n(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,i){return i?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),_.attributes&&n(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,i){return i||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),n(function(t){return null==t.getAttribute("disabled")})||o(ie,function(t,e,i){var s;return i?void 0:t[e]===!0?e.toLowerCase():(s=t.getAttributeNode(e))&&s.specified?s.value:null}),e}(t);Q.find=ne,Q.expr=ne.selectors,Q.expr[":"]=Q.expr.pseudos,Q.unique=ne.uniqueSort,Q.text=ne.getText,Q.isXMLDoc=ne.isXML,Q.contains=ne.contains;var oe=Q.expr.match.needsContext,re=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ae=/^.[^:#\[\.,]*$/;Q.filter=function(t,e,i){var s=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===s.nodeType?Q.find.matchesSelector(s,t)?[s]:[]:Q.find.matches(t,Q.grep(e,function(t){return 1===t.nodeType}))},Q.fn.extend({find:function(t){var e,i=this.length,s=[],n=this;if("string"!=typeof t)return this.pushStack(Q(t).filter(function(){for(e=0;i>e;e++)if(Q.contains(n[e],this))return!0}));for(e=0;i>e;e++)Q.find(t,n[e],s);return s=this.pushStack(i>1?Q.unique(s):s),s.selector=this.selector?this.selector+" "+t:t,s},filter:function(t){return this.pushStack(s(this,t||[],!1))},not:function(t){return this.pushStack(s(this,t||[],!0))},is:function(t){return!!s(this,"string"==typeof t&&oe.test(t)?Q(t):t||[],!1).length}});var le,he=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ce=Q.fn.init=function(t,e){var i,s;if(!t)return this;if("string"==typeof t){if(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:he.exec(t),!i||!i[1]&&e)return!e||e.jquery?(e||le).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof Q?e[0]:e,Q.merge(this,Q.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:K,!0)),re.test(i[1])&&Q.isPlainObject(e))for(i in e)Q.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return s=K.getElementById(i[2]),s&&s.parentNode&&(this.length=1,this[0]=s),this.context=K,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):Q.isFunction(t)?"undefined"!=typeof le.ready?le.ready(t):t(Q):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),Q.makeArray(t,this))};ce.prototype=Q.fn,le=Q(K);var de=/^(?:parents|prev(?:Until|All))/,ue={children:!0,contents:!0,next:!0,prev:!0};Q.extend({dir:function(t,e,i){for(var s=[],n=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(n&&Q(t).is(i))break;s.push(t)}return s},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}}),Q.fn.extend({has:function(t){var e=Q(t,this),i=e.length;return this.filter(function(){for(var t=0;i>t;t++)if(Q.contains(this,e[t]))return!0})},closest:function(t,e){for(var i,s=0,n=this.length,o=[],r=oe.test(t)||"string"!=typeof t?Q(t,e||this.context):0;n>s;s++)for(i=this[s];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(r?r.index(i)>-1:1===i.nodeType&&Q.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(o.length>1?Q.unique(o):o)},index:function(t){return t?"string"==typeof t?W.call(Q(t),this[0]):W.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(Q.unique(Q.merge(this.get(),Q(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),Q.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return Q.dir(t,"parentNode")},parentsUntil:function(t,e,i){return Q.dir(t,"parentNode",i)},next:function(t){return n(t,"nextSibling")},prev:function(t){return n(t,"previousSibling")},nextAll:function(t){return Q.dir(t,"nextSibling")},prevAll:function(t){return Q.dir(t,"previousSibling")},nextUntil:function(t,e,i){return Q.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return Q.dir(t,"previousSibling",i)},siblings:function(t){return Q.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return Q.sibling(t.firstChild)},contents:function(t){return t.contentDocument||Q.merge([],t.childNodes)}},function(t,e){Q.fn[t]=function(i,s){var n=Q.map(this,e,i);return"Until"!==t.slice(-5)&&(s=i),s&&"string"==typeof s&&(n=Q.filter(s,n)),this.length>1&&(ue[t]||Q.unique(n),de.test(t)&&n.reverse()),this.pushStack(n)}});var pe=/\S+/g,fe={};Q.Callbacks=function(t){t="string"==typeof t?fe[t]||o(t):Q.extend({},t);var e,i,s,n,r,a,l=[],h=!t.once&&[],c=function(o){for(e=t.memory&&o,i=!0,a=n||0,n=0,r=l.length,s=!0;l&&r>a;a++)if(l[a].apply(o[0],o[1])===!1&&t.stopOnFalse){e=!1;break}s=!1,l&&(h?h.length&&c(h.shift()):e?l=[]:d.disable())},d={add:function(){if(l){var i=l.length;!function o(e){Q.each(e,function(e,i){var s=Q.type(i);"function"===s?t.unique&&d.has(i)||l.push(i):i&&i.length&&"string"!==s&&o(i)})}(arguments),s?r=l.length:e&&(n=i,c(e))}return this},remove:function(){return l&&Q.each(arguments,function(t,e){for(var i;(i=Q.inArray(e,l,i))>-1;)l.splice(i,1),s&&(r>=i&&r--,a>=i&&a--)}),this},has:function(t){return t?Q.inArray(t,l)>-1:!(!l||!l.length)},empty:function(){return l=[],r=0,this},disable:function(){return l=h=e=void 0,this},disabled:function(){return!l},lock:function(){return h=void 0,e||d.disable(),this},locked:function(){return!h},fireWith:function(t,e){return!l||i&&!h||(e=e||[],e=[t,e.slice?e.slice():e],s?h.push(e):c(e)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!i}};return d},Q.extend({Deferred:function(t){var e=[["resolve","done",Q.Callbacks("once memory"),"resolved"],["reject","fail",Q.Callbacks("once memory"),"rejected"],["notify","progress",Q.Callbacks("memory")]],i="pending",s={state:function(){return i},always:function(){return n.done(arguments).fail(arguments),this},then:function(){var t=arguments;return Q.Deferred(function(i){Q.each(e,function(e,o){var r=Q.isFunction(t[e])&&t[e];n[o[1]](function(){var t=r&&r.apply(this,arguments);t&&Q.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o[0]+"With"](this===s?i.promise():this,r?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?Q.extend(t,s):s}},n={};return s.pipe=s.then,Q.each(e,function(t,o){var r=o[2],a=o[3];s[o[1]]=r.add,a&&r.add(function(){i=a},e[1^t][2].disable,e[2][2].lock),n[o[0]]=function(){return n[o[0]+"With"](this===n?s:this,arguments),this},n[o[0]+"With"]=r.fireWith}),s.promise(n),t&&t.call(n,n),n},when:function(t){var e,i,s,n=0,o=H.call(arguments),r=o.length,a=1!==r||t&&Q.isFunction(t.promise)?r:0,l=1===a?t:Q.Deferred(),h=function(t,i,s){return function(n){i[t]=this,s[t]=arguments.length>1?H.call(arguments):n,s===e?l.notifyWith(i,s):--a||l.resolveWith(i,s)}};if(r>1)for(e=new Array(r),i=new Array(r),s=new Array(r);r>n;n++)o[n]&&Q.isFunction(o[n].promise)?o[n].promise().done(h(n,s,o)).fail(l.reject).progress(h(n,i,e)):--a;return a||l.resolveWith(s,o),l.promise()}});var ge;Q.fn.ready=function(t){return Q.ready.promise().done(t),this},Q.extend({isReady:!1,readyWait:1,holdReady:function(t){t?Q.readyWait++:Q.ready(!0)},ready:function(t){(t===!0?--Q.readyWait:Q.isReady)||(Q.isReady=!0,t!==!0&&--Q.readyWait>0||(ge.resolveWith(K,[Q]),Q.fn.triggerHandler&&(Q(K).triggerHandler("ready"),Q(K).off("ready"))))}}),Q.ready.promise=function(e){return ge||(ge=Q.Deferred(),"complete"===K.readyState?setTimeout(Q.ready):(K.addEventListener("DOMContentLoaded",r,!1),t.addEventListener("load",r,!1))),ge.promise(e)},Q.ready.promise();var me=Q.access=function(t,e,i,s,n,o,r){var a=0,l=t.length,h=null==i;if("object"===Q.type(i)){n=!0;for(a in i)Q.access(t,e,a,i[a],!0,o,r)}else if(void 0!==s&&(n=!0,Q.isFunction(s)||(r=!0),h&&(r?(e.call(t,s),e=null):(h=e,e=function(t,e,i){return h.call(Q(t),i)})),e))for(;l>a;a++)e(t[a],i,r?s:s.call(t[a],a,e(t[a],i)));return n?t:h?e.call(t):l?e(t[0],i):o};Q.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},a.uid=1,a.accepts=Q.acceptData,a.prototype={key:function(t){if(!a.accepts(t))return 0;var e={},i=t[this.expando];if(!i){i=a.uid++;try{e[this.expando]={value:i},Object.defineProperties(t,e)}catch(s){e[this.expando]=i,Q.extend(t,e)}}return this.cache[i]||(this.cache[i]={}),i},set:function(t,e,i){var s,n=this.key(t),o=this.cache[n];if("string"==typeof e)o[e]=i;else if(Q.isEmptyObject(o))Q.extend(this.cache[n],e);else for(s in e)o[s]=e[s];return o},get:function(t,e){var i=this.cache[this.key(t)];return void 0===e?i:i[e]},access:function(t,e,i){var s;return void 0===e||e&&"string"==typeof e&&void 0===i?(s=this.get(t,e),void 0!==s?s:this.get(t,Q.camelCase(e))):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,s,n,o=this.key(t),r=this.cache[o];if(void 0===e)this.cache[o]={};else{Q.isArray(e)?s=e.concat(e.map(Q.camelCase)):(n=Q.camelCase(e),e in r?s=[e,n]:(s=n,s=s in r?[s]:s.match(pe)||[])),i=s.length;for(;i--;)delete r[s[i]]}},hasData:function(t){return!Q.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var ve=new a,ye=new a,be=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,we=/([A-Z])/g;Q.extend({hasData:function(t){return ye.hasData(t)||ve.hasData(t)},data:function(t,e,i){return ye.access(t,e,i)},removeData:function(t,e){ye.remove(t,e)},_data:function(t,e,i){return ve.access(t,e,i)},_removeData:function(t,e){ve.remove(t,e)}}),Q.fn.extend({data:function(t,e){var i,s,n,o=this[0],r=o&&o.attributes;if(void 0===t){if(this.length&&(n=ye.get(o),1===o.nodeType&&!ve.get(o,"hasDataAttrs"))){for(i=r.length;i--;)r[i]&&(s=r[i].name,0===s.indexOf("data-")&&(s=Q.camelCase(s.slice(5)),l(o,s,n[s])));ve.set(o,"hasDataAttrs",!0)}return n}return"object"==typeof t?this.each(function(){ye.set(this,t)}):me(this,function(e){var i,s=Q.camelCase(t);if(o&&void 0===e){if(i=ye.get(o,t),void 0!==i)return i;if(i=ye.get(o,s),void 0!==i)return i;if(i=l(o,s,void 0),void 0!==i)return i}else this.each(function(){var i=ye.get(this,s);ye.set(this,s,e),-1!==t.indexOf("-")&&void 0!==i&&ye.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){ye.remove(this,t)})}}),Q.extend({queue:function(t,e,i){var s;return t?(e=(e||"fx")+"queue",s=ve.get(t,e),i&&(!s||Q.isArray(i)?s=ve.access(t,e,Q.makeArray(i)):s.push(i)),s||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=Q.queue(t,e),s=i.length,n=i.shift(),o=Q._queueHooks(t,e),r=function(){Q.dequeue(t,e)};"inprogress"===n&&(n=i.shift(),s--),n&&("fx"===e&&i.unshift("inprogress"),delete o.stop,n.call(t,r,o)),!s&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return ve.get(t,i)||ve.access(t,i,{empty:Q.Callbacks("once memory").add(function(){ve.remove(t,[e+"queue",i])})})}}),Q.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?Q.queue(this[0],t):void 0===e?this:this.each(function(){var i=Q.queue(this,t,e);Q._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&Q.dequeue(this,t)})},dequeue:function(t){return this.each(function(){Q.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,s=1,n=Q.Deferred(),o=this,r=this.length,a=function(){--s||n.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";r--;)i=ve.get(o[r],t+"queueHooks"),i&&i.empty&&(s++,i.empty.add(a));return a(),n.promise(e)}});var _e=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,xe=["Top","Right","Bottom","Left"],ke=function(t,e){return t=e||t,"none"===Q.css(t,"display")||!Q.contains(t.ownerDocument,t)},Ce=/^(?:checkbox|radio)$/i;!function(){var t=K.createDocumentFragment(),e=t.appendChild(K.createElement("div")),i=K.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),e.appendChild(i),X.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",X.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var Se="undefined";X.focusinBubbles="onfocusin"in t;var Te=/^key/,$e=/^(?:mouse|pointer|contextmenu)|click/,Ae=/^(?:focusinfocus|focusoutblur)$/,Pe=/^([^.]*)(?:\.(.+)|)$/;Q.event={global:{},add:function(t,e,i,s,n){var o,r,a,l,h,c,d,u,p,f,g,m=ve.get(t);if(m)for(i.handler&&(o=i,i=o.handler,n=o.selector),i.guid||(i.guid=Q.guid++),(l=m.events)||(l=m.events={}),(r=m.handle)||(r=m.handle=function(e){return typeof Q!==Se&&Q.event.triggered!==e.type?Q.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(pe)||[""],h=e.length;h--;)a=Pe.exec(e[h])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p&&(d=Q.event.special[p]||{},p=(n?d.delegateType:d.bindType)||p,d=Q.event.special[p]||{},c=Q.extend({type:p,origType:g,data:s,handler:i,guid:i.guid,selector:n,needsContext:n&&Q.expr.match.needsContext.test(n),namespace:f.join(".")},o),(u=l[p])||(u=l[p]=[],u.delegateCount=0,d.setup&&d.setup.call(t,s,f,r)!==!1||t.addEventListener&&t.addEventListener(p,r,!1)),d.add&&(d.add.call(t,c),c.handler.guid||(c.handler.guid=i.guid)),n?u.splice(u.delegateCount++,0,c):u.push(c),Q.event.global[p]=!0)},remove:function(t,e,i,s,n){var o,r,a,l,h,c,d,u,p,f,g,m=ve.hasData(t)&&ve.get(t);if(m&&(l=m.events)){for(e=(e||"").match(pe)||[""],h=e.length;h--;)if(a=Pe.exec(e[h])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p){for(d=Q.event.special[p]||{},p=(s?d.delegateType:d.bindType)||p,u=l[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),r=o=u.length;o--;)c=u[o],!n&&g!==c.origType||i&&i.guid!==c.guid||a&&!a.test(c.namespace)||s&&s!==c.selector&&("**"!==s||!c.selector)||(u.splice(o,1),c.selector&&u.delegateCount--,d.remove&&d.remove.call(t,c));r&&!u.length&&(d.teardown&&d.teardown.call(t,f,m.handle)!==!1||Q.removeEvent(t,p,m.handle),delete l[p])}else for(p in l)Q.event.remove(t,p+e[h],i,s,!0);Q.isEmptyObject(l)&&(delete m.handle,ve.remove(t,"events"))}},trigger:function(e,i,s,n){var o,r,a,l,h,c,d,u=[s||K],p=Z.call(e,"type")?e.type:e,f=Z.call(e,"namespace")?e.namespace.split("."):[];if(r=a=s=s||K,3!==s.nodeType&&8!==s.nodeType&&!Ae.test(p+Q.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),h=p.indexOf(":")<0&&"on"+p,e=e[Q.expando]?e:new Q.Event(p,"object"==typeof e&&e),e.isTrigger=n?2:3,e.namespace=f.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=s),i=null==i?[e]:Q.makeArray(i,[e]),d=Q.event.special[p]||{},n||!d.trigger||d.trigger.apply(s,i)!==!1)){if(!n&&!d.noBubble&&!Q.isWindow(s)){for(l=d.delegateType||p,Ae.test(l+p)||(r=r.parentNode);r;r=r.parentNode)u.push(r),a=r;a===(s.ownerDocument||K)&&u.push(a.defaultView||a.parentWindow||t)}for(o=0;(r=u[o++])&&!e.isPropagationStopped();)e.type=o>1?l:d.bindType||p,c=(ve.get(r,"events")||{})[e.type]&&ve.get(r,"handle"),c&&c.apply(r,i),c=h&&r[h],c&&c.apply&&Q.acceptData(r)&&(e.result=c.apply(r,i),e.result===!1&&e.preventDefault());return e.type=p,n||e.isDefaultPrevented()||d._default&&d._default.apply(u.pop(),i)!==!1||!Q.acceptData(s)||h&&Q.isFunction(s[p])&&!Q.isWindow(s)&&(a=s[h],a&&(s[h]=null),Q.event.triggered=p,s[p](),Q.event.triggered=void 0,a&&(s[h]=a)),e.result}},dispatch:function(t){t=Q.event.fix(t);var e,i,s,n,o,r=[],a=H.call(arguments),l=(ve.get(this,"events")||{})[t.type]||[],h=Q.event.special[t.type]||{};if(a[0]=t,t.delegateTarget=this,!h.preDispatch||h.preDispatch.call(this,t)!==!1){for(r=Q.event.handlers.call(this,t,l),e=0;(n=r[e++])&&!t.isPropagationStopped();)for(t.currentTarget=n.elem,i=0;(o=n.handlers[i++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(o.namespace))&&(t.handleObj=o,t.data=o.data,s=((Q.event.special[o.origType]||{}).handle||o.handler).apply(n.elem,a),void 0!==s&&(t.result=s)===!1&&(t.preventDefault(),t.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,s,n,o,r=[],a=e.delegateCount,l=t.target;if(a&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==t.type){for(s=[],i=0;a>i;i++)o=e[i],n=o.selector+" ",void 0===s[n]&&(s[n]=o.needsContext?Q(n,this).index(l)>=0:Q.find(n,this,null,[l]).length),s[n]&&s.push(o);
s.length&&r.push({elem:l,handlers:s})}return a<e.length&&r.push({elem:this,handlers:e.slice(a)}),r},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,s,n,o=e.button;return null==t.pageX&&null!=e.clientX&&(i=t.target.ownerDocument||K,s=i.documentElement,n=i.body,t.pageX=e.clientX+(s&&s.scrollLeft||n&&n.scrollLeft||0)-(s&&s.clientLeft||n&&n.clientLeft||0),t.pageY=e.clientY+(s&&s.scrollTop||n&&n.scrollTop||0)-(s&&s.clientTop||n&&n.clientTop||0)),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},fix:function(t){if(t[Q.expando])return t;var e,i,s,n=t.type,o=t,r=this.fixHooks[n];for(r||(this.fixHooks[n]=r=$e.test(n)?this.mouseHooks:Te.test(n)?this.keyHooks:{}),s=r.props?this.props.concat(r.props):this.props,t=new Q.Event(o),e=s.length;e--;)i=s[e],t[i]=o[i];return t.target||(t.target=K),3===t.target.nodeType&&(t.target=t.target.parentNode),r.filter?r.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==d()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===d()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Q.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return Q.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,s){var n=Q.extend(new Q.Event,i,{type:t,isSimulated:!0,originalEvent:{}});s?Q.event.trigger(n,null,e):Q.event.dispatch.call(e,n),n.isDefaultPrevented()&&i.preventDefault()}},Q.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)},Q.Event=function(t,e){return this instanceof Q.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?h:c):this.type=t,e&&Q.extend(this,e),this.timeStamp=t&&t.timeStamp||Q.now(),void(this[Q.expando]=!0)):new Q.Event(t,e)},Q.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=h,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=h,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=h,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},Q.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){Q.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,s=this,n=t.relatedTarget,o=t.handleObj;return(!n||n!==s&&!Q.contains(s,n))&&(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}}),X.focusinBubbles||Q.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){Q.event.simulate(e,t.target,Q.event.fix(t),!0)};Q.event.special[e]={setup:function(){var s=this.ownerDocument||this,n=ve.access(s,e);n||s.addEventListener(t,i,!0),ve.access(s,e,(n||0)+1)},teardown:function(){var s=this.ownerDocument||this,n=ve.access(s,e)-1;n?ve.access(s,e,n):(s.removeEventListener(t,i,!0),ve.remove(s,e))}}}),Q.fn.extend({on:function(t,e,i,s,n){var o,r;if("object"==typeof t){"string"!=typeof e&&(i=i||e,e=void 0);for(r in t)this.on(r,e,i,t[r],n);return this}if(null==i&&null==s?(s=e,i=e=void 0):null==s&&("string"==typeof e?(s=i,i=void 0):(s=i,i=e,e=void 0)),s===!1)s=c;else if(!s)return this;return 1===n&&(o=s,s=function(t){return Q().off(t),o.apply(this,arguments)},s.guid=o.guid||(o.guid=Q.guid++)),this.each(function(){Q.event.add(this,t,s,i,e)})},one:function(t,e,i,s){return this.on(t,e,i,s,1)},off:function(t,e,i){var s,n;if(t&&t.preventDefault&&t.handleObj)return s=t.handleObj,Q(t.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this;if("object"==typeof t){for(n in t)this.off(n,e,t[n]);return this}return(e===!1||"function"==typeof e)&&(i=e,e=void 0),i===!1&&(i=c),this.each(function(){Q.event.remove(this,t,i,e)})},trigger:function(t,e){return this.each(function(){Q.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];return i?Q.event.trigger(t,e,i,!0):void 0}});var Ie=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,De=/<([\w:]+)/,Me=/<|&#?\w+;/,Ee=/<(?:script|style|link)/i,Le=/checked\s*(?:[^=]|=\s*.checked.)/i,Fe=/^$|\/(?:java|ecma)script/i,ze=/^true\/(.*)/,Oe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Re={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Re.optgroup=Re.option,Re.tbody=Re.tfoot=Re.colgroup=Re.caption=Re.thead,Re.th=Re.td,Q.extend({clone:function(t,e,i){var s,n,o,r,a=t.cloneNode(!0),l=Q.contains(t.ownerDocument,t);if(!(X.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||Q.isXMLDoc(t)))for(r=v(a),o=v(t),s=0,n=o.length;n>s;s++)y(o[s],r[s]);if(e)if(i)for(o=o||v(t),r=r||v(a),s=0,n=o.length;n>s;s++)m(o[s],r[s]);else m(t,a);return r=v(a,"script"),r.length>0&&g(r,!l&&v(t,"script")),a},buildFragment:function(t,e,i,s){for(var n,o,r,a,l,h,c=e.createDocumentFragment(),d=[],u=0,p=t.length;p>u;u++)if(n=t[u],n||0===n)if("object"===Q.type(n))Q.merge(d,n.nodeType?[n]:n);else if(Me.test(n)){for(o=o||c.appendChild(e.createElement("div")),r=(De.exec(n)||["",""])[1].toLowerCase(),a=Re[r]||Re._default,o.innerHTML=a[1]+n.replace(Ie,"<$1></$2>")+a[2],h=a[0];h--;)o=o.lastChild;Q.merge(d,o.childNodes),o=c.firstChild,o.textContent=""}else d.push(e.createTextNode(n));for(c.textContent="",u=0;n=d[u++];)if((!s||-1===Q.inArray(n,s))&&(l=Q.contains(n.ownerDocument,n),o=v(c.appendChild(n),"script"),l&&g(o),i))for(h=0;n=o[h++];)Fe.test(n.type||"")&&i.push(n);return c},cleanData:function(t){for(var e,i,s,n,o=Q.event.special,r=0;void 0!==(i=t[r]);r++){if(Q.acceptData(i)&&(n=i[ve.expando],n&&(e=ve.cache[n]))){if(e.events)for(s in e.events)o[s]?Q.event.remove(i,s):Q.removeEvent(i,s,e.handle);ve.cache[n]&&delete ve.cache[n]}delete ye.cache[i[ye.expando]]}}}),Q.fn.extend({text:function(t){return me(this,function(t){return void 0===t?Q.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=t)})},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=u(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=u(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,s=t?Q.filter(t,this):this,n=0;null!=(i=s[n]);n++)e||1!==i.nodeType||Q.cleanData(v(i)),i.parentNode&&(e&&Q.contains(i.ownerDocument,i)&&g(v(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(Q.cleanData(v(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return Q.clone(this,t,e)})},html:function(t){return me(this,function(t){var e=this[0]||{},i=0,s=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Ee.test(t)&&!Re[(De.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(Ie,"<$1></$2>");try{for(;s>i;i++)e=this[i]||{},1===e.nodeType&&(Q.cleanData(v(e,!1)),e.innerHTML=t);e=0}catch(n){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,Q.cleanData(v(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=q.apply([],t);var i,s,n,o,r,a,l=0,h=this.length,c=this,d=h-1,u=t[0],g=Q.isFunction(u);if(g||h>1&&"string"==typeof u&&!X.checkClone&&Le.test(u))return this.each(function(i){var s=c.eq(i);g&&(t[0]=u.call(this,i,s.html())),s.domManip(t,e)});if(h&&(i=Q.buildFragment(t,this[0].ownerDocument,!1,this),s=i.firstChild,1===i.childNodes.length&&(i=s),s)){for(n=Q.map(v(i,"script"),p),o=n.length;h>l;l++)r=i,l!==d&&(r=Q.clone(r,!0,!0),o&&Q.merge(n,v(r,"script"))),e.call(this[l],r,l);if(o)for(a=n[n.length-1].ownerDocument,Q.map(n,f),l=0;o>l;l++)r=n[l],Fe.test(r.type||"")&&!ve.access(r,"globalEval")&&Q.contains(a,r)&&(r.src?Q._evalUrl&&Q._evalUrl(r.src):Q.globalEval(r.textContent.replace(Oe,"")))}return this}}),Q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){Q.fn[t]=function(t){for(var i,s=[],n=Q(t),o=n.length-1,r=0;o>=r;r++)i=r===o?this:this.clone(!0),Q(n[r])[e](i),V.apply(s,i.get());return this.pushStack(s)}});var Ne,Be={},je=/^margin/,Ue=new RegExp("^("+_e+")(?!px)[a-z%]+$","i"),He=function(t){return t.ownerDocument.defaultView.getComputedStyle(t,null)};!function(){function e(){r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",r.innerHTML="",n.appendChild(o);var e=t.getComputedStyle(r,null);i="1%"!==e.top,s="4px"===e.width,n.removeChild(o)}var i,s,n=K.documentElement,o=K.createElement("div"),r=K.createElement("div");r.style&&(r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",X.clearCloneStyle="content-box"===r.style.backgroundClip,o.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",o.appendChild(r),t.getComputedStyle&&Q.extend(X,{pixelPosition:function(){return e(),i},boxSizingReliable:function(){return null==s&&e(),s},reliableMarginRight:function(){var e,i=r.appendChild(K.createElement("div"));return i.style.cssText=r.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",r.style.width="1px",n.appendChild(o),e=!parseFloat(t.getComputedStyle(i,null).marginRight),n.removeChild(o),e}}))}(),Q.swap=function(t,e,i,s){var n,o,r={};for(o in e)r[o]=t.style[o],t.style[o]=e[o];n=i.apply(t,s||[]);for(o in e)t.style[o]=r[o];return n};var qe=/^(none|table(?!-c[ea]).+)/,Ve=new RegExp("^("+_e+")(.*)$","i"),We=new RegExp("^([+-])=("+_e+")","i"),Ge={position:"absolute",visibility:"hidden",display:"block"},Ye={letterSpacing:"0",fontWeight:"400"},Ze=["Webkit","O","Moz","ms"];Q.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=_(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(t,e,i,s){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var n,o,r,a=Q.camelCase(e),l=t.style;return e=Q.cssProps[a]||(Q.cssProps[a]=k(l,a)),r=Q.cssHooks[e]||Q.cssHooks[a],void 0===i?r&&"get"in r&&void 0!==(n=r.get(t,!1,s))?n:l[e]:(o=typeof i,"string"===o&&(n=We.exec(i))&&(i=(n[1]+1)*n[2]+parseFloat(Q.css(t,e)),o="number"),null!=i&&i===i&&("number"!==o||Q.cssNumber[a]||(i+="px"),X.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),r&&"set"in r&&void 0===(i=r.set(t,i,s))||(l[e]=i)),void 0)}},css:function(t,e,i,s){var n,o,r,a=Q.camelCase(e);return e=Q.cssProps[a]||(Q.cssProps[a]=k(t.style,a)),r=Q.cssHooks[e]||Q.cssHooks[a],r&&"get"in r&&(n=r.get(t,!0,i)),void 0===n&&(n=_(t,e,s)),"normal"===n&&e in Ye&&(n=Ye[e]),""===i||i?(o=parseFloat(n),i===!0||Q.isNumeric(o)?o||0:n):n}}),Q.each(["height","width"],function(t,e){Q.cssHooks[e]={get:function(t,i,s){return i?qe.test(Q.css(t,"display"))&&0===t.offsetWidth?Q.swap(t,Ge,function(){return T(t,e,s)}):T(t,e,s):void 0},set:function(t,i,s){var n=s&&He(t);return C(t,i,s?S(t,e,s,"border-box"===Q.css(t,"boxSizing",!1,n),n):0)}}}),Q.cssHooks.marginRight=x(X.reliableMarginRight,function(t,e){return e?Q.swap(t,{display:"inline-block"},_,[t,"marginRight"]):void 0}),Q.each({margin:"",padding:"",border:"Width"},function(t,e){Q.cssHooks[t+e]={expand:function(i){for(var s=0,n={},o="string"==typeof i?i.split(" "):[i];4>s;s++)n[t+xe[s]+e]=o[s]||o[s-2]||o[0];return n}},je.test(t)||(Q.cssHooks[t+e].set=C)}),Q.fn.extend({css:function(t,e){return me(this,function(t,e,i){var s,n,o={},r=0;if(Q.isArray(e)){for(s=He(t),n=e.length;n>r;r++)o[e[r]]=Q.css(t,e[r],!1,s);return o}return void 0!==i?Q.style(t,e,i):Q.css(t,e)},t,e,arguments.length>1)},show:function(){return $(this,!0)},hide:function(){return $(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){ke(this)?Q(this).show():Q(this).hide()})}}),Q.Tween=A,A.prototype={constructor:A,init:function(t,e,i,s,n,o){this.elem=t,this.prop=i,this.easing=n||"swing",this.options=e,this.start=this.now=this.cur(),this.end=s,this.unit=o||(Q.cssNumber[i]?"":"px")},cur:function(){var t=A.propHooks[this.prop];return t&&t.get?t.get(this):A.propHooks._default.get(this)},run:function(t){var e,i=A.propHooks[this.prop];return this.pos=e=this.options.duration?Q.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):A.propHooks._default.set(this),this}},A.prototype.init.prototype=A.prototype,A.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=Q.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){Q.fx.step[t.prop]?Q.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[Q.cssProps[t.prop]]||Q.cssHooks[t.prop])?Q.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},A.propHooks.scrollTop=A.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},Q.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},Q.fx=A.prototype.init,Q.fx.step={};var Xe,Ke,Je=/^(?:toggle|show|hide)$/,Qe=new RegExp("^(?:([+-])=|)("+_e+")([a-z%]*)$","i"),ti=/queueHooks$/,ei=[M],ii={"*":[function(t,e){var i=this.createTween(t,e),s=i.cur(),n=Qe.exec(e),o=n&&n[3]||(Q.cssNumber[t]?"":"px"),r=(Q.cssNumber[t]||"px"!==o&&+s)&&Qe.exec(Q.css(i.elem,t)),a=1,l=20;if(r&&r[3]!==o){o=o||r[3],n=n||[],r=+s||1;do a=a||".5",r/=a,Q.style(i.elem,t,r+o);while(a!==(a=i.cur()/s)&&1!==a&&--l)}return n&&(r=i.start=+r||+s||0,i.unit=o,i.end=n[1]?r+(n[1]+1)*n[2]:+n[2]),i}]};Q.Animation=Q.extend(L,{tweener:function(t,e){Q.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,s=0,n=t.length;n>s;s++)i=t[s],ii[i]=ii[i]||[],ii[i].unshift(e)},prefilter:function(t,e){e?ei.unshift(t):ei.push(t)}}),Q.speed=function(t,e,i){var s=t&&"object"==typeof t?Q.extend({},t):{complete:i||!i&&e||Q.isFunction(t)&&t,duration:t,easing:i&&e||e&&!Q.isFunction(e)&&e};return s.duration=Q.fx.off?0:"number"==typeof s.duration?s.duration:s.duration in Q.fx.speeds?Q.fx.speeds[s.duration]:Q.fx.speeds._default,(null==s.queue||s.queue===!0)&&(s.queue="fx"),s.old=s.complete,s.complete=function(){Q.isFunction(s.old)&&s.old.call(this),s.queue&&Q.dequeue(this,s.queue)},s},Q.fn.extend({fadeTo:function(t,e,i,s){return this.filter(ke).css("opacity",0).show().end().animate({opacity:e},t,i,s)},animate:function(t,e,i,s){var n=Q.isEmptyObject(t),o=Q.speed(e,i,s),r=function(){var e=L(this,Q.extend({},t),o);(n||ve.get(this,"finish"))&&e.stop(!0)};return r.finish=r,n||o.queue===!1?this.each(r):this.queue(o.queue,r)},stop:function(t,e,i){var s=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,n=null!=t&&t+"queueHooks",o=Q.timers,r=ve.get(this);if(n)r[n]&&r[n].stop&&s(r[n]);else for(n in r)r[n]&&r[n].stop&&ti.test(n)&&s(r[n]);for(n=o.length;n--;)o[n].elem!==this||null!=t&&o[n].queue!==t||(o[n].anim.stop(i),e=!1,o.splice(n,1));(e||!i)&&Q.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=ve.get(this),s=i[t+"queue"],n=i[t+"queueHooks"],o=Q.timers,r=s?s.length:0;for(i.finish=!0,Q.queue(this,t,[]),n&&n.stop&&n.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;r>e;e++)s[e]&&s[e].finish&&s[e].finish.call(this);delete i.finish})}}),Q.each(["toggle","show","hide"],function(t,e){var i=Q.fn[e];Q.fn[e]=function(t,s,n){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(I(e,!0),t,s,n)}}),Q.each({slideDown:I("show"),slideUp:I("hide"),slideToggle:I("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){Q.fn[t]=function(t,i,s){return this.animate(e,t,i,s)}}),Q.timers=[],Q.fx.tick=function(){var t,e=0,i=Q.timers;for(Xe=Q.now();e<i.length;e++)t=i[e],t()||i[e]!==t||i.splice(e--,1);i.length||Q.fx.stop(),Xe=void 0},Q.fx.timer=function(t){Q.timers.push(t),t()?Q.fx.start():Q.timers.pop()},Q.fx.interval=13,Q.fx.start=function(){Ke||(Ke=setInterval(Q.fx.tick,Q.fx.interval))},Q.fx.stop=function(){clearInterval(Ke),Ke=null},Q.fx.speeds={slow:600,fast:200,_default:400},Q.fn.delay=function(t,e){return t=Q.fx?Q.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var s=setTimeout(e,t);i.stop=function(){clearTimeout(s)}})},function(){var t=K.createElement("input"),e=K.createElement("select"),i=e.appendChild(K.createElement("option"));t.type="checkbox",X.checkOn=""!==t.value,X.optSelected=i.selected,e.disabled=!0,X.optDisabled=!i.disabled,t=K.createElement("input"),t.value="t",t.type="radio",X.radioValue="t"===t.value}();var si,ni,oi=Q.expr.attrHandle;Q.fn.extend({attr:function(t,e){return me(this,Q.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){Q.removeAttr(this,t)})}}),Q.extend({attr:function(t,e,i){var s,n,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return typeof t.getAttribute===Se?Q.prop(t,e,i):(1===o&&Q.isXMLDoc(t)||(e=e.toLowerCase(),s=Q.attrHooks[e]||(Q.expr.match.bool.test(e)?ni:si)),void 0===i?s&&"get"in s&&null!==(n=s.get(t,e))?n:(n=Q.find.attr(t,e),null==n?void 0:n):null!==i?s&&"set"in s&&void 0!==(n=s.set(t,i,e))?n:(t.setAttribute(e,i+""),i):void Q.removeAttr(t,e))},removeAttr:function(t,e){var i,s,n=0,o=e&&e.match(pe);if(o&&1===t.nodeType)for(;i=o[n++];)s=Q.propFix[i]||i,Q.expr.match.bool.test(i)&&(t[s]=!1),t.removeAttribute(i)},attrHooks:{type:{set:function(t,e){if(!X.radioValue&&"radio"===e&&Q.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}}}),ni={set:function(t,e,i){return e===!1?Q.removeAttr(t,i):t.setAttribute(i,i),i}},Q.each(Q.expr.match.bool.source.match(/\w+/g),function(t,e){var i=oi[e]||Q.find.attr;oi[e]=function(t,e,s){var n,o;return s||(o=oi[e],oi[e]=n,n=null!=i(t,e,s)?e.toLowerCase():null,oi[e]=o),n}});var ri=/^(?:input|select|textarea|button)$/i;Q.fn.extend({prop:function(t,e){return me(this,Q.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[Q.propFix[t]||t]})}}),Q.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(t,e,i){var s,n,o,r=t.nodeType;if(t&&3!==r&&8!==r&&2!==r)return o=1!==r||!Q.isXMLDoc(t),o&&(e=Q.propFix[e]||e,n=Q.propHooks[e]),void 0!==i?n&&"set"in n&&void 0!==(s=n.set(t,i,e))?s:t[e]=i:n&&"get"in n&&null!==(s=n.get(t,e))?s:t[e]},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||ri.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),X.optSelected||(Q.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),Q.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Q.propFix[this.toLowerCase()]=this});var ai=/[\t\r\n\f]/g;Q.fn.extend({addClass:function(t){var e,i,s,n,o,r,a="string"==typeof t&&t,l=0,h=this.length;if(Q.isFunction(t))return this.each(function(e){Q(this).addClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(pe)||[];h>l;l++)if(i=this[l],s=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ai," "):" ")){for(o=0;n=e[o++];)s.indexOf(" "+n+" ")<0&&(s+=n+" ");r=Q.trim(s),i.className!==r&&(i.className=r)}return this},removeClass:function(t){var e,i,s,n,o,r,a=0===arguments.length||"string"==typeof t&&t,l=0,h=this.length;if(Q.isFunction(t))return this.each(function(e){Q(this).removeClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(pe)||[];h>l;l++)if(i=this[l],s=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ai," "):"")){for(o=0;n=e[o++];)for(;s.indexOf(" "+n+" ")>=0;)s=s.replace(" "+n+" "," ");r=t?Q.trim(s):"",i.className!==r&&(i.className=r)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):this.each(Q.isFunction(t)?function(i){Q(this).toggleClass(t.call(this,i,this.className,e),e)}:function(){if("string"===i)for(var e,s=0,n=Q(this),o=t.match(pe)||[];e=o[s++];)n.hasClass(e)?n.removeClass(e):n.addClass(e);else(i===Se||"boolean"===i)&&(this.className&&ve.set(this,"__className__",this.className),this.className=this.className||t===!1?"":ve.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,s=this.length;s>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(ai," ").indexOf(e)>=0)return!0;return!1}});var li=/\r/g;Q.fn.extend({val:function(t){var e,i,s,n=this[0];{if(arguments.length)return s=Q.isFunction(t),this.each(function(i){var n;1===this.nodeType&&(n=s?t.call(this,i,Q(this).val()):t,null==n?n="":"number"==typeof n?n+="":Q.isArray(n)&&(n=Q.map(n,function(t){return null==t?"":t+""})),e=Q.valHooks[this.type]||Q.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,n,"value")||(this.value=n))});if(n)return e=Q.valHooks[n.type]||Q.valHooks[n.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(i=e.get(n,"value"))?i:(i=n.value,"string"==typeof i?i.replace(li,""):null==i?"":i)}}}),Q.extend({valHooks:{option:{get:function(t){var e=Q.find.attr(t,"value");return null!=e?e:Q.trim(Q.text(t))}},select:{get:function(t){for(var e,i,s=t.options,n=t.selectedIndex,o="select-one"===t.type||0>n,r=o?null:[],a=o?n+1:s.length,l=0>n?a:o?n:0;a>l;l++)if(i=s[l],!(!i.selected&&l!==n||(X.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&Q.nodeName(i.parentNode,"optgroup"))){if(e=Q(i).val(),o)return e;r.push(e)}return r},set:function(t,e){for(var i,s,n=t.options,o=Q.makeArray(e),r=n.length;r--;)s=n[r],(s.selected=Q.inArray(s.value,o)>=0)&&(i=!0);return i||(t.selectedIndex=-1),o}}}}),Q.each(["radio","checkbox"],function(){Q.valHooks[this]={set:function(t,e){return Q.isArray(e)?t.checked=Q.inArray(Q(t).val(),e)>=0:void 0}},X.checkOn||(Q.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),Q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){Q.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),Q.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,s){return this.on(e,t,i,s)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var hi=Q.now(),ci=/\?/;Q.parseJSON=function(t){return JSON.parse(t+"")},Q.parseXML=function(t){var e,i;if(!t||"string"!=typeof t)return null;try{i=new DOMParser,e=i.parseFromString(t,"text/xml")}catch(s){e=void 0}return(!e||e.getElementsByTagName("parsererror").length)&&Q.error("Invalid XML: "+t),e};var di,ui,pi=/#.*$/,fi=/([?&])_=[^&]*/,gi=/^(.*?):[ \t]*([^\r\n]*)$/gm,mi=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,vi=/^(?:GET|HEAD)$/,yi=/^\/\//,bi=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,wi={},_i={},xi="*/".concat("*");try{ui=location.href}catch(ki){ui=K.createElement("a"),ui.href="",ui=ui.href}di=bi.exec(ui.toLowerCase())||[],Q.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ui,type:"GET",isLocal:mi.test(di[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":xi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Q.parseJSON,"text xml":Q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?O(O(t,Q.ajaxSettings),e):O(Q.ajaxSettings,t)},ajaxPrefilter:F(wi),ajaxTransport:F(_i),ajax:function(t,e){function i(t,e,i,r){var l,c,v,y,w,x=e;2!==b&&(b=2,a&&clearTimeout(a),s=void 0,o=r||"",_.readyState=t>0?4:0,l=t>=200&&300>t||304===t,i&&(y=R(d,_,i)),y=N(d,y,_,l),l?(d.ifModified&&(w=_.getResponseHeader("Last-Modified"),w&&(Q.lastModified[n]=w),w=_.getResponseHeader("etag"),w&&(Q.etag[n]=w)),204===t||"HEAD"===d.type?x="nocontent":304===t?x="notmodified":(x=y.state,c=y.data,v=y.error,l=!v)):(v=x,(t||!x)&&(x="error",0>t&&(t=0))),_.status=t,_.statusText=(e||x)+"",l?f.resolveWith(u,[c,x,_]):f.rejectWith(u,[_,x,v]),_.statusCode(m),m=void 0,h&&p.trigger(l?"ajaxSuccess":"ajaxError",[_,d,l?c:v]),g.fireWith(u,[_,x]),h&&(p.trigger("ajaxComplete",[_,d]),--Q.active||Q.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var s,n,o,r,a,l,h,c,d=Q.ajaxSetup({},e),u=d.context||d,p=d.context&&(u.nodeType||u.jquery)?Q(u):Q.event,f=Q.Deferred(),g=Q.Callbacks("once memory"),m=d.statusCode||{},v={},y={},b=0,w="canceled",_={readyState:0,getResponseHeader:function(t){var e;if(2===b){if(!r)for(r={};e=gi.exec(o);)r[e[1].toLowerCase()]=e[2];e=r[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===b?o:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return b||(t=y[i]=y[i]||t,v[t]=e),this},overrideMimeType:function(t){return b||(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>b)for(e in t)m[e]=[m[e],t[e]];else _.always(t[_.status]);return this},abort:function(t){var e=t||w;return s&&s.abort(e),i(0,e),this}};if(f.promise(_).complete=g.add,_.success=_.done,_.error=_.fail,d.url=((t||d.url||ui)+"").replace(pi,"").replace(yi,di[1]+"//"),d.type=e.method||e.type||d.method||d.type,d.dataTypes=Q.trim(d.dataType||"*").toLowerCase().match(pe)||[""],null==d.crossDomain&&(l=bi.exec(d.url.toLowerCase()),d.crossDomain=!(!l||l[1]===di[1]&&l[2]===di[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(di[3]||("http:"===di[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=Q.param(d.data,d.traditional)),z(wi,d,e,_),2===b)return _;h=d.global,h&&0===Q.active++&&Q.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!vi.test(d.type),n=d.url,d.hasContent||(d.data&&(n=d.url+=(ci.test(n)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=fi.test(n)?n.replace(fi,"$1_="+hi++):n+(ci.test(n)?"&":"?")+"_="+hi++)),d.ifModified&&(Q.lastModified[n]&&_.setRequestHeader("If-Modified-Since",Q.lastModified[n]),Q.etag[n]&&_.setRequestHeader("If-None-Match",Q.etag[n])),(d.data&&d.hasContent&&d.contentType!==!1||e.contentType)&&_.setRequestHeader("Content-Type",d.contentType),_.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+xi+"; q=0.01":""):d.accepts["*"]);for(c in d.headers)_.setRequestHeader(c,d.headers[c]);if(d.beforeSend&&(d.beforeSend.call(u,_,d)===!1||2===b))return _.abort();w="abort";for(c in{success:1,error:1,complete:1})_[c](d[c]);if(s=z(_i,d,e,_)){_.readyState=1,h&&p.trigger("ajaxSend",[_,d]),d.async&&d.timeout>0&&(a=setTimeout(function(){_.abort("timeout")},d.timeout));try{b=1,s.send(v,i)}catch(x){if(!(2>b))throw x;i(-1,x)}}else i(-1,"No Transport");return _},getJSON:function(t,e,i){return Q.get(t,e,i,"json")},getScript:function(t,e){return Q.get(t,void 0,e,"script")}}),Q.each(["get","post"],function(t,e){Q[e]=function(t,i,s,n){return Q.isFunction(i)&&(n=n||s,s=i,i=void 0),Q.ajax({url:t,type:e,dataType:n,data:i,success:s})}}),Q.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){Q.fn[e]=function(t){return this.on(e,t)}}),Q._evalUrl=function(t){return Q.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},Q.fn.extend({wrapAll:function(t){var e;return Q.isFunction(t)?this.each(function(e){Q(this).wrapAll(t.call(this,e))}):(this[0]&&(e=Q(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return this.each(Q.isFunction(t)?function(e){Q(this).wrapInner(t.call(this,e))}:function(){var e=Q(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=Q.isFunction(t);return this.each(function(i){Q(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){Q.nodeName(this,"body")||Q(this).replaceWith(this.childNodes)}).end()}}),Q.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},Q.expr.filters.visible=function(t){return!Q.expr.filters.hidden(t)};var Ci=/%20/g,Si=/\[\]$/,Ti=/\r?\n/g,$i=/^(?:submit|button|image|reset|file)$/i,Ai=/^(?:input|select|textarea|keygen)/i;Q.param=function(t,e){var i,s=[],n=function(t,e){e=Q.isFunction(e)?e():null==e?"":e,s[s.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=Q.ajaxSettings&&Q.ajaxSettings.traditional),Q.isArray(t)||t.jquery&&!Q.isPlainObject(t))Q.each(t,function(){n(this.name,this.value)});else for(i in t)B(i,t[i],e,n);return s.join("&").replace(Ci,"+")},Q.fn.extend({serialize:function(){return Q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=Q.prop(this,"elements");return t?Q.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!Q(this).is(":disabled")&&Ai.test(this.nodeName)&&!$i.test(t)&&(this.checked||!Ce.test(t))}).map(function(t,e){var i=Q(this).val();return null==i?null:Q.isArray(i)?Q.map(i,function(t){return{name:e.name,value:t.replace(Ti,"\r\n")}}):{name:e.name,value:i.replace(Ti,"\r\n")}}).get()}}),Q.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var Pi=0,Ii={},Di={0:200,1223:204},Mi=Q.ajaxSettings.xhr();t.ActiveXObject&&Q(t).on("unload",function(){for(var t in Ii)Ii[t]()}),X.cors=!!Mi&&"withCredentials"in Mi,X.ajax=Mi=!!Mi,Q.ajaxTransport(function(t){var e;return X.cors||Mi&&!t.crossDomain?{send:function(i,s){var n,o=t.xhr(),r=++Pi;if(o.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(n in t.xhrFields)o[n]=t.xhrFields[n];t.mimeType&&o.overrideMimeType&&o.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(n in i)o.setRequestHeader(n,i[n]);e=function(t){return function(){e&&(delete Ii[r],e=o.onload=o.onerror=null,"abort"===t?o.abort():"error"===t?s(o.status,o.statusText):s(Di[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))
}},o.onload=e(),o.onerror=e("error"),e=Ii[r]=e("abort");try{o.send(t.hasContent&&t.data||null)}catch(a){if(e)throw a}},abort:function(){e&&e()}}:void 0}),Q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return Q.globalEval(t),t}}}),Q.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),Q.ajaxTransport("script",function(t){if(t.crossDomain){var e,i;return{send:function(s,n){e=Q("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&n("error"===t.type?404:200,t.type)}),K.head.appendChild(e[0])},abort:function(){i&&i()}}}});var Ei=[],Li=/(=)\?(?=&|$)|\?\?/;Q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ei.pop()||Q.expando+"_"+hi++;return this[t]=!0,t}}),Q.ajaxPrefilter("json jsonp",function(e,i,s){var n,o,r,a=e.jsonp!==!1&&(Li.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Li.test(e.data)&&"data");return a||"jsonp"===e.dataTypes[0]?(n=e.jsonpCallback=Q.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Li,"$1"+n):e.jsonp!==!1&&(e.url+=(ci.test(e.url)?"&":"?")+e.jsonp+"="+n),e.converters["script json"]=function(){return r||Q.error(n+" was not called"),r[0]},e.dataTypes[0]="json",o=t[n],t[n]=function(){r=arguments},s.always(function(){t[n]=o,e[n]&&(e.jsonpCallback=i.jsonpCallback,Ei.push(n)),r&&Q.isFunction(o)&&o(r[0]),r=o=void 0}),"script"):void 0}),Q.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||K;var s=re.exec(t),n=!i&&[];return s?[e.createElement(s[1])]:(s=Q.buildFragment([t],e,n),n&&n.length&&Q(n).remove(),Q.merge([],s.childNodes))};var Fi=Q.fn.load;Q.fn.load=function(t,e,i){if("string"!=typeof t&&Fi)return Fi.apply(this,arguments);var s,n,o,r=this,a=t.indexOf(" ");return a>=0&&(s=Q.trim(t.slice(a)),t=t.slice(0,a)),Q.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(n="POST"),r.length>0&&Q.ajax({url:t,type:n,dataType:"html",data:e}).done(function(t){o=arguments,r.html(s?Q("<div>").append(Q.parseHTML(t)).find(s):t)}).complete(i&&function(t,e){r.each(i,o||[t.responseText,e,t])}),this},Q.expr.filters.animated=function(t){return Q.grep(Q.timers,function(e){return t===e.elem}).length};var zi=t.document.documentElement;Q.offset={setOffset:function(t,e,i){var s,n,o,r,a,l,h,c=Q.css(t,"position"),d=Q(t),u={};"static"===c&&(t.style.position="relative"),a=d.offset(),o=Q.css(t,"top"),l=Q.css(t,"left"),h=("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1,h?(s=d.position(),r=s.top,n=s.left):(r=parseFloat(o)||0,n=parseFloat(l)||0),Q.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(u.top=e.top-a.top+r),null!=e.left&&(u.left=e.left-a.left+n),"using"in e?e.using.call(t,u):d.css(u)}},Q.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){Q.offset.setOffset(this,t,e)});var e,i,s=this[0],n={top:0,left:0},o=s&&s.ownerDocument;if(o)return e=o.documentElement,Q.contains(e,s)?(typeof s.getBoundingClientRect!==Se&&(n=s.getBoundingClientRect()),i=j(o),{top:n.top+i.pageYOffset-e.clientTop,left:n.left+i.pageXOffset-e.clientLeft}):n},position:function(){if(this[0]){var t,e,i=this[0],s={top:0,left:0};return"fixed"===Q.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),Q.nodeName(t[0],"html")||(s=t.offset()),s.top+=Q.css(t[0],"borderTopWidth",!0),s.left+=Q.css(t[0],"borderLeftWidth",!0)),{top:e.top-s.top-Q.css(i,"marginTop",!0),left:e.left-s.left-Q.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||zi;t&&!Q.nodeName(t,"html")&&"static"===Q.css(t,"position");)t=t.offsetParent;return t||zi})}}),Q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var s="pageYOffset"===i;Q.fn[e]=function(n){return me(this,function(e,n,o){var r=j(e);return void 0===o?r?r[i]:e[n]:void(r?r.scrollTo(s?t.pageXOffset:o,s?o:t.pageYOffset):e[n]=o)},e,n,arguments.length,null)}}),Q.each(["top","left"],function(t,e){Q.cssHooks[e]=x(X.pixelPosition,function(t,i){return i?(i=_(t,e),Ue.test(i)?Q(t).position()[e]+"px":i):void 0})}),Q.each({Height:"height",Width:"width"},function(t,e){Q.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,s){Q.fn[s]=function(s,n){var o=arguments.length&&(i||"boolean"!=typeof s),r=i||(s===!0||n===!0?"margin":"border");return me(this,function(e,i,s){var n;return Q.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(n=e.documentElement,Math.max(e.body["scroll"+t],n["scroll"+t],e.body["offset"+t],n["offset"+t],n["client"+t])):void 0===s?Q.css(e,i,r):Q.style(e,i,s,r)},e,o?s:void 0,o,null)}})}),Q.fn.size=function(){return this.length},Q.fn.andSelf=Q.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Q});var Oi=t.jQuery,Ri=t.$;return Q.noConflict=function(e){return t.$===Q&&(t.$=Ri),e&&t.jQuery===Q&&(t.jQuery=Oi),Q},typeof e===Se&&(t.jQuery=t.$=Q),Q}),define("jquery_modern",function(){}),function(){var t=this,e=t._,i={},s=Array.prototype,n=Object.prototype,o=Function.prototype,r=s.push,a=s.slice,l=s.concat,h=n.toString,c=n.hasOwnProperty,d=s.forEach,u=s.map,p=s.reduce,f=s.reduceRight,g=s.filter,m=s.every,v=s.some,y=s.indexOf,b=s.lastIndexOf,w=Array.isArray,_=Object.keys,x=o.bind,k=function(t){return t instanceof k?t:this instanceof k?void(this._wrapped=t):new k(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):t._=k,k.VERSION="1.4.4";var C=k.each=k.forEach=function(t,e,s){if(null!=t)if(d&&t.forEach===d)t.forEach(e,s);else if(t.length===+t.length){for(var n=0,o=t.length;o>n;n++)if(e.call(s,t[n],n,t)===i)return}else for(var r in t)if(k.has(t,r)&&e.call(s,t[r],r,t)===i)return};k.map=k.collect=function(t,e,i){var s=[];return null==t?s:u&&t.map===u?t.map(e,i):(C(t,function(t,n,o){s[s.length]=e.call(i,t,n,o)}),s)};var S="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(t,e,i,s){var n=arguments.length>2;if(null==t&&(t=[]),p&&t.reduce===p)return s&&(e=k.bind(e,s)),n?t.reduce(e,i):t.reduce(e);if(C(t,function(t,o,r){n?i=e.call(s,i,t,o,r):(i=t,n=!0)}),!n)throw new TypeError(S);return i},k.reduceRight=k.foldr=function(t,e,i,s){var n=arguments.length>2;if(null==t&&(t=[]),f&&t.reduceRight===f)return s&&(e=k.bind(e,s)),n?t.reduceRight(e,i):t.reduceRight(e);var o=t.length;if(o!==+o){var r=k.keys(t);o=r.length}if(C(t,function(a,l,h){l=r?r[--o]:--o,n?i=e.call(s,i,t[l],l,h):(i=t[l],n=!0)}),!n)throw new TypeError(S);return i},k.find=k.detect=function(t,e,i){var s;return T(t,function(t,n,o){return e.call(i,t,n,o)?(s=t,!0):void 0}),s},k.filter=k.select=function(t,e,i){var s=[];return null==t?s:g&&t.filter===g?t.filter(e,i):(C(t,function(t,n,o){e.call(i,t,n,o)&&(s[s.length]=t)}),s)},k.reject=function(t,e,i){return k.filter(t,function(t,s,n){return!e.call(i,t,s,n)},i)},k.every=k.all=function(t,e,s){e||(e=k.identity);var n=!0;return null==t?n:m&&t.every===m?t.every(e,s):(C(t,function(t,o,r){return(n=n&&e.call(s,t,o,r))?void 0:i}),!!n)};var T=k.some=k.any=function(t,e,s){e||(e=k.identity);var n=!1;return null==t?n:v&&t.some===v?t.some(e,s):(C(t,function(t,o,r){return n||(n=e.call(s,t,o,r))?i:void 0}),!!n)};k.contains=k.include=function(t,e){return null==t?!1:y&&t.indexOf===y?-1!=t.indexOf(e):T(t,function(t){return t===e})},k.invoke=function(t,e){var i=a.call(arguments,2),s=k.isFunction(e);return k.map(t,function(t){return(s?e:t[e]).apply(t,i)})},k.pluck=function(t,e){return k.map(t,function(t){return t[e]})},k.where=function(t,e,i){return k.isEmpty(e)?i?null:[]:k[i?"find":"filter"](t,function(t){for(var i in e)if(e[i]!==t[i])return!1;return!0})},k.findWhere=function(t,e){return k.where(t,e,!0)},k.max=function(t,e,i){if(!e&&k.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&k.isEmpty(t))return-1/0;var s={computed:-1/0,value:-1/0};return C(t,function(t,n,o){var r=e?e.call(i,t,n,o):t;r>=s.computed&&(s={value:t,computed:r})}),s.value},k.min=function(t,e,i){if(!e&&k.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&k.isEmpty(t))return 1/0;var s={computed:1/0,value:1/0};return C(t,function(t,n,o){var r=e?e.call(i,t,n,o):t;r<s.computed&&(s={value:t,computed:r})}),s.value},k.shuffle=function(t){var e,i=0,s=[];return C(t,function(t){e=k.random(i++),s[i-1]=s[e],s[e]=t}),s};var $=function(t){return k.isFunction(t)?t:function(e){return e[t]}};k.sortBy=function(t,e,i){var s=$(e);return k.pluck(k.map(t,function(t,e,n){return{value:t,index:e,criteria:s.call(i,t,e,n)}}).sort(function(t,e){var i=t.criteria,s=e.criteria;if(i!==s){if(i>s||void 0===i)return 1;if(s>i||void 0===s)return-1}return t.index<e.index?-1:1}),"value")};var A=function(t,e,i,s){var n={},o=$(e||k.identity);return C(t,function(e,r){var a=o.call(i,e,r,t);s(n,a,e)}),n};k.groupBy=function(t,e,i){return A(t,e,i,function(t,e,i){(k.has(t,e)?t[e]:t[e]=[]).push(i)})},k.countBy=function(t,e,i){return A(t,e,i,function(t,e){k.has(t,e)||(t[e]=0),t[e]++})},k.sortedIndex=function(t,e,i,s){i=null==i?k.identity:$(i);for(var n=i.call(s,e),o=0,r=t.length;r>o;){var a=o+r>>>1;i.call(s,t[a])<n?o=a+1:r=a}return o},k.toArray=function(t){return t?k.isArray(t)?a.call(t):t.length===+t.length?k.map(t,k.identity):k.values(t):[]},k.size=function(t){return null==t?0:t.length===+t.length?t.length:k.keys(t).length},k.first=k.head=k.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:a.call(t,0,e)},k.initial=function(t,e,i){return a.call(t,0,t.length-(null==e||i?1:e))},k.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},k.rest=k.tail=k.drop=function(t,e,i){return a.call(t,null==e||i?1:e)},k.compact=function(t){return k.filter(t,k.identity)};var P=function(t,e,i){return C(t,function(t){k.isArray(t)?e?r.apply(i,t):P(t,e,i):i.push(t)}),i};k.flatten=function(t,e){return P(t,e,[])},k.without=function(t){return k.difference(t,a.call(arguments,1))},k.uniq=k.unique=function(t,e,i,s){k.isFunction(e)&&(s=i,i=e,e=!1);var n=i?k.map(t,i,s):t,o=[],r=[];return C(n,function(i,s){(e?s&&r[r.length-1]===i:k.contains(r,i))||(r.push(i),o.push(t[s]))}),o},k.union=function(){return k.uniq(l.apply(s,arguments))},k.intersection=function(t){var e=a.call(arguments,1);return k.filter(k.uniq(t),function(t){return k.every(e,function(e){return k.indexOf(e,t)>=0})})},k.difference=function(t){var e=l.apply(s,a.call(arguments,1));return k.filter(t,function(t){return!k.contains(e,t)})},k.zip=function(){for(var t=a.call(arguments),e=k.max(k.pluck(t,"length")),i=new Array(e),s=0;e>s;s++)i[s]=k.pluck(t,""+s);return i},k.object=function(t,e){if(null==t)return{};for(var i={},s=0,n=t.length;n>s;s++)e?i[t[s]]=e[s]:i[t[s][0]]=t[s][1];return i},k.indexOf=function(t,e,i){if(null==t)return-1;var s=0,n=t.length;if(i){if("number"!=typeof i)return s=k.sortedIndex(t,e),t[s]===e?s:-1;s=0>i?Math.max(0,n+i):i}if(y&&t.indexOf===y)return t.indexOf(e,i);for(;n>s;s++)if(t[s]===e)return s;return-1},k.lastIndexOf=function(t,e,i){if(null==t)return-1;var s=null!=i;if(b&&t.lastIndexOf===b)return s?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var n=s?i:t.length;n--;)if(t[n]===e)return n;return-1},k.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var s=Math.max(Math.ceil((e-t)/i),0),n=0,o=new Array(s);s>n;)o[n++]=t,t+=i;return o},k.bind=function(t,e){if(t.bind===x&&x)return x.apply(t,a.call(arguments,1));var i=a.call(arguments,2);return function(){return t.apply(e,i.concat(a.call(arguments)))}},k.partial=function(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)))}},k.bindAll=function(t){var e=a.call(arguments,1);return 0===e.length&&(e=k.functions(t)),C(e,function(e){t[e]=k.bind(t[e],t)}),t},k.memoize=function(t,e){var i={};return e||(e=k.identity),function(){var s=e.apply(this,arguments);return k.has(i,s)?i[s]:i[s]=t.apply(this,arguments)}},k.delay=function(t,e){var i=a.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},k.defer=function(t){return k.delay.apply(k,[t,1].concat(a.call(arguments,1)))},k.throttle=function(t,e){var i,s,n,o,r=0,a=function(){r=new Date,n=null,o=t.apply(i,s)};return function(){var l=new Date,h=e-(l-r);return i=this,s=arguments,0>=h?(clearTimeout(n),n=null,r=l,o=t.apply(i,s)):n||(n=setTimeout(a,h)),o}},k.debounce=function(t,e,i){var s,n;return function(){var o=this,r=arguments,a=function(){s=null,i||(n=t.apply(o,r))},l=i&&!s;return clearTimeout(s),s=setTimeout(a,e),l&&(n=t.apply(o,r)),n}},k.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},k.wrap=function(t,e){return function(){var i=[t];return r.apply(i,arguments),e.apply(this,i)}},k.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},k.after=function(t,e){return 0>=t?e():function(){return--t<1?e.apply(this,arguments):void 0}},k.keys=_||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)k.has(t,i)&&(e[e.length]=i);return e},k.values=function(t){var e=[];for(var i in t)k.has(t,i)&&e.push(t[i]);return e},k.pairs=function(t){var e=[];for(var i in t)k.has(t,i)&&e.push([i,t[i]]);return e},k.invert=function(t){var e={};for(var i in t)k.has(t,i)&&(e[t[i]]=i);return e},k.functions=k.methods=function(t){var e=[];for(var i in t)k.isFunction(t[i])&&e.push(i);return e.sort()},k.extend=function(t){return C(a.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},k.pick=function(t){var e={},i=l.apply(s,a.call(arguments,1));return C(i,function(i){i in t&&(e[i]=t[i])}),e},k.omit=function(t){var e={},i=l.apply(s,a.call(arguments,1));for(var n in t)k.contains(i,n)||(e[n]=t[n]);return e},k.defaults=function(t){return C(a.call(arguments,1),function(e){if(e)for(var i in e)null==t[i]&&(t[i]=e[i])}),t},k.clone=function(t){return k.isObject(t)?k.isArray(t)?t.slice():k.extend({},t):t},k.tap=function(t,e){return e(t),t};var I=function(t,e,i,s){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof k&&(t=t._wrapped),e instanceof k&&(e=e._wrapped);var n=h.call(t);if(n!=h.call(e))return!1;switch(n){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=i.length;o--;)if(i[o]==t)return s[o]==e;i.push(t),s.push(e);var r=0,a=!0;if("[object Array]"==n){if(r=t.length,a=r==e.length)for(;r--&&(a=I(t[r],e[r],i,s)););}else{var l=t.constructor,c=e.constructor;if(l!==c&&!(k.isFunction(l)&&l instanceof l&&k.isFunction(c)&&c instanceof c))return!1;for(var d in t)if(k.has(t,d)&&(r++,!(a=k.has(e,d)&&I(t[d],e[d],i,s))))break;if(a){for(d in e)if(k.has(e,d)&&!r--)break;a=!r}}return i.pop(),s.pop(),a};k.isEqual=function(t,e){return I(t,e,[],[])},k.isEmpty=function(t){if(null==t)return!0;if(k.isArray(t)||k.isString(t))return 0===t.length;for(var e in t)if(k.has(t,e))return!1;return!0},k.isElement=function(t){return!(!t||1!==t.nodeType)},k.isArray=w||function(t){return"[object Array]"==h.call(t)},k.isObject=function(t){return t===Object(t)},C(["Arguments","Function","String","Number","Date","RegExp"],function(t){k["is"+t]=function(e){return h.call(e)=="[object "+t+"]"}}),k.isArguments(arguments)||(k.isArguments=function(t){return!(!t||!k.has(t,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(t){return"function"==typeof t}),k.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},k.isNaN=function(t){return k.isNumber(t)&&t!=+t},k.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==h.call(t)},k.isNull=function(t){return null===t},k.isUndefined=function(t){return void 0===t},k.has=function(t,e){return c.call(t,e)},k.noConflict=function(){return t._=e,this},k.identity=function(t){return t},k.times=function(t,e,i){for(var s=Array(t),n=0;t>n;n++)s[n]=e.call(i,n);return s},k.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var D={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};D.unescape=k.invert(D.escape);var M={escape:new RegExp("["+k.keys(D.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(D.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(t){k[t]=function(e){return null==e?"":(""+e).replace(M[t],function(e){return D[t][e]})}}),k.result=function(t,e){if(null==t)return null;var i=t[e];return k.isFunction(i)?i.call(t):i},k.mixin=function(t){C(k.functions(t),function(e){var i=k[e]=t[e];k.prototype[e]=function(){var t=[this._wrapped];return r.apply(t,arguments),O.call(this,i.apply(k,t))}})};var E=0;k.uniqueId=function(t){var e=++E+"";return t?t+e:e},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},z=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(t,e,i){var s;i=k.defaults({},i,k.templateSettings);var n=new RegExp([(i.escape||L).source,(i.interpolate||L).source,(i.evaluate||L).source].join("|")+"|$","g"),o=0,r="__p+='";t.replace(n,function(e,i,s,n,a){return r+=t.slice(o,a).replace(z,function(t){return"\\"+F[t]}),i&&(r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),s&&(r+="'+\n((__t=("+s+"))==null?'':__t)+\n'"),n&&(r+="';\n"+n+"\n__p+='"),o=a+e.length,e}),r+="';\n",i.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{s=new Function(i.variable||"obj","_",r)}catch(a){throw a.source=r,a}if(e)return s(e,k);var l=function(t){return s.call(this,t,k)};return l.source="function("+(i.variable||"obj")+"){\n"+r+"}",l},k.chain=function(t){return k(t).chain()};var O=function(t){return this._chain?k(t).chain():t};k.mixin(k),C(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=s[t];k.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],O.call(this,i)}}),C(["concat","join","slice"],function(t){var e=s[t];k.prototype[t]=function(){return O.call(this,e.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return k})}.call(this),function(t,e){"undefined"!=typeof exports?e(t,exports,require("underscore")):"function"==typeof define&&define.amd?define("backbone",["underscore","jquery","exports"],function(i,s,n){t.Backbone=e(t,n,i,s)}):t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender)}(this,function(t,e,i,s){var n=t.Backbone,o=[],r=o.push,a=o.slice,l=o.splice;e.VERSION="1.0.0",e.$=s,e.noConflict=function(){return t.Backbone=n,this},e.emulateHTTP=!1,e.emulateJSON=!1;var h=e.Events={on:function(t,e,i){if(!d(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var s=this._events[t]||(this._events[t]=[]);return s.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,s){if(!d(this,"once",t,[e,s])||!e)return this;var n=this,o=i.once(function(){n.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,s)},off:function(t,e,s){var n,o,r,a,l,h,c,u;if(!this._events||!d(this,"off",t,[e,s]))return this;if(!t&&!e&&!s)return this._events={},this;for(a=t?[t]:i.keys(this._events),l=0,h=a.length;h>l;l++)if(t=a[l],r=this._events[t]){if(this._events[t]=n=[],e||s)for(c=0,u=r.length;u>c;c++)o=r[c],(e&&e!==o.callback&&e!==o.callback._callback||s&&s!==o.context)&&n.push(o);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!d(this,"trigger",t,e))return this;var i=this._events[t],s=this._events.all;return i&&u(i,e),s&&u(s,arguments),this},stopListening:function(t,e,i){var s=this._listeners;if(!s)return this;var n=!e&&!i;"object"==typeof e&&(i=this),t&&((s={})[t._listenerId]=t);for(var o in s)s[o].off(e,i,this),n&&delete this._listeners[o];return this}},c=/\s+/,d=function(t,e,i,s){if(!i)return!0;if("object"==typeof i){for(var n in i)t[e].apply(t,[n,i[n]].concat(s));return!1}if(c.test(i)){for(var o=i.split(c),r=0,a=o.length;a>r;r++)t[e].apply(t,[o[r]].concat(s));return!1}return!0},u=function(t,e){var i,s=-1,n=t.length,o=e[0],r=e[1],a=e[2];switch(e.length){case 0:for(;++s<n;)(i=t[s]).callback.call(i.ctx);return;case 1:for(;++s<n;)(i=t[s]).callback.call(i.ctx,o);return;case 2:for(;++s<n;)(i=t[s]).callback.call(i.ctx,o,r);return;case 3:for(;++s<n;)(i=t[s]).callback.call(i.ctx,o,r,a);return;default:for(;++s<n;)(i=t[s]).callback.apply(i.ctx,e)}},p={listenTo:"on",listenToOnce:"once"};i.each(p,function(t,e){h[e]=function(e,s,n){var o=this._listeners||(this._listeners={}),r=e._listenerId||(e._listenerId=i.uniqueId("l"));return o[r]=e,"object"==typeof s&&(n=this),e[t](s,n,this),this}}),h.bind=h.on,h.unbind=h.off,i.extend(e,h);var f=e.Model=function(t,e){var s,n=t||{};e||(e={}),this.cid=i.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),(s=i.result(this,"defaults"))&&(n=i.defaults({},n,s)),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(f.prototype,h,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,s){var n,o,r,a,l,h,c,d;if(null==t)return this;if("object"==typeof t?(o=t,s=e):(o={})[t]=e,s||(s={}),!this._validate(o,s))return!1;r=s.unset,l=s.silent,a=[],h=this._changing,this._changing=!0,h||(this._previousAttributes=i.clone(this.attributes),this.changed={}),d=this.attributes,c=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(n in o)e=o[n],i.isEqual(d[n],e)||a.push(n),i.isEqual(c[n],e)?delete this.changed[n]:this.changed[n]=e,r?delete d[n]:d[n]=e;if(!l){a.length&&(this._pending=!0);for(var u=0,p=a.length;p>u;u++)this.trigger("change:"+a[u],this,d[a[u]],s)}if(h)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,s);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var s in this.attributes)e[s]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?i.clone(this.changed):!1;var e,s=!1,n=this._changing?this._previousAttributes:this.attributes;for(var o in t)i.isEqual(n[o],e=t[o])||((s||(s={}))[o]=e);return s},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,s=t.success;return t.success=function(i){return e.set(e.parse(i,t),t)?(s&&s(e,i,t),void e.trigger("sync",e,i,t)):!1},$(this,t),this.sync("read",this,t)},save:function(t,e,s){var n,o,r,a=this.attributes;if(null==t||"object"==typeof t?(n=t,s=e):(n={})[t]=e,s=i.extend({validate:!0},s),n&&!s.wait){if(!this.set(n,s))return!1}else if(!this._validate(n,s))return!1;n&&s.wait&&(this.attributes=i.extend({},a,n)),void 0===s.parse&&(s.parse=!0);var l=this,h=s.success;return s.success=function(t){l.attributes=a;var e=l.parse(t,s);return s.wait&&(e=i.extend(n||{},e)),i.isObject(e)&&!l.set(e,s)?!1:(h&&h(l,t,s),void l.trigger("sync",l,t,s))},$(this,s),o=this.isNew()?"create":s.patch?"patch":"update","patch"===o&&(s.attrs=n),r=this.sync(o,this,s),n&&s.wait&&(this.attributes=a),r},destroy:function(t){t=t?i.clone(t):{};var e=this,s=t.success,n=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(i){(t.wait||e.isNew())&&n(),s&&s(e,i,t),e.isNew()||e.trigger("sync",e,i,t)},this.isNew())return t.success(),!1;$(this,t);var o=this.sync("delete",this,t);return t.wait||n(),o},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||T();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},i.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var s=this.validationError=this.validate(t,e)||null;return s?(this.trigger("invalid",this,s,i.extend(e||{},{validationError:s})),!1):!0}});var g=["keys","values","pairs","invert","pick","omit"];i.each(g,function(t){f.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.attributes),i[t].apply(i,e)}});var m=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},v={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};i.extend(m.prototype,h,{model:f,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.defaults(e||{},y))},remove:function(t,e){t=i.isArray(t)?t.slice():[t],e||(e={});var s,n,o,r;for(s=0,n=t.length;n>s;s++)r=this.get(t[s]),r&&(delete this._byId[r.id],delete this._byId[r.cid],o=this.indexOf(r),this.models.splice(o,1),this.length--,e.silent||(e.index=o,r.trigger("remove",r,this,e)),this._removeReference(r));return this},set:function(t,e){e=i.defaults(e||{},v),e.parse&&(t=this.parse(t,e)),i.isArray(t)||(t=t?[t]:[]);var s,n,o,a,h,c=e.at,d=this.comparator&&null==c&&e.sort!==!1,u=i.isString(this.comparator)?this.comparator:null,p=[],f=[],g={};for(s=0,n=t.length;n>s;s++)(o=this._prepareModel(t[s],e))&&((a=this.get(o))?(e.remove&&(g[a.cid]=!0),e.merge&&(a.set(o.attributes,e),d&&!h&&a.hasChanged(u)&&(h=!0))):e.add&&(p.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,null!=o.id&&(this._byId[o.id]=o)));if(e.remove){for(s=0,n=this.length;n>s;++s)g[(o=this.models[s]).cid]||f.push(o);f.length&&this.remove(f,e)}if(p.length&&(d&&(h=!0),this.length+=p.length,null!=c?l.apply(this.models,[c,0].concat(p)):r.apply(this.models,p)),h&&this.sort({silent:!0}),e.silent)return this;for(s=0,n=p.length;n>s;s++)(o=p[s]).trigger("add",o,this,e);return h&&this.trigger("sort",this,e),this},reset:function(t,e){e||(e={});for(var s=0,n=this.models.length;n>s;s++)this._removeReference(this.models[s]);return e.previousModels=this.models,this._reset(),this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,i.extend({at:this.length},e)),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,i.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return a.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t.cid||t]},at:function(t){return this.models[t]},where:function(t,e){return i.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},sortedIndex:function(t,e,s){e||(e=this.comparator);var n=i.isFunction(e)?e:function(t){return t.get(e)};return i.sortedIndex(this.models,t,n,s)},pluck:function(t){return i.invoke(this.models,"get",t)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,s=this;return t.success=function(i){var n=t.reset?"reset":"set";s[n](i,t),e&&e(s,i,t),s.trigger("sync",s,i,t)},$(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?i.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var s=this,n=e.success;return e.success=function(i){e.wait&&s.add(t,e),n&&n(t,i,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof f)return t.collection||(t.collection=this),t;e||(e={}),e.collection=this;var i=new this.model(t,e);return i._validate(t,e)?i:(this.trigger("invalid",this,t,e),!1)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,s){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,s),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];i.each(b,function(t){m.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),i[t].apply(i,e)}});var w=["groupBy","countBy","sortBy"];i.each(w,function(t){m.prototype[t]=function(e,s){var n=i.isFunction(e)?e:function(t){return t.get(e)};return i[t](this.models,n,s)}});var _=e.View=function(t){this.cid=i.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},x=/^(\S+)\s*(.*)$/,k=["model","collection","el","id","attributes","className","tagName","events"];i.extend(_.prototype,h,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=i.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var s=t[e];if(i.isFunction(s)||(s=this[t[e]]),s){var n=e.match(x),o=n[1],r=n[2];s=i.bind(s,this),o+=".delegateEvents"+this.cid,""===r?this.$el.on(o,s):this.$el.on(o,r,s)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(t){this.options&&(t=i.extend({},i.result(this,"options"),t)),i.extend(this,i.pick(t,k)),this.options=t},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t["class"]=i.result(this,"className"));var s=e.$("<"+i.result(this,"tagName")+">").attr(t);this.setElement(s,!1)}}}),e.sync=function(t,s,n){var o=C[t];i.defaults(n||(n={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var r={type:o,dataType:"json"};if(n.url||(r.url=i.result(s,"url")||T()),null!=n.data||!s||"create"!==t&&"update"!==t&&"patch"!==t||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||s.toJSON(n))),n.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),n.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){r.type="POST",n.emulateJSON&&(r.data._method=o);
var a=n.beforeSend;n.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",o),a?a.apply(this,arguments):void 0}}"GET"===r.type||n.emulateJSON||(r.processData=!1),"PATCH"!==r.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=e.ajax(i.extend(r,n));return s.trigger("request",s,l,n),l};var C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var S=function(t,e){var s,n=this;s=t&&i.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},i.extend(s,n,e);var o=function(){this.constructor=s};return o.prototype=n.prototype,s.prototype=new o,t&&i.extend(s.prototype,t),s.__super__=n.prototype,s};f.extend=m.extend=_.extend=S;var T=function(){throw new Error('A "url" property or function must be specified')},$=function(t,e){var i=e.error;e.error=function(s){i&&i(t,s,e),t.trigger("error",t,s,e)}};return e}),define("pubsub",["underscore","backbone"],function(t,e){"use strict";var i=t.extend({},e.Events);i.attach=function(e,i){t.each(e,t.bind(function(t,e){this.on(e,t,i)},this))},i.unattach=function(e,i){t.each(e,t.bind(function(t,e){this.off(e,t,i)},this))};var s=i.trigger;return i.trigger=function(t){try{s.apply(i,arguments)}catch(e){console.error('PubSub trigger "'+t+'" threw exception: ',e.stack||e.stacktrace||e.message)}return i},i}),define("utils",["jquery","underscore","backbone","pubsub"],function(t,e){"use strict";var i=function(){this.storage={},this.set("DEBUG",!0),this.set("document",t(document)),this.set("win",t(window)),this.set("body",t("body")),this.set("scrollEl",t("html,body")),this.set("doc",t(document))};return i.prototype={set:function(t,e){this.storage[t]=e},get:function(t){return this.storage[t]},getPageUrl:function(){return this.getOrigin()+window.location.pathname},getOrigin:function(){return window.location.protocol+"//"+window.location.host},getScrollPosition:function(){return window.pageYOffset||document.documentElement.scrollTop},loadScript:function(e,i,s){return t.Deferred(function(t){var s=window[i];s?t.resolve(s):require([e],function(){if(s=window[i])t.resolve(s);else{var n="Missing symbol: "+i+" from script: "+e;console.error(n),t.reject(n)}},function(e){console.error("Failed loading script",e),t.reject(e)})}).done(function(t){s&&s(t)})},openPopup:function(t,e,i){e=e||600,i=i||400;var s=this.popupCoords(e,i);window.open(t,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height="+i+",width="+e+",top="+s.top+",left="+s.left)},isValidUrl:function(t){if(!t)return!1;if(-1!==t.indexOf("mailto:"))return!0;if(-1!==t.indexOf("javascript:"))return!1;if("#"===t[0]){if(1===t.length)return!1}else if(-1!==t.indexOf("../")||"/"!==t[0]&&-1===t.indexOf("://"))return console.error("Attempting to load a relative url, bad code monkey! ("+t+")"),!1;return!0},getNested:function(t,i){return t?(i=Array.prototype.slice.call(arguments,1),e.reduce(i,function(t,e){return t&&t[e]},t)):void 0},getSiteSections:function(){var t=this.getNested(window,"site_vars","sections")||"";return t?t.split("|"):[]},popupCoords:function(t,e){var i=window.screenLeft?window.screenLeft:window.screenX,s=window.screenTop?window.screenTop:window.screenY,n=window.outerWidth?window.outerWidth:document.documentElement.clientWidth,o=window.outerHeight?window.outerHeight:document.documentElement.clientHeight;return{left:i+n/2-t/2,top:s+o/2-e/2-25}},addCommas:function(t){t+="";for(var e=t.split("."),i=e[0],s=e.length>1?"."+e[1]:"",n=/(\d+)(\d{3})/;n.test(i);)i=i.replace(n,"$1,$2");return i+s},lazyLoadImage:function(i,s,n,o,r){var a=!1;return s=s||"data-src",i.each(e.bind(function(e,i){var l=t(i),h=l.attr(s),c=l.attr("src");h&&c!==h&&(this._attachHandler("error",l,o),r&&this._attachHandler("load",l,r),l.attr("src",h),n||l.removeAttr(s),a=!0)},this)),a},_attachHandler:function(t,e,i){var s=function(){e.off(t,s),"error"===t&&e.hide(),i&&i(e)};e.on(t,s)},getSectionPath:function(t){if(t){var e=t.indexOf("?");-1!==e&&(t=t.substring(0,e))}if(t&&"/"!==t){"/"===t[0]&&(t=t.substring(1));var i=t.indexOf("/");return-1===i?t:t.substring(0,i)}return"home"},getSubSection:function(t){if(t){var e=t.indexOf("?");-1!==e&&(t=t.substring(0,e)),"/"!==t[t.length-1]&&(t+="/");var i=t.indexOf("/",1),s=t.indexOf("/",i+1);if(-1!==i&&-1!==s)return t.substring(i+1,s)}return""},lazyLoadError:function(e){t(this).hide(),e&&e(t(this))},requireSingleUseScript:function(i){return t.Deferred(function(t){require([i],function(e){t.resolveWith(this,[e])},function(e){console.error("failed loading scripts",e),t.reject(e)})}).always(e.bind(function(){this.removeRequireModule(i)},this)).promise()},removeRequireModule:function(e){require.undef(e),t('script[data-requiremodule="'+e+'"]').remove()},getUrlParam:function(t){var e=decodeURI((new RegExp(t+"=(.+?)(&|$)").exec(window.location.search)||[0,!1])[1]);return"false"===e?!1:"true"===e?!0:e},getSessionData:function(t,e){var i=sessionStorage[t];return i&&JSON.parse(i)||e},setSessionData:function(t,i){e.isString(i)||(i=JSON.stringify(i)),sessionStorage.setItem(t,i)},clearSessionData:function(t){sessionStorage.removeItem(t)},isDocumentHidden:function(){return document.hidden||document.webkitHidden||document.mozHidden||document.msHidden||document.oHidden}},new i}),define("modules/global/alert",["jquery","underscore","pubsub"],function(t,e,i){var s=function(){};return s.prototype={render:function(){this.$alert||(this.$alert=t('<div class="ui-alert"><span class="text"></span><span class="close-btn">Close</span></div>').appendTo(t("body")),this.$alertText=this.$alert.find(".text"),this.$alert.on("click",".close-btn",e.bind(function(){this.hide()},this)))},show:function(t){this.render(),i.trigger("show:alert"),this.$alertText.html(t),this.$alert.addClass("active").removeClass("error")},hide:function(){i.trigger("hide:alert"),this.$alert.removeClass("active error")},showError:function(t){this.render(),i.trigger("show:error:alert"),this.$alertText.html(t),this.$alert.addClass("active error")}},new s}),define("managers/trafficcop",["jquery","underscore"],function(t,e){var i=function(){this.DEBUG=!0,this.defaultTimeout=2e3,this.minTimeout=500,this.activeRequests=[],this.activeAnimations=[],this.animationCompletion=null};return i.prototype={addRequest:function(i){var s={ajaxPromise:i,gate:t.Deferred(),result:null};this.activeRequests.push(s),i.always(e.bind(function(t){this.activeAnimations.length?s.result=t:("resolved"===i.state()?s.gate.resolve(t):s.gate.reject(t),this._cleanup())},this));var n=s.gate.promise();return n.original=i,n.abort=i.abort,n},addAnimation:function(i,s,n,o,r){if(!i||"pending"!==i.state())return i;this.animationCompletion||(this.animationCompletion=t.Deferred());var a=Math.max(2*r,this.minTimeout)||this.defaultTimeout,l=setTimeout(e.bind(function(){console.warn("ANIMATION did NOT resolve within "+a+" ms, releasing barrier "+this._getAnimationPropertyDescription(n,o),s),this._resolveAnimation(i)},this),a);return this.activeAnimations.push(i),i.always(e.bind(function(){clearTimeout(l),this._resolveAnimation(i)||console.warn("animation finished after being released "+this._getAnimationPropertyDescription(n,o),s)},this)),this.animationCompletion.promise()},getAnimationCompletion:function(){return this.animationCompletion?this.animationCompletion.promise():t.Deferred().resolve()},_getAnimationPropertyDescription:function(t,e){return t?"on property "+t+":"+e:"on unregistered element"},_resolveAnimation:function(e){var i=t.inArray(e,this.activeAnimations);return-1!==i?(this.activeAnimations.splice(i,1),0===this.activeAnimations.length&&this._openGate(),!0):!1},_openGate:function(){var t=this.animationCompletion;this.animationCompletion=null,e.each(this.activeRequests,function(t){var e=t.ajaxPromise.state();"resolved"===e?t.gate.resolve(t.result):"rejected"===e&&t.gate.reject(t.result)}),this._cleanup(),t.resolve()},_cleanup:function(){this.activeRequests=e.reject(this.activeRequests,function(t){return"pending"!==t.gate.state()})}},new i}),define("managers/requestmanager",["jquery","underscore","managers/trafficcop","utils"],function(t,e,i,s){var n=function(){this.DEBUG=!0,this.xhrList=[],this.intervalList=[]};return t(document).ajaxSend(function(e,i,s){"post"===s.method&&i.setRequestHeader("X-CSRFToken",t.cookie("csrftoken"))}),n.prototype={timeout:3e4,fetchHtml:function(t,e,i,s){return this.fetchData(t,e,i,s,!0)},recurringFetchHtml:function(t,e,i,s,n){return this.recurringFetchData(t,e,i,s,n,!0)},recurringFetchData:function(t,i,s,n,o,r){var a=e.bind(function(){this.fetchData(t,i,!1,o,r).done(function(t){n(t)})},this);a();var l=setInterval(a,s);return this.intervalList.push(l),l},fetchData:function(i,s,n,o,r){s=this._setupRequest(i,s,o);var a=t.Deferred();this._startRequest(a,s,n,r);var l=a.promise();return l.abort=e.bind(function(){a.reject()},this),l},_setupRequest:function(e,i,s){var n={};return s&&(n["X-PJAX"]="true",n["X-PJAX-Container"]="#overlay"),e?0!==e.indexOf("/")&&0!==e.indexOf("http")&&(e="/"+e):e="/",i=t.extend({url:e,data:{ajax:!0},beforeSend:function(e){t.each(n,function(t,i){e.setRequestHeader(t,i)})},timeout:this.timeout},i)},_startRequest:function(e,s,n,o,r){var a=this._initializeFetchData(s.url,n);if(!a)return void e.reject();var l=t.ajax(s);this.DEBUG&&l.fail(function(t){t.statusText&&"abort"!==t.statusText&&console.log("fetchData Error: ",t.statusText,s)}),e.fail(function(){"pending"===l.state()&&l.abort()}),l=i.addRequest(l),this._registerNavRequests(l,e,s.url,n),n?this._resolveNavAjax(l,e,s,n,o,r):this._resolveAjax(l,e,o)},_resolveNavAjax:function(t,i,s,o,r,a){t.done(e.bind(function(){var e=t.original.getResponseHeader("X-Firefly-Session-Needed");e?this._handleFireflyAuth(e,i,s,o,r,a):this._resolveAjax(t,i,r)},this)).fail(function(){n.prototype._resolveAjax(t,i,r)})},_handleFireflyAuth:function(t,i,s,n,o,r){if(r)console.error("Auth failed, X-Firefly-Session-Needed appeared on refetch"),i.reject("NOT AUTHORIZED");else{console.log("Requesting FIREFLY Auth");var a=this._getFireflyAuth(t).done(e.bind(function(){console.log("FIREFLY Auth Successful, requesting original asset"),this._startRequest(i,s,n,o,!0)},this)).fail(function(t,e){i.reject(t,e)});i.fail(function(){a.reject()})}},_resolveAjax:function(t,e,i){t.done(function(s){i&&(s=n.prototype._toHtml(s)),e.resolveWith(t,[s])}).fail(function(i){e.rejectWith(t,[i])})},_toHtml:function(e){var i=document.createDocumentFragment(),s=document.createElement("div");return s.innerHTML=e,i.appendChild(s),t(i).children().children()},_getFireflyAuth:function(i){var n,o=Math.floor(1e3*Math.random()),r=this._createFireflyiFrame(i);return t.Deferred(e.bind(function(e){n=setTimeout(function(){console.error("Auth timeout occurred"),e.reject("NOT AUTHORIZED","Request Timed Out")},this.timeout),t(window).on("message.rqman"+o,function(t){if(t=t.originalEvent,t.origin===s.getOrigin())try{var i=JSON.parse(t.data);if("firefly-auth"!==i.type)return;if("success"===i.auth)return void e.resolve(i);e.reject("NOT AUTHORIZED",i)}catch(n){}})},this)).always(function(){clearTimeout(n),t(window).off(".rqman"+o),document.body.removeChild(r)})},_createFireflyiFrame:function(t){var i=document.createElement("iframe");return i.id=i.name=e.uniqueId("firefly_auth_"),i.className="hidden",i.src=t,document.body.appendChild(i),i},_registerNavRequests:function(t,i,s,n){var o={ajaxPromise:t,resultDeferred:i,url:s,isNav:n};this.xhrList.push(o),t.always(e.bind(function(){this.xhrList=e.without(this.xhrList,o)},this))},_initializeFetchData:function(t,e){var i=1==this.xhrList.length&&this.xhrList[0],s=i&&i.isNav;if(e){if(s&&i.url===t)return!1;this.abortAllRequests()}else if(s)return!1;return!0},abortAllRequests:function(){e.each(this.xhrList,function(t){t.ajaxPromise.abort(),t.resultDeferred.reject()}),e.each(this.intervalList,function(t){clearInterval(t)}),this.xhrList=[],this.intervalList=[]},done:function(){return t.when(this.xhrList)}},new n}),define("mergedSiteConfig",[],function(){return{require:{paths:{chosen:"libs/jquery/plugins/chosen.jquery.min",bxslider:"libs/jquery/plugins/jquery.bxslider.min",touchswipe:"libs/jquery/plugins/jquery.touchSwipe"},shim:{"libs/flot/jquery.flot.usat.pie":["libs/flot/jquery.flot"],"libs/flot/jquery.flot.multibars":["libs/flot/jquery.flot"],chosen:["jquery"],"libs/flot/jquery.flot.orderBars":["libs/flot/jquery.flot"],bxslider:["jquery"],"libs/flot/jquery.flot.usat.style":["libs/flot/jquery.flot"],"libs/flot/jquery.flot":["libs/flot/excanvas"]}},global:{modules:["modules/global/header","raven.setup","analytics/settealium","third-party-apis/facebook/facebook","third-party-apis/google/google","user-accounts/facebook-user-account","user-accounts/googleplus-user-account"],pubSub:{openFullScreenCarousel:["modules/carousel/carousel-fullscreen"]}},apps:{StaffBio:{path:"apps/stag-front",init_modules:[{name:"footer"},{name:"headline-grid"}],css:["pages/staff"]},BigPage:{path:"apps/bigpage",css:"bigpage"},Search:{path:"apps/search",css:"modules/search"},BaseApp:{path:"base-app"},Users:{path:"base-app",selector:".something"},Topics2:{path:"apps/stag-front",init_modules:[{name:"footer"},{name:"election-2012"}],name:"Topics2",pages:null},UGC:{path:"apps/ugc-app",css:["ugc/ugc"],selector:".ugc-app"},ballot:{path:"apps/ballot-app",selector:".ballot-app"},Topics:{path:"apps/stag-front",init_modules:[{name:"footer"}],css:"stag"},stories_wide:{path:"modules/stories_wide/stories-wide-app"},"Overlay-with-footer":{path:"apps/simple-overlay",init_modules:[{name:"footer"}],overlay:!0},Blog:{path:"apps/stag-front",init_modules:[{name:"footer"}],css:["blog","blog/blog-default"]},Interactives1:{path:"apps/interactives",pages:null,name:"Interactives1",selector:"#interactive"},Overlay:{path:"apps/simple-overlay",css:["story-article","story-grid","story-navbar","stories/sponsored-series","stories/story-right-rail"],overlay:!0},MediaView:{path:"apps/media",css:"media-view"},Error:{path:"apps/404",css:"404",overlay:!0},Cards:{path:"apps/cards/cards",init_modules:[{name:"footer"},{name:"sidebar"}],css:["cards","sidebar"]},wlna:{path:"app/wlna"},"Overlay-with-arrows":{path:"apps/overlay/overlay",init_modules:[{name:"utility-bar"},{name:"recommended-flyout"}],overlay:!0},LiveApp:{path:"apps/live_app/live-app-app",selector:".live-app-view-content-wrapper"},"Overlay-with-utility-bar":{path:"apps/simple-overlay",init_modules:[{name:"utility-bar"}],css:["utility-bar"],overlay:!0}},version:2,pages:[{path:"apps/overlay/pages/contact-us-overlay",init_modules:[{name:"static-story-expand-faq"},{name:"footer"}],name:"ContactUs",urls:["^(contactus.*)$"],appName:"Overlay"},{path:"apps/overlay/pages/interactive-overlay",name:"Web to Watch",urls:["^(tv/web-to-watch.*|interactives/tv-on-the-web.*)$"],appName:"Overlay"},{init_modules:[{name:"static-story-expand-faq"},{name:"footer"}],name:"StaticContent",urls:["^(social-player.*|shop.*|about.*|rss.*|mobile-apps.*|mediakit.*|press-bios.*|reporters.*|legal.*|editorial-policy.*|conversation-guidelines.*|interactives/tv-on-the-web.*)$"],appName:"Overlay"},{urls:["^(life/[a-zA-Z0-9%\\-/\\.]*)$"],name:"Life",css:["life"],appName:"Cards"},{hosturls:{"puzzles.usatoday.com":["^(|crossword|dont-quote-me|minisudoku|quickcross|sudoku|upanddown|wordroundup)/*$"]},name:"Puzzles Flash legacy",appName:"Overlay",urls:["^((puzzles/legacy)(|/.*))$"],path:"apps/overlay/pages/puzzles-overlay",preloadedUrl:"http://www.usatoday.com/life/",css:["puzzles"]},{init_modules:[{name:"snapshots"}],name:"Home",urls:["^()$","^(index.html)$","^(home/flex.*)$"],appName:"Cards"},{init_modules:[{name:"taboola-recommendations"}],name:"Photo Asset",urls:["^((photos|picture-gallery)/.*/)$"],appName:"Overlay-with-arrows"},{init_modules:[{name:"taboola-recommendations"}],name:"Video Asset",urls:["^videos/.*/$"],appName:"Overlay-with-arrows"},{name:"Sports Player",appName:"Overlay-with-utility-bar",urls:["^(sports/[a-zA-Z]+/player/.*)$"],path:"apps/overlay/pages/player-overlay",preloadedUrl:"/sports/",init_modules:[{name:"gallery"},{name:"sports-datatables"},{name:"sports-more-teams-college"}],css:["sports","sports-logos"]},{name:"Sports Olympics Widgets",appName:"Cards",urls:["^(sports/olympics/[a-zA-Z0-9]+/(medals|schedule)/)$","^(sports/olympics/[a-zA-Z0-9]+/(medals|schedule)/[0-9\\-]+/[a-zA-Z0-9]+/[a-zA-Z0-9]+/)$","^(sports/services/rightrail/olympics/[a-zA-Z0-9]+/[a-zA-Z0-9]+/)$"],path:"apps/cards/pages/sports-card",preloadedUrl:"/sports/",init_modules:[{name:"sports-olympics-schedule-results"},{name:"sports-filters"},{name:"sports-nav"},{name:"sports-jumptotop"}],css:["sports","sports-logos"]},{name:"Sports Olympics Profile Overlay",appName:"Overlay-with-utility-bar",urls:["^(sports/olympics/[a-zA-Z0-9]+/(athletes|countries)/[a-zA-Z0-9-]+/.*)$"],path:"apps/cards/pages/sports-card",preloadedUrl:"/sports/",init_modules:[{name:"gallery"},{name:"sports-olympics-profile-overlay"}],css:["sports","sports-logos"]},{name:"Sports BoxScores",appName:"Overlay",buildfile:{path:"buildfiles/sports-boxscore"},urls:["^(sports/[a-zA-Z]+/game/.*)$","^(sports/[a-zA-Z]+/event/.*)$"],path:"apps/overlay/pages/boxscore-overlay",preloadedUrl:"/sports/",init_modules:[{name:"gallery"}],css:["sports","sports-logos"]},{name:"Sports Story Overlay",appName:"Overlay-with-arrows",urls:["^(story/sports/.*)"],path:"apps/overlay/pages/sports-story-overlay",preloadedUrl:"/sports/",init_modules:[{name:"iframe-auto-height"},{name:"taboola-recommendations"},{name:"nfl-unitedway"}],css:["sports","sports-logos"]},{name:"Sports",appName:"Cards",buildfile:{path:"buildfiles/sports",modules:["sports-scores-suspender"]},urls:["^(sports/[a-zA-Z0-9%\\-/\\.#]*)$"],path:"apps/cards/pages/sports-card",init_modules:[{name:"sports-filters"},{name:"scores-page"},{name:"sports-leagues"},{name:"sports-nav"},{name:"sports-player-news"},{name:"sports-popup"},{name:"sports-jumptotop"},{name:"sports-datatables"},{name:"sports-leader-rotate"},{name:"gallery"},{name:"utility-bar"},{name:"sports-event-tool"},{name:"sports-ballots"},{name:"sports-brackets"},{name:"sports-data-video"}],css:["sports","sports-logos"]},{urls:["^(topic/.*/video-big-board/)$"],init_modules:[{name:"sports-video"},{name:"sports-featured-content"},{name:"utility-bar"}],name:"Video Big Board",css:["sports","sports-logos"],appName:"Topics"},{urls:["^(topic/.*/fantasy-football-week-in-america/)$"],init_modules:[{name:"sports-video"}],name:"Fantasy Football Week In America",css:["sports","sports-logos"],appName:"Topics"},{urls:["^(topic/.*/fantasy-football-draft-kit/)$","^(topic/.*/spanning-the-sec/)$"],name:"Sports Topic Pages Without Init Modules",css:["sports","sports-logos"],appName:"Topics"},{urls:["^(topic/.*/2014-olympic-(.+)s/)$"],init_modules:[{name:"sports-popup-media-view"}],name:"Sports Topic Pages With Popup Media View",css:["sports","sports-logos"],appName:"Topics"},{name:"Default",urls:["^(media/.*)$"],appName:"MediaView"},{name:"Default",urls:["^(topic/.*)$"],appName:"Topics"},{name:"Default",urls:["^(blog/.*)$"],appName:"Blog"},{urls:["^(blogs/)$"],name:"BlogsIndex",css:["blogs-index"],appName:"Cards"},{name:"Default",urls:["^(blog/.*)$"],appName:"Blog"},{urls:["^(life/books/best-selling/.*)$"],name:"Best Selling Book List",css:["book-reviews"],appName:"Cards"},{name:"Book Review Detail Page",appName:"Overlay-with-arrows",urls:["^(story/life/books/.*)$"],path:"apps/overlay/pages/story-overlay",init_modules:[{name:"booksAssetView"},{name:"taboola-recommendations"},{name:"form-dropdown"}],css:["book-reviews"]},{path:"apps/overlay/pages/story-overlay",init_modules:[{name:"iframe-auto-height"},{name:"taboola-recommendations"},{name:"myCapture"}],name:"Story",urls:["^((story|article)/.*/)$"],appName:"Overlay-with-arrows"},{name:"Stories Wide",appName:"stories_wide",urls:["^(wide-story/.*)$","^(longform/.*)$"],path:"modules/stories_wide/stories-wide",init_modules:[{name:"wide-story-navigation"},{name:"wide-story-share"},{name:"wide-story-nav-rail-bucket"},{name:"wide-story-top-series-bucket"}],css:["stories_wide"]},{urls:["^(wlna/.*)$"],css:["wlna"],appName:"wlna"},{path:"apps/overlay/pages/interactive-overlay",name:"Interactive",urls:["^(interactive/.*)$"],appName:"Interactives1"},{name:"Flight Tracker",appName:"Overlay-with-utility-bar",urls:["^(travel/flight-tracker/.*)$"],path:"apps/overlay/pages/flight-tracker-overlay",preloadedUrl:"travel/",css:["map"]},{init_modules:[{name:"footer"}],name:"Travel",urls:["^(travel/[a-zA-Z0-9%\\-/\\.#]*)$"],appName:"Cards"},{name:"Default",urls:["^(search/.*)$"],appName:"Search"},{urls:["^(lottery/.*/)$"],init_modules:[{name:"form-dropdown"},{name:"poster-ad-asset"}],name:"Lottery Overlay",css:["life"],appName:"Overlay-with-arrows"},{name:"Default",urls:["^(election-2012/.*)$"],appName:"Topics2"},{name:"Horoscope",appName:"Overlay-with-utility-bar",urls:["^(horoscope/(aries|taurus|gemini|cancer|leo|virgo|libra|scorpio|sagittarius|capricorn|aquarius|pisces).*)$"],path:"apps/overlay/pages/horoscope-overlay",init_modules:[{name:"inline-share-tools"},{name:"taboola-recommendations"}],css:["horoscope"]},{name:"Default",urls:["^(big-page/.*)$"],appName:"BigPage"},{name:"Money Overlay",appName:"Overlay",urls:["^(money/(economic-calendar|etfs|funds|markets|stocks|lookup)/.*/)$"],preloadedUrl:"/money/",init_modules:[{name:"form-dropdown"}],css:["money"]},{urls:["^(money/[a-zA-Z0-9%\\-/\\.]*)$"],name:"Money",css:["money"],appName:"Cards"},{name:"Default",urls:["^(staff/.*)$"],appName:"StaffBio"},{path:"apps/live_app/live-app",urls:["^(rightnow/.*)$"],name:"Right Now",css:["live-app"],appName:"LiveApp"},{name:"CatchAll",urls:["^(errors/.*)$","^(404.html)$"],appName:"Error"},{name:"Puzzles Html5 Legacy Overlay",appName:"Overlay",urls:["^(puzzles/(crossword|sudoku|roundup|upanddown).*)$"],path:"apps/overlay/pages/puzzles-oldhtml5-overlay",preloadedUrl:"/life/",css:["life","puzzles"]},{path:"apps/cards/pages/weather-card",urls:["^(weather/[a-zA-Z0-9%\\-/\\.]*)$"],name:"Weather",css:["weather"],appName:"Cards"},{css:["users"],name:"Profile Page",urls:["^(profile/[0-9]+/)$"],appName:"Users"},{css:["firefly"],name:"Not Authorized",urls:["^get-access/","^restricted/"],appName:"Overlay"},{name:"Generic Section",urls:["^(<%=site_vars.sections%>)$","^(<%=site_vars.sections%>)/.*$","^$","^index.html$","^section/[a-zA-Z0-9%\\-/\\.]*$"],appName:"Cards"},{name:"Ballot",appName:"Overlay-with-utility-bar",urls:["^(take-your-pick/[a-zA-Z0-9%\\-/\\.]*)$"],preloadedUrl:"life/",init_modules:[{name:"ballot"},{name:"poster-ad-asset"},{name:"poster-ad-asset2"}],css:["ballot-page"]},{path:"pages/static_page",ajax:!1,name:"Static Page",urls:["^pages/.*$"],appName:"Overlay-with-utility-bar"},{name:"UGC Home Page",appName:"UGC",urls:["^(yourtake/)$"],path:"apps/ugc/pages/ugc-front",init_modules:[{name:"ugc-featured-content"},{name:"ugc-hero",options:{thumbsSelector:".ugc-hero-multi-up-thumbs",fullScreen:"false",rotate:"true",ads:"false",track:"false",autostart:"true"}},{name:"ugc-my-contributions-links"}],css:["ugc-home-page"]},{name:"UGC Topics Home Page",appName:"UGC",urls:["^(yourtake/topics/)$","^(yourtake/topics/?.*)$"],path:"apps/ugc/pages/ugc-front",init_modules:[{name:"ugc-featured-content"},{name:"ugc-topics-sortby-dropdown"},{name:"ugc-my-contributions-links"}],css:["ugc-topics-page"]},{name:"UGC Topics Page",appName:"UGC",urls:["^(yourtake/topics/.*)$"],path:"apps/ugc/pages/ugc-front",init_modules:[{name:"ugc-featured-content"},{name:"ugc-my-contributions-links"}],css:["ugc-topics-page"]},{name:"UGC Posts",appName:"Overlay-with-utility-bar",urls:["^(yourtake/asset/posts/[a-zA-Z0-9%\\-/\\.]*)$"],preloadedUrl:"/yourtake/",init_modules:[{name:"ugc-report-abuse",options:{tooltipOptions:{position:"left",customTextClass:"ugc-asset-page-media-item-report-abuse-tooltip-text",customPanelClass:"ugc-asset-page-media-item-report-abuse-tooltip-panel"}}},{name:"ugc-asset-gallery",options:{track:"false",fullScreen:"false",ads:"false"}},{name:"ugc-asset-video",options:{autostart:"true"}}],css:["ugc-asset-page"]},{name:"UGC Profile",appName:"Users",urls:["^yourtake/profile/[a-zA-Z0-9%\\-/\\.]*$"],path:"apps/ugc/pages/ugc-front",init_modules:[{name:"ugc-featured-content"}],css:["ugc-user-profile-page"]},{preloadedUrl:"/yourtake/",name:"UGC FAQ",urls:["^(yourtake/faq/)$"],appName:"Overlay-with-footer"}],siteModules:{"scores-page":{path:"modules/sports/scorespage",selector:"#scorespage"},"sports-more-teams":{path:"modules/sports/sports-more-teams"},"sponsor-story-topbar":{},"sponsor-story-more-stories":{},"interactive-poll":{path:"modules/interactive-poll",selector:".interactive-poll"},sigfig:{},"site-nav-firefly-module":{path:"modules/users/site-nav-firefly-module",selector:".site-nav-firefly-module"},"ugc-featured-content":{path:"modules/fronts/featured-content",selector:".ugc-featured-content-module"},"travel-featured-content":{path:"modules/travel/travel-featured-content"},"sports-data-video":{path:"modules/sports/sports-data-video",selector:".sp-data-video"},tripology:{path:"modules/travel/tripology"},"utility-bar-module-firefly":{path:"modules/stories/utility-bar-module-firefly",selector:".util-bar-module-firefly"},"sports-popup":{path:"modules/sports/popup-details",selector:"#section_sports"},quicklinks:{},"shermans-deals":{path:"modules/travel/shermans"},"popular-on-social":{},sidebar:{path:"modules/sidebar",selector:"#card_full_width_main"},"sidebar-poster-ad":{path:"modules/fronts/sidebar-poster-ad",selector:".partner-sidebar-ad"},"travel-guides":{path:"modules/travel/travel-guides"},"blog-promo":{path:"modules/fronts/blog-promo"},"sports-olympics-countdown":{path:"modules/sports/sports-countdown"},"expandable-photo":{path:"modules/stories/expandable-photo"},"top-stories":{},"sports-pulse":{path:"modules/partner/sponsor-logo-ad",selector:".sponsor-logo"},"travel-dest-nav":{path:"modules/travel/travel-dest-nav"},usanow:{},"more-blogs":{},"utility-bar-module-ugc":{path:"modules/stories/utility-bar-module-ugc",selector:".util-bar-module-ugc"},"share-facebook":{path:"modules/stories/share-facebook",selector:".util-bar-flyout-share"},"sports-more-teams-college":{path:"modules/sports/sports-more-teams-college",selector:"#sp-more-teams-slider"},"wide-story-top-series-bucket":{path:"modules/stories_wide/stories-wide-series-bucket-top",selector:".wide-story-top-series-bucket"},"sports-syndication-hero":{},puzzles:{},"sports-filters":{path:"modules/sports/sports-filters",selector:".sp-filter-bar-wrap"},"featured-content-with-advertising":{path:"modules/fronts/sidebar-poster-ad",selector:".poster-ad-primary"},"sports-datatables":{path:"modules/sports/sports-datatables",selector:"#section_sports"},"blogs-index-latest-hero":{},"ggm-classifieds-search":{},"leaderboard-ad":{path:"modules/partner/leaderboard-ad",selector:".leaderboard-ad"},"travel-trends":{},livevideo:{path:"modules/videos/brightcove-video",selector:".ui-video"},"sports-leader-rotate":{path:"modules/sports/sports-leader-rotate",selector:".sp-leader-rotate"},"ggm-jobs-search":{path:"modules/ggm-jobs-search/ggm-jobs-search"},"static-story-expand-faq":{path:"modules/stories/expand-faq",selector:".static-page-faq"},"ggm-earlybird-signup":{},"sports-olympics-medals":{path:"apps/overlay/pages/olympics-widgets"},"flight-tracker":{path:"modules/travel/flight-search"},"sports-front-video":{path:"modules/sports/sports-front-video"},"sponsored-series-topbar":{path:"modules/stories/sponsored-series-topbar",selector:".sponsored-series-bar"},booksthreeup:{path:"modules/book-reviews/books-three-up",selector:".module-books-three-up"},twitter:{path:"modules/twitter"},"car-search":{path:"modules/car-search",selector:".car-search-module-wrap"},"market-symbol-search":{path:"modules/money/market-symbol-search"},elections:{path:"modules/fronts/elections-module"},interactive_piechart:{path:"modules/interactives/pie-chart",selector:".interactive.pie-chart"},"sports-nav":{path:"modules/sports/sports-nav",selector:".sp-nav-wrap"},video:{path:"modules/videos/brightcove-video",selector:".ui-video"},"sports-news":{path:"modules/sports/sports-news"},"featured-content":{path:"modules/fronts/featured-content"},ballot:{path:"modules/ballot/ballot",selector:".ballot-module"},"sports-video":{path:"modules/sports/sports-video",selector:".hero-3up"},"election-2012":{path:"apps/election-2012",selector:"#elections-2012"},"sports-olympics-schedule-results":{path:"apps/overlay/pages/olympics-schedule-results",selector:".olympics-schedule"},"market-tool-links":{},"utility-bar-module-share":{path:"modules/stories/utility-bar-module-share",selector:".util-bar-module-share"},"front-galleries":{path:"modules/fronts/front-galleries"},hotelme:{path:"modules/travel/hotelme",selector:".hotelme-wrapper"},"site-nav-social-module":{path:"modules/header/site-nav-social-module",selector:".site-nav-social-module"},"headline-text-grid":{},"recommended-flyout":{path:"modules/stories/recommended-flyout",selector:".recommended-flyout-container"},"iframe-auto-height":{path:"modules/global/iframe-auto-height",selector:".iframe-auto"},"sports-team-leaders":{path:"modules/sports/sports-team-leaders"},hero:{path:"modules/fronts/hero",selector:".hero"},"sports-brackets":{path:"modules/sports/sports-brackets",selector:".card-full-width.brackets"},"sports-twitter":{path:"modules/sports/sports-twitter"},"poster-ad-asset2":{path:"modules/partner/poster-ad-asset2",selector:".partner-asset-right-ad-2"},"sports-front-galleries":{path:"modules/sports/sports-front-galleries"},"about-this-blog":{},"blog-list":{path:"blog/blog-list"},"sports-olympics-widgets":{path:"apps/overlay/pages/olympics-widgets",selector:".sports-olympics-widgets"},"headline-grid":{path:"modules/fronts/headline-grid"},"section-header-nation-now":{},"countdown-clock":{path:"modules/fronts/countdown-clock"},"sports-follow-usat-overlay":{path:"modules/sports/sports-follow-usat"},"site-nav-weather-module":{path:"modules/weather/site-nav-weather-module",selector:".site-nav-weather-module"},"section-header":{},"sports-video-ooyala":{path:"modules/sports/sports-video-ooyala",selector:".sports-ooyala"},"live-newscasts":{path:"modules/live-newscasts/live-newscasts"},interactive_overview:{path:"modules/interactives/overview",selector:".interactive.overview"},"sports-olympics-results":{path:"apps/overlay/pages/olympics-widgets"},"trending-map":{},interactive_sequencer:{path:"modules/interactives/sequencer",selector:".interactive.sequencer"},"ugc-hero":{path:"modules/carousel/carousel",selector:".ugc-hero"},"travel-poll":{path:"modules/travel/travel-poll"},livefeed:{path:"modules/fronts/live-feed",selector:".livefeed-news-list"},"poster-ad-asset":{path:"modules/partner/poster-ad-asset",selector:".partner-asset-right-ad"},"sports-team-statistics":{path:"modules/sports/sports-team-leaders"},"travel-your-take":{},"brightcove-video":{path:"modules/videos/brightcove-video",selector:".ui-video:not('.gallery-video')"},interactive_barchart:{path:"modules/interactives/bar-chart",selector:".interactive.bar-chart"},header:{path:"modules/global/header",selector:".site-header"},"video-carousel":{path:"modules/global/video-carousel"},"wide-story-nav-rail-bucket":{path:"modules/stories_wide/stories-wide-nav-rail-bucket",selector:".wide-story-series-flyout-bucket-wrapper"},"suspender-ad":{path:"modules/fronts/suspender-ad",selector:".suspender-ad"},"wide-story-share":{path:"modules/stories_wide/stories-wide-share",selector:".wide-story-share-wrapper"},lottery:{path:"modules/fronts/lottery",selector:".lottery-module-content"},"sports-scores-suspender":{path:"modules/sports/sports-scores-suspender",selector:"#scores"},"ggm-va-loan":{path:"modules/ggm-va-loan/ggm-va-loan"},myCapture:{path:"modules/myCapture/myCapture",selector:".mycapture-btn-wrap"},"ugc-my-contributions-links":{path:"modules/ugc/my-contributions-links",selector:".ugc-page-container"},"generic-iframe":{},"travel-tools":{path:"modules/travel/travel-tools"},"sports-syndication-headline-grid":{path:"modules/sports/sports-headline-grid"},"utility-bar-module-comments":{path:"modules/stories/utility-bar-module-comments",selector:".util-bar-module-comments"},"hero-4-up":{path:"modules/fronts/hero",selector:".hero"},"election-results":{path:"modules/fronts/election-results-module"},"sports-team-matchup":{path:"modules/sports/sports-team-matchup"},"ugc-report-abuse":{path:"modules/ugc/report-abuse",selector:".ugc-asset-page"},"sports-ballots":{path:"modules/sports/sports-ballots",selector:"#section_sports"},"travel-email":{path:"modules/travel/travel-email"},"story-byline":{},booksAssetView:{path:"apps/overlay/pages/book-reviews-overlay",selector:".books-meta-comp"},"site-nav-user-module":{path:"modules/users/site-nav-user-module",selector:".site-nav-user-module"},snapshots:{path:"modules/fronts/snapshots",selector:".front-galleries-module"},"story-headline":{},"job-search":{path:"modules/money/job-search",selector:".job-search-module-wrap"},"sports-story-video":{path:"modules/sports/sports-story-video"},"sports-multipurpose-promo":{path:"modules/sports/sports-multipurpose-promo"},"sports-scores-suspender-des":{path:"modules/sports/sports-scores-suspender",selector:"#scores"},"kayak-widget":{path:"modules/travel/kayak-module"},"ggm-mil-mall-promo":{},"hero-4-up-flex":{path:"modules/fronts/hero",selector:".hp4fm-primary-wrap"},"travel-experience":{path:"modules/travel/travel-experience"},"inline-share-tools":{path:"modules/stories/inline-share-tools",selector:".inline-share-tools"},"most-popular":{path:"modules/fronts/most-popular"},"sports-countdown":{path:"modules/sports/sports-countdown"},"ugc-asset-gallery":{path:"modules/carousel/carousel",selector:".ugc-asset-page-gallery"},"sports-event-tool":{path:"modules/sports/sports-event-tool",selector:"#section_sports"},"sports-popup-media-view":{path:"modules/sports/sports-popup-media-view",selector:".content-wrap"},blogs:{path:"modules/fronts/blogs"},"story-transition-ad":{path:"modules/partner/story-transition-ad",selector:".partner-overlay"},"form-dropdown":{path:"ui/dropdown",selector:".ui-dropdown"},"social-media":{},"gannett-properties":{selector:".gannett-properties-wrapper"},"sports-latest-player-news":{path:"modules/sports/sports-latest-player-news"},"sports-jumptotop":{path:"modules/sports/sports-jumptotop",selector:"#section_sports"},"blogs-index-grid":{},"taboola-recommendations":{path:"modules/stories/taboola-recommendations",selector:".transition-wrap:first"},"newsletter-signup":{path:"modules/newsletter-signup/newsletter-signup"},interactive_beforeandafter:{path:"modules/interactives/before-after",selector:".interactive.before-after"},"sports-featured-content":{path:"modules/fronts/featured-content"},"social-share-modal":{path:"modules/ugc/social-share-modal",selector:"social-share-modal"},"market-summary-search":{path:"modules/money/market-summary-search"},"big-headline":{},"sports-player-news":{path:"modules/sports/sports-player-news",selector:"#player-news-page"},"site-nav-more-module":{path:"modules/header/site-nav-more-module",selector:".site-nav-more-module"},"share-email":{path:"modules/stories/share-email",selector:".util-bar-flyout-share"},"national-news-desk":{},"generic-front-header":{},"polldaddy-poll":{path:"modules/polldaddy-poll"},"more-section-stories":{},"ugc-topics-sortby-dropdown":{path:"ui/dropdown",selector:".ugc-topics-filter-sortby-dropdown"},"ggm-jobs-latest":{},"hero-5-up":{path:"modules/fronts/hero",selector:".hero"},map:{path:"modules/map/map",selector:".mapboxWrap"},"sports-tickets":{path:"modules/sports/sports-tickets"},"travel-experience-promo":{path:"modules/travel/travel-experience-promo"},"ugc-asset-video":{path:"modules/global/brightcove-video",selector:".video"},horoscope:{path:"modules/horoscope"},interactive_timeline:{path:"modules/interactives/timeline",selector:".interactive.timeline"},oembed:{path:"modules/stories/oembed",selector:".oembed"},"utility-bar-module-print":{path:"modules/stories/utility-bar-module-print",selector:".util-bar-module-print"},"sports-olympics-profile-overlay":{path:"apps/overlay/pages/olympics-profile-overlay",selector:".olympics-profile"},"sports-follow-usat":{},gallery:{path:"modules/carousel/carousel",selector:".galleries"},"video-playlist":{path:"modules/videos/video-gallery",selector:".video-gallery"},"utility-bar":{path:"modules/stories/utility-bar",selector:".utility-bar-wrap"},"hero-6-pack":{path:"modules/fronts/hero",selector:".hero"},"section-highlights":{},"wide-story-navigation":{path:"modules/stories_wide/stories-wide-navigation",selector:".wide-story-navigation-wrapper"},footer:{path:"modules/global/footer",selector:".footer"},dealchicken:{},"super-hero":{path:"modules/fronts/super-hero"},"travel-experience-featured":{path:"modules/travel/travel-experience-featured"},"vegas-experience":{},"sports-olympics-schedule":{path:"apps/overlay/pages/olympics-widgets"},"sports-leagues":{path:"modules/sports/leagues",selector:"#section_sports"},booklist:{path:"modules/book-reviews/booklist",selector:".front-booklist-page-container"},"sports-galleries":{path:"modules/fronts/front-galleries"},interactive_linechart:{path:"modules/interactives/line-chart",selector:".interactive.line-chart"},"nfl-unitedway":{path:"modules/sports/nfl-unitedway",selector:"#nfl-unitedway-subscribe"}}}
}),define("managers/siteconfig",["jquery","underscore","mergedSiteConfig"],function(t,e,i){"use strict";var s={getSiteConfig:function(){return this.inited||(this.inited=!0,this.setupSiteConfig(i)),i},setupSiteConfig:function(t){!t.require||e.isEmpty(t.require.paths)&&e.isEmpty(t.require.shim)||require.config(t.require),s._replaceEnvVariables(t)},loadRoutes:function(){return t.Deferred(e.bind(function(t){var i=this.getSiteConfig(),s=e.pluck(i.apps,"path");require(s,e.bind(function(){var s=arguments,n=0;e.each(i.apps,function(t){t.AppClass=s[n++]}),this.urls=this._buildRoutes(i.pages,i.apps),t.resolve(this.urls)},this))},this))},_buildRoutes:function(t,i){return e.reduce(t,function(t,s){var n=i[s.appName],o=s.hosturls&&s.hosturls[location.hostname]||s.urls;return n||(s.appName&&(console.error("Invalid appName "+s.appName+" for Page "+s.name),s.appName="BaseApp"),n=i.BaseApp),s.modules=(s.init_modules||[]).concat(n.init_modules||[]),t.concat(e.map(o,function(t){var e=void 0===s.ajax&&void 0===n.ajax||void 0===s.ajax&&n.ajax===!0||s.ajax===!0;return{url:new RegExp(t),app:n,page:s,ajax:e}},this))},[])},getRouteInfo:function(i){return i&&(i=i.split("?")[0].split("#")[0],"/"===i[0]&&(i=i.substring(1)),i=t.trim(i)),null!==i&&e.find(this.urls,function(t){return t.url.test(i)})},_replaceEnvVariables:function(t){e.each(t.pages,function(t){if(t.urls){var i=[];e.each(t.urls,function(t){if(-1!=t.indexOf("<%")&&-1!=t.indexOf("%>"))try{t=e.template(t,{})}catch(s){console.error("invalid url template: "+t),t=void 0}void 0!==t&&i.push(t)}),t.urls=i}})}};return s}),define("managers/resourcemanager",["jquery","underscore","managers/siteconfig"],function(t,e,i){"use strict";var s=function(){this.initialize()};return s.prototype={initialize:function(s){s=t.extend({siteModules:i.getSiteConfig().siteModules},s),this.siteModules=s.siteModules||{},this.$stylesheets=t([]),this.stylesheets=[],this.staticUrl=window.site_static_url||"/static/",this.staticVersion=window.site_static_version||"off",t("link[data-identifier]").each(e.bind(function(e,i){var s=t(i).data("identifier");"main"!=s&&(this.stylesheets.push(t(i).data("identifier")),this.$stylesheets.push(i))},this))},fetchStyles:function(i,s,n){var o=e.difference(i,this.stylesheets),r=e.difference(this.stylesheets,i);n&&r.length&&console.log("removing styles from dom: ",r),n&&o.length&&console.log("adding styles to dom: ",o);var a=this._findStyleTags(r);this.stylesheets=i,this.$stylesheets=t(e.filter(this.$stylesheets,function(t){return!e.include(a,t)})),this._addStylesToHead(o),a.length&&s.done(function(){a.remove()})},fetchJavascript:function(i,s,n){return t.Deferred(e.bind(function(t){i&&s?require([i],e.bind(function(){require([s],e.bind(function(e){this._resolveFetchJavascript(t,e,n)},this))},this)):s?require([s],e.bind(function(e){this._resolveFetchJavascript(t,e,n)},this)):this._resolveFetchJavascript(t,null,n)},this)).promise()},_resolveFetchJavascript:function(t,e,i){this.fetchPageModules(i).done(function(i){t.resolve(e,i)})},fetchPageModules:function(i){return i=i||[],t.Deferred(e.bind(function(t){var s=i.length,n=[];return s?void e.each(i,function(i){n.push(i),this.getSiteModuleByName(i.name).done(function(t){i.selector=t.selector||"."+t.name+"-module",i.ModuleClass=t.ModuleClass}).fail(function(){n=e.reject(n,function(t){return t.name===i.name})}).always(function(){s--,0===s&&t.resolve(n)})},this):void t.resolve(n)},this)).promise()},getSiteModuleByName:function(i){return t.Deferred(e.bind(function(t){var e=this.siteModules[i];e?e.ModuleClass?t.resolve(e):e.path?require([e.path],function(s){e.ModuleClass=s,e.name=i,t.resolve(e)},function(i){console.error("Failed loading "+e.path+": "+i.message,i),t.reject(i)}):t.reject():t.reject("No Such Module Found")},this)).promise()},_findStyleTags:function(i){return t(e.filter(this.$stylesheets,function(s){var n=t(s).data("identifier");return e.find(i,function(t){return n===t})}))},_addStylesToHead:function(i){if(i&&i.length>0){var s=t([]);e.each(i,function(e){var i=t('<link rel="stylesheet" data-identifier="'+e+'" href="'+this.staticUrl+"css/bundles/"+e+(window.use_minified_css?".min":"")+".css?v="+this.staticVersion+'">')[0];s.push(i),this.$stylesheets.push(i)},this),t("head").append(s)}}},new s}),define("state",["jquery","underscore","pubsub","utils","modules/global/alert","managers/trafficcop","managers/requestmanager","managers/resourcemanager","managers/siteconfig"],function(t,e,i,s,n,o,r,a,l){"use strict";Object.getPrototypeOf||(Object.getPrototypeOf=function(t){return t.constructor.prototype});var h=function(){this.scrollEl=s.get("scrollEl"),this.body=s.get("body"),this.initialize()};return h.prototype={DEBUG:!0,LAYER_OVERLAY:"overlay",LAYER_PRELOAD:"preload",LAYER_BASE:"base",REFRESH_FREQUENCY:60*(window.site_config.REFRESH_RATE||0)*1e3,start:function(){var t=l.getSiteConfig();this.started=!0,this.pubSub={"page:unload":this.updateActivityTimestamp,"page:load":this.updateActivityTimestamp,"video:load":this.updateActivityTimestamp,"slide:change":this.updateActivityTimestamp,heattrack:this.updateActivityTimestamp,vitrack:this.updateActivityTimestamp,uotrack:this.updateActivityTimestamp},i.attach(this.pubSub,this),this._setupGlobalPubSub(s.getNested(t,"global","pubSub")),this.startRefreshTimer()},stop:function(){this.started=!1,i.unattach(this.pubSub,this),e.each(s.getNested(this.siteConfig,"global","pubSub"),function(t,e){i.off(e)})},_setupGlobalPubSub:function(t){e.each(t,function(t,s){t instanceof Array||(t=[t]),require(t,e.bind(function(){var t=arguments;this.started&&i.on(s,function(i){e.each(t,function(t){new t(i)})})},this))},this)},fetchPageModules:function(t){return a.fetchPageModules(t)},initialize:function(){this.$overlayFilm=t("#overlay-film"),this.activeAppInfo={url:null,css:[],layer:null,scrollTop:0,app:null},this.lastUrl=null,this._clearPreloadedAppInfo(),this.fullscreenView=null},_clearPreloadedAppInfo:function(){this.preloadedAppInfo={url:null,css:[],scrollTop:0,layer:this.LAYER_PRELOAD,app:null}},onRouteChange:function(t,e){console.log("App: "+t.page.appName+"/"+t.page.name);var i={preloadedUrl:t.page.preloadedUrl||t.app.preloadedUrl};return this._loadApp(t.app.AppClass,i,e,t.app.overlay,t.page)},preloadPath:function(e){var i=l.getRouteInfo(e);return!i||window.chromeless||this.activeAppInfo.layer&&this.activeAppInfo.layer!==this.LAYER_OVERLAY?t.Deferred().reject():this._preloadApp(i.app.AppClass,{},e,i.page)},_loadPath:function(e){var i=l.getRouteInfo(e);return i?this.onRouteChange(i,e):(console.error("StateManager: tried navigating to path, but no match found: "+e),t.Deferred().reject())},refreshActiveApp:function(){var t=this.activeAppInfo.url,e=l.getRouteInfo(t).page,s=a.fetchJavascript(e.buildfile&&e.buildfile.path,e.path,e.modules),n=this._fetchPathHtml(t);return i.trigger("page:unload"),this.activeAppInfo.app.changePage(t,t,n,s)},setIntentUrl:function(t){this.activeAppInfo.intentUrl=t,this.activeAppInfo.app&&this.activeAppInfo.app.destroyModules()},getIntentUrl:function(){return this.activeAppInfo.intentUrl},getPreloadedUrl:function(){return this.preloadedAppInfo.url},registerFullScreenView:function(t){this._setFixedPosition(this.activeAppInfo,this.activeAppInfo.app,!0),this.fullscreenView=t,this.activeAppInfo.app.pause()},setActiveAppFixed:function(t){this._setFixedPosition(this.activeAppInfo,this.activeAppInfo.app,t)},clearFullScreenView:function(){return this._clearFixedPosition(this.activeAppInfo,this.activeAppInfo.app,!0),this.fullscreenView?(this.fullscreenView=null,this._loadPath(this.activeAppInfo.url)):void 0},clearActiveAppFixed:function(t){this._clearFixedPosition(this.activeAppInfo,this.activeAppInfo.app,t)},_loadApp:function(t,s,n,o,r){var l,h=o?this.LAYER_OVERLAY:this.LAYER_BASE,c=a.fetchJavascript(r.buildfile&&r.buildfile.path,r.path,r.modules);return this._closeFullscreenView(),this.lastUrl=this.activeAppInfo.url,this.activeAppInfo.app&&(i.trigger("page:unload"),this.activeAppInfo.intentUrl&&this.activeAppInfo.intentUrl!==n&&(this.activeAppInfo.url=this.activeAppInfo.intentUrl),this.activeAppInfo.intentUrl=null),l=this._handleTransition(n,this.activeAppInfo,t,s,h,c),this.activeAppInfo.css=r.css||[],this.activeAppInfo.url=n,this.activeAppInfo.layer=h,a.fetchStyles(e.union(this.preloadedAppInfo.css,this.activeAppInfo.css),l),l},_preloadApp:function(i,s,n,o){this.DEBUG&&console.log("Router: Preloading: ",n);var r=this._handleTransition(n,this.preloadedAppInfo,i,s,this.LAYER_PRELOAD,t.Deferred().resolve());return this.preloadedAppInfo.css=o.css||[],this.preloadedAppInfo.url=n,a.fetchStyles(e.union(this.preloadedAppInfo.css,this.activeAppInfo.css),r),r},_closeFullscreenView:function(){if(this.fullscreenView){var t=this.fullscreenView;this.fullscreenView=null,t.close()}},_handleTransition:function(i,s,n,o,r,a){var l,h=s.url,c=r===this.LAYER_PRELOAD,d=null;return this._needsNewApp(n,s)?(l=new n(o),d=this._requestPageHtml(h,i,c),s.app?s.layer===r?s.app.removeApp(h,i).then(e.bind(function(){return this._revealApp(s,l,h,i,d,a,c)},this)):r===this.LAYER_OVERLAY?this._revealOverlay(l,h,i,d,a):t.when(this._removePreloadedApp(h,i),this._removeOverlay(s.app,h,i)).then(e.bind(function(){return this._revealApp(s,l,h,i,d,a,c)},this)):this._revealApp(s,l,h,i,d,a,c)):s.layer===r?(d=this._requestPageHtml(h,i,c),s.app.changePage(h,i,d,a,c)):this._transitionFromOverlayToPreloadedApp(h,i,a)},_removePreloadedApp:function(t,e){var i=this.preloadedAppInfo.app;return i?(this._clearPreloadedAppInfo(),i.beforeOverlayRemove(e),i.removeApp(t,e)):void 0},_revealApp:function(t,e,i,s,n,o,r){return t.app=e,e.revealApp(i,s,n,o,r)},_needsNewApp:function(t,e){return!(e.app&&e.app.isRevealed()&&(Object.getPrototypeOf(e.app)===t.prototype||this.preloadedAppInfo.app&&Object.getPrototypeOf(this.preloadedAppInfo.app)===t.prototype&&this.preloadedAppInfo.app.isRevealed()))},_requestPageHtml:function(t,e,i){if(null!==t||i){if(t!==e)return this._fetchPathHtml(e,i);i||r.abortAllRequests()}return null},_transitionFromOverlayToPreloadedApp:function(t,i,s){var n=this.preloadedAppInfo,o=this._requestPageHtml(n.url,i,!1),r=this.activeAppInfo.app;return this._movePreloadAppToActiveApp(this.LAYER_BASE),n.app.beforeOverlayRemove(i),this._removeOverlay(r,t,i).then(e.bind(function(){return this._transitionFromOverlayScroll(n),n.app.changePage(t,i,o,s,!1)},this))},_removeOverlay:function(e,i,s){return t.when(e.removeApp(i,s),this._fadeOutOverlayFilm(e))},_movePreloadAppToActiveApp:function(t){this.activeAppInfo.app=this.preloadedAppInfo.app,this.activeAppInfo.css=this.preloadedAppInfo.css,this.activeAppInfo.url=this.preloadedAppInfo.url,this.activeAppInfo.layer=t,this._clearPreloadedAppInfo()},_deactivateActiveApp:function(){this.activeAppInfo.app.pause(),this.preloadedAppInfo.app=this.activeAppInfo.app,this.preloadedAppInfo.url=this.activeAppInfo.url,this.preloadedAppInfo.css=this.activeAppInfo.css||[]},_revealOverlay:function(s,n,o,r,a){var l=this.activeAppInfo.app;l.isRevealed()?this._deactivateActiveApp():(l.removeApp(n,o),l=null),this.body.css("overflow-y","scroll"),this._transitionToOverlayScroll(this.preloadedAppInfo);var h=t.when(this._fadeInOverlayFilm(s),this._revealApp(this.activeAppInfo,s,n,o,r,a,!1));return i.trigger("scrollTop",0),h.done(e.bind(function(){this.body.css("overflow-y",""),l&&l.afterOverlayReveal(this.preloadedAppInfo.scrollTop)},this)),h},_fadeInOverlayFilm:function(e){var i=e.options.animations.fadeIn;return this.$overlayFilm.length||(this.$overlayFilm=t('<div class="ui-film"></div>'),this.body.append(this.$overlayFilm)),e.animate(this.$overlayFilm,"opacity",.7,i.duration,"ease-in")},_fadeOutOverlayFilm:function(e){var i=this.$overlayFilm,s=e.options.animations.fadeOut;return this.$overlayFilm=t([]),e.animate(i,"opacity",0,s.duration,"ease-out").done(function(){i.remove()})},_fetchPathHtml:function(t,i){var o=this.fetchHtml(t,null,!i);return i||o.fail(e.bind(function(t){if(t)if("NOT AUTHORIZED"===t)window.location.assign(s.getNested(window,"firefly_urls","samSubscribeURL")||"");else{var e=this.generateRequestError(t);e&&n.showError(e),(200!==t.status&&t.status||"timeout"===t.statusText)&&window.history.back()}},this)),o},generateRequestError:function(t){if(t){if(500===t.status)return"Connection Error... (INTERNAL SERVER ERROR)";if(404===t.status)return"Connection Error... (FILE NOT FOUND)";if(200!==t.status&&t.status)return"Connection Error... ("+(t.statusText||"Unknown Error")+")"}return null},_transitionFromOverlayScroll:function(t){var e=t.app;e&&(e.isApple?e.show():this._clearFixedPosition(t,e),e.$el.css("z-index",""))},_transitionToOverlayScroll:function(t){var e=t.app;e&&(e.isApple?e.hide():this._setFixedPosition(t,e),e.$el.css("z-index","0"))},_clearFixedPosition:function(t,e,s){e.clearFixedPosition(s),i.trigger("scrollTop",t.scrollTop||0)},_setFixedPosition:function(t,e,n){var o=e.getWindowOffset().top;t.scrollTop=s.getScrollPosition(),i.trigger("scrollTop",0),e.setFixedPosition(o,n)},updateActivityTimestamp:function(){this.lastActivityTimestamp=(new Date).getTime()},getActivePageInfo:function(){return this.activeAppInfo.app&&this.activeAppInfo.app.pageInfo||{}},getActiveAppClientInfo:function(){return this.activeAppInfo.app&&this.activeAppInfo.app.getClientInfo()||{}},getPreloadedPageInfo:function(){return this.preloadedAppInfo.app&&this.preloadedAppInfo.app.pageInfo||{}},getActiveApp:function(){return this.activeAppInfo.app},getPreloadedApp:function(){return this.preloadedAppInfo.app},getReferrer:function(){return null===this.lastUrl?document.referrer:s.getOrigin()+this.lastUrl},getCurrentUrl:function(){return s.getOrigin()+this.activeAppInfo.url},startRefreshTimer:function(){return; !this.refreshTimer&&this.REFRESH_FREQUENCY&&(this.lastActivityTimestamp=0,this.refreshTimer=setInterval(e.bind(function(){if(!this.fullscreenView&&this.activeAppInfo.layer!==this.LAYER_OVERLAY){var t=(new Date).getTime(),e=t-this.lastActivityTimestamp;e>this.REFRESH_FREQUENCY&&(i.trigger("site:refresh","refresh:"+(this.getActivePageInfo().ssts||"").replace(/[\/:].*/,"")),window.location=window.location)}},this),6e4))},stopRefreshTimer:function(){this.refreshTimer&&(clearInterval(this.refreshTimer),this.refreshTimer=null)},registerAnimation:function(t,e,i,s,n){return o.addAnimation(t,e,i,s,n)},fetchHtml:function(t,e,i,s){return r.fetchHtml(t,e,i,s,!0)},fetchData:function(t,e,i,s,n){return r.fetchData(t,e,i,s,n)},recurringFetchHtml:function(t,e,i,s,n){return r.recurringFetchHtml(t,e,i,s,n,!0)},recurringFetchData:function(t,e,i,s,n,o){return r.recurringFetchData(t,e,i,s,n,o)}},window.stateManager=new h,window.stateManager}),define("managers/routemanager",["jquery","underscore","state","managers/siteconfig","pubsub","utils"],function(t,e,i,s,n,o){"use strict";var r=function(){};return r.prototype={baseUrl:window.location.protocol+"//"+window.location.host,usatBetaDomain:"http://beta.usatoday.com",start:function(t){this.started=!0,s.loadRoutes().done(e.bind(function(){this.started&&(t&&o.get("win").on("popstate",e.bind(this._onStateChange,this)),this._onStateChange(),console.log("Site Loaded"))},this))},getLocalPath:function(t){if(!t||"#"===t)return null;if(t.indexOf(this.baseUrl))if(t.indexOf(this.usatBetaDomain)){if(-1!==t.indexOf("://"))return null}else t=t.substring(this.usatBetaDomain.length);else t=t.substring(this.baseUrl.length);return t},stop:function(){this.started=!1,o.get("win").off("popstate")},getInfo:function(e){var i=this.getLocalPath(e);return null!==i?("/"===i[0]&&(i=i.substring(1)),s.getRouteInfo(t.trim(i))):null},isAjax:function(t){var e=this.getInfo(t);return e&&e.ajax},goTo:function(t,e,s){if(!o.isValidUrl(t)||!this._canNavigate())return!1;if(!i.getIntentUrl()&&this.isCurrentUrl(t))return console.warn("Tried navigating to the current url, skipping"),!1;n.trigger("track",{label:e,url:t,event:s});var r=this._goHashTag(t)||this._goInternal(t);return r||this._setLocation(this.attachChromeless(t)),!0},goToInterstitual:function(t){return t=this.getLocalPath(t),Modernizr.history&&o.isValidUrl(t)&&this._canNavigate()&&this.getInfo(t)?(i.setIntentUrl(t),this._pushState(t),!0):!1},isCurrentUrl:function(t){var e=this.getLocalPath(t);return e&&(e=e.split("#")[0]),e===this._getCurrentPath()},_getCurrentPath:function(){return window.location.pathname+location.search},_setLocation:function(t){window.location.assign(t)},_canNavigate:function(){var t=i.getActivePageInfo().navigationWarning;return t&&!window.confirm(t)?!1:!0},_goHashTag:function(e){if("#"===e[0]){e=e.substring(1);var i=t("a[name="+e+"]").offset();return i&&i.top&&n.trigger("scrollTop",i.top-40),window.location.hash=e,!0}},attachChromeless:function(t){return window.chromeless?t+(-1===t.indexOf("?")?"?":"&")+"chromeless=true":t},_goInternal:function(t){return Modernizr.history&&this.isAjax(t)&&this.isAjax(o.getPageUrl())?(this._pushState(this.getLocalPath(t)),this._onStateChange(),!0):!1},_pushState:function(t){window.history.pushState({},document.title,this.attachChromeless(t))},_onStateChange:function(){var t,e=window.location;e.pathname!==this._currentPathName&&(this._currentPathName=e.pathname,t=this.getInfo(e.pathname),t?i.onRouteChange(t,e.pathname+e.search+e.hash):console.error("Unknown location.pathname"))}},new r}),function(t){"function"==typeof define&&define.amd?define("cookie",["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){function e(t){return a.raw?t:encodeURIComponent(t)}function i(t){return a.raw?t:decodeURIComponent(t)}function s(t){return e(a.json?JSON.stringify(t):String(t))}function n(t){0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return t=decodeURIComponent(t.replace(r," ")),a.json?JSON.parse(t):t}catch(e){}}function o(e,i){var s=a.raw?e:n(e);return t.isFunction(i)?i(s):s}var r=/\+/g,a=t.cookie=function(n,r,l){if(arguments.length>1&&!t.isFunction(r)){if(l=t.extend({},a.defaults,l),"number"==typeof l.expires){var h=l.expires,c=l.expires=new Date;c.setTime(+c+864e5*h)}return document.cookie=[e(n),"=",s(r),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")}for(var d=n?void 0:{},u=document.cookie?document.cookie.split("; "):[],p=0,f=u.length;f>p;p++){var g=u[p].split("="),m=i(g.shift()),v=g.join("=");if(n&&n===m){d=o(v,r);break}n||void 0===(v=o(v))||(d[m]=v)}return d};a.defaults={},t.removeCookie=function(e,i){return void 0===t.cookie(e)?!1:(t.cookie(e,"",t.extend({},i,{expires:-1})),!t.cookie(e))}}),define("managers/abtestmanager",["jquery","underscore","utils","cookie"],function(t,e,i){"use strict";var s=function(){};return s.prototype={start:function(){this.abTestGroup=this._readAbTestGroup(),this.abTestGroup||(this.abTestGroup=this._initialGroupSetup(),this._saveAbTestGroup()),this._setupTestBuckets()},reset:function(){window.localStorage.removeItem("wfm_abtestgroup")},_readAbTestGroup:function(){return JSON.parse(window.localStorage.getItem("wfm_abtestgroup"))},_saveAbTestGroup:function(){try{window.localStorage.setItem("wfm_abtestgroup",JSON.stringify(this.abTestGroup))}catch(t){console.error("Failed saving abTestGroup",t.stack||t.stacktrace||t.message)}},_initialGroupSetup:function(){return Math.floor(100*Math.random())+1},_setupTestBuckets:function(){e.each(i.getNested(window.site_vars,"abtests"),this._setupTestBucket,this)},_setupTestBucket:function(e){var i=e.variants.length,s=0,n=new Date(e.end_time);if(this._isTestEligible(e),n)if(e.traffic_volume%i===0)for(var o=e.traffic_volume/i,r=1;r<=e.traffic_volume;r++)r%o===0&&s++,this.abTestGroup==r&&t.cookie(this._generateTestId(e),e.variants[s].variant,{expires:n});else console.warn("The number of variants for A/B Test "+e.name+" are not divisible by the traffic_volue("+e.traffic_volume+"). No segmentation cookies are being set.")},_isTestEligible:function(t,e){var i=(new Date).getTime();return e>i&&this.abTestGroup<=t.traffic_volume},_generateTestId:function(t){return"wfm_ab_"+t.url_regex.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")+"_"+t.id.toString()}},new s}),define("site-manager",["jquery","underscore","backbone","utils","pubsub","state","managers/routemanager","managers/abtestmanager"],function(t,e,i,s,n,o,r,a){var l=i.View.extend({el:"body",initialize:function(){window.appViewEventProxy=n,window.Utils=s,window.siteManager=this,this.DEBUG=s.get("DEBUG"),this.$win=s.get("win"),this.$top=s.get("scrollEl"),this.pubSub={scrollTop:this.scrollTop},n.attach(this.pubSub,this)},start:function(t,i){this.$win.on("resize."+this.cid,e.throttle(function(){n.trigger("resize:app")},50)).trigger("resize"),this.$el.on("click."+this.cid,"a,area",e.bind(this.triggerRoute,this)),this.$el.on("submit."+this.cid,"form.ui-ajax-form",e.bind(this.triggerForm,this)),t&&(window.header=this.header=new t),r.start(i||void 0===i),o.start(),a.start()},getHeader:function(){return this.header},scrollTop:function(t,e){return this.header?this.header.scrollTop(t,e):0},stop:function(){this.$el.off("."+this.cid),this.$win.off("."+this.cid),o.stop(),r.stop()},destroy:function(){this.undelegateEvents(),window.header&&delete window.header,delete window.appViewEventProxy,delete window.Utils,n.unattach(this.pubSub,this)},triggerRoute:function(e){var i=t(e.currentTarget),s=t.trim(i.attr("href"));e.isDefaultPrevented()||this._isMetaKey(e)?n.trigger("track",{event:e,url:s}):i.attr("target")?(n.trigger("track",{event:e,url:s}),this._goPopup(i,s)&&e.preventDefault()):s?(e.preventDefault(),r.goTo(s,i.data("trackLabel")||i.data("uotrack")||i.data("ht"),e)):(n.trigger("track",{event:e}),e.preventDefault())},_isMetaKey:function(t){return t.metaKey||t.ctrlKey||t.altKey||2==t.which},_goPopup:function(t,e){var i=t.attr("target");return"_popup"===i||"_blank"===i&&void 0!==t.data("popup")?(s.openPopup(e,t.data("popup-width"),t.data("popup-height")),!0):void 0},triggerForm:function(i){var s=t(i.currentTarget),n=s.data("mapping"),o={},a=s.attr("action");i.isDefaultPrevented()||(n&&(t.each(s.serializeArray(),function(t,e){o[e.name]=e.value}),a+=e.template(n,o)),i.preventDefault(),r.goTo(a,s.data("trackLabel")||s.data("uotrack")||s.data("ht"),i))}});return new l}),define("transformSupport",["jquery"],function(t){t.support.css=t.support.css||{},Modernizr.csstransitions&&(t.support.css.transition={cssName:Modernizr.prefixed("transition"),endEventNames:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}},t.support.css.transition.endName=t.support.css.transition.endEventNames[t.support.css.transition.cssName],t.support.css.transition.registerTransitionEndListener=function(e,i,s){i||(i=t.Deferred());var n=t.support.css.transition.endName,o=function(t){t.target!=e||s&&t.propertyName!==s||(this.removeEventListener(n,o),i.resolve(),o=null)};return e.addEventListener(n,o),i.promise()}),!Modernizr.csstransforms3d||navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")&&-1!==navigator.userAgent.indexOf("Version/5")||(t.support.css.transform={cssName:Modernizr.prefixed("transform"),originCssName:Modernizr.prefixed("transformOrigin"),styleCssName:Modernizr.prefixed("transformStyle"),backfaceVisibilityCssName:Modernizr.prefixed("backfaceVisibility"),perspectiveCssName:Modernizr.prefixed("perspective"),perspectiveOriginCssName:Modernizr.prefixed("perspectiveOrigin")},t.support.css.transform.cssHyphenName=t.support.css.transform.cssName.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()}).replace(/^ms-/,"-ms-"))}),define("animatecolors",["jquery"],function(t){function e(t,e,i){var s="rgb"+(Modernizr.rgba?"a":"")+"("+parseInt(t[0]+i*(e[0]-t[0]),10)+","+parseInt(t[1]+i*(e[1]-t[1]),10)+","+parseInt(t[2]+i*(e[2]-t[2]),10);return Modernizr.rgba&&(s+=","+(t&&e?parseFloat(t[3]+i*(e[3]-t[3])):1)),s+=")"}function i(t){var e,i;return(e=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/.exec(t))?i=[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),1]:(e=/#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])/.exec(t))?i=[17*parseInt(e[1],16),17*parseInt(e[2],16),17*parseInt(e[3],16),1]:(e=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(t))?i=[parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),1]:(e=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9\.]*)\s*\)/.exec(t))&&(i=[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10),parseFloat(e[4])]),i}var s=["color","backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","outlineColor"];t.each(s,function(s,n){t.Tween.propHooks[n]={get:function(e){return t(e.elem).css(n)},set:function(s){var o=s.elem.style,r=i(t(s.elem).css(n)),a=i(s.end);s.run=function(t){o[n]=e(r,a,t)}}}}),t.Tween.propHooks.borderColor={set:function(n){var o=n.elem.style,r=[],a=s.slice(2,6);t.each(a,function(e,s){r[s]=i(t(n.elem).css(s))});var l=i(n.end);n.run=function(i){t.each(a,function(t,s){o[s]=e(r[s],l,i)})}}}}),define("global/progressive-animation",["jquery","underscore","utils","managers/trafficcop","transformSupport","animatecolors"],function(t,e,i,s){"use strict";var n=function(){};return n.prototype={transitionCssName:t.support.css.transition&&t.support.css.transition.cssName,transformCssHyphenName:t.support.css.transform&&t.support.css.transform.cssHyphenName,transformCssName:t.support.css.transform&&t.support.css.transform.cssName,cssTransition:function(e,n,o,r,a,l,h){var c,d;return"opacity"===o&&"none"===n.css("display")&&(a=0),i.isDocumentHidden()?(n.css(o,r),t.Deferred().resolve()):(0!==a&&40>a&&(a=40),l=this._normalizeEasing(l,this._easingMap),d=t.camelCase(o),r=this._getCssNumber(d,r),h=h?" "+h+"ms":"",c=e&&this._canDo3dTransform(n,d)?this._transform(n,o,d,r,a,l,h):this._transition(n,o,d,r,a,l,h),s.addAnimation(c,n,o,r,a),c)},stop:function(e,i){var s=t.camelCase(i),n=window.getComputedStyle(e[0]).getPropertyValue(i);return e.stop("proganimate"+i,!0),this._failPreviousTransition(e,s)&&(e[0].style[s]=n),n},_canDo3dTransform:function(t,e){var i=t.data("transition-animate-"+e+"-defer");if(i&&"3d"===i.animationType)return!0;if("left"===e||"top"===e){if("left"===e)return i=t.data("transition-animate-top-defer"),i&&"3d"===i.animationType?!1:!0;if("top"===e)return i=t.data("transition-animate-left-defer"),i&&"3d"===i.animationType?!1:!0}return!1},jQuery:function(n,o,r,a,l,h){if(i.isDocumentHidden())return n.css(o,r),t.Deferred().resolve();var c,d={};return l=this._normalizeEasing(l,e.invert(this._easingMap)),d[o]=r,c=t.Deferred(function(t){var i="proganimate"+o;n.stop(i,!0),0===a?(n.css(o,r),e.defer(function(){t.resolve()})):n.delay(h||0,i).animate(d,{duration:a,easing:l,queue:i,done:function(){n.css(o,r),t.resolve()},fail:function(){t.reject()}}).dequeue(i)}).promise(),s.addAnimation(c,n,o,r,a),c},_easingMap:{easeInQuad:"ease-in",easeInSine:"ease-in",easeInCubic:"ease-in",easeInQuart:"ease-in",easeInQuint:"ease-in",easeInExpo:"ease-in",easeInCirc:"ease-in",easeInBack:"ease-in",easeInElastic:"ease-in",easeInBounce:"ease-in",easeOutQuad:"ease-out",easeOutSine:"ease-out",easeOutCubic:"ease-out",easeOutQuart:"ease-out",easeOutQuint:"ease-out",easeOutExpo:"ease-out",easeOutCirc:"ease-out",easeOutBack:"ease-out",easeOutElastic:"ease-out",easeOutBounce:"ease-out",easeInOutQuad:"ease-in-out",easeInOutSine:"ease-in-out",easeInOutCubic:"ease-in-out",easeInOutQuart:"ease-in-out",easeInOutQuint:"ease-in-out",easeInOutExpo:"ease-in-out",easeInOutCirc:"ease-in-out",easeInOutBack:"ease-in-out",easeInOutElastic:"ease-in-out",easeInOutBounce:"ease-in-out",swing:"ease-in-out"},_normalizeEasing:function(t,i){var s;return t=t||"linear",s=i[t],s?t=s:-1===t.indexOf("cubic-bezier")||i.swing?e.invert(i)[t]||(t="linear"):t="swing",t},_transition:function(i,s,n,o,r,a,l){var h,c=t.Deferred(),d=this._getCurrentValue(i,n,s);return this._shouldDoTransition(i,n,s,d,o,r)?(h=s+" "+r+"ms "+a+" "+l,c=this._doTransition(i,n,s,o,h)):e.defer(function(){c.resolve()}),c.promise()},_doTransition:function(i,s,n,o,r){var a=i[0].style;return this._getAnimationDeferred(i,s,n,"2d",e.bind(function(t){this._triggerTransition(t,i,s,n,o,r)},this)).then(function(){return o.replace(/[ ]+/g,"")===a[s].replace(/[ ]+/g,"")?t.Deferred().resolve():t.Deferred().reject()})},_getAnimationDeferred:function(i,s,n,o,r){return t.Deferred(e.bind(function(t){var a=this._failPreviousTransition(i,s,!0);e.delay(function(){a&&a.cleanup(),"pending"===t.state()&&r(t)},20),i.data("transition-animate-"+s+"-defer",{promise:t,animationType:o,cleanup:e.bind(function(){this._removeTransformTransition(i[0].style,n)},this)})},this)).always(e.bind(function(t){i.removeData("transition-animate-"+s+"-defer"),t||this._removeTransformTransition(i[0].style,n)},this))},_triggerTransition:function(t,e,i,s,n,o){var r=e[0].style;this._registerTransitionEndListener(e,t,s),this._setupTransition(r,s,o),r[i]=n},_failPreviousTransition:function(t,e,i){var s=t.data("transition-animate-"+e+"-defer");return s?(s.promise.reject(i),s):void 0},_setupTransition:function(t,e,i){var s=t[this.transitionCssName];s?s+=","+i:s=i,t[this.transitionCssName]=s},_transform:function(i,s,n,o,r,a,l){var h,c=t.Deferred(),d=i[0].style,u=this._getCurrentValue(i,n,s);return this._shouldDoTransition(i,n,s,u,o,r)?(h=this.transformCssHyphenName+" "+r+"ms "+a+l,this._convertToTransform(d,n,u),c=this._doTransform(i,n,o,h),c.done(e.bind(function(){d[this.transformCssName]="",d[n]=o},this))):e.defer(function(){c.resolve()}),c.promise()},_getCurrentValue:function(t,e,i){var s=t[0].style,n=s[e]||t.css(i);return"auto"!==n&&n||(s[e]=this._getCssNumber(e,0),n="0"),n},_shouldDoTransition:function(t,e,i,s,n,o){var r=t[0].style;return 0===o?(this._failPreviousTransition(t,e),r[e]=n,!1):this._canAnimate(s,n)?s:(this._failPreviousTransition(t,e),!1)},_canAnimate:function(t,e){return"0"===t.replace(/[ a-z%]+/g,"")&&"0"===e.replace(/[ a-z%]+/g,"")?!1:t.replace(/[ ]/g,"")!==e.replace(/[ ]/g,"")},_convertToTransform:function(t,e,i){t[this.transformCssName]=this._buildTranslate3d(e,i),t[e]="auto"},_doTransform:function(i,s,n,o){var r=i[0].style,a=this._buildTranslate3d(s,n);return this._getAnimationDeferred(i,s,this.transformCssHyphenName,"3d",e.bind(function(t){this._triggerTransition(t,i,this.transformCssName,this.transformCssHyphenName,a,o)},this)).then(e.bind(function(){return"auto"===r[s]&&r[this.transformCssName].replace(/[ ]+/g,"")===a.replace(/[ ]+/g,"")?t.Deferred().resolve():t.Deferred().reject()},this))},_removeTransformTransition:function(e,i){var s=e[this.transitionCssName];s=s||"",s=s.replace(new RegExp(i+" \\w+ [\\w-]+(\\s*\\([^\\)]*\\))?"),""),e[this.transitionCssName]=t.trim(s.replace(/^[ ,]+/,"").replace(/[ ,]+$/,"").replace(/,[ ]+,/,""))},_buildTranslate3d:function(t,e){var i="translate3d(";return i+="left"===t?e:"0px",i+=",",i+="top"===t?e:"0px",i+=",0px)"},_getCssNumber:function(i,s){return t.cssNumber[i]||!e.isNumber(s)&&s.match(/[a-z%]/)?s+"":s+"px"},_registerTransitionEndListener:function(e,i,s){return t.support.css.transition?t.support.css.transition.registerTransitionEndListener(e[0],i,s):t.Deferred.reject()}},new n}),define("easing",["jquery"],function(t){t.easing.jswing=t.easing.swing,t.extend(t.easing,{def:"easeOutQuad",swing:function(e,i,s,n,o){return t.easing[t.easing.def](e,i,s,n,o)},easeInQuad:function(t,e,i,s,n){return s*(e/=n)*e+i},easeOutQuad:function(t,e,i,s,n){return-s*(e/=n)*(e-2)+i},easeInOutQuad:function(t,e,i,s,n){return(e/=n/2)<1?s/2*e*e+i:-s/2*(--e*(e-2)-1)+i},easeInCubic:function(t,e,i,s,n){return s*(e/=n)*e*e+i},easeOutCubic:function(t,e,i,s,n){return s*((e=e/n-1)*e*e+1)+i},easeInOutCubic:function(t,e,i,s,n){return(e/=n/2)<1?s/2*e*e*e+i:s/2*((e-=2)*e*e+2)+i},easeInQuart:function(t,e,i,s,n){return s*(e/=n)*e*e*e+i},easeOutQuart:function(t,e,i,s,n){return-s*((e=e/n-1)*e*e*e-1)+i},easeInOutQuart:function(t,e,i,s,n){return(e/=n/2)<1?s/2*e*e*e*e+i:-s/2*((e-=2)*e*e*e-2)+i},easeInQuint:function(t,e,i,s,n){return s*(e/=n)*e*e*e*e+i},easeOutQuint:function(t,e,i,s,n){return s*((e=e/n-1)*e*e*e*e+1)+i},easeInOutQuint:function(t,e,i,s,n){return(e/=n/2)<1?s/2*e*e*e*e*e+i:s/2*((e-=2)*e*e*e*e+2)+i
},easeInSine:function(t,e,i,s,n){return-s*Math.cos(e/n*(Math.PI/2))+s+i},easeOutSine:function(t,e,i,s,n){return s*Math.sin(e/n*(Math.PI/2))+i},easeInOutSine:function(t,e,i,s,n){return-s/2*(Math.cos(Math.PI*e/n)-1)+i},easeInExpo:function(t,e,i,s,n){return 0==e?i:s*Math.pow(2,10*(e/n-1))+i},easeOutExpo:function(t,e,i,s,n){return e==n?i+s:s*(-Math.pow(2,-10*e/n)+1)+i},easeInOutExpo:function(t,e,i,s,n){return 0==e?i:e==n?i+s:(e/=n/2)<1?s/2*Math.pow(2,10*(e-1))+i:s/2*(-Math.pow(2,-10*--e)+2)+i},easeInCirc:function(t,e,i,s,n){return-s*(Math.sqrt(1-(e/=n)*e)-1)+i},easeOutCirc:function(t,e,i,s,n){return s*Math.sqrt(1-(e=e/n-1)*e)+i},easeInOutCirc:function(t,e,i,s,n){return(e/=n/2)<1?-s/2*(Math.sqrt(1-e*e)-1)+i:s/2*(Math.sqrt(1-(e-=2)*e)+1)+i},easeInElastic:function(t,e,i,s,n){var o=1.70158,r=0,a=s;if(0==e)return i;if(1==(e/=n))return i+s;if(r||(r=.3*n),a<Math.abs(s)){a=s;var o=r/4}else var o=r/(2*Math.PI)*Math.asin(s/a);return-(a*Math.pow(2,10*(e-=1))*Math.sin(2*(e*n-o)*Math.PI/r))+i},easeOutElastic:function(t,e,i,s,n){var o=1.70158,r=0,a=s;if(0==e)return i;if(1==(e/=n))return i+s;if(r||(r=.3*n),a<Math.abs(s)){a=s;var o=r/4}else var o=r/(2*Math.PI)*Math.asin(s/a);return a*Math.pow(2,-10*e)*Math.sin(2*(e*n-o)*Math.PI/r)+s+i},easeInOutElastic:function(t,e,i,s,n){var o=1.70158,r=0,a=s;if(0==e)return i;if(2==(e/=n/2))return i+s;if(r||(r=.3*n*1.5),a<Math.abs(s)){a=s;var o=r/4}else var o=r/(2*Math.PI)*Math.asin(s/a);return 1>e?-.5*a*Math.pow(2,10*(e-=1))*Math.sin(2*(e*n-o)*Math.PI/r)+i:a*Math.pow(2,-10*(e-=1))*Math.sin(2*(e*n-o)*Math.PI/r)*.5+s+i},easeInBack:function(t,e,i,s,n,o){return void 0==o&&(o=1.70158),s*(e/=n)*e*((o+1)*e-o)+i},easeOutBack:function(t,e,i,s,n,o){return void 0==o&&(o=1.70158),s*((e=e/n-1)*e*((o+1)*e+o)+1)+i},easeInOutBack:function(t,e,i,s,n,o){return void 0==o&&(o=1.70158),(e/=n/2)<1?s/2*e*e*(((o*=1.525)+1)*e-o)+i:s/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+i},easeInBounce:function(e,i,s,n,o){return n-t.easing.easeOutBounce(e,o-i,0,n,o)+s},easeOutBounce:function(t,e,i,s,n){return(e/=n)<1/2.75?7.5625*s*e*e+i:2/2.75>e?s*(7.5625*(e-=1.5/2.75)*e+.75)+i:2.5/2.75>e?s*(7.5625*(e-=2.25/2.75)*e+.9375)+i:s*(7.5625*(e-=2.625/2.75)*e+.984375)+i},easeInOutBounce:function(e,i,s,n,o){return o/2>i?.5*t.easing.easeInBounce(e,2*i,0,n,o)+s:.5*t.easing.easeOutBounce(e,2*i-o,0,n,o)+.5*n+s}})}),define("baseview",["jquery","underscore","backbone","pubsub","state","global/progressive-animation","easing","transformSupport"],function(t,e,i,s,n,o){"use strict";var r=i.View.extend({useCSSTransitions:!!t.support.css.transition,transitionCssName:t.support.css.transition&&t.support.css.transition.cssName,useCSSTransforms:!!t.support.css.transform,transformOriginCssName:t.support.css.transform&&t.support.css.transform.originCssName,transformCssName:t.support.css.transform&&t.support.css.transform.cssName,transformCssHyphenName:t.support.css.transform&&t.support.css.transform.cssHyphenName,isSafari6:navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")&&-1!==navigator.userAgent.indexOf("Version/6"),isSafari5:navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")&&-1!==navigator.userAgent.indexOf("Version/5"),isApple:navigator.userAgent.indexOf("iPhone")>-1||navigator.userAgent.indexOf("iPad")>-1,pubSub:null,options:{animations:{fadeIn:{duration:200,easing:"easeInQuad"},fadeOut:{duration:200,easing:"easeOutSine"},useCSSTransitions:!0,useCSSTransforms:!1}},initialize:function(e){this.options=t.extend(!0,{},r.prototype.options,e),this.useCSSTransitions=this.options.animations.useCSSTransitions&&this.useCSSTransitions,this.useCSSTransforms=this.useCSSTransitions?this.options.animations.useCSSTransforms&&this.useCSSTransforms:!1,this.seenModules={},this.subviews=this.subviews||{},this.clear$$(),this.pubSub&&s.attach(this.pubSub,this)},$$:function(t){var e=this.cachedSelectors[t];return e||(e=this.$(t),this.cachedSelectors[t]=e),e},clear$$:function(t){t?delete this.cachedSelectors[t]:this.cachedSelectors={}},setElement:function(){this.clear$$(),i.View.prototype.setElement.apply(this,arguments)},destroy:function(t,e){this.destroyed=!0,this.destroyModules(t,e),this.clear$$(),this.pubSub&&s.unattach(this.pubSub,this),t&&this.$el.remove()},destroyModules:function(t,e){this._callCollection(this.subviews,"destroy",[t,e]),this.undelegateEvents(),this.subviews={}},triggerEvent:function(t,e){e=Array.prototype.slice.call(arguments,1),this._callCollection(this.subviews,t,e)},_callCollection:function(i,s,n){e.each(i,function(i){try{t.isArray(i)?e.each(i,function(e){t.isFunction(e[s])&&e[s].apply(e,n)}):i&&t.isFunction(i[s])&&i[s].apply(i,n)}catch(o){console.error("subview threw exception on destruction: ",o.stack||o.stacktrace||o.message)}})},registerAnimation:function(t,e,i,s,o){return n.registerAnimation(t,e,i,s,o)},animate:function(i,s,n,r,a,l){return i&&0!==i.length?((this.isSafari5||this.isSafari6)&&"opacity"===s&&(r=0),t.when.apply(t,e.map(i,e.bind(function(e){return this.useCSSTransitions&&!this.isSafari5?o.cssTransition(this.useCSSTransforms,t(e),s,n,r,a,l):o.jQuery(t(e),s,n,r,a,l)},this)))):(console.error("tried animating null or empty jquery object"),t.Deferred().reject())},show:function(i,s){var n,o=this.options.animations.fadeIn;return!i||this.isSafari5||this.isSafari6?(n=t.Deferred(),e.defer(function(){n.resolve()}),this.$el.css({display:"block",opacity:1})):(n=this.$el.fadeTo(o.duration,1,o.easing).promise(),this.registerAnimation(n,this.$el,"opacity",1)),n.done(function(){s&&s()}),n},hide:function(i,s){var n,o=this.options.animations.fadeOut;return!i||this.isSafari5||this.isSafari6?(n=t.Deferred().resolve(),this.$el.css({display:"none",opacity:0})):(n=this.$el.fadeTo(o.duration,0,o.easing).promise(),n.done(e.bind(function(){this.$el.css({display:"none"})},this)),this.registerAnimation(n,this.$el,"opacity",0,o.duration)),n.done(function(){s&&s()}),n},setupSub:function(t,e,i,s){s=s||{};var n=this.subviews[t];n||(this.subviews[t]=n=[]),this.$(e).each(function(t,e){s.el=e,n.push(new i(s))})},buildModules:function(t){return n.fetchPageModules(t).done(e.bind(this._initModules,this))},_initModules:function(t){this.destroyed||e.each(t,this._initModule,this)},_initModule:function(i){var s=i.selector,n=this.seenModules[i.name]||0;i.position&&(s="#module-position-"+i.position+s+",#module-position-"+i.position+" "+s),this.$(s).each(e.bind(function(e,s){var o=t.extend(!0,{},i.options);o.el=s,o.layoutType=i.layoutType;try{this.subviews[i.name+n]=new i.ModuleClass(o)}catch(r){console.error("failed loading module "+i.name,r.stack||r.stacktrace||r.message)}n+=1},this)),this.seenModules[i.name]=n}});return r}),define("base-app",["jquery","underscore","baseview","state","managers/trafficcop","site-manager","utils","pubsub"],function(t,e,i,s,n,o,r,a){"use strict";var l=i.extend({currentPath:"",initialize:function(e){this._animId=0,this._isFixedOffset=null,this.$top=r.get("scrollEl"),this.appRevealed=!1,this.pubSub=t.extend({"header:fixed":this._onHeaderFixed,"header:unfixed":this._onHeaderUnfixed},this.pubSub),i.prototype.initialize.call(this,e)},isRevealed:function(){return this.appRevealed},revealApp:function(t,e,i,s,n){var o=this._buildRequestInfo(t,e,s,n);return i?"rejected"===i.state()?i:this._handleAsyncReveal(i,s,o):this._handleInitialReveal(s,o)},_buildRequestInfo:function(e,i,s,n){return{fromUrl:e,toUrl:i,animId:++this._animId,resourcePromise:s,modulePromise:t.Deferred(),paused:n}},_handleInitialReveal:function(e,i){var s=t(".site-header").next();return s.length||(s=r.get("body")),this.setElement(s),this._getPageInfo(this.$el,i),this._triggerAfterPageReveal(i)},_handleAsyncReveal:function(i,s,n){var o;return"resolved"===i.state()?i.then(e.bind(function(t){return this._triggerBeforePageReveal(t,n),this._revealAppMarkup(t,n).then(e.bind(function(){return this._finishReveal(t,n)},this))},this)):(o=this.getRevealAppLoader(n.toUrl),o instanceof t||(o=t(o)),this._revealAppMarkup(o,n).then(e.bind(function(){return i.then(e.bind(function(t){return this._triggerBeforePageReveal(t,n),this._handleRevealLoaderContentSwap(t,n).then(e.bind(function(){return this.setElement(t,!1),this._finishReveal(t,n)},this))},this))},this)))},_revealAppMarkup:function(e,i){this._insertAppMarkup(e,i.paused);var s=this._safeCall("animateRevealApp",i.fromUrl,i.toUrl,i.paused);return s?n.addAnimation(s):t.Deferred().resolve()},_handleRevealLoaderContentSwap:function(e,i){return i.animId!==this._animId?t.Deferred().reject():this.swapContent(this.$el,e,i.paused,this.getHash(i.toUrl))},_finishReveal:function(e,i){return i.animId!==this._animId?t.Deferred().reject():(i.paused&&this.setFixedPosition(this.$el.offset().top),this._triggerAfterPageReveal(i))},_fetchPageModules:function(t,i){i.paused?i.modulePromise.resolve():i.resourcePromise.done(e.bind(function(){this.fetchPageModules(t).done(function(t){i.modulePromise.resolve(t)})},this))},_insertAppMarkup:function(e,i){var s=t(".site-header");e.hide(),this.setElement(e,!1),this.$el.insertAfter(s),i&&this.setFixedPosition(s.outerHeight())},changePage:function(t,e,i,s,n){var o=this._buildRequestInfo(t,e,s,n);return this.destroyModules(),i?this._handleChangePageRequest(i,o):this._handleChangePageNoRequest(o)},_handleChangePageNoRequest:function(t){return this._fetchPageModules(this.pageInfo,t),this._triggerAfterPageReveal(t)},_handleChangePageRequest:function(i,s){var n=this.animateChangePagePreData(s.fromUrl,s.toUrl);return n||this._triggerGenericLoader(i),i.done(e.bind(function(t){this._triggerBeforePageReveal(t,s)},this)),t.when(i,n).then(e.bind(function(t){return this._finishChangePage(t,s)},this))},_triggerGenericLoader:function(t){"pending"===t.state()&&(this.activateLoader(),t.always(e.bind(function(){this.deactivateLoader()},this)))},_finishChangePage:function(i,s){if(s.animId!==this._animId)return t.Deferred().reject();var n=this.animateChangePagePostData(s.fromUrl,s.toUrl,i,s.paused)||t.Deferred().resolve();return s.paused&&this.setFixedPosition(this.$el.offset().top),n.then(e.bind(function(){return this._triggerAfterPageReveal(s)},this))},swapContent:function(e,i,s,n){return this.isSafari5||this.isApple||s?(i.insertAfter(e),e.remove(),t.Deferred().resolve()):this._crossFade(e,i,n)},_crossFade:function(t,e,i){var s=parseInt(t.css("top"),10)||0;return s-=r.getScrollPosition(),e.css({"z-index":100}),t.css({position:"absolute","z-index":101,opacity:1,top:s}),e.insertAfter(t),i&&this._scrollToHashTag(e,i)||o.scrollTop(0),this.animate(t,"opacity",0,this.options.animations.fadeIn.duration).always(function(){e.css({"z-index":""}),t.remove()})},_scrollToHashTag:function(t,e){var i=this._getOffset(t,e);return i.top?(this.$top.scrollTop(i.top-this.$el.offset().top),!0):void 0},_getOffset:function(t,e){try{return t.find("a[name="+e+"]").offset()||{}}catch(i){console.warn("Invalid hashtag",e)}return{}},pause:function(){this.destroyModules(!1,!0)},getHash:function(t){var e=t.indexOf("#");return-1!==e?t.substring(e+1):null},_triggerAfterPageReveal:function(i){return t.when(i.resourcePromise,i.modulePromise).done(e.bind(function(t,e){i.animId===this._animId&&(i.paused||this._initPage(null!==i.fromUrl,t,e),this._safeCall("afterPageReveal",i.fromUrl,i.toUrl,i.paused,t&&t[0]),this.appRevealed=!0,this.currentPath=i.toUrl,i.paused||this.trackPageLoad(this.pageInfo))},this))},_safeCall:function(t){try{return this[t].apply(this,Array.prototype.slice.call(arguments,1))}catch(e){console.error("View threw an exception on "+t,e.stack||e.stacktrace||e.message)}},_initPage:function(t,e,i){t&&(this.delegateEvents(),this._updatePageTitle()),this._initModules(e&&e.length>1?e[1].concat(i||[]):i)},_triggerBeforePageReveal:function(t,e){this._safeCall("beforePageReveal",e.fromUrl,e.toUrl,t,e.paused),this._getPageInfo(t,e)},_getPageInfo:function(t,e){this.pageInfo=this._safeCall("parsePageInfo",t)||{},this._verifyPageInfo(this.pageInfo),this._fetchPageModules(this.pageInfo,e)},_verifyPageInfo:function(t){t.templatetype=t.templatetype||"",t.ssts=t.ssts||"bugpages",t.cst=t.aws||t.cst||"undefined"},_updatePageTitle:function(){if("None"===(this.pageInfo.seotitle||"None")){var t=window.site_config.display_name;t&&(document.title=t)}else document.title=this.pageInfo.seotitle},removeApp:function(t,i){return this._animId++,this._safeCall("beforeAppRemove",t,i),this.destroyModules(!1),this._triggerAnimateRemoveApp(t,i).always(e.bind(function(){this._safeCall("afterAppRemove",t,i),this._safeDestroy()},this))},_triggerAnimateRemoveApp:function(e,i){var s=this._safeCall("animateRemoveApp",e,i);return s?n.addAnimation(s):t.Deferred().resolve()},_safeDestroy:function(){try{this.destroy(!0)}catch(t){console.error("View threw an exception on destroy: ",t.stack||t.stacktrace||t.message),this.$el.remove()}},getWindowOffset:function(){return this.el?this.el.getBoundingClientRect():{top:0,left:0}},animateRevealApp:function(e,i,s){return this.isApple&&s?t.Deferred().resolve():this.show(!0)},animateRemoveApp:function(){return this.hide(!0)},animateChangePagePreData:function(){},animateChangePagePostData:function(t,e,i,s){var n=this.swapContent(this.$el,i,s,this.getHash(e));return this.setElement(i,!1),n},setFixedPosition:function(t,e){e||!this.isSafari5&&!this.isApple?(this.header=o.getHeader(),!this.header||this.header.isFixed()?(this._isFixedOffset=t,this.$el.css({position:"fixed",top:t})):(this._isFixedOffset=t=this.$el.offset().top,this.$el.css({position:"absolute",top:t}))):this.$el.hide()},clearFixedPosition:function(t){this._isFixedOffset=null,t||!this.isSafari5&&!this.isApple?this.$el.css({position:"",top:""}):this.$el.show()},_onHeaderFixed:function(){this.header&&null!==this._isFixedOffset&&(this._isFixedOffset-=this.header.getFixedThreshold(),this.$el.css({position:"fixed",top:this._isFixedOffset}))},_onHeaderUnfixed:function(){this.header&&null!==this._isFixedOffset&&(this._isFixedOffset+=this.header.getFixedThreshold(),this.$el.css({position:"absolute",top:this._isFixedOffset}))},activateLoader:function(){},deactivateLoader:function(){},beforeAppRemove:function(){},afterAppRemove:function(){},beforePageReveal:function(){},afterPageReveal:function(t,e,i,s){s&&(this.subviews.page=new s({el:this.$el}))},getRevealAppLoader:function(){return'<section class="ui-loading dark-medium ui-app-loader"></section>'},beforeOverlayRemove:function(){},afterOverlayReveal:function(){},getClientAdInfo:function(){return{}},parsePageInfo:function(t){return JSON.parse(t.find(".pageinfo").eq(0).html())||{}},fetchPageModules:function(t){return s.fetchPageModules(t.js_modules)},getClientInfo:function(){return{}},trackPageLoad:function(t){e.defer(function(){n.getAnimationCompletion().done(function(){a.trigger("page:load",t)})})}});return l}),define("managers/cachemanager",["jquery","underscore"],function(t,e){"use strict";var i=function(){e.bindAll(this,"_updateCache"),window.addEventListener?window.addEventListener("storage",this._updateCache,!1):window.attachEvent("onstorage",this._updateCache),this.reset(),this.getValue("cmgc",this.gc,10080)};return i.prototype={keyPrefix:"wf_",reset:function(){this._cache={}},gc:function(){var t=i.prototype;e.each(e.keys(window.localStorage),function(e){0===e.indexOf(t.keyPrefix)&&(t._getBrowserCache(window.localStorage,e)||window.localStorage.removeItem(e))})},_updateCache:function(e){var i;e||(e=window.event),e.key&&0===e.key.indexOf(this.keyPrefix)&&(e.newValue?(i=JSON.parse(e.newValue),"raw"!==i.type&&(i.data=t.Deferred().resolve(i.data)),this._setMemoryCache(e.key,i)):delete this._cache[e.key])},getValue:function(t,i,s){var n,o,r,a=this._getStorage(s);return t=this.keyPrefix+t,n=this._getMemoryCache(t),n||(n=this._getBrowserCache(a,t),n||(o=this._getValue(i),r=this._isPromise(o),n=this._buildCacheEntry(o,r,s),r?o.done(e.bind(function(e){var i=this._buildCacheEntry(e,!0,s);this._setBrowserCache(t,i,a)},this)):this._setBrowserCache(t,n,a)),this._setMemoryCache(t,n)),n.data},setValue:function(t,i,s){var n=this._isPromise(i),o=this._buildCacheEntry(i,n,s);t=this.keyPrefix+t,n?i.done(e.bind(function(e){var i=this._buildCacheEntry(e,!0,s);this._setBrowserCache(t,i,this._getStorage(s))},this)):this._setBrowserCache(t,o,this._getStorage(s)),this._setMemoryCache(t,o)},_isPromise:function(e){return t.isPlainObject(e)&&t.isFunction(e.promise)},_getStorage:function(t){var e=t?"localStorage":"sessionStorage";return window[e]},_setMemoryCache:function(t,e){this._cache[t]=e},_setBrowserCache:function(t,e,i){try{i.setItem(t,JSON.stringify(e))}catch(s){console.log("Storage Set Failed for key: "+t)}},_buildCacheEntry:function(t,e,i){var s,n={data:t,type:e?0:"raw"};return i&&(s=new Date,n.expires=s.setTime(s.getTime()+1e3*i*60)),n},clearValue:function(t){t=this.keyPrefix+t,sessionStorage.removeItem(t),localStorage.removeItem(t),delete this._cache[t]},_getMemoryCache:function(t){var e=this._cache[t];if(e){if("raw"!==e.type){if("pending"===e.data.state())return e;if("rejected"===e.data.state())return null}if(!e.expires)return e;if(new Date<new Date(e.expires))return e}},_getBrowserCache:function(e,i){var s=e.getItem(i);return s&&(s=JSON.parse(s),!s.expires||new Date<new Date(s.expires))?("raw"!==s.type&&(s.data=t.Deferred().resolve(s.data)),s):void 0},_getValue:function(e){return t.isFunction(e)?e():e}},new i}),define("user-manager",["jquery","underscore","pubsub","managers/cachemanager"],function(t,e,i,s){"use strict";var n=function(){this.initialize()};return n.prototype={PREFERRED_ACCOUNT_KEY:"userPreferredAccount",PREFERRED_ACCOUNT_TIMEOUT:525600,initialize:function(){this.resetManager(),this.preferredAccount&&(this.state="loggingIn",i.on("page:load",this.autoLogin,this)),i.on("user:statuschange",this._userStatusChange,this)},autoLogin:function(){this.state=null,this.loginUser(this.preferredAccount,!0).fail(e.bind(function(){this.logoutUser()},this)),i.off("page:load",this.autoLogin,this)},registerAccount:function(t){var e=t.getName();return this.accounts[e]?void console.error("duplicate account name given to registerAccount"):void(this.accounts[e]=t)},unRegisterAccount:function(t){var e=t.getName();this.accounts[e]?this.accounts[e]=null:console.error("unRegisterAccount called on name that isn't registered!"),t.logout(),this.preferredAccount===e&&this.setPreferredAccount(null)},loginUser:function(t,e){return this._askAccount("login",t,e)},_userStatusChange:function(t,e,i){"loggedIn"===e?this._onLoginSuccess(t,i):"loggedOut"===e&&this._onLogoutSuccess(t)},_onLoginSuccess:function(t,e){this.setPreferredAccount(t),i.trigger("user:login",e,t)},setPreferredAccount:function(t){var e=this.getPreferredAccountLookupKey();t?s.setValue(e,t,this.PREFERRED_ACCOUNT_TIMEOUT):s.clearValue(e),this.preferredAccount=t},getPreferredAccountLookupKey:function(){return this.PREFERRED_ACCOUNT_KEY},getPreferredAccount:function(){return this.preferredAccount||s.getValue(this.getPreferredAccountLookupKey(),null,this.PREFERRED_ACCOUNT_TIMEOUT)},getLoginStatus:function(t){var e,i=this.getAccount(t);return e=i?i.getLoginStatus():"loggedOut",this.state||e},logoutUser:function(t){return this._askAccount("logout",t)},logoutAll:function(){return t.when.apply(t,e.map(this.accounts,function(t){return t.logout()}))},_onLogoutSuccess:function(t){i.trigger("user:logout",t),t===this.getPreferredAccount()&&this.setPreferredAccount(null)},getAccount:function(t){return this.accounts[t||this.preferredAccount]},getUserInfo:function(t){return this._askAccount("getUserInfo",t)},getCoreUserInfo:function(t){return this._askAccount("getCoreUserInfo",t)},resetManager:function(){this.accounts={},this.preferredAccount=this.getPreferredAccount()},_askAccount:function(e,i){var s=this.getAccount(i);return s?s[e]?s[e].apply(s,Array.prototype.slice.call(arguments,2)):t.Deferred().reject("Account "+(i||this.preferredAccount)+" does not support method "+e):t.Deferred().reject("Invalid Account")}},new n}),define("adLogger",["underscore"],function(t){"use strict";var e=function(){this.initialize()};return e.prototype={initialize:function(){this.debug=window.isAdDebug,Function.prototype.bind&&window.console&&"object"==typeof window.console.log&&t.each(["log","info","warn","error"],function(t){window.console[t]=Function.prototype.call.bind(window.console[t],window.console)})},logGroup:function(t){this.debug&&window.console.groupCollapsed(t)},logGroupEnd:function(){this.debug&&window.console.groupEnd()},_log:function(t,e,i){var s="Ad "+e+": "+t;if(window.console&&window.console[e])if(i.length){window.console.groupCollapsed(s);for(var n=0,o=i.length;o>n;n++)window.console[e](i[n]);window.console.groupEnd()}else window.console[e](s)},logDebug:function(t){this.debug&&this._log(t,"log",Array.prototype.slice.call(arguments,1))},logError:function(t){this._log(t,"error",Array.prototype.slice.call(arguments,1))},logInfo:function(t){this.debug&&this._log(t,"info",Array.prototype.slice.call(arguments,1))},logWarn:function(t){this._log(t,"warn",Array.prototype.slice.call(arguments,1))}},new e}),define("partner/ad-slot",["jquery","underscore","baseview","state","utils","user-manager","pubsub","adLogger"],function(t,e,i,s,n,o,r,a){"use strict";var l=i.extend({className:"ad-slot",id:function(){return e.uniqueId("ad-slot-"+this.options.adUnit.replace(/\//g,"-")+"-")},events:{partnersetup:"onHighImpactAdLoad",partnerloading:"onPartnerLoading"},pageLoaded:!1,initialized:!1,queue:[],pageUnLoad:function(){l.prototype.pageLoaded=!1},pageLoad:function(){l.prototype.queue.length&&l.prototype._requestSlots(l.prototype.queue),l.prototype.queue=[],l.prototype.pageLoaded=!0},initialize:function(e){return e=t.extend({adUnit:null,targeting:{},sizes:[],type:"in",onSlotRequest:null,onSlotRender:null,onSlotEmpty:null,position:null},e),!l.prototype.initialized&&window.googletag&&(l.prototype.initialized=!0,googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",l.prototype._renderEnded)})),this.$el.length&&e.position&&e.position.length&&e.position.parents("body").length?(e.position.append(this.$el),this.gptSlot=null,this.slotId=this.$el.prop("id"),this.adDeliveryData=null,i.prototype.initialize.call(this,e),void this._buildGptSlot()):void a.logError("AdSlot("+this.options.adUnit+"): Unable to request ad because no valid dom element provided")},_buildGptSlot:function(){return s.getActivePageInfo().noadvertising?void a.logInfo("AdSlot("+this.options.adUnit+"): blocked because of noadvertising flag in pageinfo"):void("in"===this.options.type?this._registerSlotWithGoogle(this.options.adUnit,this.options.sizes,this.slotId):this._registerOutOfPageSlotWithGoogle(this.options.adUnit,this.slotId))},destroy:function(){this.gptSlot&&(this.gptSlot.__gannettSlot=null),this.destroyed=!0,this.gptSlot=null,i.prototype.destroy.call(this,!0)},refresh:function(){this.destroyed||(this.adLoading=!1,this.adData=null,this.$el.closest("body").length||this.options.position.append(this.$el),this.delegateEvents(),this.gptSlot?window.googletag&&!s.getActivePageInfo().noadvertising&&(this._refreshSlot(this.gptSlot),a.logInfo("AdSlot("+this.options.adUnit+"): Ad refreshed for slot",this.gptSlot)):this._buildGptSlot())},onPartnerLoading:function(){this.adLoading=!0},onHighImpactAdLoad:function(t,e){var i=null;if(e&&e.data)i=e.data;else{if(!t.originalEvent||!t.originalEvent.data)return void a.logError("AdSlot("+this.options.adUnit+"): Found a high impact ad, can't find the data object from the iFrame",arguments);i=t.originalEvent.data}if(!i||!i.adType)return void a.logError("AdSlot("+this.options.adUnit+"): high impact event received, but invalid data object was given",i);this.adData=i;var s=this._normalizeAdType(i.adType);this.options.onSlotRender(i,s)},_normalizeAdType:function(t){return t?t.toLowerCase().replace(/[^a-z]/,""):null},_registerOutOfPageSlotWithGoogle:function(t,i){window.googletag&&googletag.cmd.push(e.bind(function(){a.logInfo("AdSlot("+this.options.adUnit+"): registering out of page slot with google "+t),this.gptSlot=googletag.defineOutOfPageSlot(t,i).addService(googletag.pubads()),this.gptSlot.__gannettSlot=this,googletag.display(i),this._refreshSlot(this.gptSlot)},this))},_refreshSlot:function(t){this.setTargeting(this.options.targeting),this.pageLoaded?this._requestSlots([t]):this.queue.push(t)},_requestSlots:function(t){googletag.pubads().refresh(t),e.each(t,function(t){t.__gannettSlot.options.onSlotRequest()})},_registerSlotWithGoogle:function(t,i,s){window.googletag&&googletag.cmd.push(e.bind(function(){a.logGroup("AdSlot "+this.options.adUnit),a.logInfo("registering slot with google "+t+" sizes",i),this.gptSlot=googletag.defineSlot(t,i,s).addService(googletag.pubads()),this.gptSlot.__gannettSlot=this,googletag.display(s),this._refreshSlot(this.gptSlot),a.logGroupEnd()},this))},_renderEnded:function(t){t.slot.__gannettSlot&&e.defer(e.bind(function(){!this.gptSlot||this.adData||this.adLoading||(t.isEmpty||t.size[0]<10||t.size[1]<10?(a.logInfo("AdSlot("+this.options.adUnit+"): No Ad Delivered"),this.options.onSlotEmpty&&this.options.onSlotEmpty()):this.options.onSlotRender())},t.slot.__gannettSlot))},setTargeting:function(t){this.gptSlot&&(this.options.targeting=t,this._setTargeting(this.gptSlot,t))},_setTargeting:function(t,i){t.clearTargeting(),e.each(i,function(e,i){(e||0===e||e===!1)&&(t.setTargeting(i,e),a.logInfo("set targetting - key:"+i+" value:"+e))},this)}});return l}),define("modules/global/barrier",["jquery"],function(t){var e=function(e,i,s){t.extend(this,t.Deferred()),s&&(this.reject=this.resolve);var n=setTimeout(t.proxy(function(){this.reject()},this),i);e.then(t.proxy(function(){this.resolve.apply(this,arguments)},this),t.proxy(function(){this.reject.apply(this,arguments)},this)).always(function(){clearTimeout(n)})},i=function(){this.init()};return i.prototype={init:function(){this._processes=[],this._waiting=[]},add:function(t,i,s){return i?void this._addToQueue(this._processes,new e(t,i,s)):void console.error("Invalid Barrier, timeoutMS required")},cancel:function(e){t.each(this._waiting,function(t,e){e.reject()}),this._waiting=[],e&&(t.each(this._processes.slice(0),function(t,e){e.reject()}),this._processes=[])},wait:function(){var e=this._processes;return e.length?this._addToQueue(this._waiting,t.Deferred(function(i){t.when.apply(t,e).then(function(){i.resolve.apply(i,arguments)},function(){i.reject.apply(i,arguments)})})):t.Deferred().resolve()},_addToQueue:function(e,i){return e.push(i),i.always(t.proxy(function(){return this._removeFromQueue(e,i)},this))},_removeFromQueue:function(e,i){var s=t.inArray(i,e);return-1!==s?(e.splice(s,1),!0):!1}},i}),define("modules/global/memobarrier",["jquery","modules/global/barrier"],function(t,e){var i=function(){this.init()};return i.prototype=new e,i.prototype.constructor=i,i.prototype._addToQueue=function(t,e){return t.push(e),e},i}),define("admanager",["jquery","underscore","pubsub","state","utils","user-manager","partner/ad-slot","modules/global/memobarrier","adLogger","cookie"],function(t,e,i,s,n,o,r,a,l){"use strict";var h=function(){this.initialize()};return h.prototype={adSizes:{pushdown:[1200,615],gravity:[2560,1440],dual_pushdown:[1200,1230],skyline:[1080,450],elastic:[1080,810],outofpage:[1080,810],cinematicvideoskin:[2600,1400],heroflip:[720,524],coverviewfullpage:[1,1],bigpageflex:[1,1],mediumrectangle:[300,250],halfpage:[300,600],sponsor_logo_medium:[100,50],leaderboard:[728,90],generic:[1,2],filmstrip:[300,600],iabpushdown:[970,90],iabpushdown2:[970,66],billboard:[970,250],portrait:[300,1050],sponsor_logo:[100,30]},flexibleAds:["pushdown","gravity","dual_pushdown","elastic","outofpage","cinematicvideoskin","heroflip","coverviewfullpage","generic"],activeAdPlacements:{},globalTargetingKeys:[],getSharedAdSlot:function(t,i,s,n){var o=this._buildAdSizesFromPlacements(i),r=this.buildAdUnit(t),a=s&&s.$el||this.globalStaging;return n=n||s&&s.getSlotType()||"in",this._createAdSlot(r,{},o,n,a,function(t,e){if(!e&&s)s.render();else{var n=i[e];if(!n)return void l.logError("AdSlot("+r+"): ad delivered to unknown ad position/type: "+e);n.render(t,e)}},function(){e.each(i,function(t){t.noAd()})})},getAdSlot:function(t,e,i,s,n){var o=this.buildAdUnit(t),r=this._mapAdSizeNamesToActualSizes(i);return this.activeSlotStatistics.unknown++,this._createAdSlot(o,e,r,n,s.$el,function(t,e){s.render(t,e)},function(){s.noAd()})},buildAdUnit:function(t){var e=n.getNested(window.site_vars,"ads")||{},i=n.getNested(e,"dfp","account_id"),s=e.account_name;return this.override&&(i=this.override.usatai,s=this.override.usatan),i+"/"+s+"/"+t},getSize:function(e){var i=this.adSizes[t.trim(e)];return i?i:(l.logWarn("Size not found for "+e),null)},isFlexibleAdSize:function(t){return-1!==e.indexOf(this.flexibleAds,t)},getVCESize:function(t){var e=this.getSize(t);return e?e.join("x"):"1x1"},initialize:function(){if(this._resetSlots(),window.googletag){this.targetBarrier=new a,this._fetchTargeting(),l.logGroup("AdManager initialize"),i.attach({"page:load":this.onPageLoad,"page:unload":this.onPageUnload,"user:statuschange":this.onUserStatusChange},this);var e=n.getUrlParam("usatai"),s=n.getUrlParam("usatan"),o=n.getUrlParam("usatl");e&&s&&o&&(this.override={usatai:e,usatan:s,usatl:o}),this.globalStaging=t("#ad-staging"),this._initializeGoogletag(),window.adManager=this,this._initializeBaseTargeting(),l.logDebug("AdManager initialized"),l.logGroupEnd()}},_beginA9:function(){var t=n.getNested(window.site_vars,"ads","a9");t&&t.enabled&&this.targetBarrier.add(this._fetchA9(t),2e3,!0)},_fetchA9:function(e){return n.loadScript(e.url,"amznads").then(function(i){try{i.ads={},i.getAdsAsync(e.account)}catch(s){return console.error("failed amznads.getAdsAsync("+e.account+")",s),t.Deferred().reject()}return t.Deferred(function(t){i.tasks.push(function(){t.resolve({amznslots:i.getTokens()})})})})},_fetchTargeting:function(){this._beginA9(),this._beginCriteo(),this._beginRubicon(),this._beginPubMatic()},_beginCriteo:function(){var t=n.getNested(window.site_vars,"ads","criteo");t&&t.enabled&&this.targetBarrier.add(this._fetchCriteo(t),2e3,!0)},_fetchCriteo:function(i){return window[i.varName]=t.cookie(i.cookie),t.ajax({url:i.url,data:{netId:i.account,cookieName:i.cookie,varName:i.varName},dataType:"script"}).then(e.bind(function(){var t=window[i.varName];return t?e.reduce(t.split(";"),function(t,e){if(e){var i=e.split("=");t[i[0]]=i[1]}return t},{}):{}},this))},_beginRubicon:function(){var t=n.getNested(window.site_vars,"ads","rubicon");t&&t.enabled&&this.targetBarrier.add(this._fetchRubicon(t),2e3,!0)},_fetchRubicon:function(e){return window.oz_api=e.api,window.oz_ad_server=e.adServer,window.oz_site=e.site,window.oz_ad_slot_size=e.adSlotSize,window.oz_async=!0,t.Deferred(function(i){window.oz_callback=function(){i.resolve({tier:n.getNested(window.rp_valuation,"estimate","tier")})},t.ajax({url:e.url,dataType:"script",cache:!0}).fail(function(){i.reject()})})},_beginPubMatic:function(){var t=n.getNested(window.site_vars,"ads","pubMatic");t&&t.enabled&&this.targetBarrier.add(this._fetchPubMatic(t),2e3,!0)},_fetchPubMatic:function(i){window.pm_pub_id=i.account,window.pm_optimize_adslots=i.slots;var s=i.site,n="100";switch(window.location.href.split("/")[3]){case"life":n="20";break;case"money":n="30";break;case"news":n="40";break;case"sports":n="50";break;case"tech":n="60";break;case"travel":n="70";break;case"weather":n="80";break;case"entertainment":n="90";break;default:n="10"}return window.pmzoneid=s+","+n,l.logGroup("PubMatic Initialization Info"),l.logInfo("PubMatic pmzoneid: "+window.pmzoneid),l.logInfo("PubMatic slots: "+window.pm_optimize_adslots),l.logGroupEnd(),t.Deferred(function(s){window.pm_async_callback_fn="pm_async_callback",window.pm_async_callback=function(){var t,i,n=window.PubMaticGrouped;if(n){try{t=n.getCombinedKeyValueGPT()}catch(o){l.logError("PubMatic.getCombinedKeyValueGPT() failed",o)}t&&(i=e.object(e.map(t.split(";"),function(t){return t.split("=")})),s.resolve(i))}else l.logError("PubMatic script failed to provide PubMaticGrouped");s.reject()},t.ajax({url:i.url,dataType:"script",cache:!0}).fail(function(){s.reject()})})},_createAdSlot:function(i,s,o,a,l,h,c){var d=t.Deferred();
return d.done(e.bind(function(){this.activeSlotStatistics.unknown--},this)),this.activeSlotStatistics.unknown++,new r({adUnit:i,targeting:s,sizes:o,type:a||"out",position:l,onSlotRequest:e.bind(function(){this.slotsBarrier.add(d,2e3,!0)},this),onSlotEmpty:e.bind(function(){this.activeSlotStatistics.noad++,d.resolve(),c()},this),onSlotRender:e.bind(function(t,e){if(e){this.activeSlotStatistics.high_impact++;var i=n.getNested(t,"dfp","ecid");this.activeSlotStatistics.high_impact_info.push({adType:e,ecid:i})}else this.activeSlotStatistics.iab++;d.resolve(),h(t,e)},this)})},_resetSlots:function(){this.slotsBarrier?this.slotsBarrier.cancel(!0):this.slotsBarrier=new a,this.adLoadBarrier&&this.adLoadBarrier.reject(),this.adLoadBarrier=t.Deferred(),this.activeSlotStatistics={high_impact:0,high_impact_info:[],iab:0,noad:0,unknown:0}},getActiveSlotStatistics:function(){return this.adLoadBarrier.then(e.bind(function(){return this.slotsBarrier.wait()},this)).then(e.bind(function(){return this.activeSlotStatistics},this))},_initializeGoogletag:function(){googletag.cmd.push(function(){var t=googletag.pubads();l.logInfo("Collapses the empty divs. Used for the asset pages where the slot and placement are the same"),t.collapseEmptyDivs(),t.enableSingleRequest(),l.logInfo("Disabling initial load of slots"),t.disableInitialLoad(),l.logInfo("Enabled the ad calls"),googletag.enableServices()})},_initializeBaseTargeting:function(){var e=googletag.pubads(),i=this.override;googletag.cmd.push(function(){var s=((t.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join();e.setTargeting("aam",s),e.setTargeting("u",t.cookie("aam_uuid")||""),i&&i.usatl&&e.setTargeting("adlabel",i.usatl);var n=window.site_config.ADS.DFP.ENV;l.logInfo("using env targeting: "+n),e.setTargeting("env",n)})},onPageLoad:function(i){this._buildSharedAdSlots(i.cst),this.pageLoaded=!0,this.targetBarrier?this.targetBarrier.wait().done(e.bind(function(){var e=[{},{ss:this.ssInfo}].concat([].slice.call(arguments)),s=t.extend.apply(t,e);l.logInfo("AdManager: requestAds()",i,s),this._setGlobalTargeting(i,s),r.prototype.pageLoad(),this.adLoadBarrier.resolve()},this)):this.adLoadBarrier.resolve()},_buildSharedAdSlots:function(t){e.each(this.activeAdPlacements,function(e){e&&(e.slotInfo=this.getSharedAdSlot(e.name+"/"+t,e.positionMap,e.defaultPosition))},this)},onPageUnload:function(){this.pageLoaded=!1,this._resetSlots(),r.prototype.pageUnLoad(),this._resetTargeting()},_resetTargeting:function(){this.targetBarrier.cancel(!0),this._clearGlobalTargeting(),this._fetchTargeting()},isPageLoaded:function(){return this.pageLoaded},_clearGlobalTargeting:function(){googletag.cmd.push(e.bind(function(){var t=googletag.pubads(),i=this.globalTargetingKeys;l.logInfo("clear pubads() targetting",i),e.each(i,function(e){t.clearTargeting(e)}),this.globalTargetingKeys=[]},this))},_setGlobalTargeting:function(i,n){var o=this,r=t.extend({},this.getPageAdTargeting(i),n,s.getActiveApp().getClientAdInfo());this.globalTargetingKeys=[],googletag.cmd.push(function(){var t=googletag.pubads();e.each(r,function(e,i){(e||0===e||e===!1)&&(o.globalTargetingKeys.push(i),t.setTargeting(i,String(e)),l.logInfo("set pubads() targetting - key:"+i+" value:"+e))})})},getPageAdTargeting:function(t){var e=n.getNested(window,"site_vars","aws_site_name")||"usat";return{pageType:t.basePageType,referrer:(s.getReferrer().match(/https?:\/\/[:\w\.-]+/)||[])[0],series:t.series,sitepage:e+"/"+t.ssts,contentid:t.assetid,topic:t.topic}},onUserStatusChange:function(t,i){if("firefly"===t)if("loggedIn"==i||"loggingIn"==i){var s=o.getCoreUserInfo();s=s.then(e.bind(function(t){this.ssInfo=t.UserLicenseType?e.map(t.UserLicenseType.split("_"),function(t){return t.substring(0,3)}).join("_"):null},this),e.bind(function(){this.ssInfo=null},this)),this.targetBarrier.add(s,2e3,!0)}else this.ssInfo=null},getAdActualSizes:function(t){return this._mapAdSizeNamesToActualSizes(t)},_mapAdSizeNamesToActualSizes:function(t){if(e.isString(t)){var i=t.split(",");return this._processAdSizeData(i.length>1?i:[t])}return e.isArray(t)?this._processAdSizeData(this._isAdSizeArray(t)?[t]:t):[]},_processAdSizeData:function(t){return e.reduce(t,function(t,i){var s;return e.isString(i)?s=this._getAdSizeFromString(i):e.isArray(i)&&this._isAdSizeArray(i)&&(s=i),s&&t.push(s),t},[],this)},_isAdSizeArray:function(e){return 2===e.length&&t.isNumeric(e[0])&&t.isNumeric(e[1])},_getAdSizeFromString:function(t){var e=this.getSize(t);if(!e){var i=t.toLowerCase().split("x");2===i.length&&(i=[parseInt(i[0],10),parseInt(i[1],10)],this._isAdSizeArray(i)&&(e=i))}return e},_buildAdSizesFromPlacements:function(i){var s=[];return e.each(i,function(e){var i=this._mapAdSizeNamesToActualSizes(e.getAdSizes());t.merge(s,i)},this),e.uniq(s)},refreshSharedAdPosition:function(t){var i=this.activeAdPlacements[t];return i?i.slotInfo?(e.each(i.positionMap,function(t){t.destroyAdPlacement()},this),void i.slotInfo.refresh()):void l.logError("AdManager: tried refreshing shared ad position that hasn't been requested yet"):void l.logError("AdManager: tried refreshing shared ad position that no longer exists")},registerSharedAdPosition:function(t){var i=t.getAdPlacement(),s=t.getAdType();if(this._checkPageChange(),s&&!e.isArray(s)&&(s=[s]),!i||!s||!s.length)return void l.logError("AdManager: invalid ad unit registered, adUnit and adType are required",t);var n=this._getAdPlacementInfo(i);this._addAdToPlacementInfo(n,t,s)},_getAdPlacementInfo:function(t){var e=this.activeAdPlacements[t];return e||(this.activeAdPlacements[t]=e={name:t,positionMap:{},defaultPosition:null,slotInfo:null,numPositions:0}),e},_addAdToPlacementInfo:function(t,i,s){e.each(s,function(e){return t.positionMap[e]?void l.logError("AdManager: invalid ad unit registered, duplicate adType registered",i):(l.logInfo("AdManager: registerSharedAdPosition for adPlacement: "+t.name+" and adType:"+e),void(t.positionMap[e]=i))}),t.numPositions++,i.isDefaultPosition()&&(t.defaultPosition?l.logWarn("AdManager: multiple ad placements declared themselves default for adUnit: "+t.name,i):t.defaultPosition=i)},_checkPageChange:function(){var t=window.location.pathname;t!==this.siteUrl&&(this.siteUrl=t,e.each(this.activeAdPlacements,function(t){t&&l.logError("Site Url changed, but ad placements were not released: ",t)}),this.activeAdPlacements={})},destroySharedAdPosition:function(t){var i=t.getAdPlacement(),s=t.getAdType(),n=this.activeAdPlacements[i];return n?(s&&!e.isArray(s)&&(s=[s]),e.each(s,function(e){var s=n.positionMap[e];return s?(l.logInfo("AdManager: destroySharedAdPosition for adPlacement: "+i+" and adType:"+e),void(n.positionMap[e]=null)):void l.logError("AdManager: destruction of unknown ad type",t)}),t.isDefaultPosition()&&(n.defaultPosition=null),n.numPositions--,void(n.numPositions||(n.slotInfo&&n.slotInfo.destroy(),this.activeAdPlacements[i]=null))):void l.logError("AdManager: destruction of unknown ad unit",t)},_createScript:function(t,e,i){l.logDebug("Creating script",t,e,i[0]);var s=document.createElement("script");s.id=t,s.src=e,s.type="text/javascript",s.defer=!1,i[0].appendChild(s)},logDebug:function(){l.logDebug.apply(l,arguments)},logError:function(){l.logError.apply(l,arguments)},logInfo:function(){l.logInfo.apply(l,arguments)},logWarn:function(){l.logWarn.apply(l,arguments)}},new h}),define("api/ads",["jquery","admanager"],function(t,e){return{registerAd:function(i,s,n,o){var r=t("string"==typeof i?"#"+i:i),a={$el:r,render:function(){},noAd:function(){}};e.getAdSlot(s,o,n,a,"in")}}});var swfobject=function(){function t(){if(!H){try{var t=z.getElementsByTagName("body")[0].appendChild(m("span"));t.parentNode.removeChild(t)}catch(e){return}H=!0;for(var i=N.length,s=0;i>s;s++)N[s]()}}function e(t){H?t():N[N.length]=t}function i(t){if(typeof F.addEventListener!=A)F.addEventListener("load",t,!1);else if(typeof z.addEventListener!=A)z.addEventListener("load",t,!1);else if(typeof F.attachEvent!=A)v(F,"onload",t);else if("function"==typeof F.onload){var e=F.onload;F.onload=function(){e(),t()}}else F.onload=t}function s(){R?n():o()}function n(){var t=z.getElementsByTagName("body")[0],e=m(P);e.setAttribute("type",M);var i=t.appendChild(e);if(i){var s=0;!function(){if(typeof i.GetVariable!=A){var n=i.GetVariable("$version");n&&(n=n.split(" ")[1].split(","),W.pv=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)])}else if(10>s)return s++,void setTimeout(arguments.callee,10);t.removeChild(e),i=null,o()}()}else o()}function o(){var t=B.length;if(t>0)for(var e=0;t>e;e++){var i=B[e].id,s=B[e].callbackFn,n={success:!1,id:i};if(W.pv[0]>0){var o=g(i);if(o)if(!y(B[e].swfVersion)||W.wk&&W.wk<312)if(B[e].expressInstall&&a()){var c={};c.data=B[e].expressInstall,c.width=o.getAttribute("width")||"0",c.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(c.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(c.align=o.getAttribute("align"));for(var d={},u=o.getElementsByTagName("param"),p=u.length,f=0;p>f;f++)"movie"!=u[f].getAttribute("name").toLowerCase()&&(d[u[f].getAttribute("name")]=u[f].getAttribute("value"));l(c,d,i,s)}else h(o),s&&s(n);else w(i,!0),s&&(n.success=!0,n.ref=r(i),s(n))}else if(w(i,!0),s){var m=r(i);m&&typeof m.SetVariable!=A&&(n.success=!0,n.ref=m),s(n)}}}function r(t){var e=null,i=g(t);if(i&&"OBJECT"==i.nodeName)if(typeof i.SetVariable!=A)e=i;else{var s=i.getElementsByTagName(P)[0];s&&(e=s)}return e}function a(){return!q&&y("6.0.65")&&(W.win||W.mac)&&!(W.wk&&W.wk<312)}function l(t,e,i,s){q=!0,C=s||null,S={success:!1,id:i};var n=g(i);if(n){"OBJECT"==n.nodeName?(x=c(n),k=null):(x=n,k=i),t.id=E,(typeof t.width==A||!/%$/.test(t.width)&&parseInt(t.width,10)<310)&&(t.width="310"),(typeof t.height==A||!/%$/.test(t.height)&&parseInt(t.height,10)<137)&&(t.height="137"),z.title=z.title.slice(0,47)+" - Flash Player Installation";var o=W.ie&&W.win?"ActiveX":"PlugIn",r="MMredirectURL="+F.location.toString().replace(/&/g,"%26")+"&MMplayerType="+o+"&MMdoctitle="+z.title;if(typeof e.flashvars!=A?e.flashvars+="&"+r:e.flashvars=r,W.ie&&W.win&&4!=n.readyState){var a=m("div");i+="SWFObjectNew",a.setAttribute("id",i),n.parentNode.insertBefore(a,n),n.style.display="none",function(){4==n.readyState?n.parentNode.removeChild(n):setTimeout(arguments.callee,10)}()}d(t,e,i)}}function h(t){if(W.ie&&W.win&&4!=t.readyState){var e=m("div");t.parentNode.insertBefore(e,t),e.parentNode.replaceChild(c(t),e),t.style.display="none",function(){4==t.readyState?t.parentNode.removeChild(t):setTimeout(arguments.callee,10)}()}else t.parentNode.replaceChild(c(t),t)}function c(t){var e=m("div");if(W.win&&W.ie)e.innerHTML=t.innerHTML;else{var i=t.getElementsByTagName(P)[0];if(i){var s=i.childNodes;if(s)for(var n=s.length,o=0;n>o;o++)1==s[o].nodeType&&"PARAM"==s[o].nodeName||8==s[o].nodeType||e.appendChild(s[o].cloneNode(!0))}}return e}function d(t,e,i){var s,n=g(i);if(W.wk&&W.wk<312)return s;if(n)if(typeof t.id==A&&(t.id=i),W.ie&&W.win){var o="";for(var r in t)t[r]!=Object.prototype[r]&&("data"==r.toLowerCase()?e.movie=t[r]:"styleclass"==r.toLowerCase()?o+=' class="'+t[r]+'"':"classid"!=r.toLowerCase()&&(o+=" "+r+'="'+t[r]+'"'));var a="";for(var l in e)e[l]!=Object.prototype[l]&&(a+='<param name="'+l+'" value="'+e[l]+'" />');n.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+o+">"+a+"</object>",j[j.length]=t.id,s=g(t.id)}else{var h=m(P);h.setAttribute("type",M);for(var c in t)t[c]!=Object.prototype[c]&&("styleclass"==c.toLowerCase()?h.setAttribute("class",t[c]):"classid"!=c.toLowerCase()&&h.setAttribute(c,t[c]));for(var d in e)e[d]!=Object.prototype[d]&&"movie"!=d.toLowerCase()&&u(h,d,e[d]);n.parentNode.replaceChild(h,n),s=h}return s}function u(t,e,i){var s=m("param");s.setAttribute("name",e),s.setAttribute("value",i),t.appendChild(s)}function p(t){var e=g(t);e&&"OBJECT"==e.nodeName&&(W.ie&&W.win?(e.style.display="none",function(){4==e.readyState?f(t):setTimeout(arguments.callee,10)}()):e.parentNode.removeChild(e))}function f(t){var e=g(t);if(e){for(var i in e)"function"==typeof e[i]&&(e[i]=null);e.parentNode.removeChild(e)}}function g(t){var e=null;try{e=z.getElementById(t)}catch(i){}return e}function m(t){return z.createElement(t)}function v(t,e,i){t.attachEvent(e,i),U[U.length]=[t,e,i]}function y(t){var e=W.pv,i=t.split(".");return i[0]=parseInt(i[0],10),i[1]=parseInt(i[1],10)||0,i[2]=parseInt(i[2],10)||0,e[0]>i[0]||e[0]==i[0]&&e[1]>i[1]||e[0]==i[0]&&e[1]==i[1]&&e[2]>=i[2]?!0:!1}function b(t,e,i,s){if(!W.ie||!W.mac){var n=z.getElementsByTagName("head")[0];if(n){var o=i&&"string"==typeof i?i:"screen";if(s&&(T=null,$=null),!T||$!=o){var r=m("style");r.setAttribute("type","text/css"),r.setAttribute("media",o),T=n.appendChild(r),W.ie&&W.win&&typeof z.styleSheets!=A&&z.styleSheets.length>0&&(T=z.styleSheets[z.styleSheets.length-1]),$=o}W.ie&&W.win?T&&typeof T.addRule==P&&T.addRule(t,e):T&&typeof z.createTextNode!=A&&T.appendChild(z.createTextNode(t+" {"+e+"}"))}}}function w(t,e){if(V){var i=e?"visible":"hidden";H&&g(t)?g(t).style.visibility=i:b("#"+t,"visibility:"+i)}}function _(t){var e=/[\\\"<>\.;]/,i=null!=e.exec(t);return i&&typeof encodeURIComponent!=A?encodeURIComponent(t):t}{var x,k,C,S,T,$,A="undefined",P="object",I="Shockwave Flash",D="ShockwaveFlash.ShockwaveFlash",M="application/x-shockwave-flash",E="SWFObjectExprInst",L="onreadystatechange",F=window,z=document,O=navigator,R=!1,N=[s],B=[],j=[],U=[],H=!1,q=!1,V=!0,W=function(){var t=typeof z.getElementById!=A&&typeof z.getElementsByTagName!=A&&typeof z.createElement!=A,e=O.userAgent.toLowerCase(),i=O.platform.toLowerCase(),s=/win/.test(i?i:e),n=/mac/.test(i?i:e),o=/webkit/.test(e)?parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,r=!1,a=[0,0,0],l=null;if(typeof O.plugins!=A&&typeof O.plugins[I]==P)l=O.plugins[I].description,!l||typeof O.mimeTypes!=A&&O.mimeTypes[M]&&!O.mimeTypes[M].enabledPlugin||(R=!0,r=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),a[0]=parseInt(l.replace(/^(.*)\..*$/,"$1"),10),a[1]=parseInt(l.replace(/^.*\.(.*)\s.*$/,"$1"),10),a[2]=/[a-zA-Z]/.test(l)?parseInt(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof F.ActiveXObject!=A)try{var h=new ActiveXObject(D);h&&(l=h.GetVariable("$version"),l&&(r=!0,l=l.split(" ")[1].split(","),a=[parseInt(l[0],10),parseInt(l[1],10),parseInt(l[2],10)]))}catch(c){}return{w3:t,pv:a,wk:o,ie:r,win:s,mac:n}}();!function(){W.w3&&((typeof z.readyState!=A&&"complete"==z.readyState||typeof z.readyState==A&&(z.getElementsByTagName("body")[0]||z.body))&&t(),H||(typeof z.addEventListener!=A&&z.addEventListener("DOMContentLoaded",t,!1),W.ie&&W.win&&(z.attachEvent(L,function(){"complete"==z.readyState&&(z.detachEvent(L,arguments.callee),t())}),F==top&&!function(){if(!H){try{z.documentElement.doScroll("left")}catch(e){return void setTimeout(arguments.callee,0)}t()}}()),W.wk&&!function(){return H?void 0:/loaded|complete/.test(z.readyState)?void t():void setTimeout(arguments.callee,0)}(),i(t)))}(),function(){W.ie&&W.win&&window.attachEvent("onunload",function(){for(var t=U.length,e=0;t>e;e++)U[e][0].detachEvent(U[e][1],U[e][2]);for(var i=j.length,s=0;i>s;s++)p(j[s]);for(var n in W)W[n]=null;W=null;for(var o in swfobject)swfobject[o]=null;swfobject=null})}()}return{registerObject:function(t,e,i,s){if(W.w3&&t&&e){var n={};n.id=t,n.swfVersion=e,n.expressInstall=i,n.callbackFn=s,B[B.length]=n,w(t,!1)}else s&&s({success:!1,id:t})},getObjectById:function(t){return W.w3?r(t):void 0},embedSWF:function(t,i,s,n,o,r,h,c,u,p){var f={success:!1,id:i};W.w3&&!(W.wk&&W.wk<312)&&t&&i&&s&&n&&o?(w(i,!1),e(function(){s+="",n+="";var e={};if(u&&typeof u===P)for(var g in u)e[g]=u[g];e.data=t,e.width=s,e.height=n;var m={};if(c&&typeof c===P)for(var v in c)m[v]=c[v];if(h&&typeof h===P)for(var b in h)typeof m.flashvars!=A?m.flashvars+="&"+b+"="+h[b]:m.flashvars=b+"="+h[b];if(y(o)){var _=d(e,m,i);e.id==i&&w(i,!0),f.success=!0,f.ref=_}else{if(r&&a())return e.data=r,void l(e,m,i,p);w(i,!0)}p&&p(f)})):p&&p(f)},switchOffAutoHideShow:function(){V=!1},ua:W,getFlashPlayerVersion:function(){return{major:W.pv[0],minor:W.pv[1],release:W.pv[2]}},hasFlashPlayerVersion:y,createSWF:function(t,e,i){return W.w3?d(t,e,i):void 0},showExpressInstall:function(t,e,i,s){W.w3&&a()&&l(t,e,i,s)},removeSWF:function(t){W.w3&&p(t)},createCSS:function(t,e,i,s){W.w3&&b(t,e,i,s)},addDomLoadEvent:e,addLoadEvent:i,getQueryParamValue:function(t){var e=z.location.search||z.location.hash;if(e){if(/\?/.test(e)&&(e=e.split("?")[1]),null==t)return _(e);for(var i=e.split("&"),s=0;s<i.length;s++)if(i[s].substring(0,i[s].indexOf("="))==t)return _(i[s].substring(i[s].indexOf("=")+1))}return""},expressInstallCallback:function(){if(q){var t=g(E);t&&x&&(t.parentNode.replaceChild(x,t),k&&(w(k,!0),W.ie&&W.win&&(x.style.display="block")),C&&C(S)),q=!1}}}}();define("libs/swfobject/swfobject",function(){}),define("partner/iab",["jquery","underscore","baseview","adLogger","libs/swfobject/swfobject"],function(t,e,i,s){"use strict";var n=i.extend({destroy:function(e){this.$markup&&this.$markup.remove(),this.$iabThirdParty.remove(),this.adData.cleanUpSelectors&&t(this.adData.cleanUpSelectors).remove(),i.prototype.destroy.call(this,e)},render:function(e){var i;return this.adData=e,this.$el.addClass("iab-risingstar"),"flash"===e.adCreativeType?this.setupFlash(e):"image"===e.adCreativeType?this.setupImage(e):"third"===e.adCreativeType&&(i=this.setupThirdParty(e)),i?i:t.Deferred().resolve()},setupFlash:function(i){var s={clickTag:i.clickUrl+i.clickThruUrl},n={allowscriptaccess:"always",wmode:"transparent"},o=i.flashAttr||{},r=e.uniqueId("flashiab_");this.$markup=t('<div id="'+r+'"></div>'),this.$el.append(this.$markup),window.swfobject&&window.swfobject.embedSWF(i.flashUrl,r,i.width,i.height,"9.0.0",null,s,n,o)},setupImage:function(e){this.$markup=t('<a href="'+e.clickUrl+e.clickThruUrl+'" target="_blank"><img src="'+e.imageUrl+'"></a>'),this.$el.append(this.$markup)},setupThirdParty:function(i){var n=document.createElement("iframe");if(n.id=n.name="google_ads_"+i.dfp.ecid,n.src="about:blank",n.width=i.width||0,n.height=i.height||0,n.width&&n.height||(n.style.display="none"),n.scrolling="no",n.marginWidth=0,n.marginHeight=0,n.frameBorder=0,n.className="iab-iframe",this.$el.append('<div class="iab-third-party"></div>'),this.$iabThirdParty=this.$(".iab-third-party"),this.$iabThirdParty[0].appendChild(n),n.doc=null,n.contentDocument?n.doc=n.contentDocument:n.contentWindow?n.doc=n.contentWindow.document:n.document&&(n.doc=n.document),!n.doc)return s.logError("IAB iFrame failed creation, container must be inserted into DOM before creating the iFrame"),t.Deferred().reject();var o="<!doctype html><head><script>window.template = "+JSON.stringify(i)+"; var inDapIF = true; var gnEbMinZIndex = 1; "+i.extraVars+'</script></head><body><script src="'+i.thirdPartyScript+'"></script><script>'+i.scriptOverrides+"</script></body></html>";return i.fullDump&&(o="<!doctype html><head><script>var inDapIF = true; var gnEbMinZIndex = 1;</script></head><body>"+i.thirdPartyTag+"</body></html>"),n.doc.open(),n.doc.write(o),this.$markup=t(n),t.Deferred(function(t){e.defer(function(){t.resolve()})}).promise()},onResize:function(){},onStopToClose:function(){}});return n}),define("partner/ad-position",["jquery","underscore","baseview","utils","admanager","managers/cachemanager","pubsub","partner/iab","adLogger"],function(t,e,i,s,n,o,r,a,l){"use strict";var h=i.extend({$head:t("head"),initialize:function(s){s=t.extend({adSizes:[],adPlacement:null,subSection:null,slotType:"in",adWidth:null,adHeight:null,onAdReady:null,onNoAd:null,beforeAdRender:null},s),this._debounceAdReady=e.debounce(this._adReady,30),this.$el.prop("id")||this.$el.prop("id",e.uniqueId("ad-position-")),i.prototype.initialize.call(this,s),this.tracked=!1,this.adState="pending",this.$el.css({width:"",height:"",display:""});var n=this.$el.closest(".partner-placement");n.attr("data-monetization-id",this.options.adPlacement.replace(/\/.*/,"")),n.attr("data-monetization-sizes",this.options.adSizes.join(","))},render:function(t,i){if(this.options.beforeAdRender&&this.options.beforeAdRender(t,i),i||t){if(this.adType=i,this.adData=t,l.logDebug("AdPosition HighImpact Ad recieved with type: "+i,t),"risingstar"===i||"generic"===i)return this.subviews.partnerView=new a({el:this.$el}),void this.subviews.partnerView.render(t).done(e.bind(function(){this.destroyed||"generic"!==i&&this._adReady()},this));this._renderCustomAd(t)}else this._adReady()},noAd:function(){this.adState="noad",this.options.onNoAd&&this.options.onNoAd()},getAdState:function(){return this.adState},_renderCustomAd:function(i){return i.dfp&&i.dfp.ecid?(i.html&&(this.$adEl=t(t.parseHTML(i.html,document,!0)),this.$el.append(this.$adEl)),i.stylesheet&&(this.$stylesheet=t('<link rel="stylesheet" data-ad-stylesheet="'+i.dfp.ecid+'" href="'+i.stylesheet+'">'),this.$head.append(this.$stylesheet)),void(i.script?(i.el=this.$el,s.requireSingleUseScript(i.script).done(e.bind(function(t){var e=this._getPubSubKey();if(!this.destroyed){i.initialWidth=this.options.adWidth,i.initialHeight=this.options.adHeight,r.on(e,this._debounceAdReady,this);try{this.subviews.partnerView=new t(i)}catch(s){l.logError("AdSlot("+this.options.adUnit+"): ad delivered threw exception on creation",s.stack||s.stacktrace||s.message)}}},this))):this._adReady())):void l.logError("invalid ad returned, no dfp/ecid found",i)},_getPubSubKey:function(){return"partner:"+this.adData.dfp.ecid+":ready"},destroy:function(t){"hasad"===this.adState&&this.$el.css({width:this.getWidth(),height:this.getHeight()}),this.destroyAdPlacement();var e=this.$el.closest(".partner-placement");e.removeAttr("data-monetization-id"),e.removeAttr("data-monetization-sizes"),this.destroyed=!0,i.prototype.destroy.call(this,t)},destroyAdPlacement:function(){this.tracked=!1,this.subviews.partnerView&&(this.stopAd(),this._dispatchToPartner("destroy",!1),this.subviews.partnerView=null),this.adData&&this.adData.script&&r.off(this._getPubSubKey(),this._debounceAdReady,this),this.adType=this.adData=null,this.$adEl?(this.$adEl.remove(),this.$adEl=null):this.$("iframe").remove(),this.$stylesheet&&(this.$stylesheet.remove(),this.$stylesheet=null)},getAdPlacement:function(){var t=this.options.adPlacement;return this.options.subSection&&(t+="/"+this.options.subSection),t},getAdSizes:function(){return this.options.adSizes},getSlotType:function(){return this.options.slotType},_adReady:function(){l.logDebug("AdPosition("+this.getAdPlacement()+") "+this.adType+" ready"),this.adData&&this.adData.script&&r.off(this._getPubSubKey(),this._debounceAdReady,this),this.adState="hasad",this.options.onAdReady?this.options.onAdReady(this.adData,this.adType):"in"===this.options.slotType&&(this.show(),this.playAd())},isAdReady:function(){var t="hasad"===this.adState;return t&&"blank"===s.getNested(this.adData,"adType")?(this.trackAd(),!1):t},getCreativeState:function(t,e){return this.adData&&this.adData.dfp&&this.adData.dfp.ecid?o.getValue("dfpc_"+this.adData.dfp.ecid,t,e):void l.logWarn("Attempted to get state on non high impact ad")},setCreativeState:function(t,e){this.adData&&this.adData.dfp&&this.adData.dfp.ecid?o.setValue("dfpc_"+this.adData.dfp.ecid,t,e):l.logWarn("Attempted to set state on non high impact ad")},getHeight:function(){return this.$el.outerHeight()},getWidth:function(){return this.$el.outerWidth()},showAd:function(t,e){this.$el.show(),this._dispatchToPartner("onShow",t,e),this.trackAd()},resizeAd:function(t,e){this.options.adWidth=t,this.options.adHeight=e,this._dispatchToPartner("onResize",t,e)},setInitialDimensions:function(t,e){this.options.adWidth=t,this.options.adHeight=e},_dispatchToPartner:function(t){var e,i=this.subviews.partnerView;if(i)if(i[t]){e=Array.prototype.slice.call(arguments,1),l.logDebug.apply(l,["AdPosition("+this.getAdPlacement()+") "+t].concat());try{i[t].apply(i,e)}catch(s){l.logError("Ad threw an exception in function "+t,s.stack||s.stacktrace||s.message)}}else l.logWarn("Ad does not implement "+t)},stopAd:function(){this._dispatchToPartner("onStopToClose")},pauseAd:function(){this._dispatchToPartner("onPause")},resumeAd:function(){this._dispatchToPartner("onResume")},trackAd:function(e){var i;if(!this.tracked&&this.adData){if(this.tracked=!0,this.adData.viewUrl){var s=t('<img src="'+this.adData.viewUrl+encodeURIComponent(window.site_static_url+"images/pixels/pixel-transparent.png")+'" style="display:none;">');this.$adEl?this.$adEl.append(s):(this.$adEl=s,this.$el.append(s)),l.logDebug("Fired Tracking Pixel",this.adData.viewUrl)}if("Yes"===this.adData.trackVCE&&this.adData.vCEUrl){e=e||this.$el,i=e.prop("id");var o=this.adData.vCEUrl.replace(/\[domid\]/g,i);n._createScript("vce_"+i,o,e),l.logDebug("Tracked vCE",o)}}},playAd:function(){this.trackAd(),this._dispatchToPartner("onPlay")}});return h}),define("sharedAdPosition",["jquery","underscore","partner/ad-position","utils","admanager"],function(t,e,i,s,n){"use strict";var o=i.extend({initialize:function(e){e=t.extend({adType:null,defaultPosition:!1},e),i.prototype.initialize.call(this,e),n.registerSharedAdPosition(this)},isDefaultPosition:function(){return this.options.defaultPosition},getAdType:function(){return this.options.adType},refreshPosition:function(){n.refreshSharedAdPosition(this.getAdPlacement())},destroy:function(t){i.prototype.destroy.call(this,t),n.destroySharedAdPosition(this)}});return o}),define("partner/slider",["jquery","underscore","baseview","sharedAdPosition"],function(t,e,i,s){"use strict";var n=i.extend({el:".partner-slider-ad",events:{"click .partner-slider-close":"onClickCloseButton"},destroy:function(){this.stopCloseTimer(),this.hide(!0),i.prototype.destroy.call(this,!1)},initialize:function(n){e.bindAll(this,"onAdReady"),n=t.extend({adSizes:["mediumrectangle","halfpage","portrait","filmstrip"],adPlacement:"high_impact"},n),i.prototype.initialize.call(this,n),this.subviews.ad=new s({el:this.$el,adSizes:n.adSizes,adPlacement:n.adPlacement,adType:"slider",defaultPosition:!0,onAdReady:this.onAdReady})},onAdReady:function(){this.subviews.ad.show(),this.show(!0).done(e.bind(function(){this.startCloseTimer()},this))},onClickCloseButton:function(t){t.preventDefault(),this.destroy(!1)},startCloseTimer:function(){var t=window.site_config.ADS.SLIDER.CLOSETIME;t&&(this.closeTimer=setTimeout(e.bind(function(){this.hide()},this),t))},stopCloseTimer:function(){clearTimeout(this.closeTimer)}});return n}),define("partner/overlay-ad-base",["jquery","underscore","pubsub","state","utils","baseview"],function(t,e,i,s,n,o){"use strict";var r=o.extend({events:{"click .partner-close,.ui-film":"onClickCloseButton"},initialize:function(i){i=t.extend({getHeaderOffset:null},i),e.bindAll(this,"onResize"),this.listen(),this.$body=n.get("body"),o.prototype.initialize.call(this,i),this.$placement=this.$(".partner-placement")},showAd:function(){s.setActiveAppFixed(!0),this.showingAd=!0,this.show(!0).done(e.bind(function(){this.subviews.ad&&this.subviews.ad.playAd()},this)),this.$body.addClass("high-impact-ad-visible")},stopAd:function(){this.subviews.ad&&this.subviews.ad.stopAd()},onAdReady:function(t,e){var i=this.subviews.ad;i&&("blank"===e?i.trackAd():this.showAd())},destroy:function(t){this.close(),o.prototype.destroy.call(this,t)},findSizeForAd:function(){var t={adSizeClass:"size-s",adTop:"50%",adHeight:450,adWidth:600},e=0;this.options.getHeaderOffset&&(e=this.options.getHeaderOffset()||0);var i=document.documentElement.clientHeight-e-80,s=document.documentElement.clientWidth-160;return s>1080&&i>810?(t.adSizeClass="size-xl",t.adHeight=810,t.adWidth=1080):s>936&&i>700?(t.adSizeClass="size-l",t.adHeight=700,t.adWidth=936):s>768&&i>576&&(t.adSizeClass="size-m",t.adHeight=576,t.adWidth=768),t.adTop=(document.documentElement.clientHeight-e-t.adHeight)/2+e+"px",t},listen:function(){this.pubSub={},this.pubSub["resize:app"]=this.onResize,this.pubSub["breakingbar:after:open"]=this.onResize,this.pubSub["breakingbar:after:close"]=this.onResize},onClickCloseButton:function(t){t.preventDefault(),this.close(!0)},close:function(t){this.showingAd&&this.subviews.ad&&(this.showingAd=!1,s.clearActiveAppFixed(!0),this.subviews.ad.stopAd(),this.hide(t)),this.$body.removeClass("high-impact-ad-visible")},onResize:function(){var t=this.findSizeForAd();this.$placement.removeClass("size-s size-m size-l size-xl").addClass(t.adSizeClass).css({top:t.adTop}),this.subviews.ad&&this.subviews.ad.resizeAd(t.adWidth,t.adHeight)}});return r}),define("partner/leavebehind",["jquery","underscore","baseview","adLogger","utils"],function(t,e,i,s,n){var o=i.extend({events:{click:"onClick"},initialize:function(n){n=t.extend({template:'<div class="leavebehind-sponsoredby">sponsored by</div><img class="leavebehind-image" src="<%= imageUrl %>" alt="<%= altText %>"/>',onShowAd:null,imageUrl:"",altText:"",isCompact:!0,isNative:!1},n),i.prototype.initialize.call(this,n),this.$el.prop("id")||this.$el.prop("id",e.uniqueId("ad-position-")),s.logDebug("LeaveBehind initialized",this)},destroy:function(){this.hide(),this.$el.removeClass("stag-masthead-logo-clickable"),i.prototype.destroy.call(this,!1)},render:function(t){var i=this.options.expiration,s=isNaN(i)?n.getNested(window.site_vars,"ads","LEAVEBEHIND_EXPIRATION_MINUTES"):i,o=t.getCreativeState({isOpen:!0},s);this.options.isCompact?this.$el.addClass("compact"):this.$el.removeClass("compact"),this.$el.empty().append(e.template(this.options.template,this.options)),this.options.isNative?this.$el.addClass("stag-masthead-logo-clickable"):this.$el.empty().append(e.template(this.options.template,this.options)),o.isOpen?(o.isOpen=!1,t.setCreativeState(o,s),this.options.onShowAd&&this.options.onShowAd()):(this.show(),t.trackAd(this.$el))},show:function(){this.options.isNative||i.prototype.show.call(this)},hide:function(){this.options.isNative||i.prototype.hide.call(this)},onClick:function(){return this.hide(),this.options.onShowAd&&this.options.onShowAd(!0),!1}});return o}),define("partner/overlay-ad-fronts",["jquery","underscore","partner/overlay-ad-base","sharedAdPosition","partner/leavebehind","adLogger"],function(t,e,i,s,n,o){"use strict";var r=i.extend({initialize:function(s){s=t.extend({adSizes:["elastic"],adType:"elastic",adPlacement:"high_impact",isCardBumped:!0,isNative:!1},s),e.bindAll(this,"onAdReady","showAd"),i.prototype.initialize.call(this,s),this.loadAdPlacement(),o.logDebug("Partner Shared Overlay initialized",this)},loadAdPlacement:function(){this.subviews.ad=new s({el:this.$placement,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,adType:this.options.adType,onAdReady:this.onAdReady,beforeAdRender:this.onResize})},onAdReady:function(t){t.leaveBehindImage&&t.leaveBehindText&&this.options.leaveBehindEl?(this.subviews.adLeaveBehind=new n({el:this.options.leaveBehindEl,onShowAd:this.showAd,imageUrl:t.leaveBehindImage,altText:t.leaveBehindText,isCompact:this.options.isCardBumped,isNative:this.options.isNative}),this.subviews.adLeaveBehind.render(this.subviews.ad)):this.showAd()},close:function(){this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.show(),i.prototype.close.apply(this,arguments)}});return r}),define("modules/global/brightcove-video",["jquery","underscore","baseview","pubsub","state","admanager","adLogger","cookie"],function(t,e,i,s,n,o,r){"use strict";var a=i.extend({events:{"click .videoStillPlay":"swapImageForVideo","click .videoStill":"swapImageForVideo","click .videoCloseButton":"hidePlayer"},initialize:function(a){a=t.extend({live:!1,onVideoComplete:null,onVideoShow:null,onVideoHide:null,onVideoLoaded:null},a),this.$videoObj=this.$(".videoObject"),this.$brightcove=this.$(".BrightcoveExperience"),this.brightcoveId=this.$(".BrightcoveExperience").attr("id"),this.playerHTML=this.$videoObj.html();var l=this.$videoObj.data()||{},h=((t.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join(","),c=t.cookie("aam_uuid"),d="";this.pageinfo=n.getActivePageInfo(),this.pageinfo.series&&(d+="&series="+encodeURIComponent(this.pageinfo.series)),this.pageinfo.topic&&(d+="&topic="+encodeURIComponent(this.pageinfo.topic)),d+="&aam="+h+"&u="+c,r.logInfo("Built ad call for video, "+l.id+".",this.pageinfo,l);
var u="http://pubads.g.doubleclick.net/gampad/ads?env=vp&gdfp_req=1&impl=s&output=xml_vast2&iu="+o.buildAdUnit("preroll_video")+"/"+l.cst+"&sz=920x508&unviewed_position_start=1&cust_params=ttid%3D"+l.brightcovevideoid+encodeURIComponent(d)+'&cmsid=12768&url=""';r.logInfo("Video Ad call: "+u),t("<param>",{name:"adServerURL",value:u}).appendTo(this.$(".BrightcoveExperience")),this.$videoObj.length&&this.brightcoveId&&(e.bindAll(this,"createPlayer","onBrightCoveLoad","onTemplateReady","onVideoComplete","onVideoStart","isPlayingHandler","determineCompletion"),this.throttledDetermine=e.throttle(this.determineCompletion,1500),i.prototype.initialize.call(this,a),(this.options.autostart||this.$videoObj.attr("data-autoplay"))&&this.createPlayer(),this._buildBrightCoveLoadCallback(),this.pubSub={"pause:videos":this.pauseVideo},s.attach(this.pubSub,this))},_buildBrightCoveLoadCallback:function(){window.BCCallbacks||(window.BCCallbacks={}),window.BCCallbacks[this.brightcoveId]=this.onBrightCoveLoad,window.BCLoad||(window.BCLoad=function(t){window.BCCallbacks[t]?window.BCCallbacks[t](t):console.log("received brightcove callback for video that does not exist: "+t)})},onBrightCoveLoad:function(t){this.$(".temp-loader").fadeOut(),this.player=window.brightcove.api.getExperience(t),this.APIModules=window.brightcove.api.modules.APIModules,this.player?(console.log("brightcove loaded successfully",this.brightcoveId),this.options.onVideoLoaded&&this.options.onVideoLoaded(this.brightcoveId),this.modVP=this.player.getModule(this.APIModules.VIDEO_PLAYER),this.modCon=this.player.getModule(this.APIModules.CONTENT),this.modExp=this.player.getModule(this.APIModules.EXPERIENCE),this.modExp.addEventListener(window.brightcove.api.events.ExperienceEvent.TEMPLATE_READY,this.onTemplateReady)):console.warn("brightcove video loaded, but could not get experience: "+t)},onTemplateReady:function(){this.modVP&&(this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.BEGIN,this.onVideoStart),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.COMPLETE,this.onVideoComplete),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.PLAY,this.onMediaEventFired),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.STOP,this.onMediaEventFired),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.SEEK_NOTIFY,this.onMediaEventFired),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.PROGRESS,this.throttledDetermine))},onVideoStart:function(t){var e=this.getVideoDetail();e.videoDuration=t.duration<0?"":t.duration<120?"less than 2 min":"greater than 2 min",e.completion="0%",e.videoName=e.liveVideoSubject?e.liveVideoSubject:t.media.displayName,e.eventtype="video:load",e.contentid=t.target.experience.id,e.videoFulllengthUrl=t.media.FLVFullLengthURL,"undefined"!=typeof e.assetid&&t.media.referenceId!==e.assetid.toString()&&(e.assetid=t.media.referenceId,e.ssts=t.media.customFields.gdp_ssts||e.ssts,e.cst=t.media.customFields.gdp_cst||e.cst,e.videocontentprovider=t.media.customFields.gannetttracking+"|"+t.media.displayName,e.keywords=t.media.customFields.gdp_tags||e.keywords,"undefined"!=typeof t.media.customFields.gdp_canonical_url&&(e.pathName=t.media.customFields.gdp_canonical_url.replace(/^.*\/\/[^\/]+/,"")),e=this.setVideoDetailMeta(e)),s.trigger("video:load",e)},onVideoComplete:function(){console.log("video playback finished: "+this.brightcoveId),t.isFunction(this.options.onVideoComplete)&&this.options.onVideoComplete()},onMediaEventFired:function(t){s.trigger("uotrack",t.type)},determineCompletion:function(t){var e=t.duration,i=t.position,n=Math.round(i/e*100);!this.fiftypercent&&n>=50&&95>n?(s.trigger("vitrack","50%"),this.fiftypercent=!0):!this.ninetyfivepercent&&n>=95&&99>n&&(s.trigger("vitrack","95%"),this.ninetyfivepercent=!0)},createPlayer:function(){if(window.brightcove){var t=this.$brightcove;t.params={forceHTML:!1},window.brightcove.createExperiencesPostLoad=function(){},window.brightcove.createExperiences(null,this.brightcoveId),n.stopRefreshTimer(),this.$videoObj.show()}else this.loadScripts(this.createPlayer)},destroy:function(){if(n.startRefreshTimer(),this.brightcoveId&&window.brightcove&&(this.player||window.brightcove.api&&(this.player=window.brightcove.api.getExperience(this.brightcoveId)),this.player&&(this.modVP||(this.modVP=this.player.getModule(window.brightcove.api.modules.APIModules.VIDEO_PLAYER)),this.modVP&&this.resetVideoState()),window.brightcove&&(window.brightcove.experiences&&delete window.brightcove.experiences[this.brightcoveId],window.brightcove.instances&&delete window.brightcove.instances[this.brightcoveId])),window.BCCallbacks){if(window.BCCallbacks[this.brightcoveId]&&delete window.BCCallbacks[this.brightcoveId],0===e.size(window.BCCallbacks)){window.BCCallbacks=void 0,window.BCLoad=void 0;try{delete window.BCCallbacks,delete window.BCLoad}catch(t){}}}else console.warn("BCCallbacks no longer available on video destroy");i.prototype.destroy.apply(this,arguments)},resetVideoState:function(){this.player&&(this.modVP&&(this.pauseVideo(),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.BEGIN,this.onVideoStart),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.COMPLETE,this.onVideoComplete),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PLAY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.STOP,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.SEEK_NOTIFY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PROGRESS,this.throttledDetermine),this.modVP=!1,this.modCon=!1,this.modExp=!1),this.player=!1),this.$(".videoStill, .videoStillPlay").show(),this.$videoObj.html(this.playerHTML),this.hidePlayer()},hidePlayer:function(){this.$videoObj&&this.$videoObj.hide(),this.options.onVideoHide&&this.options.onVideoHide(),n.startRefreshTimer()},loadScripts:function(t){require(["http://admin.brightcove.com/js/BrightcoveExperiences.js"],function(){"undefined"!=typeof window.brightcove?(console.log("Brightcove loaded"),t()):console.log("Error loading Brightcove")})},swapImageForVideo:function(){this.createPlayer(),this.options.onVideoShow&&this.options.onVideoShow(),this.$(".videoStill, .videoStillPlay").hide(),this.$(".temp-loader").show(),s.trigger("video:playClick")},getVideoDetail:function(){var t=this.$videoObj.data()||{};return t.pathName="",t.liveVideoSubject?t.pathName=t.liveVideoSubject:t.videourl&&(t.pathName=t.videourl.replace(/^.*\/\/[^\/]+/,"")),this.setVideoDetailMeta(t)},setVideoDetailMeta:function(t){try{t.cst||(t.cstlist=t.cst.split("/"),t.category=t.cstlist[0],t.cst=t.cstlist.slice(0,3).join(":"),t.subcategory=t.cstlist.slice(0,2).join(":")),t.sstslist||(t.sstslist=t.ssts.split("/"),t.section=t.sstslist[0],t.ssts=t.sstslist.join(":"),t.subsection=t.sstslist.slice(0,2).join(":"),t.topic=t.sstslist.slice(0,3).join(":"))}catch(e){return void console.error("Invalid page",e.stack||e.stacktrace||e.message)}return t},pauseVideo:function(){void 0!==this.modVP&&this.modVP.pause(!0)},isPlayingHandler:function(t){this.options.live||t&&this.modVP.pause(!0)},loadVideoById:function(t){this.modVP.loadVideoByID(t)}});return a}),define("apps/stag-front",["jquery","underscore","backbone","utils","state","site-manager","pubsub","base-app","sharedAdPosition","partner/slider","partner/overlay-ad-fronts","modules/global/brightcove-video"],function(t,e,i,s,n,o,r,a,l,h,c,d){"use strict";var u=a.extend({el:".cards.stag",afterPageReveal:function(t){this._initializeTopic(t,"stag")},_initializeTopic:function(){var e=this;this.isNative=this.$el.hasClass("stag-native"),this.subviews.video=[],t(".stag.hero .video").each(function(){var i=new d({el:t(this).parent().get(0)});e.subviews.video.push(i)}),this.subviews.overlayAd=new c({el:this.$(".partner-overlay"),leaveBehindEl:this.$(this.isNative?".stag-masthead-logo":".partner-leavebehind"),isCardBumped:!1,isNative:this.isNative,getHeaderOffset:function(){var t=o.getHeader();return t?t.getExpandedHeight():0}}),this.subviews.genericad=new l({el:"#ad-staging",adSizes:["generic"],adPlacement:"high_impact",adType:"generic"}),this.$(".hero-1up").length<1&&(this.subviews.sliderad=new h)}});return u}),define("modules/global/footer",["jquery","underscore","baseview","easing","pubsub","utils"],function(t,e,i,s,n,o){var r=i.extend({events:{"click .site-index":"toggle","click .footer-more-trigger":"showMore"},initialize:function(t){this.$scrollEl=o.get("scrollEl"),this.$nav=this.$("nav"),this.$toggle=this.$(".site-index"),i.prototype.initialize.call(this,t)},showMore:function(e){e.preventDefault();var i=t(e.currentTarget);i.hide().siblings(".footer-more-item").show()},toggle:function(t){t&&t.preventDefault();var e=this.$el.offset().top-(o.get("headerHeight")||0);this.$toggle.toggleClass("open"),this.$scrollEl.animate({scrollTop:e},500,"easeInOutCubic"),this.$nav.slideToggle(500,"easeInOutCubic")}});return r}),define("ui/button-toggle",["jquery","underscore","baseview"],function(t,e,i){"use strict";var s=i.extend({initialize:function(s){s=t.extend({onSelect:null},s),i.prototype.initialize.call(this,s),this.toggleItems=this.$(".ui-button-toggle-item"),this.toggleItems.on("click."+this.cid,e.bind(function(e){this.onClick(t(e.currentTarget))},this))},onClick:function(t){t.hasClass("active")||(this.toggleItems.removeClass("active"),t.addClass("active"),this.options.onSelect&&this.options.onSelect(t))},destroy:function(t){this.toggleItems.off("."+this.cid),i.prototype.destroy.call(this,t)}});return s}),define("modules/fronts/headline-grid",["jquery","underscore","backbone","state","pubsub","utils","baseview","ui/button-toggle"],function(t,e,i,s,n,o,r,a){"use strict";var l=r.extend({events:{"click .button-add-content":"showMore"},initialize:function(t){this.$button=this.$(".button-add-content"),r.prototype.initialize.call(this,t),e.bindAll(this,"transitionMore","toggleGridListView");var i=this.$(".headline-toggler");i.length&&(this.subviews.gridListViewToggler=new a({el:i,onSelect:this.toggleGridListView}))},getMoreHeadlines:function(t,i){s.fetchHtml(window.location.pathname+t+"/").done(e.bind(function(t){var e=t.find(".headline-page").removeClass("active").addClass("inactive"),s=t.find(".button-add-content");this.$(".headline-collection").append(e),s.length>0?this.$(".headlines-show-more").empty().append(s):this.$button.addClass("inactive"),i(e)},this)).fail(e.bind(function(){var t=this.$button.attr("data-default");this.$button.removeClass("loading").addClass("inactive").text(t)},this))},showMore:function(e){if(t(e.target).hasClass("inactive"))return!1;this.$button=t(".button-add-content",this.el),this.$button.addClass("loading").text(this.$button.attr("data-loading"));var i;if(this.$el.hasClass("stagfront-primary")&&!this.$(".front-headlines-header").hasClass("staff")){var s=parseInt(t(e.target).data("next"),10);this.getMoreHeadlines(s,this.transitionMore)}else{i=this.$(".headline-page.active:last").next();var r,a=i.attr("data-itemnum"),l=i.attr("data-items-per-page"),h=Math.round(a/l),c=t(".headline-collection");r=c.hasClass("listview")?"data-list-src":"data-grid-src",o.lazyLoadImage(i.find("img"),r,!0),n.trigger("uotrack",o.getSectionPath(window.location.pathname)+"morestories"+h),this.transitionMore(i)}e.preventDefault()},toggleGridListView:function(t){var e=this.$(".headline-collection"),i=t.hasClass("grid-big")?"grid-big":"list-big";"list-big"===i?(e.addClass("listview"),n.trigger("uotrack","listview"),o.lazyLoadImage(this.$("img"),"data-list-src",!0)):(e.removeClass("listview"),n.trigger("uotrack","gridview"),o.lazyLoadImage(this.$("img"),"data-grid-src",!0))},transitionMore:function(e){var i,s=t(".headline-collection");Modernizr.csstransitions?e.removeClass("inactive").addClass("active"):e.animate({"max-height":"5000px"},200,function(){t(this).removeClass("inactive").addClass("active").css("max-height","")}),this.$(".headline-page.inactive").length<=0&&this.$button.addClass("inactive"),i=s.hasClass("listview")?"data-list-src":"data-grid-src",o.lazyLoadImage(e.find("img"),i,!0),this.$button.removeClass("loading").text(this.$button.attr("data-default")),n.trigger("showmore:headlines")}});return l}),define("directAdPosition",["jquery","underscore","partner/ad-position","state","admanager"],function(t,e,i,s,n){"use strict";var o=i.extend({initialize:function(e){e=t.extend({targeting:{},subSection:s.getActivePageInfo().cst,slotType:"in"},e),i.prototype.initialize.call(this,e),"in"==e.slotType&&this.refreshPosition()},prefetchAd:function(){return this.subviews.adSlot?!1:(this.adSlotPlacement=this.getAdPlacement(),this.subviews.adSlot=n.getAdSlot(this.adSlotPlacement,this.options.targeting,this.options.adSizes,this,this.options.slotType),!0)},setTargeting:function(t){this.options.targeting=t,this.subviews.adSlot&&this.subviews.adSlot.setTargeting(this.options.targeting)},destroy:function(){this.destroyAdSlot(),i.prototype.destroy.apply(this,arguments)},destroyAdSlot:function(){this.subviews.adSlot&&(this.subviews.adSlot.destroy(),this.subviews.adSlot=null)},setPageInfo:function(e){e.cst&&this.setSubSection(e.cst),this.setTargeting(t.extend(n.getPageAdTargeting(e),this.options.targeting))},setSubSection:function(t){this.options.subSection=t},refreshPosition:function(){this.adState="pending",this.subviews.adSlot&&this.adSlotPlacement!==this.getAdPlacement()&&(this.destroyAdPlacement(),this.destroyAdSlot()),this.prefetchAd()||(this.destroyAdPlacement(),this.subviews.adSlot.refresh())}});return o}),define("uiPageTurn",["jquery","transformSupport"],function(t){"use strict";var e="uiPageTurn",i={useTransforms:!!t.support.css.transform,fallback:"crossfade",pageSelector:".ui-page-turn",placerSelector:".ui-placer",transitionTiming:"linear",turnDuration:300,perspective:"2200px",slideDuration:200,fadeDuration:200,shadow:!0,shadowOpacity:.7,onPageTurn:function(){}},s={init:function(s){return this.each(function(){var n=t(this),o=t.extend({},i,s),r=n.find(o.pageSelector+".active");0===r.length&&(r=n.children(":first")),r.next(o.pageSelector).addClass("preload"),n.data(e,{currentPage:r,busy:!1,settings:o})})},option:function(t,i){var s=this.data(e);if(s&&t){if(!i)return s[t];("function"==typeof i||"onPageTurn"!==t)&&(s[t]=i)}},nextPage:function(t,i){var s=this.data(e),o=s.settings,r=s.currentPage,a=r.next(o.pageSelector);return n.transition(this,r,a,!1,o,s,t,i)},prevPage:function(t,i){var s=this.data(e),o=s.settings,r=s.currentPage,a=r.prev(o.pageSelector);return n.transition(this,r,a,!0,o,s,t,i)},goToPage:function(i,s,o){var r=this.data(e),a=r.settings,l=r.currentPage,h=this.children(a.pageSelector),c=h.eq(i),d=h.index(l);return d===i?t.Deferred().reject():n.transition(this,l,c,d>i,a,r,s,o)},getCurrentPage:function(){var t=this.data(e);return t.currentPage}},n={transition:function(e,i,s,o,r,a,l,h){var c;return!s.length||a.busy?t.Deferred().reject():l?(n.finishTransition(i,s,o,r,a),t.Deferred().resolve()):(a.busy=!0,s.removeClass("preload"),c=!h&&r.useTransforms?n.flipTransform(e,i,s,o,r):"slide"===r.fallback?n.slideTransition(i,s,o,r):n.fadeTransition(i,s,r),c.done(function(){n.finishTransition(i,s,o,r,a)}),c)},finishTransition:function(t,e,i,s,n){s.onPageTurn(e),n.busy=!1,t.removeClass("active"),e.addClass("active"),i?e.prev(s.pageSelector).addClass("preload"):e.next(s.pageSelector).addClass("preload"),n.currentPage=e},flipTransform:function(e,i,s,o,r){i.removeClass("active");var a=i.clone(),l=s.clone(),h=t('<div class="ui-shadow"></div>'),c=t('<div class="ui-shadow"></div>'),d=t('<div class="ui-page-turn-animator"></div>');r.shadow&&(s.append(h),i.append(c),h.css({opacity:r.shadowOpacity}),c.css({opacity:0})),d.append(a),d.append(l),e.append(d),o?(i.addClass("right"),s.addClass("left"),l.addClass("right"),a.addClass("left")):(i.addClass("left"),s.addClass("right"),l.addClass("left"),a.addClass("right")),n.setupTransition(e[0],d[0],a[0],l[0],o,r);var u=t.Deferred();return t.support.css.transition.registerTransitionEndListener(d[0],u).done(function(){c.remove(),h.remove(),d.remove(),s.removeClass("left right"),i.removeClass("left right"),e[0].style[t.support.css.transform.perspectiveCssName]="",e[0].style[t.support.css.transform.styleCssName]=""}),setTimeout(function(){var e=o?"rotateY(180deg)":"rotateY(-180deg)";d[0].style[t.support.css.transform.cssName]=e,r.shadow&&(h[0].style[t.support.css.transition.cssName]=n.getTransitionStyle("opacity",r.turnDuration/2,r.transitionTiming),c[0].style[t.support.css.transition.cssName]=n.getTransitionStyle("opacity",r.turnDuration/2,r.transitionTiming,r.turnDuration/2),h.css({opacity:0}),c.css({opacity:r.shadowOpacity}))},20),u.promise()},slideTransition:function(e,i,s,o){if(i.addClass("active"),e.css({left:"0%"}),i.css(s?{left:"-100%"}:{left:"100%"}),t.support.css.transition){var r=n.getTransitionStyle("left",o.slideDuration,o.transitionTiming);return i[0].style[t.support.css.transition.cssName]=r,e[0].style[t.support.css.transition.cssName]=r,setTimeout(function(){i.css({left:"0%"}),e.css({left:s?"100%":"-100%"})},20),t.support.css.transition.registerTransitionEndListener(i[0])}return e.animate({left:s?"100%":"-100%"},o.slideDuration,o.transitionTiming),i.animate({left:"0%"},o.slideDuration,o.transitionTiming).promise()},fadeTransition:function(t,e,i){t.css({opacity:1,"z-index":11}).show(),e.css({opacity:1,"z-index":10}).show();var s=t.fadeOut(i.fadeDuration).promise();return s.done(function(){t.css({"z-index":""}),e.css({"z-index":""})}),s},getTransitionStyle:function(t,e,i,s){var n=t+" "+e+"ms "+i;return s&&(n+=" "+s+"ms"),n},setupTransition:function(e,i,s,o,r,a){e.style[t.support.css.transform.perspectiveCssName]=a.perspective,e.style[t.support.css.transform.styleCssName]="preserve-3d",i.style[t.support.css.transform.styleCssName]="preserve-3d",i.style[t.support.css.transform.perspectiveCssName]=a.perspective,i.style[t.support.css.transition.cssName]=n.getTransitionStyle(t.support.css.transform.cssHyphenName,a.turnDuration,a.transitionTiming),s.style[t.support.css.transform.styleCssName]="preserve-3d",s.style[t.support.css.transform.cssName]="rotateY(0deg)",s.style[t.support.css.transform.backfaceVisibilityCssName]="hidden",o.style[t.support.css.transform.styleCssName]="preserve-3d",r?(s.style[t.support.css.transform.originCssName]="right center",o.style[t.support.css.transform.originCssName]="left center",o.style[t.support.css.transform.cssName]="rotateY(-180deg) translateZ(1px)"):(s.style[t.support.css.transform.originCssName]="left center",o.style[t.support.css.transform.originCssName]="right center",o.style[t.support.css.transform.cssName]="rotateY(180deg) translateZ(1px)")}};t.fn.uiPageTurn=function(e){return s[e]?s[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.uiPageTurn"):s.init.apply(this,arguments)}}),define("apps/bigpage",["jquery","underscore","backbone","site-manager","pubsub","utils","state","admanager","base-app","directAdPosition","uiPageTurn"],function(t,e,i,s,n,o,r,a,l,h){var c=l.extend({el:"#cover-view",events:{"click .big-page-prev":"prevSlide","click .ui-page-turn":"palmSlide","click .big-page-next":"nextSlide"},initialize:function(i){i=t.extend(!0,{animation:{slideDuration:350}},i),e.bindAll(this,"keyboardShortcuts","onPageTurn","resizeHandler","moveSlide","playAd"),this.$body=o.get("body"),this.$top=o.get("scrollEl"),this.$doc=o.get("doc"),this.$win=o.get("win"),this.$adContents=this.$(".partner-coverview-contents"),this.flipTransformStyle=this.transformCssHyphenName+" "+i.animation.slideDuration+"ms linear";var s=e.throttle(this.resizeHandler,50);this.$win.on("resize."+this.cid,s),l.prototype.initialize.call(this,i)},resizeHandler:function(){if(this.$pages){var e=this.$win.width(),i=this.$win.height()-40;e%2?this.$pages.addClass("width-wiggler"):this.$pages.removeClass("width-wiggler"),this.$adContents.css({width:e+"px",top:40,height:i+"px"}),t.each(this.subviews,function(t,s){0===t.indexOf("ad_")&&s.resizeAd(e,i)})}},palmSlide:function(e){var i=t(e.target);if(!(i.hasClass("load-story")||i.hasClass("parent-label")||i.closest(".partner-placement").length)){var s=e.screenX,n=this.$win.width()>>1;s>n?this.nextSlide(e):this.prevSlide(e)}},prevSlide:function(t){t&&t.preventDefault(),this.moveSlide(-1),n.trigger("heattrack","thebigpageleft")},nextSlide:function(t){t&&t.preventDefault(),this.moveSlide(1),n.trigger("heattrack","thebigpageright")},moveSlide:function(t){var e=this.$pages.uiPageTurn("getCurrentPage").index(),i=e+t,s=!1,n=this.playAd;this.isIndexAd(i)?(s=this.isAdReady(i),s||(i+=t)):this.prepareNextAd(e),r.registerAnimation(this.$pages.uiPageTurn("goToPage",i)).done(function(){s&&n(i)})},animateRevealApp:function(){return s.getHeader().setClosedFixed(),l.prototype.animateRevealApp.apply(this,arguments)},playAd:function(t){var e=this.subviews["ad_"+t];e&&(e.playAd(),e.show())},fetchAd:function(t){var e,i,s=this.$pagesChildren.eq(t),n=o.getNested(window,"site_vars","aws_site_name")||"usat",r=s.find(".partner-coverview-contents");return e=this.getPageInfo(s.prev()),this.subviews["ad_"+t]=i=new h({el:r,adPlacement:"coverview/"+e.cst,adSizes:["coverviewfullpage"],targeting:{sitePage:n+"/"+(e.ssts||"").replace(/\/\/*$/,"")},slotType:"out"}),i.prefetchAd(),this.resizeHandler(),!0},beforeOverlayRemove:function(){s.getHeader().setClosedFixed()},afterOverlayReveal:function(){var t=s.getHeader();t&&(t.setFixingScroller(!0),t.scrollTop(0))},afterAppRemove:function(){s.getHeader().restoreDefaultState()},getNextAdIndex:function(t){return this.$pagesChildren.eq(t).nextAll(".partner-placement").first().index()},checkIfAdHasBeenFetched:function(t){t>0&&!this.subviews["ad_"+t]&&this.fetchAd(t)},isIndexAd:function(t){return this.$pagesChildren.eq(t).hasClass("partner-placement")},prepareNextAd:function(t){var e=this.getNextAdIndex(t);this.checkIfAdHasBeenFetched(e)},isAdReady:function(t){var e=this.subviews["ad_"+t];return e?e.isAdReady():!1},slideTransition:function(t,i){t.addClass("active"),i?t.css("left","100%"):t.css("left","-100%"),this.animate(t,"left",0,this.options.animation.slideDuration,"linear").done(e.bind(function(){this.$activePage=t,this.busy=!1},this)),this.$activePage.css("left","0%"),this.animate(this.$activePage,"left",i?"-100%":"100%",this.options.animation.slideDuration,"linear")},setFixedPosition:function(){l.prototype.setFixedPosition.call(this,0)},keyboardShortcuts:function(t){t.target===this.$body[0]&&(37===t.which?this.prevSlide(t):39===t.which&&this.nextSlide())},afterPageReveal:function(){this.$prev=this.$(".big-page-prev"),this.$next=this.$(".big-page-next"),this.$pages=this.$("#cover-view-pages"),this.$pagesChildren=this.$pages.children(),this.$pages.uiPageTurn({onPageTurn:this.onPageTurn,turnDuration:600,fallback:"slide",shadow:!1}),this.resizeHandler(),this.$doc.on("keyup."+this.cid,this.keyboardShortcuts),this.trackPageChange(this.$(".ui-page-turn.active"))},onPageTurn:function(t){t.prev(".ui-page-turn").length?this.$prev.show():this.$prev.hide(),t.next(".ui-page-turn").length?this.$next.show():this.$next.hide(),this.trackPageChange(t)},trackPageLoad:function(){},trackPageChange:function(t){this.pageInfo=this.getPageInfo(t),n.trigger("page:load",this.pageInfo)},getPageInfo:function(t){var e,i=t.find(".coverInfo").html()||"{}";try{e=JSON.parse(i)}catch(s){console.error("could not get current asset page info",s.stack||s.stacktrace||s.message)}return e||{}},pause:function(){this.$doc.off("."+this.cid),l.prototype.pause.apply(this,arguments)},destroy:function(){this.$doc.off("."+this.cid),this.$win.off("."+this.cid),l.prototype.destroy.apply(this,arguments)}});return c}),function(){var t={},e={};document.writeln=(self.console||{}).log||function(){},document.write=function(){for(var i in t)if(t.hasOwnProperty(i))try{t[i].apply({},arguments)}catch(s){}for(var n=Array.prototype.join.call(arguments,""),o="<script[^<>]*src=['\"]?([^'\"<> :/]*:*//[a-z0-9.]*google.com/[^'\"<> ]*)['\"]?[^<>]*>[^<>]*</script>",r=new RegExp(o,"gi"),a=new RegExp(o,"i"),l=n.match(r)||[],h=0;h<l.length;h++)l[h].match(a),$.ajax({cache:!0,dataType:"script",success:function(){for(var t in e)if(e.hasOwnProperty(t))try{e[t].apply({},arguments)}catch(i){}},url:RegExp.$1}),n=n.replace(l[h],"");if(!n.match(/^\s*$/))try{console.log("document.write ignoring ",n)}catch(s){}},document.addOnWrite=function(e,i){"function"==typeof i&&(t[e]||(t[e]=i))},document.addOnScript=function(t,i){"function"==typeof i&&(e[t]||(e[t]=i))},document.delOnWrite=function(e){delete t[e]||(t[e]=void 0)},document.delOnScript=function(t){delete e[t]||(e[t]=void 0)}}(),define("global/document-write",function(){}),define("apps/search",["jquery","underscore","backbone","pubsub","utils","base-app","state","site-manager","global/document-write"],function(t,e,i,s,n,o,r,a){var l=o.extend({el:".search-results",events:{"click .grid-btn":"gridView","click .list-btn":"listView"},initialize:function(i){i=t.extend(!0,{delay:{playlistAutoClose:250},animations:{open:{duration:250,easing:"ease-in-out"},close:{duration:250,easing:"ease-in-out"}}},i),this.win=n.get("win"),this.body=n.get("body"),this.scrollEl=n.get("scrollEl"),this.header=a.getHeader(),e.bindAll(this,"lazyload"),this.currentView="view-grid",this.init=!1,this.requestInProgress=!1,this.win.on("scroll."+this.cid,e.throttle(this.lazyload,200)),t(".site-masthead-search-close-btn").addClass("site-masthead-search-close-btn-visible"),o.prototype.initialize.call(this,i)},getRevealAppLoader:function(){return'<article class="search-results ui-loading dark-medium"></article>'},isSearchPage:!0,animateRevealApp:function(i){if(null===i)return t.Deferred().resolve();this.$("#search-form").css("height",""),this.header.setOpenFixed(),this.$el.css({opacity:1,display:"block",top:"-100%",height:"100%"});var s=this.animate(this.$el,"top","0%",this.options.animations.open.duration,this.options.animations.open.easing);return s.done(e.bind(function(){this.body.addClass("show-search"),this.$el.css({height:"",top:""})},this)),s},animateRemoveApp:function(){var t=n.getScrollPosition();return this.$el.css({marginTop:-1*t,height:this.win.height()+t}),this.$(".summary").css("position","absolute"),this.header.scrollTop(0),this.body.removeClass("show-search"),this.animate(this.$el,"top","-100%",this.options.animations.close.duration,this.options.animations.close.easing)},beforeOverlayRemove:function(){this.header.setOpenFixed()},afterOverlayReveal:function(){this.header.setFixingScroller(!0),this.header.scrollTop(0)},afterAppRemove:function(){this.header.restoreDefaultState(),t(".site-masthead-search-close-btn").removeClass("site-masthead-search-close-btn-visible"),s.trigger("uotrack","searchResultsclose")},afterPageReveal:function(t){this.init||(this.init=!0,this.originalPath=t),this.moreResultsPlacer=this.$(".more-results"),this.lazyload(),this.searchWrap=this.$("#search-form"),this.searchTextInput=this.searchWrap.find(".text-input"),this.setup(),this.setupTextAd()},getMoreResults:function(t){return this.requestInProgress=!0,this.moreResultsPlacer.show(),r.fetchHtml(t).done(e.bind(function(t){this.moreResultsPlacer.parent().append(t),this.moreResultsPlacer.remove(),this.moreResultsPlacer=this.$(".more-results")},this)).fail(e.bind(function(){this.moreResultsPlacer.remove(),this.moreResultsPlacer=null},this)).always(e.bind(function(){this.requestInProgress=!1},this)),!1},getTerm:function(){return t(".search-term .term",this.$el).attr("data-term")},setup:function(){this.results=this.$(".results"),this.summary=this.$(".summary"),this.sidebar=this.$(".sidebar"),this.viewGrid=this.$(".grid-btn"),this.viewList=this.$(".list-btn"),"view-list"===this.currentView&&this.listView()},setupTextAd:function(){var e=this.getTerm(),i="partner_search_text_ads"+(new Date).getTime();t(".tile.ad",this.$el).attr("id",i);var s={pubId:"partner-usatoday_js",query:e,hl:"en"},n={container:i,lines:"3",fontFamily:"arial",fontSizeTitle:"13px",fontSizeDescription:"12px",fontSizeDomainLink:"12px",colorTitleLink:"1EA3FF",colorText:"FFFFFF",colorDomainLink:"00C641",colorBackground:"2C2C2C"};this.loadGoogleSearchAds(s,n)},gridView:function(){return this.viewGrid.addClass("active"),this.viewList.removeClass("active"),this.summary.removeClass("list").addClass("grid"),this.results.removeClass("view-list").addClass("view-grid"),this.currentView="view-grid",t(".ad").appendTo(".sidebar"),!1},listView:function(){return this.viewList.addClass("active"),this.viewGrid.removeClass("active"),this.summary.removeClass("grid").addClass("list"),this.results.removeClass("view-grid").addClass("view-list"),this.currentView="view-list",t(".ad").prependTo(".list-content"),!1},lazyload:function(){if(this.init&&this.moreResultsPlacer&&this.moreResultsPlacer.length&&!this.requestInProgress){var t=n.getScrollPosition(),e=this.body.height();this.moreResultsPlacer.offset().top<=t+e&&this.getMoreResults(this.moreResultsPlacer.data("href"))}},loadGoogleSearchAds:function(t,e){var i=!1,s=function(){return i?(document.delOnWrite("searchads"),void document.delOnScript("searchads")):void(window.google&&window.google.ads&&window.google.ads.search&&window.google.ads.search.Ads&&(i=new window.google.ads.search.Ads(t,e),document.delOnWrite("searchads"),document.delOnScript("searchads")))};s()||(document.addOnWrite("searchads",s),document.addOnScript("searchads",s),r.fetchData("http://www.google.com/adsense/search/ads.js",{cache:!0,dataType:"script",success:s}))},destroy:function(){document.delOnWrite("searchads"),document.delOnScript("searchads"),this.win.off("."+this.cid),o.prototype.destroy.apply(this,arguments)}});return l}),define("form/base-form-element",["jquery","underscore","baseview"],function(t,e,i){"use strict";var s=i.extend({getFormElement:function(){return this.$el},getUIElement:function(){return this.$el},getType:function(){return""},reset:function(){},isRequired:function(){var t=this.getFormElement().attr("required");return"required"===t||t}});return s}),define("form/input-field",["jquery","underscore","form/base-form-element"],function(t,e,i){"use strict";var s=i.extend({events:{focus:"onInputFocus",blur:"onInputBlur",keyup:"onKeyPress"},initialize:function(e){e=t.extend({onValueChange:null},e),i.prototype.initialize.call(this,e),this.isInputField="input"===(this.$el.prop("tagName")||"").toLowerCase()?!0:!1,this.hasPlaceHolderNativeSupport=Modernizr.input.placeholder?!0:!1,this.placeholder=this.$el.attr("placeholder"),this.setup()},setup:function(){this.placeholder&&this.showPlaceHolder(),this.$el.data("clearable")&&this.isInputField&&this._setupClearButton()},showPlaceHolder:function(){this.hasPlaceHolderNativeSupport||(this.setInputValue(this.placeholder),this.$el.addClass("ui-text-input-placeholder"))},clearPlaceHolder:function(){this.hasPlaceHolderNativeSupport||(this.clearInputValue(),this.$el.removeClass("ui-text-input-placeholder"))},getInputValue:function(){var t=this.$el.val();return t===this.placeholder&&(t=""),t},clearInputValue:function(){var t=this.getInputValue();this.$el.val(""),t&&this._triggerValueChange()},setInputValue:function(t){this.$el.val(t),this._triggerValueChange()},_setupClearButton:function(){this.clearButton=t('<div class="ui-text-input-clear-btn" style="display:none"></div>'),this.$el.parent().append(this.clearButton),this.clearButton.on("mousedown."+this.cid,e.bind(function(t){this.onClearButtonClick(t)},this))},onInputFocus:function(){var t=this.getInputValue();t?this.clearButton&&this.clearButton.show():this.clearPlaceHolder()},onInputBlur:function(){this.getInputValue()||this.reset(),this.clearButton&&this.clearButton.hide()},_triggerValueChange:function(){var t=this.getInputValue();this.clearButton&&(t?this.clearButton.show():this.clearButton.hide()),this.options.onValueChange&&this.options.onValueChange(t)},resetInput:function(){this.reset()},reset:function(){this.clearInputValue(),this.placeholder&&this.showPlaceHolder(),this.clearButton&&this.clearButton.hide()
},onKeyPress:function(){clearTimeout(this.keyPressDelay),this.keyPressDelay=setTimeout(e.bind(function(){this._triggerValueChange()},this),1)},getType:function(){return"input"},onClearButtonClick:function(t){t.preventDefault(),this.clearInputValue(),this.clearButton.hide(),this.$el.focus()},destroy:function(t){this.clearButton&&(this.clearButton.off("."+this.cid),this.clearButton.remove()),i.prototype.destroy.call(this,t)}});return s}),define("form/autocomplete",["jquery","underscore","form/base-form-element","state","form/input-field"],function(t,e,i,s,n){"use strict";var o=i.extend({events:{"keydown .ui-text-input":"onKeyDown","paste .ui-text-input":"updateResults",focusout:"onInputBlur","mousedown .ui-autocomplete-result-item":"onMouseDownResultItem","mouseenter .ui-autocomplete-result-item":"onResultMouseEnterLeave","mousedown .ui-text-input-clear-btn":"onClearButtonClick"},initialize:function(s){s=t.extend({url:this.$el.data("autocomplete-url"),ajaxOptions:null,ajaxQueryKey:"query",resultDisplayTemplate:null,resultValueTemplate:null,onError:null,onSelect:null,maxResults:4,onShowResults:null,onParseResults:null,onValueChange:null},s),this.inputField=this.$el,this.setElement(this.$el.parent(),!1),this.autoCompleteResultsContainer=t('<ul class="ui-autocomplete-result-container"></ul>'),this.autoCompleteContent=t('<div class="ui-autocomplete-content"></div>'),this.autoCompleteContent.append(this.autoCompleteResultsContainer),this.$el.append(this.autoCompleteContent),e.bindAll(this,"updateResults","showResult","clearResults"),i.prototype.initialize.call(this,s),this.subviews.inputField=new n({el:this.inputField,onValueChange:this.options.onValueChange})},updateAjaxOptions:function(e){t.extend(!0,this.options.ajaxOptions,e)},updateResults:function(){clearTimeout(this.keyPressDelay),this.keyPressDelay=setTimeout(e.bind(function(){var t=this.inputField.val();this.fetcher&&this.fetcher.abort(),t.length?this.fetcher=this._fetchResults(t):this.clearResults()},this),1)},onResultMouseEnterLeave:function(e){var i=t(e.target);i.hasClass("hover")||(this.autoCompleteResultsContainer.find(".ui-autocomplete-result-item").removeClass("hover"),i.addClass("hover"))},onInputBlur:function(){this.clearResults(),this.fetcher&&this.fetcher.abort()},onMouseDownResultItem:function(e){3!==e.which&&this._processSelectedItem(t(e.currentTarget))},onKeyDown:function(t){var e=t.keyCode?t.keyCode:t.which,i=this.autoCompleteResultsContainer.find(".ui-autocomplete-result-item"),s=i.filter(".ui-autocomplete-result-hover");9!==e&&(38===e||40===e?(t.preventDefault(),i.length&&this.onResultItemUpDownArrowKeyPress(e,s)):13===e?s.length?(t.preventDefault(),this._processSelectedItem(s)):this.clearResults():32===e&&s.length?this._processSelectedItem(s):this.updateResults())},onResultItemUpDownArrowKeyPress:function(t,e){var i=this.autoCompleteResultsContainer.find(".ui-autocomplete-result-item");i.removeClass("ui-autocomplete-result-hover"),38===t?e.length&&this.inputField.val()!==this.currentInputFieldValue?e.prev().length?this.hoverResultItem(e.prev()):this.inputField.val(this.currentInputFieldValue):this.hoverResultItem(i.last()):e.length?e&&e.next().length?this.hoverResultItem(e.next()):this.inputField.val(this.currentInputFieldValue):this.hoverResultItem(i.first())},hoverResultItem:function(t){t.addClass("ui-autocomplete-result-hover"),this.inputField.val(t.text())},getUIElement:function(){return this.inputField},getFormElement:function(){return this.inputField},reset:function(){this.clearResults(),this.subviews.inputField.reset()},resetInput:function(){this.reset()},showResult:function(e,i,s){var n=t('<li class="ui-autocomplete-result-item"></li>');n.text(e),n.data("value",i),s&&n.data("result",s),this.autoCompleteResultsContainer.append(n)},clearResults:function(){this.autoCompleteResultsContainer.empty()},onClearButtonClick:function(){this.clearResults()},_processSelectedItem:function(t){var e=t.data("value")||t.text(),i=t.data("result");this.inputField.val(e),this.clearResults(),this.options.onSelect&&this.options.onSelect(e,i)},_getFetchAjaxOptions:function(i){var s=t.extend(!0,{},this.options.ajaxOptions),n={},o=s.url||this.options.url;return-1!==o.indexOf("<%=")?s.url=e.template(o,{query:i}):(n[this.options.ajaxQueryKey]=i,s=t.extend(!0,{url:o,data:n},s)),s},_fetchResults:function(i){var n=this._getFetchAjaxOptions(i);return s.fetchData(null,n).done(e.bind(function(e){var i=e;this.options.onParseResults&&(i=this.options.onParseResults(e)),this.autoCompleteResultsContainer.empty(),t.isArray(i)&&i.length>0&&(i=i.slice(0,this.options.maxResults),this._parseResults(i),this.options.onShowResults&&this.options.onShowResults(i),this.currentInputFieldValue=this.inputField.val())},this)).fail(e.bind(function(t){this.options.onError&&this.options.onError(t)},this))},_parseResults:function(i){t.map(i,e.bind(function(t){var i,s;this.options.resultDisplayTemplate&&(s=e.template(this.options.resultDisplayTemplate,t)),this.options.resultValueTemplate&&(i=e.template(this.options.resultValueTemplate,t)),this.showResult(s,i,t)},this))},getType:function(){return"autocomplete"},destroy:function(t){this.autoCompleteContent.remove(),i.prototype.destroy.call(this,t)}});return o}),define("apps/election-2012",["jquery","underscore","backbone","utils","pubsub","baseview","form/autocomplete"],function(t,e,i,s,n,o,r){var a=o.extend({el:"#elections-2012",initialize:function(i){this.$win=s.get("win"),t("#election-results-fullscreen").get(0)&&(this.onResize(),this.$win.on("resize."+this.cid,this.onResize)),e.bindAll(this,"onStateSelect"),o.prototype.initialize.call(this,i),this.$(".election-state-input").each(e.bind(function(t,e){this.subviews["stateAutocomplete"+t]=new r({el:e,resultDisplayTemplate:"<%= state %>",resultValueTemplate:"<%= state %>",onSelect:this.onStateSelect,selectedInputValue:"state"})},this))},onStateSelect:function(t,e){var i=this.$("#election-state-nav-form");i.attr("action",e.link),i.submit()},onResize:function(){var e=this.$win.height()>620?this.$win.height():620;t("#election-results-fullscreen").height(e)},destroy:function(t){this.$win.off("."+this.cid),o.prototype.destroy.call(this,t)}});return a}),define("apps/ugc-app",["jquery","underscore","base-app","site-manager"],function(t,e,i,s){"use strict";var n=i.extend({animateChangePagePreData:function(){s.scrollTop(0)}});return n}),define("apps/ballot-app",["jquery","underscore","base-app","site-manager","state"],function(t,e,i,s,n){"use strict";var o=i.extend({initialize:function(t){i.prototype.initialize.call(this,t),n.stopRefreshTimer()},animateChangePagePreData:function(){s.scrollTop(0)},destroy:function(t){i.prototype.destroy.call(this,t),n.startRefreshTimer()}});return o}),define("modules/stories_wide/stories-wide-app",["jquery","underscore","base-app","site-manager"],function(t,e,i,s){var n=i.extend({animateRevealApp:function(){return s.getHeader().setClosedFixed(),i.prototype.animateRevealApp.apply(this,arguments)},afterAppRemove:function(){s.getHeader().restoreDefaultState()}});return n}),define("apps/simple-overlay",["jquery","underscore","backbone","base-app","state","utils","site-manager","managers/routemanager","pubsub","user-manager"],function(t,e,i,s,n,o,r,a,l,h){"use strict";var c=s.extend({el:"#overlay",events:{"click .transition-wrap":"close","click .close-overlay":"close"},initialize:function(i){i=t.extend(!0,{template:'<div id="overlay" class="no-transition"><div class="transition-wrap"><article class="asset clearfix story ui-loading light-medium"></article></div></div>'},i),e.bindAll(this,"resizeHandler"),this.preloadUrl=i.preloadedUrl,this.win=o.get("win"),this.scrollEl=o.get("scrollEl"),this.header=r.getHeader(),this.pubSub={"header:fixed":this.onHeaderFixed,"header:unfixed":this.onHeaderUnfixed};var n=e.throttle(this.resizeHandler,50);this.win.on("resize."+this.cid,n),this.resizeHandler(),s.prototype.initialize.call(this,i)},resizeHandler:function(){this.winSize={width:this.win.width(),height:this.win.height()},this.header&&(this.winSize.height-=this.header.getCollapsedHeight()),this.setArticleMinHeight(this.$(".transition-wrap:first .asset"))},setArticleMinHeight:function(t){t.length&&t.outerHeight()<this.winSize.height&&t.css("min-height",this.winSize.height)},onHeaderFixed:function(){this.positionCloseButton("fixed")},onHeaderUnfixed:function(){this.positionCloseButton("absolute")},beforeAppRemove:function(){this.win.off("."+this.cid),this.positionCloseButton("absolute",o.getScrollPosition())},animateRemoveApp:function(t,e){return this.isSafari5?this.hide():(this.header&&this.header.updateNavigation(e),this.$el.css({position:"relative",opacity:1}),this.animate(this.$el,"opacity",0,250))},beforePageReveal:function(t,e,i){i.find(".asset").css("min-height",this.winSize.height)},animateRevealApp:function(){var i=this.$(".transition-wrap"),s=this.winSize.height;if(this.isSafari5||!t.support.css.transform)return i.css("height",s),this.show();i.css({height:s,overflow:"hidden",opacity:0}),i[0].style[this.transformCssName]="scale(0.4)",i[0].style[this.transformOriginCssName]="50% "+.25*s+"px",i[0].style[this.transitionCssName]=this.transformCssHyphenName+" 300ms linear, opacity 300ms linear",this.$el.show().css({opacity:1,display:"block"}),e.delay(e.bind(function(){i[0].style[this.transformCssName]="scale(1.0)",i[0].style.opacity=1},this));var n=t.support.css.transition.registerTransitionEndListener(i[0]);return n.done(e.bind(function(){i[0].style[this.transformCssName]="",i[0].style[this.transitionCssName]="",i[0].style[this.transformOriginCssName]=""},this)),n.promise()},getRevealAppLoader:function(){return this.options.template},animateChangePagePreData:function(){var e=this.winSize.height,i=o.getScrollPosition(),s=this.$(".transition-wrap:first");this.prepareContentForTransition(s,i,e);var n=t(this.options.template),a=n.find(".transition-wrap");return this.prepareContentForTransition(a,0,e),this.$el.prepend(a),r.scrollTop(0),this.positionCloseButton("absolute",i,s),this.swapContent(s,a)},prepareContentForTransition:function(t,e,i){t.css({height:i}),t.children().css({top:-1*e})},animateChangePagePostData:function(t,i,s){var n=s.find(".transition-wrap");return n.css("height",this.winSize.height),this.setArticleMinHeight(n.find(".asset")),this.swapContent(this.$(".transition-wrap:first"),n,this.getHash(i)).done(e.bind(function(){n.css("height","")},this))},afterPageReveal:function(t,e,i,s){var n=this.$(".transition-wrap:first");n.css({height:"",overflow:"visible"}),this.currentSection=this.getSectionName(),this.header&&this.header.updateNavigation((this.pageInfo||{}).ssts),null===t&&this.preloadPath(),s&&(this.subviews.view=new s({el:n,path:e})),this.header&&this.header.isFixed()&&this.positionCloseButton("fixed")},parsePageInfo:function(){var t=h.getAccount("firefly"),e=s.prototype.parsePageInfo.apply(this,arguments),i="nothitpaywall";if(t){var n=t.getViewsCookie().viewsRemaining;n>=0&&(i=0===n?"nofreearticlesremaining":n)}return e.numPageViewsLeft=i,e},preloadPath:function(){n.preloadPath(this.preloadUrl||this.currentSection||"/")},positionCloseButton:function(t,e,i){var s=i?i.find(".close-wrap"):this.$(".close-wrap");s.css("absolute"===t?{position:t,"margin-top":"",top:e||0}:{position:t,"margin-top":-80,top:""})},getSectionName:function(){var t,i="",s=this.pageInfo||{};if(s&&(s.ss||s.ssts)){if(t=s.ss,!t){t=s.ssts;var n=t.indexOf("/");n>0&&(t=t.substring(0,n)),-1===e.indexOf(o.getSiteSections(),t)&&(t="")}i=t,t.indexOf("/")>0&&(i=t.substring(0,t.indexOf("/"))),i="home"===i?"/":"/"+i+"/"}return i},close:function(e){if(!e||e.target===e.currentTarget){var i=t(e.currentTarget).attr("data-ht")||"modalclose";return l.trigger("heattrack",i),a.goTo(n.getPreloadedUrl()||"/"),e?!1:void 0}}});return c}),define("apps/interactives",["jquery","underscore","base-app"],function(t,e,i){var s=i.extend({trackPageLoad:function(t){window.top===window&&i.prototype.trackPageLoad(t)}});return s}),define("modules/global/taboola",["jquery","underscore","utils"],function(t,e,i){"use strict";var s=function(s){var n=i.getNested(window,"site_config","THIRDPARTYAPI","Taboola")||{};this.options=t.extend({apiBase:n.apiBase+n.api_id,apiKey:n.apiKey,widgetUrl:"http://cdn.taboolasyndication.com/libtrc/"+n.publisher_id+"/loader.js",widget:n.widget,taboola_enabled:n.ENABLED},s),this.options.widget&&i.loadScript(this.options.widgetUrl,"_taboola",e.bind(this.getWidget,this))};return s.prototype={registerTaboolaClick:function(t,e,i,s){s||(s="below-photo");var n=this.options.apiBase+"/recommendations.notify-click?app.type=desktop&app.apikey="+this.options.apiKey+"&response.id="+i+"&item.type="+e+"&item.id="+t+"&placement="+s;(new Image).src=n},registerTaboolaVisible:function(t){var e=this.options.apiBase+"/recommendations.notify-visible?app.type=desktop&app.apikey="+this.options.apiKey+"&response.id="+t;(new Image).src=e},getRelated:function(t,s,n,o,r,a){if(this.options.taboola_enabled){if(!t)return;s=s||"video",n=n||"video",o=o||6,r=r||window.location.href,a=a||0;var l=this.options.apiBase+"/recommendations.get";l+="?output.callback=define&app.type=desktop&app.apikey="+this.options.apiKey,l+="&source.id="+a+"&source.url="+encodeURIComponent(r)+"&source.type="+s+"&rec.type="+n+"&rec.count="+o,i.requireSingleUseScript(l).done(e.bind(function(e){i.set("taboolaResponseID",e.id),e.list||(e.list={}),this.registerTaboolaVisible(e.id),t(e)},this))}},getWidget:function(t){this.options.taboola_enabled&&(this.options.widget.length>1&&console.log("TABOOLA more stories"),t.push({notify:"newPageLoad"}),t.push({article:"auto",target_type:"mix",url:window.location.href}),e.each(this.options.widget,function(e){t.push(-1!==i.getPageUrl().indexOf("/sports/")||-1!==i.getPageUrl().indexOf("/gameon/")?{category:"sports",mode:e.mode,container:e.container}:{mode:e.mode,container:e.container})}))}},s}),define("meteredAdPosition",["jquery","underscore","directAdPosition","utils","managers/cachemanager","admanager","adLogger"],function(t,e,i,s,n,o,r){"use strict";var a=i.extend({initialize:function(e){e=t.extend({slotType:"out",rateMeterId:null},e),i.prototype.initialize.call(this,e)},getDefaultThreshold:function(t){var e=t||this.options.meterThreshold||this.options.adPlacement,i=e.indexOf("/");-1!==i&&(e=e.substring(0,i));var n=s.getNested(window,"site_config","ADS","THRESHOLDS",e.toUpperCase());return n||r.logError("Could not find default threshold for metered ad: "+e),n},tickMeter:function(t,e){var i=!1,s=this.getCurrentMeter(e);return s.length?(s[0]=Math.max(0,s[0]-1),s[0]<1&&(i=!0,t||(s[0]=s[1])),n.setValue(this.getRateMeterId(e),s),i):i},resetMeter:function(t){var e=this.getCurrentMeter(t);e[0]=e[1],n.setValue(this.getRateMeterId(t),e)},getRateMeterId:function(t){return"dfpc_"+(t||this.options.rateMeterId)},getCurrentMeterCount:function(t){return this.getCurrentMeter(t)[0]||0},getCurrentMeter:function(t){var e=this.getRateMeterId(t),i=this.getDefaultThreshold(t);return i?n.getValue(e,i):[]},shouldShowAd:function(){var t=this.tickMeter();return this.prefetchAd(),t&&!this.isAdReady()&&(r.logDebug("ad skipped due to no ad being delivered in time, refreshing slot"),this.refreshPosition(),t=!1),r.logDebug("shouldShowAd: "+t,this),t}});return a}),define("modules/carousel/gallery",["jquery","underscore","backbone","baseview","pubsub","utils","modules/global/taboola","meteredAdPosition","directAdPosition","adLogger","cookie"],function(t,e,i,s,n,o,r,a,l,h){var c=s.extend({events:{"click .gallery-actions-replay, .gallery-photo":"nextSlide","click .gallery-related-link":"taboolaClick"},selectors:{endSlate:".endslate",slides:".slide:not(.partner-placement)",hiddenWhileSurvey:".p402_hide"},endSlateTemplate:'<% _.each(data, function(item) { %><li class="gallery-related-item"><a class="gallery-related-link" data-taboola-type="<%= item.type %>" data-taboola-id="<%= item.id %>" data-taboola-response-id="<%=response_id%>"href="<%= item.url %>"><span class="taboola-image-crop"><img src="<%= item.thumbnail[0].url %>" class="taboola-related-img" alt="" /></span><%= item.name %></a><span class="gallery-related-date"><%= item.created %></span></li><% }); %>',initialize:function(i){e.bindAll(this,"_showEndslate","setAdSize","beforeAdRender"),i=t.extend({ads:!0,slideTransition:0,imageLazySrcAttr:"data-src",lookAheadAmount:2,transitionSlides:null},i),this.index=i.index,s.prototype.initialize.call(this,i),this.adCount=0,this.googleSurveyNeeded=!1,o.getNested(window.site_config,"ADS","GALLERY","SURVEY")&&(this.googleSurveyNeeded=!0),this._initializeAds(),this.endSlateBuilt=!1,this.isRotating=!1,this.galleryThumbnails=this.$(".gallery-thumbs")},destroy:function(){t.cookie("GoogleSurveyDropped")&&(t.cookie("GoogleSurveyDropped",""),0!==this.$el.parent(".p402_premium").length&&this.$el.unwrap(),t("#contain-402").remove()),this._destroySurveyCallback(),s.prototype.destroy.call(this)},_initializeAds:function(){if(this.options.ads){this.galleryData=this.$el.data()||{},this.setAdCount();var t=this.getAdTargeting();if(this.$sponsorshipAd=this.$(".snapshot-sponsor"),this.$sponsorshipAd.length){var e=this._getSlideIn(this.index).data("qqid");t.snapshotid=e,this.subviews.sponsorshipAd=new l({el:this.$sponsorshipAd,adPlacement:"sponsor_logo/snapshots",adSizes:["sponsor_logo"],targeting:t})}this.$viewport=this.$(".viewport");var i=this.$viewport.width(),s=this.$viewport.height();if(450>s||600>i)h.logWarn("Advertisement viewport is too small: "+i+"x"+s);else{this.$adSlide=this.$(".partner-slide-ad"),this.$adContents=this.$(".partner-slide-ad .gallery-photo-border");var n=null;"snapshot"===this.galleryData.galleryId&&(n="transition_snapshot"),this.subviews.ad=new a({el:this.$adContents,adPlacement:"transition_gallery/"+this.galleryData.cst,adSizes:["elastic"],beforeAdRender:this.beforeAdRender,meterThreshold:n,rateMeterId:"gallery_"+this.galleryData.galleryId,targeting:t})}}},setAdCount:function(){this.adCount++},getAdTargeting:function(){return{pageType:this.galleryData.basePageType,contentid:this.galleryData.galleryId,sitePage:"usat/"+(this.galleryData.ssts||"").replace(/\/\/*$/,""),series:this.galleryData.series,topic:this.galleryData.topic,count:this.adCount,surveyCookie:""+(t.cookie("GoogleSurveyTaken")||!1),surveyOn:this.googleSurveyNeeded.toString()}},completedSurvey:function(){if(t.cookie("GoogleSurveyTaken","true",{expires:1}),t.cookie("GoogleSurveyDropped",""),this.isRotating)this.options.carousel.autoplay();else{var e=this.options.carousel.subviews.controls.selectors,i=!!t(e.nextArrow).attr("data-lastClicked"),s="none"==t(e.prevArrow).css("display"),n=-1;(i||s)&&(n=1),this.options.carousel.switchSlide(null,n)}var o=this.options.carousel.subviews.controls.$el;o.find(this.selectors.hiddenWhileSurvey).css("display","block"),this._destroySurveyCallback()},_destroySurveyCallback:function(){if(window.USATGoogleSurvey){window.USATGoogleSurvey=void 0;try{delete window.USATGoogleSurvey}catch(t){}}},render:function(){this._loadImage(this.$$(this.selectors.slides).eq(this.index))},taboolaClick:function(e){var i=t(e.currentTarget);r.prototype.registerTaboolaClick(i.attr("data-taboola-id"),i.attr("data-taboola-type"),i.attr("data-taboola-response-id"),"end-slate")},nextSlide:function(t){t.preventDefault(),this.options.carousel.switchSlide(null,1)},_buildEndslate:function(){this.endSlateBuilt=!0;var t=window.location.href;this.$el.hasClass("hasendslate")&&this.$el.data("gallery-id")&&(t=window.location.protocol+"//"+window.location.host+"/picture-gallery/"+this.$el.data("gallery-id")+"/");var e=new r;this.$$(this.selectors.endSlate).addClass("loading"),e.getRelated(this._showEndslate,"photo","photo",4,t,this.$el.data("gallery-id"))},_showEndslate:function(t){{var i=this.$$(this.selectors.endSlate).removeClass("loading");i.find(".gallery-endslate-related").attr("data-media-url")||""}if(e.each(t.list,function(t){t.thumbnail[0].url.indexOf("images.taboola.com")>-1&&(t.thumbnail[0].url=decodeURIComponent((t.thumbnail[0].url+"").replace(/\+/g,"%20")),t.thumbnail[0].url=t.thumbnail[0].url.replace("http://images.taboola.com/taboola/image/fetch/f_jpg,q_80,c_fill,g_face,e_sharpen/",""))}),1===i.length){var s=e.template(this.endSlateTemplate,{data:t.list,response_id:t.id});i.find(".gallery-endslate-related").html(s)}},goToSlide:function(e){var i=this._getSlideOut(),s=this._getSlideIn(e);return s.length?(this.index=e,n.trigger("carousel:switchSlide"),this.options.triggerAdRefresh&&n.trigger("carousel:refreshAd"),this._switchSlides(s,i)):t.Deferred().reject()},shouldShowAd:function(){return!this.showingAd&&this.options.ads&&this.subviews.ad&&this.subviews.ad.shouldShowAd()?!0:!1},showAd:function(){var i=this._getSlideOut();return this.showingAd=this.$adSlide,i[0]!==this.showingAd[0]?(this.$sponsorshipAd&&this.$sponsorshipAd.hide(),this._switchSlides(this.showingAd,i).done(e.bind(function(){if(t.cookie("GoogleSurveyDropped")+""=="true"){var e=this.options.carousel.subviews.controls.$el,i=this.selectors.hiddenWhileSurvey.substr(1);e.find(".media-playlist").wrap('<div class="'+i+'"></div>'),this.options.carousel.playTimer&&(this.isRotating=!0,this.options.carousel._stopCarouselRotate())}this.subviews.ad.playAd(),this.hideThumbnails()},this))):t.Deferred().reject()},hideThumbnails:function(){this.galleryThumbnails.hide()},showThumbnails:function(){this.galleryThumbnails.show()},_transitionSlides:function(t,i){var s=this.options.slideTransition;if(this.options.transitionSlides){var n=this.$$(this.selectors.slides);return this.options.transitionSlides(n.index(t),n.index(i))}return i.css({opacity:1}),this.animate(i,"opacity",0,s,"ease-in-out").then(e.bind(function(){return this._fadeInSlide(t,s).done(e.bind(function(){i.css({visibility:"hidden",opacity:0})},this))},this))},_switchSlides:function(t,i){return i===this.showingAd&&(this.subviews.ad.stopAd(),this.showThumbnails()),this._transitionSlides(t,i).then(e.bind(function(){if(i.removeClass("active"),i===this.showingAd){this.setAdCount();var e=this.getAdTargeting();this.subviews.ad.setTargeting(e),this.subviews.ad.refreshPosition(),this.showingAd=null}t!==this.showingAd&&this.$sponsorshipAd&&this.$sponsorshipAd.length&&this.refreshSponsorshipAd(t.data("qqid"))},this))},refreshSponsorshipAd:function(t){var e=this.getAdTargeting();e.snapshotid=t,this.subviews.sponsorshipAd.setTargeting(e),this.subviews.sponsorshipAd.refreshPosition()},_getSlideOut:function(){var t;return t=this.showingAd?this.showingAd:this.$$(this.selectors.slides).eq(this.index)},_getSlideIn:function(t){var e;return e=this.$$(this.selectors.slides).eq(t),this._loadImage(e,this.index>t),!this.endSlateBuilt&&e.hasClass("endslate")&&this._buildEndslate(),e},_loadImage:function(t,e){var i=this.options.lookAheadAmount;do this._fetchImage(t.find("img")),i--,t=e?t.prev():t.next();while(i>=0&&t.length>0)},_fetchImage:function(t){if(t.length>0&&o.lazyLoadImage(t,this.options.imageLazySrcAttr)){var i=t.parent();i.addClass("loading"),t.load(e.bind(function(){i.removeClass("loading"),this._resizeMeta(t)},this))}},_fadeInSlide:function(t,e){return t.css({visibility:"visible","z-index":1}),t.addClass("active"),this._resizeMeta(t.find(".gallery-photo")),this.animate(t,"opacity",1,e,"ease-in-out")},_resizeMeta:function(t){if(t.length){var e=this._getImageWidth(t);e&&t.parent().width(e)}},_getImageWidth:function(t){return t.width()},viewportResize:function(i,s){this.$(".active .gallery-photo").each(e.bind(function(e,i){this._resizeMeta(t(i))},this)),this.$adSlide&&this.subviews.ad&&(this.setAdSize(i,s),this.subviews.ad.resizeAd(i,s))},beforeAdRender:function(t){t.survey&&(window.USATGoogleSurvey={completedSurvey:e.bind(this.completedSurvey,this)}),this.setAdSize()},setAdSize:function(t,e){t=t||this.$viewport.width(),e=e||this.$viewport.height();var i=this.findSizeForAd(t,e);this.$adContents.removeClass("size-s size-m size-l size-xl").addClass(i.adSizeClass).css("margin-top",i.marginTop)},findSizeForAd:function(t,e){var i={adSizeClass:"size-s",marginTop:"5px"},s=450;return t>1080&&e>810?(i.adSizeClass="size-xl",s=810):t>936&&e>700?(i.adSizeClass="size-l",s=700):t>768&&e>576&&(i.adSizeClass="size-m",s=576),i.marginTop=(e-s)/2+"px",i}});return c}),define("modules/myCapture/myCapture",["jquery","underscore","baseview","pubsub"],function(t,e,i,s){"use strict";var n=i.extend({events:{"click .js-mycapture-btn":"mycaptureBtnClick"},initialize:function(t){i.prototype.initialize.call(this,t)},mycaptureBtnClick:function(e){e.preventDefault(),s.trigger("uotrack","mycapturepurchase");var i=t(e.currentTarget.parentElement).parent(),n=location.host.split(".").slice(-2)[0],o=".mycapture.com/mycapture/remoteimage.asp?",r=i.parent().find("img").attr("data-mycapture-src"),a={image:r,caption:t.trim(i.find(".js-caption").text()),credit:t.trim(i.find(".credit").text()),backtext:"Back to Site",backurl:location.href},l="http://"+n+o+t.param(a);window.open(l,"mycapture")},switchMyCaptureBtn:function(t){var e=t.$(".single-photo"),i=e.find(".js-mycapture-btn-small"),s=e.find(".js-mycapture-btn"),n=t.$(".js-caption-wrapper");e.hasClass("expandable-collapsed")?(i.hide(),s.show(),n.addClass("expandable-photo-caption-with-mycapture")):(s.hide(),i.show(),n.removeClass("expandable-photo-caption-with-mycapture"))},toggleSmallTag:function(t){this.$(".mycapture-small-btn").toggle(t)}});return n}),define("modules/carousel/controls",["jquery","underscore","backbone","baseview","modules/myCapture/myCapture","pubsub","utils"],function(t,e,i,s,n,o,r){var a=s.extend({events:{"click .slide-nav":"switchSlide","click .autoplay":"autoplay","click .thumbnails":"thumbsToggle","click .captions":"captionsToggle",mouseenter:"mouseover",mouseleave:"mouseout","click .fullscreen":"launchFullscreen"},selectors:{allCaptions:".meta",captionBtnLabel:".captionLabel",nextArrow:".slide-nav.next",playBtn:".playbtn",prevArrow:".slide-nav.prev",thumbsBtnLabel:".thumbLabel",thumbsWrapper:".thumbs",ticker:".ticker",viewport:".viewport",activeSlide:".gallery-viewport-slide.active"},initialize:function(e){e=t.extend({index:0,hoverShowControls:!0,interactionDemo:!0,interactionShowDelay:600,interactionHideDelay:3600,totalImages:0,totalSlides:0},e),this.index=e.index,s.prototype.initialize.call(this,e),r.getNested(window,"site_vars","THIRDPARTYAPI","MYCAPTURE","ENABLED")&&this.setupMyCapture()},render:function(){this.updateTicker(),this.updateNextPrevArrows(this.index),this.options.interactionDemo&&this.startInteractionDemo()},destroy:function(t){this.clearUserInteractionDemo(),s.prototype.destroy.call(this,t)},setupMyCapture:function(){this.subviews.mycapture=new n({el:this.$el})},switchSlide:function(e){e.preventDefault();var i=t(e.currentTarget),s=i.hasClass("prev");if(i.attr("data-lastClicked","true").siblings(".slide-nav").removeAttr("data-lastClicked"),s?this.options.carousel.switchSlide(null,-1,!1):this.options.carousel.switchSlide(null,1,!1),this.subviews.mycapture){var n=this.$(this.selectors.allCaptions).hasClass("on");this.subviews.mycapture.toggleSmallTag(!n)}},autoplay:function(t){t.preventDefault(),this.options.carousel.autoplay()},startInteractionDemo:function(){var t=this;this.uxTimeout1=setTimeout(function(){t.$el.addClass("hover")},this.options.interactionShowDelay),this.uxTimeout2=setTimeout(function(){t.$el.removeClass("hover")},this.options.interactionHideDelay)},clearUserInteractionDemo:function(){clearTimeout(this.uxTimeout1),clearTimeout(this.uxTimeout2)},mouseover:function(){this.options.hoverShowControls&&this.$$(this.selectors.viewport).addClass("hover"),this.$el.addClass("hover"),this.clearUserInteractionDemo()},mouseout:function(){this.options.hoverShowControls&&this.$$(this.selectors.viewport).removeClass("hover"),this.$el.removeClass("hover")},launchFullscreen:function(t){t.preventDefault(),o.trigger("openFullScreenCarousel",{carousel:this,fullScreen:!0,parent:this.$el})},captionsToggle:function(t){var e=this.$$(this.selectors.allCaptions),i=this.$$(this.selectors.captionBtnLabel);t.preventDefault(),e.hasClass("on")?(e.removeClass("on"),i.html("Show Captions")):(e.addClass("on"),i.html("Hide Captions")),this.subviews.mycapture&&this.subviews.mycapture.toggleSmallTag(!e.hasClass("on"))},thumbsToggle:function(t){var e=this.$$(this.selectors.thumbsBtnLabel),i=this.$$(this.selectors.thumbsWrapper);t.preventDefault(),i.hasClass("on")?(i.removeClass("on"),e.html("Show Thumbnails"),this.options.carousel.toggleThumbnail(!1)):(i.addClass("on"),e.html("Hide Thumbnails"),this.options.carousel.toggleThumbnail(!0))},updateNextPrevArrows:function(t){var e=this.$$(this.selectors.prevArrow),i=this.$$(this.selectors.nextArrow);0===t?e.hide():e.show(),t<this.options.totalSlides-1?i.show():i.hide()},updateTicker:function(){var t=this.$$(this.selectors.ticker);t.length&&(t.css(this.index<this.options.totalImages?{visibility:"visible"}:{visibility:"hidden"}),t.html("<b>"+(this.index+1)+"</b> of <b>"+this.options.totalImages+"</b>"))},goToSlide:function(t){this.index=t,this.updateNextPrevArrows(t),this.updateTicker()},onPlay:function(){this.$$(this.selectors.playBtn).addClass("pause").text("Pause")},onStop:function(){this.$$(this.selectors.playBtn).removeClass("pause").text("Autoplay")}});return a}),function(t){"function"==typeof define&&define.amd?define("mousewheel",["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function e(e){var r=e||window.event,a=l.call(arguments,1),h=0,d=0,u=0,p=0,f=0,g=0;if(e=t.event.fix(r),e.type="mousewheel","detail"in r&&(u=-1*r.detail),"wheelDelta"in r&&(u=r.wheelDelta),"wheelDeltaY"in r&&(u=r.wheelDeltaY),"wheelDeltaX"in r&&(d=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(d=-1*u,u=0),h=0===u?d:u,"deltaY"in r&&(u=-1*r.deltaY,h=u),"deltaX"in r&&(d=r.deltaX,0===u&&(h=-1*d)),0!==u||0!==d){if(1===r.deltaMode){var m=t.data(this,"mousewheel-line-height");h*=m,u*=m,d*=m}else if(2===r.deltaMode){var v=t.data(this,"mousewheel-page-height");h*=v,u*=v,d*=v}if(p=Math.max(Math.abs(u),Math.abs(d)),(!o||o>p)&&(o=p,s(r,p)&&(o/=40)),s(r,p)&&(h/=40,d/=40,u/=40),h=Math[h>=1?"floor":"ceil"](h/o),d=Math[d>=1?"floor":"ceil"](d/o),u=Math[u>=1?"floor":"ceil"](u/o),c.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();f=e.clientX-y.left,g=e.clientY-y.top}return e.deltaX=d,e.deltaY=u,e.deltaFactor=o,e.offsetX=f,e.offsetY=g,e.deltaMode=0,a.unshift(e,h,d,u),n&&clearTimeout(n),n=setTimeout(i,200),(t.event.dispatch||t.event.handle).apply(this,a)}}function i(){o=null}function s(t,e){return c.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120===0}var n,o,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(t.event.fixHooks)for(var h=r.length;h;)t.event.fixHooks[r[--h]]=t.event.mouseHooks;var c=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=a.length;i;)this.addEventListener(a[--i],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",c.getLineHeight(this)),t.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=a.length;i;)this.removeEventListener(a[--i],e,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var i=t(e),s=i["offsetParent"in t.fn?"offsetParent":"parent"]();return s.length||(s=t("body")),parseInt(s.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),define("modules/scroller/base-scroll",["jquery","underscore","backbone","baseview","pubsub","utils","mousewheel"],function(t,e,i,s,n,o){var r=s.extend({events:{mousewheel:"handleMouseWheel",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchstart:"onTouchStart","mousedown .scrolldragger":"onDraggerMouseDown","mouseenter .scrolldragger":"onDraggerMouseOver","mouseleave .scrolldragger":"onDraggerMouseOut","mousedown .scrollbar":"onBarClick"},removeActiveDelay:300,initialize:function(i){i=t.extend({disabled:!1,contentClass:".scrollable-content",lockPageScroll:!0,delayScroll:!1,minDraggerSize:40,template:null},i),e.bindAll(this,"onDraggerMouseUp","onDraggerMouseMove","onTouchMove","onTouchStop","_setMouseInHouse","_clearMouseInHouse"),this.content=this.$(i.contentClass),this.bar=t(i.template).hide(),this.bar.addClass("scrollbar"),this.dragger=this.bar.find(".scrolldragger"),this.body=o.get("body"),this.$el.append(this.bar),this.isMouseDown=!1,this.isMouseOver=!1,this.draggerOffset=0,s.prototype.initialize.call(this,i),this.refresh()
},bindEvents:function(){this.delegateEvents()},unbindEvents:function(t){t||this.undelegateEvents(),this.body.off("."+this.cid),clearInterval(this.accelerationTimer),clearTimeout(this.enterDelay),clearTimeout(this.leaveDelay)},refresh:function(){if(this.content=this.$(this.options.contentClass),!this.options.disabled&&0!==this.content.length)if(this.viewportSize=this.getViewportSize(),this.contentSize=this.getContentSize(),this.contentViewportRatio=this.viewportSize/this.contentSize,this.contentViewportRatio<1){var t=this._calculateDraggerSize(this.viewportSize,this.contentViewportRatio,this.contentSize);this.draggerSize=this._setDraggerSize(t),this.active||(this.bar.show(),this.bindEvents(),this.active=!0,this.origPosition&&this.moveContentToPosition(this.origPosition.left,this.origPosition.top)),this.shiftContent(0,0)}else this.active&&(this.origPosition=this.content.position(),this.moveContentToPosition(0,0),this.bar.hide(),this.unbindEvents(),this.active=!1)},_calculateDraggerSize:function(t,e,i){var s=Math.round(t*e);if(s<this.options.minDraggerSize){var n=i-t,o=t-this.options.minDraggerSize;this.contentViewportRatio=o/n,s=this.options.minDraggerSize}return s},onTouchStart:function(t){var e=t.originalEvent.touches;e.length>1||this.options.disabled||!this.active||(clearInterval(this.accelerationTimer),this.touchX=e[0].pageX,this.touchY=e[0].pageY,this.touchVectorX=0,this.touchVectorY=0,this.touchDragStarted=!1,this.touchLastMove=(new Date).getTime(),this.body.on("touchend."+this.cid,this.onTouchStop),this.body.on("touchcancel."+this.cid,this.onTouchStop),this.body.on("touchmove."+this.cid,this.onTouchMove))},onTouchStop:function(t){if(0===t.originalEvent.touches.length&&(this.body.off("."+this.cid),this.touchDragStarted)){var e=(new Date).getTime(),i=e-this.touchLastMove;return t.preventDefault(),100>i&&this._triggerScrollingDecelerate(this.touchVectorX,this.touchVectorY,1500),!1}},_triggerScrollingDecelerate:function(t,i,s){var n=(new Date).getTime(),o=n+s,r=n,a=window.requestAnimationFrame||window.webkitRequestAnimationFrame,l=e.bind(function(){var e=(new Date).getTime(),h=e-r;r=e,o>e&&a(l),e-=n;var c=this._adjustVelocityVector(t,e,s),d=this._adjustVelocityVector(i,e,s);this.shiftContent(c*h,d*h)},this);this.accelerationTimer=a(l)},_adjustVelocityVector:function(t,e,i){return t*Math.pow(1-e/i,3)},onTouchMove:function(t){if(1===t.originalEvent.touches.length){var e=t.originalEvent.touches,i=e[0].pageX-this.touchX,s=e[0].pageY-this.touchY;if(this.touchDragStarted||Math.abs(i)>10||Math.abs(s)>10){var n=(new Date).getTime();this.touchDragStarted=!0,this.touchX=e[0].pageX,this.touchVectorX=i/(n-this.touchLastMove),this.touchY=e[0].pageY,this.touchVectorY=s/(n-this.touchLastMove),this.touchLastMove=(new Date).getTime(),this.shiftContent(i,s)===!1&&t.preventDefault()}}},onBarClick:function(t){if(1===t.which&&!t.isDefaultPrevented()){t.preventDefault();var e=this.bar.offset(),i=t.pageX-e.left-this.draggerSize/2,s=t.pageY-e.top-this.draggerSize/2;this.moveDraggerToPosition(i,s),this.onDraggerMouseOver(t),this.onDraggerMouseDown(t)}},onDraggerMouseDown:function(t){if(1===t.which){this.isMouseDown=!0,t.preventDefault(),this.body.on("mousemove."+this.cid,this.onDraggerMouseMove),this.body.on("mouseup."+this.cid,this.onDraggerMouseUp);var e=this.dragger.offset();this.draggerClickOffset={left:t.pageX-e.left,top:t.pageY-e.top}}},onDraggerMouseUp:function(t){1===t.which&&(t.preventDefault(),this.isMouseDown=!1,this.body.off("."+this.cid),this.isMouseOver||this.dragger.removeClass("hover"))},onDraggerMouseMove:function(t){if(this.isMouseDown){var e=this.bar.offset(),i=t.pageX-e.left-this.draggerClickOffset.left,s=t.pageY-e.top-this.draggerClickOffset.top;this.moveDraggerToPosition(i,s)}},onDraggerMouseOver:function(){this.isMouseOver=!0,this.dragger.addClass("hover")},onDraggerMouseOut:function(){this.isMouseOver=!1,this.isMouseDown||this.dragger.removeClass("hover")},onMouseEnter:function(){clearTimeout(this.leaveDelay),this.enterDelay=setTimeout(this._setMouseInHouse,300)},onMouseLeave:function(){clearTimeout(this.enterDelay),this.leaveDelay=setTimeout(this._clearMouseInHouse,300)},_setMouseInHouse:function(){this.isMouseInTheHouse=!0},_clearMouseInHouse:function(){this.isMouseInTheHouse=!1},handleMouseWheel:function(t){if(!this.isMouseDown&&this.active&&(!this.options.delayScroll||this.isMouseInTheHouse)){var e=t.deltaY*t.deltaFactor,i=-1*t.deltaX*t.deltaFactor||e;this.shiftContent(i,e)===!1&&t.preventDefault()}},shiftContent:function(t,e){var i=this.content.position(),s=this.content.parent(),n=i.left+t-(parseInt(s.css("padding-left"),10)||0)-(parseInt(s.css("margin-left"),10)||0),o=i.top+e-(parseInt(s.css("padding-top"),10)||0)-(parseInt(s.css("margin-top"),10)||0);return this.moveContentToPosition(n,o)?!1:this.options.lockPageScroll?!1:void 0},destroy:function(){this.unbindEvents(!0),this.bar.remove(),s.prototype.destroy.apply(this,arguments)},moveDraggerToPosition:function(){},moveContentToPosition:function(){},scrollToElement:function(){},animateContentToPosition:function(){},getViewportSize:function(){return 0},getContentSize:function(){return 0},_setDraggerSize:function(t){return t}});return r}),define("modules/scroller/horizontal-scroll",["jquery","underscore","modules/scroller/base-scroll"],function(t,e,i){var s=i.extend({initialize:function(s){s=t.extend({color:"light",draggerPaddingLeft:0,draggerPaddingRight:2,delayScroll:!0},s);var n=e.template('<div class="horizontal-scroll ui-<%= color %>"><div class="scrolldragger"><div class="over-icon"></div></div></div>');s.template=n({color:s.color}),this.$(".horizontal-scroll").remove(),i.prototype.initialize.call(this,s)},getViewportSize:function(){return this.$el.width()},getContentSize:function(){return this.content.width()},_setDraggerSize:function(t){return t-=this.options.draggerPaddingLeft+this.options.draggerPaddingRight,this.dragger.css({width:t}),t},animateContentToPosition:function(i,s,n,o){var r=this.viewportSize-this.contentSize,a=Math.max(r,Math.min(i,0));return o=o||"ease-out",t.when(this.animate(this.dragger,"left",-1*a*this.contentViewportRatio+"px",n||0,o),this.animate(this.content,"left",a+"px",n,o)).done(e.bind(function(){this.$el.trigger("scrollBarUpdate",[a/r])},this))},scrollToElement:function(t,e,i,s){var n,o=t.outerWidth(),r=t.position().left+t.parent().position().left,a=r+o;if(0>r){var l=this.getViewportSize();n=e?r+(o-l):r}else a>this.getViewportSize()&&(n=e?r:r+(o-this.getViewportSize()));if(n){var h=this.content.position().left-n;this.animateContentToPosition(h,0,i,s)}},moveContentToPosition:function(t){if(!this.active)return!1;var e=Math.min(this.viewportSize-this.contentSize,0),i=Math.max(e,Math.min(t,0));return this._positionDragger(-1*i*this.contentViewportRatio),this._positionContent(i),this.$el.trigger("scrollBarUpdate",[i/e]),i===t},moveDraggerToPosition:function(t){if(!this.active)return!1;var e=this.viewportSize-(this.draggerSize+this.options.draggerPaddingRight+this.options.draggerPaddingLeft),i=Math.max(0,Math.min(t,e));return this._positionDragger(i),this._positionContent(-1*i/this.contentViewportRatio),this.$el.trigger("scrollBarUpdate",i/e),i===t},_positionDragger:function(t){t+=this.options.draggerPaddingLeft,t=Math.round(t),this.dragger.css({left:t})},_positionContent:function(t){t=Math.round(t),this.content.css({left:t})}});return s}),define("modules/carousel/thumbs",["jquery","underscore","backbone","baseview","pubsub","utils","modules/scroller/horizontal-scroll"],function(t,e,i,s,n,o,r){var a=s.extend({events:{"mouseenter li":"thumbMouseover","mouseleave li":"thumbMouseout","click li":"switchSlide"},selectors:{thumbs:"li"},initialize:function(e){e=t.extend({hoverTransition:0},e),this.index=e.index,s.prototype.initialize.call(this,e),this.subviews.scrollbar=new r({el:this.$el,color:this.options.scrollerColor,padding:2})},switchSlide:function(e){e.preventDefault();var i=t(e.currentTarget).index();this.options.carousel.switchSlide(i)},showAd:function(){var t=this.$$(this.selectors.thumbs);t.eq(this.index).removeClass("active")},thumbMouseover:function(i){var s=i.currentTarget;this.options.hoverTransition&&(this.hoverTimeout=setTimeout(e.bind(function(){this.hoverTimeout=null,this.options.carousel.switchSlide(t(s).index(),null,!0)},this),this.options.hoverTransition))},thumbMouseout:function(){this.options.hoverTransition&&this.hoverTimeout&&clearTimeout(this.hoverTimeout)},goToSlide:function(t){var e=this.$$(this.selectors.thumbs),i=e.eq(t);e.eq(this.index).removeClass("active"),i.addClass("active"),this.index=t,i.length&&this.subviews.scrollbar.scrollToElement(i,!1,300)},viewportResize:function(){this.subviews.scrollbar&&this.subviews.scrollbar.refresh()}});return a}),define("modules/partner/simple-ad",["jquery","underscore","baseview","state","sharedAdPosition","directAdPosition"],function(t,e,i,s,n,o){"use strict";var r=i.extend({initialize:function(n){e.bindAll(this,"onAdReady"),n=t.extend({adPlacement:"poster_front",adSizes:"mediumrectangle",pageInfo:s.getActivePageInfo(),onAdReady:this.onAdReady,isShared:!1},n),i.prototype.initialize.call(this,n)},_initAds:function(){var t=this.options,e=t.adSizes;e&&(e=e.split(","));var i={el:this.$el,adPlacement:t.adPlacement,pageInfo:t.pageInfo,adSizes:e,onAdReady:this.onAdReady,adType:t.adType};t.isShared?(i.defaultPosition=!0,this.subviews.simpleAd=new n(i)):this.subviews.simpleAd=new o(i)},onAdReady:function(){this.subviews.simpleAd.show()}});return r}),define("modules/partner/companion-ad",["jquery","underscore","modules/partner/simple-ad"],function(t,e,i){"use strict";var s=i.extend({initialize:function(e){e=t.extend({adPlacement:"poster_gallery_companion"},e),i.prototype.initialize.call(this,e),this._initAds()},refresh:function(){this.subviews.simpleAd.refreshPosition()}});return s}),define("modules/carousel/companion",["jquery","underscore","baseview","modules/partner/companion-ad"],function(t,e,i,s){"use strict";var n=i.extend({initialize:function(t){i.prototype.initialize.call(this,t),this.slides=t.slides,this.currentInfo=this.$(".pag-current-info"),this.subviews.ad=new s({el:this.$(".pag-ad"),adPlacement:"poster"})},goToSlide:function(t){this.subviews.ad.refresh();var e=this.slides.eq(t),i=e.find(".pag-photo-info").html();this.currentInfo.html(i)}});return n}),define("modules/carousel/carousel",["jquery","underscore","backbone","baseview","pubsub","state","utils","modules/carousel/gallery","modules/carousel/controls","modules/carousel/thumbs","modules/carousel/companion"],function(t,e,i,s,n,o,r,a,l,h,c){var d=s.extend({events:{mouseenter:"mouseEnter"},selectors:{slides:".slide:not(.partner-placement)",images:".slide:not(.partner-placement,.endslate)",companion:".pag-companion-wrapper"},initialize:function(i){i=t.extend({ads:!0,slideTransition:0,hoverShowControls:!0,hoverTransition:0,interactionDemo:!0,linkPath:null,rotate:!1,controlsSelector:null,gallerySelector:null,thumbsSelector:".thumbs",imageLazySrcAttr:"data-src",scrollerColor:"light",rotateInterval:3e3,autostart:!1},i),e.bindAll(this,"rotateCarousel"),this.index=this.$(".slide.active").index(),-1===this.index&&(this.index=0),this.linkPath=i.linkPath?i.linkPath:"",this.playTimer=null,this.subviews={},this.triggerAdRefresh=0===this.$$(this.selectors.companion).length,this._initializeGallery(i.imageLazySrcAttr,i.slideTransition,i.ads,i.gallerySelector,this.triggerAdRefresh),this._initializeControls(i.hoverShowControls,i.interactionDemo,i.controlsSelector),this._initializeThumbs(i.hoverTransition,i.scrollerColor,i.thumbsSelector),this._initializeCompanion(this.selectors.slides),this.pubSub={"carousel:stoptimer":this.stoptimer,"carousel:starttimer":this.resumeAutoPlay},s.prototype.initialize.call(this,i),i.autostart&&this._startCarouselRotate()},_initializeCompanion:function(t){this.$$(this.selectors.companion).each(e.bind(function(e,i){this.subviews.companion=new c({el:i,slides:this.$$(t)})},this))},_initializeGallery:function(t,e,i,s,n){this.subviews.gallery=new a({ads:i,el:s?this.$(s):this.$el,index:this.index,imageLazySrcAttr:t,slideTransition:e,carousel:this,triggerAdRefresh:n})},_initializeControls:function(t,e,i){var s=this.$(this.selectors.images),n=this.$$(this.selectors.slides);this.subviews.controls=new l({el:i?this.$(i):this.$el,hoverShowControls:t,interactionDemo:e,index:this.index,totalSlides:n.length,totalImages:s.length,carousel:this}),this.subviews.controls.render()},_initializeThumbs:function(t,e,i){this.subviews.thumbs=new h({el:i?this.$(i):this.$el,hoverTransition:t,index:this.index,scrollerColor:e,carousel:this})},mouseEnter:function(){this.options.autostart&&this._stopCarouselRotate()},rotateCarousel:function(){var t=this.$$(this.selectors.slides).length-1;this.switchSlide(null,1,!0),this.index!==t||this.options.rotate||this._stopCarouselRotate()},destroy:function(t){this.playTimer&&this._stopCarouselRotate(),s.prototype.destroy.call(this,t)},stoptimer:function(){clearInterval(this.playTimer),this.playTimer=null},switchSlide:function(t,e,i){var s=this.$$(this.selectors.slides).length;if(!this.showingAd&&this.subviews.gallery.shouldShowAd())return this.showingAd=!0,this.slideAdStep=e,void this.triggerEvent("showAd");if(e){this.slideAdStep&&this.slideAdStep!==e&&(e+=this.slideAdStep);var n=this.index+e;t=0>n?s-1:n>=s?0:n}else 0>t?t=0:t>=s&&(t=s-1);(this.index!==t||this.showingAd)&&(this.showingAd=!1,this.slideAdStep=0,this.index=t,this.triggerEvent("goToSlide",t),i||this._trackSlideChange())},_trackSlideChange:function(){var e;e=this.$el.hasClass("galleries")?this.$el:this.$(".galleries");var i=e.attr("data-gallery-id"),s=(e.attr("data-gal-pageurl")||"").replace(/^.*\/\/[^\/]+/,""),r=o.getActivePageInfo().contenttype;r?-1===r.indexOf("gallery")&&(r=t.trim(r)+" gallery"):r="galleries";var a={gallery_id:i,gallery_title:e.attr("data-title"),gallery_index:this.index+1,slide_id:e.find(".slide.active img").attr("data-id"),ssts:e.attr("data-ssts"),cst:(e.attr("data-cst")||"bugpages").replace(/\/+$/,""),contenttype:"snapshot"===i?"snapshot":r,pathName:""===s?this.linkPath:s};n.trigger("slide:change",a),t.ajax({url:window.site_static_path+"html/comscorepvcandidate.xml",cache:!1})},autoplay:function(){this.playTimer?this._stopCarouselRotate():this._startCarouselRotate(!0)},_startCarouselRotate:function(t){this.playTimer=setInterval(this.rotateCarousel,this.options.rotateInterval),t&&this.rotateCarousel(),this.triggerEvent("onPlay")},_stopCarouselRotate:function(){this.stoptimer(),this.options.autostart=!1,this.triggerEvent("onStop")},resumeAutoPlay:function(){this.options.autostart&&!this.playTimer&&this._startCarouselRotate()},toggleThumbnail:function(){this.triggerEvent("viewportResize")},viewportResize:function(){this.triggerEvent("viewportResize")}});return d}),define("modules/carousel/carousel-autosize",["jquery","underscore","backbone","baseview","utils","modules/carousel/carousel"],function(t,e,i,s,n,o){var r=o.extend({initialize:function(i){e.bindAll(this,"handleResizeWindow"),this.options=t.extend({hoverShowControls:!1,verticalAdjust:80,interactionDemo:!1,horizontalAdjust:0,thumbSize:84,imageLazySrcAttr:"data-large-src"},i),this.$win=n.get("win"),this.$el.hasClass("galleries")?this.$el.addClass("autosize"):this.$(".galleries").addClass("autosize");var s=e.throttle(this.handleResizeWindow,50);this.$win.on("resize."+this.cid,s),this.handleResizeWindow(),o.prototype.initialize.call(this,this.options),this.subviews.gallery.render()},destroy:function(t){this.$win.off("."+this.cid),o.prototype.destroy.call(this,t)},handleResizeWindow:function(){this.windowHeight=this.$win.height(),this.windowWidth=this.$win.width(),this.viewportResize()},viewportResize:function(){var t=this.windowHeight-this.options.verticalAdjust;this.showThumbs&&(t-=this.options.thumbSize),this.$$(".viewport").height(t),this.triggerEvent("viewportResize",this.windowWidth-this.options.horizontalAdjust,t)},toggleThumbnail:function(t){this.showThumbs=t,this.viewportResize()}});return r}),define("modules/videos/video-transcript",["jquery","underscore","baseview","state","pubsub"],function(t,e,i,s,n){"use strict";var o=i.extend({events:{"click .video-transcript-caption":"onClickVideoSeek","click .video-transcript-keywordresult":"onClickkeyword","keydown .video-search-input":"onKeyDown","click .ui-ramp-transcriptplus":"onClickTranscriptSlide","click .toggle-transcript":"onClickTranscriptSlide","click .video-search-btn":"onClickVideoSearch","click .video-search-close-btn":"onClickSearchCloseBtn","click .transcript-navigate-next-active":"nextslide","click .transcript-navigate-prev-active":"prevslide","mouseenter .video-full-transcript-text":"toggleautoscroll","mouseleave .video-full-transcript-text":"toggleautoscroll"},initialize:function(e){var s=t.extend(!0,{animations:{useCSSTransitions:!1}},e);i.prototype.initialize.call(this,s),this.currentplayer=this.options.player||{},this.$viewport=this.$(".keywords-viewport"),this.$searchViewport=this.$(".search-viewport"),this.$keywordWindow=this.$(".video-keywords-result"),this.$searchWindow=this.$(".video-search-result"),this.initializeTranscript(),this.$searchinput=this.$(".video-search-input"),this.$keywords=this.$(".video-transcript-keywords"),this.$search=this.$(".video-transcript-search"),this.$searchresults=this.$(".video-search-display"),this.$searchCancelBtn=this.$(".video-search-close-btn"),this.$search.hide(),this._currentSlideCount=1,this.autoscroll=!0},onClickVideoSearch:function(e){this.$currentcaption.blur();var i,s;this.$searchresults.empty(),this.$searchWindow.empty(),this.clearActiveArrows();var n=this.$searchinput.val().toLowerCase(),o=new RegExp("\\b"+n+"\\b"),r=n.split(" ");if(0!==n.length){var a=this.$videotranscriptmain.filter(function(){return t(this).text().toLowerCase().search(o)>-1});if(2==r.length){var l=this.$videotranscriptmain.filter(function(){var e=t(this),i=t.trim(e.text().toLowerCase()).split(" ");if(i[i.length-1]==r[0]){var s=t.trim(e.next().text().toLowerCase()).split(" ");return s[0]==r[1]}return!1});l.length>0&&(a=a.add(l))}if(0===a.length&&"undefined"!=typeof e&&e.currentTarget.getAttribute("data-startoffset")&&(a=a.add(t(e.currentTarget))),this.trackclicks(this.$searchinput.data().track),this.$keywords.hide(),this.$search.show(),this.$searchOpen=this.$(".transcript-search-input"),this.$searchOpen.removeClass("video-search-open-button"),this.$searchCancelBtn.addClass("video-search-close-btn-visible"),this.$searchresults.addClass("show-results"),0!==a.length){this.$searchresults.append("<span class='video-search-term'>"+n+"</span> found at");for(var h=0;h<a.length;h++)i=a[h].getAttribute("data-startoffset"),s=a[h].getAttribute("data-startoffset_display"),this.$searchWindow.append("<span class='video-transcript-caption transcript-search-result' data-track='searchclick' data-startoffset="+i+">"+s+"</span>")}else this.$searchresults.append("<span class='no-results'>No results found for <span class='video-search-term'>\""+n+'"</span></span>')}this.updateSlideCount(),this.loadActiveArrows(),this._currentSlideCount=1},onKeyDown:function(t){var e=t.keyCode?t.keyCode:t.which;13===e&&(this.$searchresults.empty(),this.$searchWindow.empty(),this.onClickVideoSearch(t))},onClickSearchCloseBtn:function(){this.$searchCancelBtn.removeClass("video-search-close-btn-visible"),this.$searchOpen.addClass("video-search-open-button"),this.$searchresults.removeClass("show-results"),this.$searchresults.empty(),this.$searchWindow.empty(),this.clearActiveArrows(),this.$searchWindow.css("left","auto"),this.$keywordWindow.css("left","auto"),this.$searchinput.val(""),this.$search.hide(),this.$keywords.show(),this.updateSlideCount(),this.loadActiveArrows(),this._currentSlideCount=1},togglesearch:function(t){var e=this.$(".video-full-transcript-control");t&&e.hasClass("searchcontroloff")?(e.removeClass("searchcontroloff"),this.trackclicks("open-search"),this.updateSlideCount(),this.loadActiveArrows()):(e.addClass("searchcontroloff"),this.trackclicks("close-search"))},isTranscriptAvailable:function(){return this.$videotranscriptmain.length>0},initializeTranscript:function(){this.$videotranscriptmain=this.$(".video-transcript-caption"),this.$currentcaption=t(this.$videotranscriptmain[0]),this.clearHighlight(this.$currentcaption),this.addHighlight(this.$currentcaption),!this.options.player.hidesearchcontrol&&this.options.player.flashsearchcontrolOn&&(this.updateSlideCount(),this.loadActiveArrows())},loadActiveArrows:function(){this.$(".video-transcript-keywords").is(":visible")?!this.$(".video-transcript-navigate-next").hasClass("transcript-navigate-next-active")&&this.$keywordWindow.width()>this.$viewport.width()&&this.$(".video-transcript-navigate-next").addClass("transcript-navigate-next-active"):this.$search.is(":visible")&&!this.$(".video-transcript-navigate-next").hasClass("transcript-navigate-next-active")&&this.$searchWindow.width()>this.$searchViewport.width()&&this.$(".video-transcript-navigate-next").addClass("transcript-navigate-next-active")},clearActiveArrows:function(){this.$(".video-transcript-navigate-next").removeClass("transcript-navigate-next-active"),this.$(".video-transcript-navigate-prev").removeClass("transcript-navigate-prev-active")},onClickVideoSeek:function(e){var i=t(e.currentTarget),s=i.data();this.trackclicks(s.track),this.options.seek&&this.options.seek(s.startoffset)},onClickkeyword:function(e){var i=t(e.currentTarget).text();this.$searchinput.val(t.trim(i)),this.onClickVideoSearch(e)},progressHighlight:function(t){this.$currentcaption&&t.position>parseFloat(this.$currentcaption.attr("data-startoffset"))+parseFloat(this.$currentcaption.attr("data-duration"))&&(this.clearHighlight(this.$currentcaption),this.addHighlight(this.$currentcaption.next()))},clearHighlight:function(t){t.hasClass("active-transcript")&&t.removeClass("active-transcript")},toggleautoscroll:function(t){this.autoscroll="mouseenter"==t.type?!1:!0},transcriptautoscroll:function(t){if(this.autoscroll){var e=t.offsetTop-t.parentElement.offsetTop;this.$(".video-full-transcript-text").animate({scrollTop:e},1e3)}},addHighlight:function(t){t.length>0&&(this.transcriptautoscroll(t[0]),this.$currentcaption=t,this.$currentcaption.addClass("active-transcript"))},onStatusChange:function(i){if("mediaSeekNotify"===i.type){this.clearHighlight(this.$currentcaption);{e.find(this.$videotranscriptmain,function(e){var s=t(e);return i.position<s.data().startoffset+s.data().duration?(this.$currentcaption=s,this.addHighlight(s),!0):void 0},this)}}else"mediaBegin"===i.type&&i.media.referenceId.toString()!=this.options.video.id&&this.$el.hide()},onClickTranscriptSlide:function(){this.trackclicks("transcript"),this.$(".video-full-transcript-text").toggle("slow")},keywordSlide:function(t,e){return this.animate(t,"left",e+"px",250,"easeInOutQuad")},nextslide:function(){var t=this.getCurrentSlide();0!==this.totalSlides&&t!=this.totalSlides&&(this.targetWindow=1==t?-1*this.slideWidth:this.slideWidth*t*-1,this.$(".video-transcript-keywords").is(":visible")?this.keywordSlide(this.$keywordWindow,this.targetWindow):this.$search.is(":visible")&&this.keywordSlide(this.$searchWindow,this.targetWindow),this._currentSlideCount+=1,this.$(".video-transcript-navigate-prev").addClass("transcript-navigate-prev-active")),this._currentSlideCount==this.totalSlides&&this.$(".video-transcript-navigate-next").removeClass("transcript-navigate-next-active")},prevslide:function(){var t=this.getCurrentSlide();0!==this.totalSlides&&1!=t&&(this.targetWindow=this.slideWidth*(t-2)*-1,this.$(".video-transcript-keywords").is(":visible")?this.keywordSlide(this.$keywordWindow,this.targetWindow):this.$search.is(":visible")&&this.keywordSlide(this.$searchWindow,this.targetWindow),this._currentSlideCount-=1,this.$(".video-transcript-navigate-next").addClass("transcript-navigate-next-active"),1==this._currentSlideCount&&this.$(".video-transcript-navigate-prev").removeClass("transcript-navigate-prev-active"))},getCurrentSlide:function(){return this._currentSlideCount},updateSlideCount:function(){var t,e;this.$(".video-transcript-keywords").is(":visible")?(t=this.$keywordWindow,e=t.width(),this.viewportWidth=this.$viewport.width()):this.$search.is(":visible")&&(t=this.$searchWindow,e=t.width(),this.viewportWidth=this.$searchViewport.width()),this.slideWidth=Math.floor(this.viewportWidth/2),e>this.viewportWidth/2&&(this.totalSlides=2*Math.ceil(e/this.viewportWidth))},trackclicks:function(t){n.trigger("uotrack","ramp"+this.currentplayer.name+t)}});return o}),define("modules/stories/taboola-recommendations",["jquery","underscore","baseview","state","managers/routemanager","utils","modules/global/taboola","pubsub"],function(t,e,i,s,n,o,r,a){"use strict";var l=i.extend({events:{"click .headline img":"taboolaPixelTracking"},initialize:function(t){this.texttype=s.getActivePageInfo().texttype||"story",e.bindAll(this,"showTaboola","showNextRecommendation"),i.prototype.initialize.call(this,t),this.$endslate=this.$("#endslate-taboola-template"),this.$endslate_template=this.$(".video-endslate"),this.render()},render:function(){var e;if("galleries"===this.texttype||-1!==this.texttype.indexOf("video"))0===this.$(".gallery-more .headline").length&&(this.subviews.taboola||(this.subviews.taboola=new r),"galleries"===this.texttype?this.subviews.taboola.getRelated(this.showTaboola,"photo","photo",null,null,s.getActivePageInfo().assetid):this.subviews.taboola.getRelated(this.showTaboola,"video","video",null,null,t(".videoObject").attr("data-brightcove-video-id")));else{if("interactive"!==this.texttype){var i=this.$(".double-wide"),n=this.$(".story-right-rail");if(!i.length)return;var o=i.position().top,a=i.height(),l=n.position().top+n.height()-o;l-50>a&&(e=!0)}t(".iframe-auto").length>0&&(e=!0),this.createTaboola(e)}},createTaboola:function(t){var e;t?(e={widget:[{mode:"verticalx8",container:"taboola-div-verticalx8"}]},this.$(".more-stories-wrap").addClass("vertical")):e=-1!==o.getPageUrl().indexOf("/sports/")||-1!==o.getPageUrl().indexOf("/gameon/")?{widget:[{mode:"grid-sports",container:"taboola-div-grid-2x4"}]}:{widget:[{mode:"grid-2x4",container:"taboola-div-grid-2x4"}]},this.subviews.taboola=new r(e)},showTaboola:function(t){var i=this.$("#more-galleries-template");if(1===i.length){var s=e.template(i.html(),{data:t.list});this.$(".headlines.gallery-more").append(s)}},renderEndslate:function(t,e){this.subviews.taboola||(this.subviews.taboola=new r),this.subviews.taboola.getRelated(this.showNextRecommendation,"video","video",1,t,e)},showNextRecommendation:function(t){var i=decodeURIComponent(t.list[0].url.match(/\&redir\=(.+)/)[1]),n=i.replace(/^.*\/\/[^\/]+/,""),o=n.replace(/^\D+/g,"");s.fetchData("/videos/services/"+o).done(e.bind(function(e){e?(this.videoResponse=e,this.video_media_url=decodeURIComponent(t.list[0].url.match(/\&redir\=(.+)/)[1]),this.temp_media_url="/media/cinematic/video/"+o):a.trigger("uotrack","taboola-no-recommendations")},this))},populateEndslate:function(t,i){this.$endslate_markup=t,this.$endslate=this.$endslate_markup.find("#endslate-taboola-template");var s=this.videoResponse.url.replace(/^.*\/\/[^\/]+/,"");i&&(s=this.video_media_url.replace(/^.*\/\/[^\/]+/,""));var o=e.template(this.$endslate.html(),{data:this.videoResponse});this.$endslate_markup.append(o),this.showendslate();var r=3;this.timer=setInterval(e.bind(function(){this.$endslate_markup.find(".counter").text("0"+r--),-1==r&&(clearInterval(this.timer),this.destroyed||n.goTo(s))},this),1e3)},showendslate:function(){this.$endslate_markup.addClass("video-endslate-active")},taboolaPixelTracking:function(e){{var i=t(e.currentTarget),s=window.site_config.THIRDPARTYAPI.Taboola.publisher_id,n=window.site_config.THIRDPARTYAPI.Taboola.apiKey,r=o.get("taboolaResponseID"),a=i.attr("data-type"),l=i.attr("data-id");t("<img/>").attr("src","http://api.taboola.com/1.0/json/"+s+"/recommendations.notify-click?app.type=desktop&app.apikey="+n+"&response.id="+r+"&item.type="+a+"&item.id="+l).load()}},destroy:function(){clearInterval(this.timer),i.prototype.destroy.apply(this,arguments)}});return l}),define("modules/videos/brightcove-video",["jquery","underscore","baseview","state","utils","admanager","pubsub","modules/videos/video-transcript","adLogger","modules/stories/taboola-recommendations"],function(t,e,i,s,n,o,r,a,l,h){"use strict";var c=i.extend({events:{"click .ui-video-still-image-active, .ui-video-play-btn-active":"onClickVideoStill"},initialize:function(s){s=t.extend({video:this.$(".ui-video-data").eq(0).html(),player:this.$(".ui-video-player-data").eq(0).html(),brightcovePlayerParams:null,onStatusChange:null,onProgressChange:null,onClickPlay:null,customContainerClass:""},s),e.bindAll(this,"onVideoStatusChange","onVideoProgressChange","seekVideo","onVideoError","destroy"),this.pubSub={"pause:videos":this.onPauseVideo,"page:load":this.onPageLoad},i.prototype.initialize.call(this,s),this.$videoStill=this.$(".ui-video-still-image"),this.$playBtn=this.$(".ui-video-play-btn"),this.isVideoStillActiveClassPreExisting=this.$videoStill.hasClass("ui-video-still-image-active"),this.isPlayBtnActiveClassPreExisting=this.$playBtn.hasClass("ui-video-play-btn-active"),window.BCCallbacks||(window.BCCallbacks={}),this.video=this._buildVideoData(),this.player=this._buildPlayerData()},playerKey:1,_buildVideoData:function(){var t=this.options.video||{};return"string"==typeof t&&(t=JSON.parse(t)),t},playVideo:function(){var t=this.getVideoData().id;t?(this.hideStill(),this.loadPlayer().then(function(e){e.getIsPlaying(function(i){i?e.pause(!1):e.loadVideoByReferenceID(t)})})):console.warn("cannot autoplay video: no video id was specified!")},_buildPlayerData:function(){var e=this.options.player||{};return"string"==typeof e&&(e=t.parseJSON(e)),t.extend({width:480,height:270},e)},getVideoData:function(){return this.video},getPlayerData:function(){return this.player},onPageLoad:function(){o.getActiveSlotStatistics().done(e.bind(function(t){!this.getPlayerData().autoplay||e.findWhere(t.high_impact_info,{adType:"gravity"})||this.destroyed||this.playVideo()},this))},_loadScript:function(){return this._loadScriptPromise||(this._loadScriptPromise=t.Deferred(function(t){require(["http://admin.brightcove.com/js/BrightcoveExperiences.js"],function(){"undefined"!=typeof window.brightcove?t.resolve():(console.warn("Error loading Brightcove"),t.reject())})})),this._loadScriptPromise.promise()},loadPlayer:function(){return this._loadScript().then(e.bind(function(){if(!this._loadPlayerPromise){var t=this.getPlayerKey();this.video.transcript_available&&(this.subviews.videotranscript=new a({el:this.$el.siblings(".ui-video-controls"),seek:this.seekVideo,video:this.video,player:this.player})),this._loadPlayerPromise=this._createPlayer(t).then(e.bind(function(e){return this.setupPlayer(e,t),this.$el.addClass("video-player-loaded"),this._player=e,e},this))}return this._loadPlayerPromise},this))},setupPlayer:function(t,i){this.setupEventListeners(t),this.addPlayerCallback(i,"onClickShareButton",e.bind(function(){this.onClickShareButton()},this)),this.addPlayerCallback(i,"onClickSearchButton",e.bind(function(t){this.onClickSearchButton(t)},this))},_createPlayer:function(i){return this._videoObjEl=this._buildVideoObjectHtml(i),t.Deferred(e.bind(function(t){this.getPlayerData().id?(this.addPlayerCallback(i,this.getPlayerReadyCallbackKey(),function(){var e=window.brightcove.api.getExperience(i),s=e.getModule(window.brightcove.api.modules.APIModules.VIDEO_PLAYER);t.resolve(s)}),this.addPlayerCallback(i,this.getPlayerErrorCallbackKey(),function(e){var i=e.errorType;4===e.code?i="error creating video player because of "+e.errorType:(console.warn("video player error: "+i),t.reject(e))}),window.brightcove.createExperiencesPostLoad=function(){},window.brightcove.createExperience(this._videoObjEl,this.$el[0],!0)):(console.warn("error creating video player: no video player id was specified!"),t.reject())},this))},onClickShareButton:function(){s.getActiveApp().$(".util-bar-btn-email").click()},onClickSearchButton:function(t){this.subviews.videotranscript.togglesearch(t)
},onPauseVideo:function(){this._player&&this._player.pause()},addPlayerCallback:function(t,e,i){window.BCCallbacks[t]||(window.BCCallbacks[t]={}),window.BCCallbacks[t][e]||(window.BCCallbacks[t][e]={}),window.BCCallbacks[t][e]=function(){i.apply(this,arguments)}},setupEventListeners:function(t){this.eventListeners={BEGIN:this.onVideoStatusChange,COMPLETE:this.onVideoStatusChange,PLAY:this.onVideoStatusChange,STOP:this.onVideoStatusChange,SEEK_NOTIFY:this.onVideoStatusChange,PROGRESS:this.onVideoProgressChange,ERROR:this.onVideoError,CHANGE:this.onVideoProgressChange},this.mediaEventApi=window.brightcove.api.events.MediaEvent,e.each(this.eventListeners,function(e,i){t.addEventListener(this.mediaEventApi[i],e)},this)},removeEventListeners:function(t){e.each(this.eventListeners,function(e,i){t.removeEventListener(this.mediaEventApi[i],e)},this)},onVideoStatusChange:function(t){if("mediaBegin"===t.type){var e="video:load";s.stopRefreshTimer(),r.trigger(e,this.getVideoEventAnalyticsData(t,e))}else"mediaComplete"===t.type?this.player.gannett_continuous_endslate&&(this.subviews.TaboolaOutbrain?(this.$endslate_template=this.$(".video-endslate"),this.subviews.TaboolaOutbrain.populateEndslate(this.$endslate_template,this.player.mediatemplate)):this.reset()):r.trigger("uotrack",t.type);this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()&&this.subviews.videotranscript.onStatusChange(t),this.options.onStatusChange&&this.options.onStatusChange(t)},onVideoProgressChange:function(t){this.trackVideoProgressEvent(t),this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()&&this.subviews.videotranscript.progressHighlight(t),this.options.onProgressChange&&this.options.onProgressChange(t)},onVideoError:function(t){r.trigger("uotrack","videoError:"+this.player.name+":"+(t.errorType||t.code))},trackVideoProgressEvent:function(t){var e=t.duration,i=t.position,s=Math.round(i/e*100);!this.fiftypercent&&s>=50&&95>s?(r.trigger("vitrack","50%"),this.fiftypercent=!0):!this.ninetyfivepercent&&s>=95&&99>s&&(r.trigger("vitrack","95%"),this.ninetyfivepercent=!0,this.subviews.TaboolaOutbrain||(this.subviews.TaboolaOutbrain=new h,this.subviews.TaboolaOutbrain.renderEndslate(this.video.url,this.video.brightcove_id)))},_buildVideoObjectHtml:function(e){var i=document.createElement("object"),s=this.getPlayerData(),n=this.getVideoData();i.setAttribute("id",e),i.className="brightcove-video-object "+this.options.customContainerClass,i.setAttribute("style","width: "+s.width+"px; height: "+s.height+"px;");var o=t.extend({},this.getDefaultParams(e),this.options.brightcovePlayerParams);for(var r in o)if(o.hasOwnProperty(r)){var a=document.createElement("param");a.name=r,a.value=o[r],i.appendChild(a)}if(n&&(n.id||n.brightcove_id)){var l=document.createElement("param");l.name="@videoPlayer",l.value=n.id?"ref:"+n.id:n.brightcove_id,i.appendChild(l)}return i},getDefaultParams:function(t){var e=this.getVideoData(),i=this.getPlayerData(),s={};return s={bgcolor:"#FFFFFF",playerID:i.id,width:i.width,height:i.height,autoStart:!1,isVid:!0,isUI:!0,wmode:"transparent",htmlFallback:!0,dynamicStreaming:!0,includeAPI:!0,usat_hasEmbed:!0,templateReadyHandler:"BCCallbacks."+t+"."+this.getPlayerReadyCallbackKey(),templateErrorHandler:"BCCallbacks."+t+"."+this.getPlayerErrorCallbackKey(),adServerURL:this._buildAdServerParam(),usat_linkurl:e.url||"",SSTSCode:(e.ssts_string||"")+"/"},!this.player.hidesearchcontrol&&this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()&&(s.usat_searchToggled=this.player.flashsearchcontrolOn?"true":"false",s.usat_searchFunction="function(e){setTimeout(BCCallbacks."+t+".onClickSearchButton(e), 1)}"),this.player.overridesharecontrol&&(s.usat_shareFunction="function(){setTimeout(BCCallbacks."+t+".onClickShareButton(), 1)}"),s},_buildAdServerParam:function(){var e=((t.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join(","),i=t.cookie("aam_uuid"),n="",r=s.getActivePageInfo(),a=this.getVideoData();r.series&&(n+="&series="+encodeURIComponent(r.series)),r.topic&&(n+="&topic="+encodeURIComponent(r.topic)),n+="&aam="+e+"&u="+i;var h="http://pubads.g.doubleclick.net/gampad/ads?env=vp&gdfp_req=1&impl=s&output=xml_vast2&iu="+o.buildAdUnit("preroll_video")+"/"+a.cst+"&sz=920x508&unviewed_position_start=1&cust_params=ttid%3D"+a.id+encodeURIComponent(n)+'&cmsid=12768&url=""';return l.logInfo("Built ad call for video, "+a.id+".",r,a),l.logInfo("Video Ad call: "+h),h},getVideoEventAnalyticsData:function(t,e){var i=t.duration,s=t.media,n=Math.round(t.position/i*100),o=this.getVideoData(),r=this.getPlayerData(),a={completion:n+"%",videoFulllengthUrl:s.FLVFullLengthURL,eventtype:e||t.type,videoName:s.customFields.liveVideoSubject||s.displayName,contentid:s.id,assetid:s.referenceId,ssts:o.ssts_string||s.customFields.gdp_ssts,cst:o.cst||s.customFields.gdp_cst,keywords:o.keywords||s.customFields.gdp_tags,videoplayername:r.name,videocontentprovider:o.videocontentprovider||s.customFields.gannetttracking+"|"+s.displayName,contenttype:o.type||"video",videotranscript:this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()?"yes":"no"};return a.videoDuration=0>i?"":120>i?"less than 2 min":"greater than 2 min",o.url&&(a.pathName=o.url.replace(/^.*\/\/[^\/]+/,"")),a},getPlayerReadyCallbackKey:function(){return"onTemplateReady"},getPlayerErrorCallbackKey:function(){return"onTemplateError"},getPlayerKey:function(){return this._playerKey||c.prototype.playerKey++,this._playerKey="myExperience"+c.prototype.playerKey,this._playerKey},onClickVideoStill:function(t){this.options.onClickPlay?this.options.onClickPlay(t):this.playVideo()},hideStill:function(){this.$videoStill.removeClass("ui-video-still-image-active"),this.$playBtn.removeClass("ui-video-play-btn-active")},showStill:function(){this.$videoStill.addClass("ui-video-still-image-active"),this.$playBtn.addClass("ui-video-play-btn-active")},reset:function(){var t=this._player;this.showStill(),t&&t.getIsPlaying(function(e){e&&t.getVideoPosition(!1,function(e){0!==e&&t.seek(0),t.pause(!0)})})},_destroyVideoObjectElement:function(){this._videoObjEl&&(t("#"+this.getPlayerKey()).remove(),this._videoObjEl=null)},seekVideo:function(t){this._player.getIsPlaying(e.bind(function(e){e&&this._player.seek(t)},this))},_resetPlayerModule:function(){this._player&&(this.removeEventListeners(this._player),this._player=null)},_getPreExistingActiveClass:function(t){var e=t+"-active";return this.isPlayBtnActiveClassPreExisting||this.isVideoStillActiveClassPreExisting?e:""},destroy:function(e,n){if(s.startRefreshTimer(),!n){var o=this.getPlayerKey();window.BCCallbacks&&window.BCCallbacks[o]&&delete window.BCCallbacks[o],window.BCCallbacks&&t.isEmptyObject(window.BCCallbacks)&&delete window.BCCallbacks,this._resetPlayerModule(),this._destroyVideoObjectElement(),this.$el.removeClass("video-player-loaded"),this.$videoStill.addClass(this._getPreExistingActiveClass("ui-video-still-image")),this.$playBtn.addClass(this._getPreExistingActiveClass("ui-video-play-btn"))}i.prototype.destroy.apply(this,arguments)}});return c}),define("modules/scroller/vertical-scroll",["jquery","underscore","utils","modules/scroller/base-scroll"],function(t,e,i,s){var n=s.extend({initialize:function(i){i=t.extend({color:"light",fadeout:!1,draggerPaddingTop:3,draggerPaddingBottom:3},i);var n=this.options.fadeout?"fadeout":"",o=e.template('<div class="vertical-scroll ui-<%= color %> <%= fade %>"><div class="scrolldragger"><div class="over-icon"></div></div></div>');i.template=o({color:i.color,fade:n}),this.$(".vertical-scroll").remove(),s.prototype.initialize.call(this,i)},getViewportSize:function(){return this.$el.height()},getContentSize:function(){return this.content.height()},_setDraggerSize:function(t){return t-=this.options.draggerPaddingTop+this.options.draggerPaddingBottom,this.dragger.css({height:t}),t},animateContentToPosition:function(i,s,n,o){var r=this.viewportSize-this.contentSize,a=Math.max(r,Math.min(s,0));return o=o||"ease-out",t.when(this.animate(this.dragger,"top",-1*a*this.contentViewportRatio+"px",n||0,o),this.animate(this.content,"top",a+"px",n,o)).done(e.bind(function(){this.$el.trigger("scrollBarUpdate",[a/r])},this))},scrollToElement:function(t,e,i,s){var n,o=t.outerHeight(),r=t.position().top+t.parent().position().top,a=r+o;if(0>r){var l=this.getViewportSize();n=e?r+(o-l):r}else a>this.getViewportSize()&&(n=e?r:r+(o-this.getViewportSize()));if(n){var h=this.content.position().top-n;this.animateContentToPosition(0,h,i,s)}},moveContentToPosition:function(t,e){if(!this.active)return!1;var i=Math.min(this.viewportSize-this.contentSize,0),s=Math.max(i,Math.min(e,0));return this._positionDragger(-1*s*this.contentViewportRatio),this._positionContent(s),this.$el.trigger("scrollBarUpdate",[s/i]),s===e},moveDraggerToPosition:function(t,e){if(!this.active)return!1;var i=this.viewportSize-(this.draggerSize+this.options.draggerPaddingBottom+this.options.draggerPaddingTop),s=Math.max(0,Math.min(e,i));return this._positionDragger(s),this._positionContent(-1*s/this.contentViewportRatio),this.$el.trigger("scrollBarUpdate",s/i),s===e},_positionDragger:function(t){t+=this.options.draggerPaddingTop,t=Math.round(t),this.dragger.css({top:t})},_positionContent:function(t){t=Math.round(t),this.content.css({top:t}),"function"==typeof this.options.onScroll&&this.options.onScroll(t)}});return n}),define("ui/dropdown",["jquery","underscore","utils","managers/routemanager","baseview","state","modules/scroller/vertical-scroll"],function(t,e,i,s,n,o,r){"use strict";var a=n.extend({events:{"click .ui-dropdown-value":"onClick",keydown:"onKeyDown","click .ui-dropdown-item":"onItemClick","mouseenter .ui-dropdown-item":"onItemHover","click .ui-dropdown-item-link":"onItemLinkClick"},initialize:function(s){s=t.extend({onSelect:null},s),e.bindAll(this,"refresh"),n.prototype.initialize.call(this,s),this.body=i.get("body"),this.$el.attr("tabindex")||this.$el.attr("tabindex",0),this.dropdownItems=this._setupDropdownItems(this.$(".ui-dropdown-item")),this.dropdownValueDiv=this.$(".ui-dropdown-value"),this.defaultItem=this.dropdownItems.filter('[data-selected="selected"]'),this.setValue(this.defaultItem.data("value"),this.defaultItem.text())},_setupDropdownItems:function(e){var i=e.filter('[data-selected="selected"]');if(1!==i.length){var s=e.eq(0);s.length&&s.attr("data-selected","selected")}return e.each(function(e,i){var s=t(i),n=s.find("a");s.addClass(n.length?"ui-dropdown-item-with-link":"ui-dropdown-item-without-link")}),e},open:function(){var i=this.getDataValue(),s=this.getDropdownItemByDataValue(i);s.eq(0).attr("data-selected","selected").addClass("ui-dropdown-item-highlight"),this.$el.addClass("expanded"),this.isDropdownOpen=!0,this.subviews.scrollbar?this.subviews.scrollbar.refresh():this.subviews.scrollbar=new r({el:this.$(".ui-dropdown-content"),contentClass:".ui-dropdown-items-container",padding:6}),s.length&&this.subviews.scrollbar.scrollToElement(s,!1,50),this.body.on("click."+this.cid,e.bind(function(e){0===t(e.target).closest(this.el).length&&this.close()},this))},close:function(){this.$el.removeClass("expanded"),this.dropdownItems.removeClass("ui-dropdown-item-highlight"),this.isDropdownOpen=!1,this.body.off("click."+this.cid)},onClick:function(){this.isDropdownOpen?this.close():this.open()},onKeyDown:function(t){var e=t.keyCode?t.keyCode:t.which;if(38===e||40===e)return this.isDropdownOpen?this.onResultItemUpDownArrowKeyPress(e):this.open(),void t.preventDefault();if(27===e)this.isDropdownOpen&&(t.preventDefault(),this.close());else if(9===e)this.isDropdownOpen&&(t.preventDefault(),this.close());else if(32===e||13===e)return this.onSpaceBarOrEnterKeyPress(),void t.preventDefault()},onResultItemUpDownArrowKeyPress:function(t){var e=this.dropdownItems.filter(".ui-dropdown-item-highlight").eq(0);this.dropdownItems.removeClass("ui-dropdown-item-highlight"),e.length?38===t?(e=e.prev(),e.length||(e=this.dropdownItems.last()),this.subviews.scrollbar&&this.subviews.scrollbar.scrollToElement(e,!1,50)):40===t&&(e=e.next(),e.length||(e=this.dropdownItems.first()),this.subviews.scrollbar&&this.subviews.scrollbar.scrollToElement(e,!1,50)):e=this.dropdownItems.eq(0),e.addClass("ui-dropdown-item-highlight")},onSpaceBarOrEnterKeyPress:function(){var t=this.dropdownItems.filter(".ui-dropdown-item-highlight").eq(0),e=t.find("a").attr("href"),i=t.data("value"),n=t.text();t.length&&this.setValue(i,n),this.options.onSelect&&this.options.onSelect(i,n,t),e&&s.goTo(e)},onItemClick:function(e){var i=t(e.currentTarget),s=i.data("value"),n=i.text();this.setValue(s,n),this.options.onSelect&&this.options.onSelect(s,n,i)},onItemLinkClick:function(e){var i=t(e.currentTarget).closest(".ui-dropdown-item");this.setValue(i.data("value"),i.text())},onItemHover:function(e){this.dropdownItems.removeClass("ui-dropdown-item-highlight"),t(e.currentTarget).addClass("ui-dropdown-item-highlight")},setValue:function(t,e){var i;this.dropdownItems.removeAttr("data-selected"),void 0!==t?(this.dropdownValueDiv.data("value",t),i=this.getDropdownItemByDataValue(t)):i=this.getDropdownItemByDisplayValue(e),this.dropdownValueDiv.html(e),"selected"!==i.eq(0).data("selected")&&i.eq(0).attr("data-selected","selected"),this.isDropdownOpen&&this.close()},getDataValue:function(){return this.dropdownValueDiv.data("value")||""},getDisplayValue:function(){return this.dropdownValueDiv.text()||""},getDropdownItemByDataValue:function(t){return this.dropdownItems.filter('[data-value="'+t+'"]')},getDropdownItemByDisplayValue:function(t){return this.dropdownItems.filter(':contains("'+t+'")')},refresh:function(e){if(e){var i=this._setupDropdownItems(t(e));this.$(".ui-dropdown-items-container").html(i),this.dropdownItems=i}var s=this.dropdownItems.filter('[data-selected="selected"]');this.setValue(s.data("value"),s.text()),this.defaultItem=s},reset:function(){this.setValue(this.defaultItem.data("value"),this.defaultItem.text())},destroy:function(t){this.body.off("."+this.cid),n.prototype.destroy.call(this,t)}});return a}),define("apps/media",["jquery","underscore","pubsub","utils","state","site-manager","base-app","sharedAdPosition","modules/carousel/carousel-autosize","modules/videos/brightcove-video","modules/global/taboola","ui/dropdown"],function(t,e,i,s,n,o,r,a,l,h,c,d){"use strict";var u=r.extend({el:"#media-view",events:{"click .recommended, .more-from, .expando":"mediaTabClick","mouseout .media-playlist":"mediaPlaylistMouseOut","mouseover .media-playlist":"mediaPlaylistMouseIn","click .media-playlist a":"changeMediaClick","click .media-sidebar-list li.sub":"sectionHighlight",click:"userInteraction"},initialize:function(i){i=t.extend(!0,{delay:{playlistAutoClose:250},animations:{slide:{duration:350,easing:"ease-in-out"},cinematic:{change:{fadeOut:{duration:300,easing:"ease-in-out"},fadeIn:{duration:300,easing:"ease-in-out"}}}}},i),e.bindAll(this,"switchToNextVideo","handleResizeWindow"),this.win=s.get("win"),this.scrollEl=s.get("scrollEl"),this.win.on("resize."+this.cid,e.throttle(this.handleResizeWindow,50)),this.playlistTimer=null,this.init=!1,this.subviews={},r.prototype.initialize.call(this,i);var n=t(".sidenav > li.sub-active");this.lastSectionName=n.attr("data-section")},getAd:function(){this.subviews.skinad=new a({el:this.$(".partner-media-ad"),adSizes:["cinematicvideoskin"],adPlacement:"skin_media",adType:"skinmedia",defaultPosition:!0})},handleResizeWindow:function(){this.browse&&this.columnize(this.$el)},beforePageReveal:function(t,e,i){this.isCinematicPath(e)||this.columnize(i)},afterPageReveal:function(t,e){this.isCinematicPath(e)?("galleries"==this.pageInfo.media_type?this._initializeGallery():"videopage"==this.pageInfo.media_type&&(this._initializeVideo(this.$(".ui-video")),this.getAd()),this.browse=!1,this.isCinematicPath(t)||(this.playlistStuckOpen=!1,this.delayClosePlaylist(),t&&this.$(".back-to-media").attr("href",t))):this._initializeBrowse(),this.handleResizeWindow(),this.subviews.filterDropdown||(this.subviews.filterDropdown=new d({el:this.$(".media-view-sort-by-dropdown")})),s.lazyLoadImage(this.$(".more-from").find("img"),"data-src",!0)},animateRevealApp:function(){return o.getHeader().setClosedFixed(),r.prototype.animateRevealApp.apply(this,arguments)},afterAppRemove:function(){o.getHeader().restoreDefaultState()},animateChangePagePostData:function(t,e,i){return this.isCinematicPath(e)?this.isCinematicPath(t)?this._fadeInNewCinematicContent(e,i):this.slide(i,"left",this.options.animations.slide.duration,this.options.animations.slide.easing):this.isCinematicPath(t)?this.slide(i,"right",this.options.animations.slide.duration,this.options.animations.slide.easing):r.prototype.animateChangePagePostData.apply(this,arguments)},animateChangePagePreData:function(t,e){return this.isCinematicPath(t)||this.isCinematicPath(e)?void 0:this.changeBrowseSection(t,e)},changeBrowseSection:function(e,i){var s=this.$(".media-sidebar-list"),o=this._getSubSectionPath(e),r=this._getSubSectionPath(i);if(o!==r){var a,l;return s.children().each(function(e,i){i=t(i);var s=i.attr("data-section")||"";s===o?(a=i.find(".media-sidenav-sublist").slideUp(250).promise(),a.done(function(){i.removeClass("active")})):s===r&&(l=i.find(".media-sidenav-sublist").slideDown(250).promise(),l.done(function(){i.addClass("active")}))}),a&&n.registerAnimation(a),l&&n.registerAnimation(l),t.when(a,l)}},_getSubSectionPath:function(t){if(t=t.replace(/^media\/((latest|popular)\/)?/,"")){var e=t.indexOf("/");return-1===e?t:t.substring(0,e)}return""},isCinematicPath:function(t){return t&&-1!==t.indexOf("/cinematic")},_fadeInNewCinematicContent:function(i,s){return t.Deferred(e.bind(function(t){this._swapRelatedMedia(s),this._swapNavBar(s),this._swapMainView(s,t)},this)).promise()},_swapNavBar:function(t){var i=this.animate(this.$(".cinematic-side-nav-ul"),"opacity",0,this.options.animations.cinematic.change.fadeOut.duration,this.options.animations.cinematic.change.fadeOut.easing);i.done(e.bind(function(){var e=t.find(".cinematic-side-nav-ul");e.css("opacity",0),this.$(".cinematic-side-nav-ul").replaceWith(e),this.animate(e,"opacity",1,this.options.animations.cinematic.change.fadeIn.duration,this.options.animations.cinematic.change.fadeIn.easing)},this))},_swapMainView:function(t,i){var s=this.animate(this.$(".media-main-view"),"opacity",0,this.options.animations.cinematic.change.fadeOut.duration,this.options.animations.cinematic.change.fadeOut.easing);s.done(e.bind(function(){var s=t.find(".media-main-view");if(s.css("opacity",0),this.$(".media-main-view").replaceWith(s),s.length){var n=this.animate(s,"opacity",1,this.options.animations.cinematic.change.fadeIn.duration,this.options.animations.cinematic.change.fadeIn.easing);n.done(e.bind(function(){i.resolve()},this))}else i.resolve()},this))},_swapRelatedMedia:function(t){var i=this.animate(this.$(".recommended"),"opacity",this.options.animations.cinematic.change.fadeOut.duration,this.options.animations.cinematic.change.fadeOut.easing);i.done(e.bind(function(){var e=t.find(".media-tabs-ul .recommended"),i=t.find(".media-playlist > .recommended");e.css("opacity",0),this.$(".media-tabs-ul .recommended").replaceWith(e),this.$(".media-playlist > .recommended").replaceWith(i),e.length&&this.animate(e,"opacity",1,this.options.animations.cinematic.change.fadeIn.duration,this.options.animations.cinematic.change.fadeIn.easing)},this))},_initializeGallery:function(){var t=this.$(".galleries"),e=t.data().galleryId||0;this.subviews.carousel=new l({el:this.$el,gallerySelector:t,scrollerColor:"dark",horizontalAdjust:126,verticalAdjust:117}),this.subviews.taboola=new c,this.subviews.taboola.getRelated(this.showRecommended,"photo","photo",10,null,e)},_initializeVideo:function(t){var e=this.$(".ui-video .brightcove-video-object").attr("id");this.subviews.video=new h({el:t,onVideoStatusChange:this.switchToNextVideo,autostart:!0}),this.subviews.taboola=new c,this.subviews.taboola.getRelated(this.showRecommended,"video","video",10,null,e)},userInteraction:function(){this.switchVideoTimer&&clearTimeout(this.switchVideoTimer)},switchToNextVideo:function(){var t=this.$(".more-from .active").next();t.length&&(this.switchVideoTimer=setTimeout(function(){t.find("a").click()},5e3))},destroyModules:function(){clearTimeout(this.switchVideoTimer),r.prototype.destroyModules.apply(this,arguments)},destroy:function(t){this.win.off("."+this.cid),r.prototype.destroy.call(this,t)},changeMediaClick:function(e){var i=t(e.target);if(this.$(".playlist li.active").removeClass("active"),i.closest("li").addClass("active"),i.closest("nav").hasClass("recommended")){var n=i.closest("img"),o=s.get("taboolaResponseID"),r=n.attr("data-type"),a=n.attr("data-id");c.prototype.registerTaboolaClick(a,r,o)}},mediaTabClick:function(e){var i=this.$(".media-playlist"),s=t(e.target).closest("li");s.hasClass("expando")?i.hasClass("open")?(this.playlistStuckOpen=!1,i.removeClass("open")):(this.playlistStuckOpen=!0,i.addClass("open")):s.hasClass("tab")&&(i.addClass("open"),s.hasClass("active")||(i.find(".media-tabs .active").removeClass("active"),s.addClass("active"),i.find(".playlist").addClass("hidden"),i.find("."+s.attr("for")).removeClass("hidden")))},mediaPlaylistMouseOut:function(){this.playlistStuckOpen||this.delayClosePlaylist()},mediaPlaylistMouseIn:function(){clearTimeout(this.playlistTimer)},delayClosePlaylist:function(){this.$(".media-playlist").removeClass("initial")},_initializeBrowse:function(){this.gridWrapper=this.$(".grid-wrapper"),this.browse=!0},columnize:function(e){var i=360,n=e.find(".medialistitems"),o=t(window).width(),r=o-130-31,a=Math.floor(r/i);1>a&&(a=1),e.find(".media-content").width(a*i),n.removeClass("mediaview-featured"),n.slice(0,a).addClass("mediaview-featured"),s.lazyLoadImage(this.$(".mediaview-featured").find("img"),"data-large-src",!0)},sectionHighlight:function(e){var i=t(e.currentTarget);if(i.hasClass("active")&&!t(e.target).attr("href")){var s=i.children("ul");i.hasClass("collapsed")?(n.registerAnimation(s.slideDown(250).promise()),i.removeClass("collapsed")):(n.registerAnimation(s.slideUp(250).promise()),i.addClass("collapsed"))}},slide:function(i,n,r,a){var l=null,h=null;"left"===n?(l="left",h=-100):"right"===n&&(l="left",h=100);var c=s.getScrollPosition(),d=this.$el.offset().top;o.scrollTop(0),c-=d,this.$el.css(l,"0%"),this.$el.css({position:"absolute",top:-1*c}),i=t(i),i.css(l,-1*h+"%"),i.css({position:"absolute",top:d}),i.insertAfter(this.$el);var u=t.Deferred();return e.defer(e.bind(function(){0!==this.$el.length&&this.animate(this.$el,l,h+"%",r,a);var t=this.animate(i,l,"0%",r,a);t.done(e.bind(function(){this.$el.remove(),i.css({position:"",top:""}),this.setElement(i),u.resolve()},this))},this)),u.promise()},showRecommended:function(i){var s=t("#mediaview-recommended-template");if(1===s.length){var n=e.template(s.html(),{data:i.list});t("#mediaview-cinematic-recommended").append(n)}}});return u}),define("apps/404",["jquery","underscore","backbone","state","pubsub","apps/simple-overlay"],function(t,e,i,s,n,o){var r=o.extend({initialize:function(t){o.prototype.initialize.call(this,t),this.options.ajax&&(this.render(this.options.htmlFrag),s.registerFullScreenView(this),this.afterPageReveal())},close:function(t){return t&&t.target!==t.currentTarget?void 0:(this.options.ajax?(s.clearFullScreenView(this),this.destroy(!0)):s.navigateToPreloadedUrl(),!1)}});return r}),define("apps/cards/layouts",[],function(){return{"primary-suspender-sidebar-page":[{name:"large",adClass:"size-l",adTargeting:"large",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:340,belowHeroAd:!1,cardWidth:1180,windowWidth:1250},{name:"medium",adClass:"size-m",adTargeting:"medium",sidebarOpen:!0,sidebarAds:!1,sidebarWidth:240,belowHeroAd:!0,cardWidth:1080,windowWidth:1150},{name:"small",adClass:"size-s",adTargeting:"small",sidebarOpen:!1,sidebarAds:!1,sidebarWidth:240,belowHeroAd:!0,cardWidth:840,windowWidth:980}],"primary-flex-sidebar-page":[{name:"1320w",adClass:"size-xl",adTargeting:"xlarge",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:360,belowHeroAd:!1,primaryFlexWidth:960,cardWidth:1320,windowWidth:1320},{name:"1080w",adClass:"size-m",adTargeting:"medium",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:360,belowHeroAd:!1,primaryFlexWidth:720,cardWidth:1080,windowWidth:1150,layout:"flexCard"}]}}),define("partner/high-impact-base",["jquery","underscore","baseview","sharedAdPosition","admanager","partner/leavebehind","animatecolors"],function(t,e,i,s,n,o){"use strict";var r=i.extend({initialize:function(t){e.bindAll(this,"onAdReady","showAd"),i.prototype.initialize.call(this,t)},_createAd:function(t,e,i){var n=this._filterAdsByCardWidth(t,i);this.subviews.adPosition=new s({el:this.$el,adPlacement:"high_impact",adSizes:n,adType:e,onAdReady:this.onAdReady,beforeAdRender:this.beforeAdRender}),this.currentCardInfo=i},_filterAdsByCardWidth:function(t,i){return e.filter(t,function(t){var e=n.isFlexibleAdSize(t),s=n.getSize(t);return e||s&&s[0]<=i.cardWidth})},changeBackground:function(){if(this.backgroundSolidColor&&"transparent"!==this.backgroundSolidColor){if(this.startingBackgroundColor=this.$body.css("background-color"),"transparent"===this.startingBackgroundColor||!this.startingBackgroundColor)return void(this.startingBackgroundColor="");this.$body.addClass("partner-background"),this.animate(this.$body,"background-color",this.backgroundSolidColor,200,"ease-in").done(e.bind(function(){this.changeBackgroundImage(this.backgroundRepeatingImage?this.backgroundRepeatingImage:window.site_static_url+"images/pixels/pixel-transparent.png")},this))}},changeBackgroundImage:function(t){this.$body.css({"background-image":"url('"+t+"')","background-repeat":"repeat"})},clearBackground:function(){this.startingBackgroundColor&&this.backgroundSolidColor&&"transparent"!==this.backgroundSolidColor&&(this.$body.css({"background-image":"","background-repeat":""}),this.animate(this.$body,"background-color",this.startingBackgroundColor,200,"ease-in").done(e.bind(function(){this.$body.removeClass("partner-background")},this)))},onAdReady:function(e){e.leaveBehindImage&&e.leaveBehindText?(this.subviews.adLeaveBehind=new o({el:t(".partner-leavebehind"),onShowAd:this.showAd,imageUrl:e.leaveBehindImage,altText:e.leaveBehindText,expiration:parseInt(e.leaveBehindExp,10),isCompact:this.isCardBumped}),this.subviews.adLeaveBehind.render(this.subviews.adPosition)):this.showAd()},showAd:function(){this.showingAd=!0,this.subviews.adPosition.show()}});return r}),define("partner/pushdown-ad",["jquery","underscore","utils","partner/high-impact-base","adLogger"],function(t,e,i,s,n){"use strict";var o=s.extend({events:{"click .partner-close":"closeAdClick"},initialize:function(o){o=t.extend({adClasses:"",animations:{vertical:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"}},ratio:{}},o),e.bindAll(this,"onAdReady","showAd","beforeAdRender"),s.prototype.initialize.call(this,o),this.$body=i.get("body"),this.$bigHeadline=this.$(".big-headline"),this.$aboveCardContent=this.options.cards.find(".card-above-content"),n.logDebug("Pushdown Advertisment initialized",this)},renderCardInfo:function(t,e){this._createAd(["pushdown","iabpushdown","iabpushdown2","billboard"],["pushdown","risingstar"],t),this.isCardBumped=e},beforeAdRender:function(t){this.adType=t.adType,this.adInfo=t,this.currentCardInfo&&this.onCardWidthChange(this.currentCardInfo)},destroy:function(t){this.showingAd?this.closeAd(!0):this.clearBackground(),s.prototype.destroy.call(this,t)},getAdHeight:function(t){return this.adInfo.ratio?this.adInfo.ratio.height/this.adInfo.ratio.width*t:615},onAdReady:function(t){this.backgroundSolidColor=t.backgroundSolidColor,this.backgroundRepeatingImage=t.backgroundRepeatingImage,"Pushdown+"===t.adType&&(this.persistBackground=!0,this.changeBackground(),this.$el.css({display:"block",height:0})),s.prototype.onAdReady.call(this,t)},showAd:function(){s.prototype.showAd.call(this);var i;this.$aboveCardContent.animate({opacity:0},150).slideUp(this.options.animations.vertical.duration-150),this.$el.hasClass("iab-risingstar")?this.isCardBumped&&this.$el.css("margin","-5px auto 10px"):(this.$el.css({height:0}),i=this.getAdHeight(this.currentCardInfo.cardWidth)-this.getBigHeadlineHeight(),this.$bigHeadline.css("visibility","hidden"),t.when(this.animate(this.$el,"height",i,this.options.animations.vertical.duration),this.animate(this.$el,"top",0,this.options.animations.vertical.duration)).done(e.bind(function(){this.subviews.adPosition&&this.subviews.adPosition.playAd()},this)),this.$body.addClass("high-impact-ad-visible")),this.changeBackground()},closeAdClick:function(t){t.preventDefault(),this.closeAd(),this.$aboveCardContent.slideDown(this.options.animations.vertical.duration-150).animate({opacity:1},150)},getBigHeadlineHeight:function(){return this.$bigHeadline.height()||0},closeAd:function(i){if(this.$el.hasClass("iab-risingstar"))this.isCardBumped&&this.$el.css("margin","");else{var s=this.getBigHeadlineHeight();this.showingAd=!1,this.subviews.adPosition.stopAd(),t.when(this.animate(this.$el,"height",0,this.options.animations.vertical.duration),this.animate(this.$el,"top",s+"px",this.options.animations.vertical.duration)).done(e.bind(function(){this.$bigHeadline.css("visibility","visible"),this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.show()},this))}this.$body.removeClass("high-impact-ad-visible"),(!this.persistBackground||i)&&this.clearBackground()},onCardWidthChange:function(t){if(this.subviews.adPosition&&this.adType){var e=this.getBigHeadlineHeight(),i=this.getAdHeight(t.cardWidth);this.currentCardInfo=t,"Pushdown+"!==this.adType||this.showingAd||this.$el.css("top",e),this.$el.removeClass(this.options.adClasses).addClass(t.adClass),this.subviews.adPosition.resizeAd(t.cardWidth,i),!this.$el.hasClass("iab-risingstar")&&this.adInfo.ratio&&this.showingAd&&(i-=this.getBigHeadlineHeight(),this.$el.css("height",i)),this.$el.hasClass("iab-risingstar")&&"small"===t.name&&(this.$el.remove(),this.destroy())}}});return o}),define("partner/gravity-ad",["jquery","underscore","utils","state","user-manager","pubsub","partner/high-impact-base","site-manager","adLogger"],function(t,e,i,s,n,o,r,a,l){"use strict";var h=r.extend({haveBreakingNews:!1,pubSub:{},state:"stopped",events:{"click .partner-scroll":"scrollPage","click .partner-scroll-login":"showLogin","click .partner-login-modal-close":"closeLogin","click .ui-film":"closeLogin","click .partner-login-modal-btn":"onClickLogin"},initialize:function(s){s=t.extend({adClasses:""},s),this.pubSub={"user:statuschange":this.determineLoggedInStatus},e.bindAll(this,"onAdReady","beforeAdRender","onResizeWindow","onScrollWindow","scrollPage","countDown","shiftUnlockedContentDown"),r.prototype.initialize.call(this,s),this.header=a.getHeader(),this.header&&this.header.subviews&&(this.breakingbar=this.header.subviews.breakingbar),this.$body=i.get("body"),this.$loginOverlay=this.$(".partner-login-overlay"),this.$partnerScroll=this.$(".partner-scroll"),this.$leftCircleHalf=this.$(".left-half .scroll-circle"),this.$rightCircleHalf=this.$(".right-half .scroll-circle"),this.$partnerScrollMessage=this.$(".partner-scroll-message"),this.$window=i.get("win"),l.logDebug("Gravity Advertisment initialized",this)},renderCardInfo:function(t){this._createAd(["gravity"],"gravity",t)},beforeAdRender:function(t){this.adType=t.adType,this.windowWidth=this.$window.width(),this.windowHeight=this.$window.height(),this.subviews.adPosition.setInitialDimensions(this.windowWidth,this.windowHeight)},destroy:function(t){this.closeAd(),this.header&&(this.header.destroyTransparency(),this.header.restoreLastState()),this.$leftCircleHalf.removeAttr("style"),this.$rightCircleHalf.removeAttr("style"),this.$partnerScroll.removeAttr("style").removeClass("done").off("."+this.cid),r.prototype.destroy.call(this,t)},onAdReady:function(t){t.leaveBehindExp&&t.leaveBehindImage?r.prototype.onAdReady.call(this,t):this.showAd();var e=s.getActiveApp();if(i.getNested(window.site_vars,"ads","high_impact_companion_ad")&&e.calculateCardDimensions){var n=e.calculateCardDimensions();
s.getActiveApp().triggerEvent("renderFrontPosterAd",n,!0)}},showAd:function(t){this.showingAd=!0,this.$partnerScroll=this.$(".partner-scroll");var s=e.throttle(this.onResizeWindow,50),r=e.throttle(this.onScrollWindow,50);this.$window.on("resize."+this.cid,s).on("scroll."+this.cid,r),this.pubSub={"breakingbar:before:open":this.onResizeWindow,"breakingbar:before:close":this.onResizeWindow},o.attach(this.pubSub,this),this.onResizeWindow(),this.subviews.adPosition.show(),this.options.contentSection.css("margin-top",this.cardOffset),this.onScrollWindow(),this.$body.addClass("high-impact-ad-visible"),this.header.setClosedFixed(!0),this.setBreakingNewsBarrier();var a=n.getLoginStatus();this.paywall=i.getNested(window.site_vars,"ads","gravity_paywall"),!this.paywall||"loggedOut"!==a&&"loggingOut"!==a&&"loginFailed"!==a||t?this.$partnerScroll.addClass("done"):(this.$partnerScrollMessage.text("Loading your news..."),this.lockContent()),o.trigger("gravity:open")},lockContent:function(){this.count=i.getNested(window.site_vars,"ads","gravity_paywall_wait")||30;var e=this.count/2,s=t.support.css.transform.cssName+" "+e+"s "+e+"s linear",n=t.support.css.transform.cssName+" "+e+"s linear";this.contentLocked=!0,this.$loadingNumber=this.$(".partner-scroll-number"),this.$leftCircleHalf[0].style[t.support.css.transition.cssName]=s,this.$rightCircleHalf[0].style[t.support.css.transition.cssName]=n,this.$leftCircleHalf[0].style[t.support.css.transform.cssName]="rotate(180deg)",this.$rightCircleHalf[0].style[t.support.css.transform.cssName]="rotate(180deg)",this.options.contentSection.css("position","fixed"),this.countDown(),this.countdownInterval=setInterval(this.countDown,1e3)},countDown:function(){this.$loadingNumber.text(this.count),this.count||this.unlockContent(),this.count--},unlockContent:function(){this.contentLocked=!1,clearInterval(this.countdownInterval),this.$partnerScrollMessage.text("Your news is ready!"),this.$partnerScroll.on("click."+this.cid,this.scrollPage),this.$partnerScroll.addClass("done"),this.options.contentSection.css("position",""),this.shiftUnlockedContentUp(this.$partnerScroll)},shiftUnlockedContentUp:function(){var t=this.cardOffset-this.header.getCollapsedHeight()-30;this.options.contentSection.animate({"margin-top":t},350).addClass("gravity-bumped"),this.shiftDownTimeout=e.delay(e.bind(function(){this.shiftUnlockedContentDown()},this),5e3)},shiftUnlockedContentDown:function(){this.options.contentSection.hasClass("gravity-bumped")&&(this.options.contentSection.removeClass("gravity-bumped"),t.when(this.animate(this.options.contentSection,"margin-top",this.cardOffset,500),this.animate(this.$partnerScroll,"margin-top",-75,500)).done(e.bind(function(){this.$partnerScroll.css("margin-top","").addClass("shifted")},this)))},determineLoggedInStatus:function(t,e,i){"loggedIn"===e?this.welcomeUser(i):"loggedOut"===e&&this.unWelcomeUser()},welcomeUser:function(e){if(!this.showingAd)return!1;var i=e.first_name;this.$partnerScrollMessage.fadeOut(350,function(){t(this).text("Welcome back "+i+", get the news").fadeIn(350)}),this.$partnerScroll.hasClass("done")||this.contentLocked?this.contentLocked&&(this.closeLogin(),this.unlockContent()):this.shiftUnlockedContentUp(this.$partnerScroll)},unWelcomeUser:function(){this.$partnerScrollMessage.fadeOut(350,function(){t(this).text("Get the news").fadeIn(350)})},showLogin:function(){this.$loginOverlay.show()},closeLogin:function(){this.$loginOverlay.hide()},onClickLogin:function(e){var i=t(e.target).data("user-account");n.loginUser(i)},setBreakingNewsBarrier:function(){this.breakingNewsBarrier&&"resolved"!==this.breakingNewsBarrier.state()||(this.breakingNewsBarrier=new t.Deferred,this.breakingbar.addToBarrier(this.breakingNewsBarrier,999999,!1))},getHeaderOffset:function(){return this.header&&this.breakingbar?this.header.getCollapsedHeight()+this.breakingbar.getHeight():0},closeAd:function(){this.subviews.adPosition&&this.adType&&(this.showingAd=!1,this.subviews.adPosition.stopAd(),this.breakingNewsBarrier.resolve(),this.options.contentSection.css({"margin-top":"",position:""}),this.$body.removeClass("high-impact-ad-visible"),clearInterval(this.countdownInterval),clearTimeout(this.shiftDownTimeout),this.$window.off("."+this.cid))},onResizeWindow:function(){return this.windowWidth=this.$window.width(),this.windowHeight=this.$window.height(),this.subviews.adPosition?(this.subviews.adPosition.resizeAd(this.windowWidth,this.windowHeight),this.cardOffset=this.windowHeight-this.getHeaderOffset(),this.options.contentSection.css("margin-top",this.cardOffset),void this.onScrollWindow()):!1},onScrollWindow:function(){var t=this.$window.scrollTop(),e=this.header.getCurrentHeight(),i=(this.windowHeight-t-e)/(this.windowHeight-e),s=i>0?i:0;this.$el.css("opacity",s),.1>s&&"playing"===this.state?(this.state="paused",this.subviews.adPosition&&(this.subviews.adPosition.pauseAd(),this.breakingNewsBarrier.resolve(),this.haveBreakingNews&&this.breakingbar.openBreakingBar()),this.header.toggleTransparency(!1)):s>.1&&"paused"===this.state?(this.state="playing",this.subviews.adPosition&&(this.subviews.adPosition.resumeAd(),this.haveBreakingNews=this.breakingbar.closeBreakingBar(),this.setBreakingNewsBarrier()),this.header.toggleTransparency(!0)):s>.1&&"stopped"===this.state&&(this.state="playing",this.subviews.adPosition&&(this.subviews.adPosition.playAd(),this.haveBreakingNews=this.breakingbar.closeBreakingBar(),this.setBreakingNewsBarrier()),this.options.contentSection.css("overflow","visible"),this.header.toggleTransparency(!0)),0===s?this.$el.css("display","none"):this.$el.css("display","block"),this.onArticleScroll&&this.onArticleScroll(s,e)},scrollPage:function(e){e.preventDefault();var i=this.windowHeight-this.header.getCurrentHeight();t("body, html").animate({scrollTop:i},500),this.shiftDownTimeout&&(clearTimeout(this.shiftDownTimeout),this.shiftUnlockedContentDown())}});return h}),define("partner/dual-pushdown-ad",["jquery","underscore","utils","partner/high-impact-base","site-manager","adLogger"],function(t,e,i,s,n,o){"use strict";var r=s.extend({initialize:function(r){r=t.extend({adClasses:"",animations:{vertical:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"}}},r),e.bindAll(this,"onAdReady","beforeAdRender","onResizeWindow","onScrollWindow"),s.prototype.initialize.call(this,r),this.header=n.getHeader(),this.headerHeight=this.header?this.header.getCurrentHeight():0,this.pubSub={"header:fixed":this.onHeaderHeightChange,"header:unfixed":this.onHeaderHeightChange},this.$body=i.get("body"),this.$bigHeadline=this.$(".big-headline"),this.$window=i.get("win"),o.logDebug("Pushdown Advertisment initialized",this)},renderCardInfo:function(t){this._createAd(["dual_pushdown"],"dualpushdown",t)},beforeAdRender:function(i){if(this.adType=i.adType,this.adInfo=t.extend({ratio:{height:9,width:16},fixed:!0},i),this.currentCardInfo&&this.onCardWidthChange(this.currentCardInfo,!0),(t("html").hasClass("lt-ie10")||Modernizr.touch)&&(this.adInfo.fixed=!0),!this.adInfo.fixed){var s=e.throttle(this.onResizeWindow,50),n=e.throttle(this.onScrollWindow,10);this.$window.on("resize."+this.cid,s).on("scroll."+this.cid,n),this.onResizeWindow()}this.$el.addClass("partner-dual-pushdown")},closeAd:function(i){this.showingAd=!1,this.subviews.adPosition.stopAd(),t.when(this.animate(this.options.card,"margin-bottom",0,this.options.animations.vertical.duration),this.animate(this.options.card,"margin-top",0,this.options.animations.vertical.duration)).done(e.bind(function(){this.$bigHeadline.css("visibility","visible")},this)),this.$body.removeClass("high-impact-ad-visible"),(!this.persistBackground||i)&&this.clearBackground(),this.$window.off("."+this.cid)},destroy:function(t){this.closeAd(!0),clearTimeout(this.calcWait),s.prototype.destroy.call(this,t)},getAdHeight:function(t){return this.adInfo.ratio.height/this.adInfo.ratio.width*t},getBigHeadlineHeight:function(){return this.$bigHeadline.height()||0},onAdReady:function(t){this.backgroundSolidColor=t.backgroundSolidColor,this.backgroundRepeatingImage=t.backgroundRepeatingImage,this.showAd()},onCardWidthChange:function(t,i){if(this.subviews.adPosition&&this.adType){this.currentCardInfo=t;var s=this.getAdHeight(t.cardWidth)-this.getBigHeadlineHeight();this.$el.removeClass(this.options.adClasses).addClass(t.adClass),this.subviews.adPosition.resizeAd(t.cardWidth,s),clearTimeout(this.calcWait),this.calcWait=setTimeout(e.bind(function(){if(!i)if(this.calculateScrollSpecs(s),this.options.card.css({"margin-bottom":s+50,"margin-top":s}),this.adInfo.fixed){var t=this.cardHeight;this.$(".partner-pushdown-container").css("height",t)}else this.onScrollWindow()},this),100)}},onHeaderHeightChange:function(){this.headerHeight=this.header.getCurrentHeight()},onScrollWindow:function(){var t=this.$window.scrollTop()-this.headerHeight,e=this.cardHeight-this.windowHeight,i=1-(e-t)/e;i>1?i=1:0>i&&(i=0);var s=50+this.adDiffHeight*i;this.$el.css("top",s)},onResizeWindow:function(){this.windowHeight=this.$window.height()},showAd:function(){s.prototype.showAd.call(this),this.adHeight=this.$el.height();var i=this.getAdHeight(this.currentCardInfo.cardWidth)-this.getBigHeadlineHeight();this.calculateScrollSpecs(i),this.adInfo.fixed?this.$(".partner-pushdown-container").css("height",this.cardHeight):this.onScrollWindow(),t.when(this.animate(this.options.card,"margin-bottom",i+50,this.options.animations.vertical.duration),this.animate(this.options.card,"margin-top",i,this.options.animations.vertical.duration)).done(e.bind(function(){this.subviews.adPosition&&this.subviews.adPosition.playAd()},this)),this.$bigHeadline.css("visibility","hidden"),this.$body.addClass("high-impact-ad-visible"),this.changeBackground()},calculateScrollSpecs:function(t){this.cardHeight=this.options.card.height()+70+2*t,this.adDiffHeight=this.cardHeight-this.adHeight-this.headerHeight+100}});return r}),define("partner/skyline-ad",["jquery","underscore","sharedAdPosition","partner/high-impact-base","adLogger"],function(t,e,i,s,n){"use strict";var o=s.extend({events:{"click .partner-close":"closeAdClick"},initialize:function(i){i=t.extend({adClasses:""},i),e.bindAll(this,"onAdReady","showAd"),s.prototype.initialize.call(this,i),n.logDebug("Skyline Advertisment initialized",this)},renderCardInfo:function(t){this._createAd(["skyline"],"skyline",t)},destroy:function(t){this.showingAd&&this.closeAd(),s.prototype.destroy.call(this,t)},closeAdClick:function(t){t.preventDefault(),this.closeAd()},closeAd:function(){this.showingAd=!1,this.subviews.adPosition.stopAd(),this.subviews.adPosition.hide(),this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.show()}});return o}),define("apps/cards/cards",["jquery","underscore","pubsub","utils","site-manager","base-app","apps/cards/layouts","partner/pushdown-ad","partner/gravity-ad","partner/dual-pushdown-ad","partner/overlay-ad-fronts","partner/skyline-ad","sharedAdPosition"],function(t,e,i,s,n,o,r,a,l,h,c,d,u){"use strict";var p=o.extend({cards:(window.section_arrows||"home").split("|"),cardsDisplay:(window.section_arrows_display||"home").split("|"),initialize:function(i){i=t.extend(!0,{animations:{horizontal:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"},fadeIn:{duration:200}},UPDATE_FREQUENCY:9e5,keyboard:!1,peekWidth:-100,template:'<div class="card-wrap-<%= layoutType %> card-wrap"><section class="card <%= section %> card-loading" id="section_<%= section %>"><div class="card-loading-border"></div></section></div>',overlayTemplate:'<div class="card-wrap-<%= layoutType %> card-wrap card-wrap-behind-overlay"><section class="card <%= section %> card-loading" id="section_<%= section %>"><div class="card-suspender-color <%= section %>"></div><div class="card-loading-border"></div><div class="sidebar"></div></section></div>'},i),e.bindAll(this,"handleResizeWindow"),this.$top=s.get("scrollEl"),this.$doc=s.get("doc"),this.$body=s.get("body"),this.$win=s.get("win"),this.template=e.template(i.template),this.overlayTemplate=e.template(i.overlayTemplate),this.containerOffset=0,this.header=n.getHeader(),this.cardSizes=[];var r=e.throttle(this.handleResizeWindow,50);this.$win.on("resize."+this.cid,r),this.options.keyboard&&this.$doc.on("keydown."+this.cid,this.keyNavigation),o.prototype.initialize.call(this,i)},destroy:function(t){this.$win.off("."+this.cid),this.$doc.off("."+this.cid),o.prototype.destroy.call(this,t)},animateChangePagePreData:function(t,e){var i=s.getSectionPath(e),o=this.goTo(i);if(this._updateNav(e,i),!o&&this.currentPath!==e){var r=this.createAndInitializeEmptyCard(i,this.$win.height()),a=s.getScrollPosition();a-=n.scrollTop(0),this.$currentCard.children(".card").css({top:-1*a}),r.css({position:"relative",margin:"",left:-1*this.containerOffset}),this.$currentCard.css({left:this.leftMargin+-1*this.containerOffset}),o=this.swapContent(this.$currentCard,r),this.$currentCard=r}return o},animateChangePagePostData:function(t,e,i){var s=this.$currentCard,n=i.find(".card-wrap");return n.css({left:-1*this.containerOffset}),s.css({height:"",overflow:"","padding-right":"",left:this.leftMargin+-1*this.containerOffset}),this.$currentCard=n,this.swapContent(s,n,!1,this.getHash(e))},animateRevealApp:function(e,i,s){return s?(this.afterOverlayReveal(0,i),t.Deferred().resolve()):o.prototype.animateRevealApp.apply(this,arguments)},beforePageReveal:function(t,e,i,s){s&&i.css("display","none")},afterPageReveal:function(t,n,o,a){var l=s.getSectionPath(n);this.domInitialized||this.initializeDom(),this.cardSizes=r[s.getNested(this.pageInfo,"layout_type")]||[],this.calculateCardDimensions(this.$win.width()),this._updateNav(n,l),this.$currentCard=this.$container.children(".card-wrap"),this.currentIndex=e.indexOf(this.cards,l),o||(a&&(this.subviews.view=new a({el:this.$currentCard})),this.setupAds(),this.triggerEvent("renderCardInfo",this.currentCardInfo,this.isCurrentCardBumped())),i.trigger("cards:loaded")},setupAds:function(){this.subviews.pushdownAd=new a({el:this.$(".partner-pushdown-ad"),adClasses:e.pluck(this.cardSizes,"adClass").join(" "),cards:this.$currentCard}),this.subviews.gravityAd=new l({el:this.$(".partner-gravity-ad"),contentSection:this.$el}),this.subviews.dualPushdownAd=new h({el:this.$(".partner-pushdown-ad"),card:this.$currentCard.children(".card"),adClasses:e.pluck(this.cardSizes,"adClass").join(" ")}),this.subviews.overlayAd=new c({el:this.$(".partner-overlay"),leaveBehindEl:this.$(".partner-leavebehind"),isCardBumped:this.isCurrentCardBumped(),getHeaderOffset:e.bind(function(){return this.header.getExpandedHeight()},this)}),this.subviews.skylineAd=new d({el:this.$(".partner-skyline-ad")}),this.subviews.genericad=new u({el:"#ad-staging",adSizes:["generic"],adPlacement:"high_impact",adType:"generic"})},isCurrentCardBumped:function(){return this.$currentCard.children(".card-bumped").length},beforeAppRemove:function(){t(".site-nav span.site-nav-span").removeClass("site-nav-active-span")},getRevealAppLoader:function(e){var i=s.getSectionPath(e),n=this.createAndInitializeEmptyCard(i,this.$win.height());return n.css({position:"relative",margin:""}),n=t('<div class="card-container"></div>').append(n),n=t('<article id="cards" class="cards"></article>').append(n)},initializeDom:function(){this.$container=this.$(".card-container"),this.$prevBtn=this.$("#cards-prev-link"),this.$nextBtn=this.$("#cards-next-link"),this.buttonWidth=this.$prevBtn.width(),this.buttonsVisible=!1,this.domInitialized=!0},handleResizeWindow:function(){if(this.domInitialized){var t=this.$win.width();if(this.windowWidth===t)return!1;var e=this.currentCardInfo;this.calculateCardDimensions(t),this.currentCardInfo!==e&&this.triggerEvent("onCardWidthChange",this.currentCardInfo)}},calculateCardDimensions:function(t){var i=this.getMinCardInfo();t<i.windowWidth&&(t=i.windowWidth),this.windowWidth=t;var s=i,n=(window.matchMedia||Modernizr.mq("only all"))&&!this.$top.hasClass("lt-ie9");return e.find(this.cardSizes,function(e){if(n){if(Modernizr.mq("only screen and (min-width: "+e.windowWidth+"px)"))return s=e,!0}else if(t>=e.windowWidth)return s=e,!0}),this.cardWrapWidth=s.cardWidth+((t-2*this.options.peekWidth-s.cardWidth)/2+.5)>>0,this.cardWrapWidth<i.cardWidth&&(this.cardWrapWidth=i.cardWidth),this.leftMargin=(t-s.cardWidth-2*this.options.peekWidth)/2+this.options.peekWidth+.5>>0,this.currentCardInfo=s,this._shouldShowBtns(s.cardWidth,t),s},_shouldShowBtns:function(t,e){var i=2*this.buttonWidth+t<e;i!==this.buttonsVisible&&(i?(this.$nextBtn.css("visibility","visible"),this.$prevBtn.css("visibility","visible")):(this.$nextBtn.css("visibility","hidden"),this.$prevBtn.css("visibility","hidden")),this.buttonsVisible=i)},updateNavLinks:function(t,e){e="home"===e?"/":"/"+e+"/",t.attr("href",e)},keyNavigation:function(t){switch(t.keyCode){case 37:this.previous();break;case 39:this.next()}},inBounds:function(t,e){return!isNaN(parseFloat(t,10))&&isFinite(t)&&t>=0&&e-1>=t},goTo:function(i){var n=e.indexOf(this.cards,i);if(-1!==n&&-1!==this.currentIndex&&n!==this.currentIndex){var o=s.getScrollPosition();return this.isApple&&o>0?t.Deferred(e.bind(function(t){this.$top.animate({scrollTop:0},200).promise().done(e.bind(function(){this._animateCards(n,o).done(function(){t.resolve()})},this))})).promise():this._animateCards(n,o)}},_animateCards:function(e,i){var s,o=0,r=t([]),a=this.$win.height(),l=this.$currentCard,h=this.currentIndex,c=this.$currentCard.height(),d=l.offset().top,u=0;u=Math.abs(e-h)>this.cards.length/2?e>h?-1:1:e>h?1:-1;do h=this._incrementIndex(h,u),s=this.createAndInitializeEmptyCard(this.cards[h],a),h!==e&&r.push(s[0]),this._positionCard(s,++o*u),this.$container.append(s);while(h!==e);this.$currentCard=s,this.containerOffset-=o*u*this.cardWrapWidth,i>c+d-a&&l.css({height:a,overflow:"hidden"}),i-=n.scrollTop(0),this.isApple||l.children(".card").css({top:-1*i});var p=this.animate(this.$container,"left",this.containerOffset+"px",this.options.animations.horizontal.duration,this.options.animations.horizontal.easing);return p.done(function(){s.css("position","relative")}).always(function(){l.remove(),r.remove()}),p},_incrementIndex:function(t,e){return(this.cards.length+t+e)%this.cards.length},createAndInitializeEmptyCard:function(e,i){var n=t(this.template({section:e,layoutType:s.getNested(this.pageInfo,"layout_type")||"primary-suspender-sidebar-page"}));return n.css({margin:0,position:"absolute",height:i,bottom:0}),n},_positionCard:function(t,e){t.css({left:this.leftMargin-this.containerOffset+e*this.cardWrapWidth})},getMinCardInfo:function(){return this.cardSizes[this.cardSizes.length-1]||{}},afterOverlayReveal:function(e,i){var n=s.getSectionPath(i||this.currentPath),o=this.$(".card-wrap > .card").position().top||50,r=this.header.getFixedThreshold(),a=o+this.header.getExpandedHeight();this.$el.hide(),a>e&&(e>r&&(a-=e-r),this.offsetPlaceholder=t('<div id="cards-offset-placeholder" style="height:'+a+'px"></div>'),this.$body.append(this.offsetPlaceholder)),this.header.isFixed()?this._fixPlaceholder():this._unfixPlaceholder(),this.fakeCardPlaceholder=t(this.overlayTemplate({section:n,layoutType:s.getNested(this.pageInfo,"layout_type")||"primary-suspender-sidebar-page"})),this.$body.append(this.fakeCardPlaceholder)},_fixPlaceholder:function(){this.offsetPlaceholder&&this.offsetPlaceholder.css({position:"fixed",top:-1*this.header.getFixedThreshold()})},_unfixPlaceholder:function(){this.offsetPlaceholder&&this.offsetPlaceholder.css({position:"absolute",top:0})},_onHeaderFixed:function(){this._fixPlaceholder(),o.prototype._onHeaderFixed.apply(this,arguments)},_onHeaderUnfixed:function(){this._unfixPlaceholder(),o.prototype._onHeaderUnfixed.apply(this,arguments)},beforeOverlayRemove:function(){this.$el.show(),this.offsetPlaceholder&&(this.offsetPlaceholder.remove(),this.offsetPlaceholder=null),this.fakeCardPlaceholder&&(this.fakeCardPlaceholder.remove(),this.fakeCardPlaceholder=null)},getClientAdInfo:function(){return{cardsize:this.currentCardInfo.adTargeting}},_updateNav:function(t,i){var s,n,o=e.indexOf(this.cards,i),r=this._incrementIndex(o,1),a=this._incrementIndex(o,-1);this.header&&this.header.updateNavigation(t),this.domInitialized&&(-1===o&&(r=e.indexOf(this.cards,"home"),a=this._incrementIndex(r,-1)),s=this.cards[r],n=this.cards[a],this.updateNavLinks(this.$nextBtn,s),this.updateNavLinks(this.$prevBtn,n),this.$(".front-next-arrow-label").html(this.cardsDisplay[r]||s),this.$(".front-prev-arrow-label").html(this.cardsDisplay[a]||n),this.$nextBtn.removeClass().addClass("front-arrow-"+s),this.$prevBtn.removeClass().addClass("front-arrow-"+n),this.$(".front-overlay-next-arrows-anchor").removeClass().addClass("front-overlay-next-arrows-anchor "+s+"-theme-bg"),this.$(".front-overlay-prev-arrows-anchor").removeClass().addClass("front-overlay-prev-arrows-anchor "+n+"-theme-bg"))}});return p}),define("modules/scroller/sidebar-scroll",["jquery","underscore","modules/scroller/vertical-scroll"],function(t,e,i){var s=i.extend({initialize:function(s){e.bindAll(this,"onScrollUpdated","removeActiveClass"),s=t.extend({removeActiveDelay:700},s),Modernizr.touch&&(this.$el.css({"-webkit-overflow-scrolling":"touch"}),"touch"===this.$el.css("-webkit-overflow-scrolling")&&(this.$el.css({overflow:"scroll"}),s.disabled=!0)),this._addBottomShadow(),this._addTopShadow(),i.prototype.initialize.call(this,s),this.bar.addClass("hide")},bindEvents:function(){this.options.disabled||(this.$el.on("scrollBarUpdate."+this.cid,this.onScrollUpdated),i.prototype.bindEvents.apply(this,arguments))},destroy:function(){this.$el.off("."+this.cid),this.topShadow.remove(),this.bottomShadow.remove(),clearTimeout(this.removeActiveClassDelay),clearTimeout(this.hideClassDelay),i.prototype.destroy.apply(this,arguments)},_addTopShadow:function(){this.topShadow=t('<div class="shadow top-shadow"></div>').hide(),this.$el.append(this.topShadow)},_addBottomShadow:function(){this.bottomShadow=t('<div class="shadow bottom-shadow"></div>').hide(),this.$el.append(this.bottomShadow)},removeActiveClass:function(){this.isMouseDown||this.isMouseOver||(this.bar.removeClass("active"),clearTimeout(this.removeActiveClassDelay),this.hideClassDelay=setTimeout(e.bind(function(){this.bar.addClass("hide")},this),1e3))},addActiveClass:function(t){this.bar.addClass("active"),this.bar.removeClass("hide"),this.startTimeout(t||this.options.removeActiveDelay)},startTimeout:function(t){clearTimeout(this.removeActiveClassDelay),this.removeActiveClassDelay=setTimeout(this.removeActiveClass,t)},onMouseOut:function(){i.prototype.onMouseOut.apply(this,arguments),this.isMouseDown||this.startTimeout(this.options.removeActiveDelay)},onMouseEnter:function(){i.prototype.onMouseEnter.apply(this,arguments),this.addActiveClass(this.options.removeActiveDelay)},onScrollUpdated:function(t,e){0===e?this.topShadow.hide():this.topShadow.show(),1===e?this.bottomShadow.hide():this.bottomShadow.show(),this.addActiveClass()}});return s}),define("modules/sidebar",["jquery","underscore","baseview","pubsub","state","modules/scroller/sidebar-scroll"],function(t,e,i,s,n,o){"use strict";var r=i.extend({events:{"click .open-sidebar":"openSidebarClick","click .close-sidebar":"closeSidebarClick"},initialize:function(s){this.sidebar=this.$(".sidebar"),this.sidebar.length&&(e.bindAll(this,"showSidebarOpenButton","showSidebarCloseButton","onScroll","_recalculateScrollBar"),s=t.extend(!0,{animations:{sidebar:{button:{fadeIn:200,fadeOut:200},slide:250}}}),this.pubSub={"sidebar:hide":this.closeSidebarClick,"sidebar:show":this.openSidebarClick,"showmore:headlines":this.onHeadlinesUpdated},this.refreshSidebarScroll=e.debounce(this._recalculateScrollBar,1e3),i.prototype.initialize.call(this,s),this._addSidebar())},renderCardInfo:function(t){this.currentCardInfo=t,t.isSidebarOpen&&(this.isSidebarOpen=!0,this.refreshSidebarScroll())},onCardWidthChange:function(t){var e=t.sidebarOpen!==this.currentCardInfo.sidebarOpen||this.sidebarOpen!==t.sidebarOpen;this.currentCardInfo=t,this.resetSidebar(),e&&n.getActiveApp().triggerEvent(t.sidebarOpen?"openSideBar":"closeSideBar")},_recalculateScrollBar:function(){this._setSideBarTitles();var t=this.$(".sidebar-fixed-content"),e=t.height(),i=this.sidebar.height(),s=Math.max(0,i-e),o=this.$(".sidebar-scrollable-window");e>i&&(e=i,t.css("height",i)),s!==parseInt(o[0].style.height,10)&&(o.css("height",s),n.getActiveApp().triggerEvent("onSidebarScrollableHeightChange",e,s)),this.subviews.vscrollbar&&this.subviews.vscrollbar.refresh()},_addSidebar:function(){Modernizr.touch||this.initializeSidebarTitles(),this.openButton=this.$(".open-sidebar"),this.closeButton=this.$(".close-sidebar"),this.subviews.vscrollbar=new o({el:this.$(".sidebar-scrollable-window"),contentClass:this.$(".sidebar-scrollable-content"),padding:2,lockPageScroll:!1,delayScroll:!1,fadeout:!0,onScroll:this.onScroll})},initializeSidebarTitles:function(){this.$sidebarScrollableTitles=this.$(".sidebar-scrollable-content .sidebar-title-wrapper"),this.$sidebarStaticTitle=this.$(".sidebar-static-title-wrapper");var t=this.$(".sidebar-scrollable-content .sidebar-title-wrapper:first");t.length&&(t.hide(),this.$sidebarStaticTitle.html(t.html()).show())},_setSideBarTitles:function(){var e=this;this.sideBarTitles=[],this.$sidebarScrollableTitles&&this.$sidebarScrollableTitles.each(function(i,s){var n=t(s),o=!1;n.is(":hidden")&&(n.show(),o=!0);var r=n.position().top+n.outerHeight();o&&n.hide(),r=-1*r,e.sideBarTitles.push({position:r,html:n.html()})})},onScroll:function(t){if(this.$sidebarScrollableTitles.length>1&&0!==t){var e=this.$sidebarStaticTitle;this.sideBarTitles||this._setSideBarTitles();var i,s=this.sideBarTitles.length-1,n=e.html();for(s;s>=0;s--)if(i=this.sideBarTitles[s],i.position>t){n=i.html;break}e.html()!==n&&e.html(n)}},openSidebarClick:function(t){t&&t.preventDefault(),n.getActiveApp().triggerEvent("openSideBar"),this._slideSidebar(this.openButton,!0)},openSidebar:function(){this.isSidebarOpen=!0},closeSidebarClick:function(t){t&&t.preventDefault(),this._slideSidebar(this.closeButton,!1),n.getActiveApp().triggerEvent("closeSideBar")},closeSidebar:function(){this.isSidebarOpen=!1},_slideSidebar:function(t,i){var s=this.options.animations.sidebar.slide,o=this.options.animations.sidebar.button.fadeOut;n.registerAnimation(t.fadeOut(o,"easeInOutCubic").promise());var r=parseInt(this.sidebar.css("width"),10),a=null;if(this.currentCardInfo.sidebarOpen){var l=i?this.currentCardInfo:n.getActiveApp().getMinCardInfo();this.sidebar.removeClass("top"),a=this.animate(this.$.closest(".card"),"width",l.cardWidth,s,"ease-in-out")}else a=this.animate(this.sidebar,"right",-1*r,s,"ease-in-out");return a.then(e.bind(function(){var t=this.animate(this.sidebar,"right",0,s,"ease-in-out");return i?this.currentCardInfo.sidebarOpen?(this.sidebar.removeClass("top"),this.$el.closest(".card").css("width","")):(this.sidebar.addClass("top"),t.done(this.showSidebarCloseButton)):(t.done(this.showSidebarOpenButton),this.sidebar.removeClass("top")),t},this))},resetSidebar:function(){this.$el.closest(".card").css("width",""),this.sidebar.removeClass("top"),this.currentCardInfo.sidebarOpen?(this.openButton.hide(),this.closeButton.hide()):(this.adVisible?this.openButton.hide():this.openButton.show(),this.closeButton.hide()),this._setSideBarTitles()},showSidebarOpenButton:function(){this.adVisible||(this.openButton.css({visibility:"visible",display:"none"}),this.openButton.fadeIn(this.options.animations.sidebar.button.fadeIn,"easeInOutCubic"))},showSidebarCloseButton:function(){this.closeButton.fadeIn(this.options.animations.sidebar.button.fadeIn,"easeInOutCubic")},onHeadlinesUpdated:function(){this.headlinesUpdate=setTimeout(this._recalculateScrollBar,1e3)},onHeroAdClose:function(){this.adVisible=!1,this.isSidebarOpen||this.showSidebarOpenButton()},onHeroAdOpen:function(){this.adVisible=!0,this.isSidebarOpen?this.currentCardInfo.sidebarOpen||this.closeSidebar():this.openButton.fadeOut(this.options.animations.sidebar.button.fadeOut,"easeInOutCubic")}});return r}),define("app/wlna",["jquery","underscore","state","base-app","directAdPosition","modules/global/brightcove-video","pubsub"],function(t,e,i,s,n,o,r){"use strict";var a=s.extend({initialize:function(){this.$sponsorshipAd=t(".wlna-ad"),this.$adPlacement=this.$sponsorshipAd.data("ad-placement"),this.$videoClick=t(".ui-video-play-btn.ui-video-play-btn-active"),s.prototype.initialize.call(this,{}),this._buildDollyAd(),i.stopRefreshTimer(),r.on("page:load",this._autoPlayVideo,this)},_autoPlayVideo:function(){this.$videoClick.click()},_buildDollyAd:function(){this.$sponsorshipAd.length&&!this.subviews.sponsorshipAd&&(this.subviews.sponsorshipAd=new n({el:this.$sponsorshipAd,adSizes:[300,250],adPlacement:this.$adPlacement,pageInfo:i.getActivePageInfo()}))},destroy:function(){r.off("page:load",this._autoPlayVideo,this),s.prototype.destroy.call(this)}});return a}),define("partner/overlay-ad-asset",["jquery","underscore","partner/overlay-ad-base","meteredAdPosition","adLogger"],function(t,e,i,s,n){"use strict";var o=i.extend({initialize:function(s){s=t.extend({adSizes:["elastic"],adPlacement:"transition",rateMeterId:"transition",pageInfo:null},s),e.bindAll(this,"onAdReady"),i.prototype.initialize.call(this,s),this.loadAdPlacement(this.options.pageInfo),n.logDebug("Partner Metered Overlay initialized",this)},loadAdPlacement:function(t){t=t||this.options.pageInfo,this.subviews.ad=new s({el:this.$placement,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,rateMeterId:this.options.rateMeterId,pageInfo:t,onAdReady:this.onAdReady,beforeAdRender:this.onResize})},triggerAd:function(){var t="transition_referrer"===this.options.adPlacement,e=this.options.pageInfo.excludeTransitionAd;this._tickMeterFetchAd(e),t&&!e&&this.$placement.children(".partner-overlay-close").data("uotrack","referreradclosed")},getCurrentMeterCount:function(){return this._tellAd("getCurrentMeterCount")},_tickMeterFetchAd:function(t){this.tickMeter(t)&&!t&&this.subviews.ad.prefetchAd()},tickMeter:function(t,e){return this._tellAd("tickMeter",t,e)},_tellAd:function(t){var e=this.subviews.ad;return e&&e[t]?e[t].apply(e,Array.prototype.slice.call(arguments,1)):null},resetMeter:function(t){return this._tellAd("resetMeter",t)},refresh:function(t){this.destroyAdPosition(),this.loadAdPlacement(t)}});return o}),define("modules/partner/story-transition-ad",["jquery","underscore","baseview","state","site-manager","utils","admanager","partner/overlay-ad-asset"],function(t,e,i,s,n,o,r,a){"use strict";var l=i.extend({initialize:function(t){i.prototype.initialize.call(this,t),this.renderAd()},renderAd:function(){var t=s.getReferrer(),i={el:this.$el,pageInfo:s.getActivePageInfo(),getHeaderOffset:function(){var t=n.getHeader();return t?t.getExpandedHeight():0}},o=!1;t&&-1===t.indexOf(window.location.protocol+"//"+window.location.hostname)&&(i.adPlacement="transition_referrer",i.rateMeterId="transition_referrer",o=!0),this.subviews.transitionAd=new a(i),Modernizr.history||(o=!0),0===this.subviews.transitionAd.getCurrentMeterCount()&&(o=!0),r.getActiveSlotStatistics().done(e.bind(function(t){e.findWhere(t.high_impact_info,{adType:"gravity"})&&o&&(o=!1,this.subviews.transitionAd.resetMeter("transition")),o?this.subviews.transitionAd.triggerAd():this.subviews.transitionAd.tickMeter(!0,"transition"),"transition_referrer"===i.rateMeterId&&this.subviews.transitionAd.resetMeter("transition")},this))},getTransitionMeterCount:function(){return this.subviews.transitionAd?this.subviews.transitionAd.getCurrentMeterCount("transition"):0}});return l}),define("partner/gravity-ad-article",["jquery","underscore","utils","sharedAdPosition","partner/gravity-ad"],function(t,e,i,s,n){"use strict";var o=n.extend({articleElsHidden:!1,initialize:function(t){n.prototype.initialize.call(this,t);var e=this.options.contentSection;this.$recommended=e.find(".recommended-flyout-container"),this.$utilityBarPrimaryModules=e.find(".util-bar-primary-modules"),this.$utilityBarSecondaryModules=e.find(".util-bar-secondary-modules"),this.$closeWrap=e.find(".close-wrap"),this._createAd(["gravity"],"gravity")
},_createAd:function(){var t=this._filterAdsByCardWidth(["gravity"]);this.subviews.adPosition=new s({el:this.$el,adPlacement:"high_impact",adSizes:t,adType:"gravity",onAdReady:this.onAdReady,beforeAdRender:this.beforeAdRender})},onAdReady:function(){this.showAd(),i.get("scrollEl").animate({scrollTop:0},500)},onArticleScroll:function(t,e){var i=this.$utilityBarSecondaryModules.height();.1>t&&this.articleElsHidden?(this.$utilityBarSecondaryModules.stop("gravity").animate({bottom:0},{duration:200,queue:"gravity"}).dequeue("gravity"),this.$recommended.show(),this.$closeWrap.show(),this.$body.removeClass("high-impact-ad-visible"),this.articleElsHidden=!1):t>.1&&!this.articleElsHidden&&(this.$recommended.hide(),this.$closeWrap.hide(),this.$utilityBarSecondaryModules.stop("gravity").animate({bottom:-i},{duration:200,queue:"gravity"}).dequeue("gravity"),this.$body.addClass("high-impact-ad-visible"),this.articleElsHidden=!0),0>=t?(this.$utilityBarPrimaryModules.css({position:"fixed",top:80+e}),this.$closeWrap.css({position:"fixed",top:80+e})):t>0&&(this.$utilityBarPrimaryModules.css({position:"absolute",top:80}),this.$closeWrap.css({position:"absolute",top:80}))},shiftUnlockedContentUp:function(){n.prototype.shiftUnlockedContentUp.call(this),this.$utilityBarPrimaryModules.css({position:"absolute",top:80}),this.$partnerScroll.animate({"margin-top":-145},350)},showAd:function(){n.prototype.showAd.call(this),(!this.paywall||this.paywall&&("loggedIn"===status||"loggingIn"===status))&&this.shiftUnlockedContentUp()}});return o}),define("apps/overlay/overlay",["jquery","underscore","backbone","utils","site-manager","apps/simple-overlay","state","admanager","modules/partner/story-transition-ad","meteredAdPosition","partner/gravity-ad-article","managers/routemanager"],function(t,e,i,s,n,o,r,a,l,h,c,d){"use strict";var u=o.extend({el:"#overlay",events:function(){return t.extend({},o.prototype.events,{"click .overlay-content-arrows":"nextArticleClick"})},initialize:function(i){i=t.extend({inbetweenAdTemplate:'<div class="partner-inbetween transition-wrap"><div class="partner-inbetween-content partner-placement"></div></div>'}),this.init=!1,this.$doc=s.get("doc"),this.$body=s.get("body"),e.bindAll(this,"keyboardEvent","beforeInbetweenAdRender"),this.currentStoryIndex=-1,this.storyCollection=[],this.animationIndex=0,o.prototype.initialize.call(this,i)},resizeHandler:function(){o.prototype.resizeHandler.apply(this,arguments),this.inbetweenAd&&this.inbetweenAd.resizeAd(980,this.winSize.height),this.$inbetweenPartner&&this.$inbetweenPartner.css(this.winSize)},afterPageReveal:function(t){o.prototype.afterPageReveal.apply(this,arguments),this.$doc.on("keyup."+this.cid,this.keyboardEvent),this.init?(this.renderInbetweenAd(),this.updateArrowLinks()):(this.initializeDom(),this.init=!0,this.updateArrowLinks(!0),this.subviews.storyTransitionAd=new l({el:this.$(".partner-overlay")}),0===this.subviews.storyTransitionAd.getTransitionMeterCount()&&this.renderInbetweenAd()),null!==t&&this.triggerEvent("storyCollectionLoaded",this.getStoryCollection(),this.currentStoryIndex),this.loadAdPlacements()},loadAdPlacements:function(){r.getActivePageInfo().sponsored_series||(this.subviews.gravityAd=new c({el:this.$(".partner-gravity-ad"),contentSection:this.$el}))},preloadPath:function(){r.preloadPath(this.currentSection).done(e.bind(function(){this.updateArrowLinks(!0),this.triggerEvent("storyCollectionLoaded",this.getStoryCollection(),this.currentStoryIndex)},this))},beforeInbetweenAdRender:function(){this.inbetweenAd.setInitialDimensions(980,this.winSize.height)},renderInbetweenAd:function(){this.$inbetweenPartner?this.$inbetweenPartner.parent().length||this.$el.append(this.$inbetweenPartner.hide()):(this.$inbetweenPartner=t(this.options.inbetweenAdTemplate),this.$el.append(this.$inbetweenPartner)),this.inbetweenAd?this.isShowingAd&&(this.isShowingAd=!1):this.inbetweenAd=new h({el:this.$inbetweenPartner.find(".partner-inbetween-content"),adPlacement:"transition",adSizes:["bigpageflex"],beforeAdRender:this.beforeInbetweenAdRender,rateMeterId:"transition"}),this.inbetweenAd.setPageInfo(r.getActivePageInfo()),this.inbetweenAd.tickMeter(!0)&&a.getActiveSlotStatistics().done(e.bind(function(t){e.findWhere(t.high_impact_info,{adType:"gravity"})?this.inbetweenAd.resetMeter():(this.timeToShowAd=!0,this.inbetweenAd.refreshPosition())},this))},keyboardEvent:function(e){if(e.target===this.$body[0])switch(e.which){case 37:t(".overlay-content-arrows-previous-wrap").trigger("click");break;case 39:t(".overlay-content-arrows-next-wrap").trigger("click")}},nextArticleClick:function(i){var s=1,n=t(i.currentTarget),o=n.attr("href"),r=this.inbetweenAd;if(n.hasClass("overlay-content-arrows-previous-wrap")&&(s=-1),!this.isShowingAd&&this.timeToShowAd&&r.isAdReady()&&(r.tickMeter(),this.timeToShowAd=!1,i.preventDefault(),d.goToInterstitual(o))){var a=this.getStoryCollection();return n.siblings().remove(),this.arrowContainer.append(this.buildArrowDom(a[this.currentStoryIndex],0>s?"next":"previous")),this.currentStoryIndex+=s/2,this.isShowingAd=!0,r.showAd(980,this.winSize.height),this.animateToContent(this.$inbetweenPartner,s).done(e.bind(function(){this.inbetweenAd&&r.playAd()},this))}},initializeDom:function(){this.arrowWrapTemplate=this.$("#overlay-arrow-wrap"),this.arrowContainer=this.$(".overlay-arrows")},destroyModules:function(){this.$doc.off("."+this.cid),this.isShowingAd&&this.inbetweenAd&&this.inbetweenAd.destroyAdPlacement(),o.prototype.destroyModules.apply(this,arguments)},beforeAppRemove:function(){this.inbetweenAd&&(this.inbetweenAd.destroy(),this.inbetweenAd=null),o.prototype.beforeAppRemove.apply(this,arguments)},updateArrowLinks:function(t){if(-1!==this.currentStoryIndex||(this.currentStoryIndex=this.getBestStoryIndex(window.location.pathname,t),-1!==this.currentStoryIndex)){var e=this.getStoryCollection(),i=this.buildArrowDom(e[this.currentStoryIndex-1],"previous"),s=this.buildArrowDom(e[this.currentStoryIndex+1],"next");this.arrowContainer.empty().append(i).append(s),this.animate(this.arrowContainer,"opacity",1,250)}},buildArrowDom:function(i,s){var n=!i;if(i?i.disabled="":i={disabled:"disabled"},i.dir=s,i.photo&&i.photo.crops&&i.photo.crops["1_1"]&&-1!==i.photo.crops["1_1"].indexOf(".jpg")&&(i.image=i.photo.crops["1_1"]),!this.arrowWrapTemplate.length)return t([]);var o=t(t.trim(e.template(this.arrowWrapTemplate.html(),i)));return n?o.css(this.isApple?{display:"none"}:{"z-index":1}):this.isApple&&o.find(".preview").remove(),o},getBestStoryIndex:function(t,e){t&&"/"!==t[0]&&(t="/"+t);var i=this.getStoryCollection();if(!i||0===i.length)return-1;var s=-1,n=-1,o=Math.round(this.currentStoryIndex);-1===o&&(o=0);var r;for(r=o;r>=0;r--)if(i[r].links===t){s=r;break}for(r=o;r<i.length;r++)if(i[r].links===t){n=r;break}if(-1===n&&-1===s&&e){var a={links:t};return this.storyCollection.unshift(a),0}return-1===n?s:-1===s?n:n-o>o-s?s:n},getStoryCollection:function(){if(0===this.storyCollection.length){var t=r.getPreloadedPageInfo(),i=t&&t.asset_collection;i&&(this.storyCollection=e.filter(i,this._filterStoryCollection))}return this.storyCollection},_filterStoryCollection:function(t){var e,i,s;return t.links&&(e=d.getInfo(t.links),i=e&&e.app&&e.app.AppClass),s=i===u,t.headline&&t.links&&!t.links.match("http")&&s},animateChangePagePreData:function(e,i){var s,n=this.getBestStoryIndex(i);return-1!==this.currentStoryIndex&&-1!==n&&(s=this.currentStoryIndex>n?"left":"right"),this.currentStoryIndex=n,this.animateToContent(t(this.options.template).find(".transition-wrap"),s)},animateToContent:function(i,o){var r=this.winSize.height,a=s.getScrollPosition(),l=this.$(".transition-wrap:first");if(a-=n.scrollTop(0),this.$el.css({position:"relative"}),this.prepareContentForTransition(l,a,r),i.css({position:"absolute",display:"block"}),i.attr("data-animation-index",++this.animationIndex),this.prepareContentForTransition(i,0,r),this.$el.prepend(i),this.header.isFixed()&&this.positionCloseButton("absolute",a,l),o){l.css({left:"0%"});var h,c="0%";return"left"===o?(i.css("left","-100%"),h="100%"):(i.css("left","100%"),h="-100%"),t.Deferred(e.bind(function(s){var n=t.when(this.animate(l,"left",h,350,"ease-in-out"),this.animate(i,"left",c,350,"ease-in-out"));n.done(e.bind(function(){l.remove(),parseInt(i.attr("data-animation-index"),10)===this.animationIndex&&this.resetContentTransition(i),s.resolve()},this))},this)).promise()}return i.css({position:"relative"}),this.swapContent(l,i)},prepareContentForTransition:function(t,e,i){t.css({height:i}),t.children().css({top:-1*e})},resetContentTransition:function(t){t.css({position:"relative"}),this.$el.css({position:""})}});return u}),define("third-party-apis/base-third-party-api",["jquery","underscore","backbone","pubsub"],function(t,e,i,s){"use strict";var n=i.View.extend({SITE_CONFIG:window.site_config.AUTH||window.site_config.THIRDPARTYAPI,initialize:function(){s.on("page:load",e.bind(this.loadScript,this))},loadScript:function(){return this.loadScriptPromise||(this.loadScriptPromise=this._handleLoadScript()),this.loadScriptPromise},_handleLoadScript:function(){return t.Deferred().resolve()},setupOnLoadCallbacks:function(t,i){window[t]||(window[t]=e.bind(function(){i()},this))},getApiSiteConfig:function(t){t=t.toUpperCase();var e=this.SITE_CONFIG;return e?e[t]:(console.error("No siteconfig set up for "+t+" api!"),"")}});return n}),function(){var t="undefined"!=typeof exports?exports:window,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=function(){try{document.createElement("$")}catch(t){return t}}();t.btoa||(t.btoa=function(t){for(var s,n,o=0,r=e,a="";t.charAt(0|o)||(r="=",o%1);a+=r.charAt(63&s>>8-o%1*8)){if(n=t.charCodeAt(o+=.75),n>255)throw i;s=s<<8|n}return a}),t.atob||(t.atob=function(t){if(t=t.replace(/=+$/,""),t.length%4==1)throw i;for(var s,n,o=0,r=0,a="";n=t.charAt(r++);~n&&(s=o%4?64*s+n:n,o++%4)?a+=String.fromCharCode(255&s>>(-2*o&6)):0)n=e.indexOf(n);return a})}(),define("base64",function(){}),define("third-party-apis/firefly/firefly",["jquery","underscore","third-party-apis/base-third-party-api","managers/requestmanager","utils","base64"],function(t,e,i,s,n){"use strict";var o=i.extend({initialize:function(){i.prototype.initialize.call(this)},_handleLoadScript:function(){return this._fireflyPromise||(this._fireflyPromise=t.Deferred(e.bind(function(t){t.resolve()},this)).promise()),this._fireflyPromise},getUserInfo:function(){var i=this,s=t.Deferred();return this.userInfo?s.resolve(this.userInfo):this.loadScript().done(e.bind(function(){var o=t.getJSON(n.getNested(window,"firefly_urls","samServiceURL")+"gateway/getUser/?callback=?");o.done(e.bind(function(t){0===t.meta.status?(i.userInfo=t.response,s.resolve(t.response)):s.reject("Not logged in.")})).fail(e.bind(function(){s.reject("Can't contact getUser.")}))},this)),s.promise()},sanitizeFireflyViewsObject:function(t){return e.isObject(t)?t.viewCount&&t.viewThreshold&&t.viewedContent?e.isNumber(t.viewCount)&&e.isNumber(t.viewThreshold)&&e.isArray(t.viewedContent)?(t.viewCount<1&&(t.viewCount=1),t.viewThreshold<1&&(t.viewThreshold=1),t.viewCount>t.viewThreshold&&(t.viewThreshold=t.viewCount),t):(console.error("Wrong format in Firefly views object values"),!1):(console.error("Missing Firefly views object properties"),!1):(console.error("Firefly views cookie is not an object"),!1)},getFireflyViewsCookie:function(){var e=null,i=t.cookie("firefly_akamai_open");if(i&&(e=this._parseCookie(i))){e=this.sanitizeFireflyViewsObject(e);var s=e.viewThreshold-e.viewCount;e.viewsRemaining=s}return e},_parseCookie:function(t){try{return JSON.parse(atob(t))}catch(e){try{return JSON.parse(t)}catch(i){}}return null},getLoginStatus:function(){return this.getUserInfo()},loginUser:function(){return this.getLoginStatus()},logoutUser:function(){var i=t.Deferred();return this.userInfo=null,this.loadScript().done(e.bind(function(){i.resolve()},this)),i.promise()}});return new o}),define("modules/stories/utility-bar-module-popups",["jquery","underscore","backbone","pubsub"],function(t,e,i){var s=i.View.extend({});return new s}),define("modules/stories/utility-bar",["jquery","underscore","backbone","pubsub","utils","state","baseview","site-manager","managers/resourcemanager","third-party-apis/firefly/firefly","user-manager","modules/stories/utility-bar-module-popups"],function(t,e,i,s,n,o,r,a,l,h,c,d){var u=r.extend({el:".utility-bar-wrap",events:{"click .util-bar-btn":"onClickUtilityBtn"},initialize:function(t){e.bindAll(this,"onDestroySubview"),this.pubSub={"header:fixed":this.onHeaderFixed,"header:unfixed":this.onHeaderUnfixed,"user:statuschange":this._loginStatus},this.$primaryModules=this.$(".util-bar-primary-modules"),this.$secondaryModules=this.$(".util-bar-secondary-modules");var i=a.getHeader();i&&i.isFixed()&&this.onHeaderFixed(),r.prototype.initialize.call(this,t),this.autoPopoutComments(),this.setupFireflyout()},autoPopoutComments:function(){this.$commentsBtn=this.$(".util-bar-btn-comments"),window.location.search.search("[?&]fb_comment_id=.+")>-1&&e.defer(e.bind(function(){this.openComments()},this))},setupFireflyout:function(){this.$fireflyModule=this.$(".util-bar-module-firefly"),this.$fireflyBtn=this.$(".util-bar-btn-firefly"),this.$fireflyModule.length&&this._checkUserAccount()},_checkUserAccount:function(){var t=c.getAccount("firefly");t&&t.getUserInfo().always(e.bind(function(e){this._loginStatus("firefly",t.getLoginStatus(),e)},this))},_loginStatus:function(t,i,s){if("firefly"===t){"loggedIn"===i?this.$fireflyModule.addClass("util-bar-module-firefly-authenticated"):"loggingIn"!==i&&this.$fireflyModule.removeClass("util-bar-module-firefly-authenticated");var n=o.getActivePageInfo().content_protection_state,r=!n||"free"===n;if("loggedIn"===i&&s&&s.hasMarketAccess||r)this.$fireflyModule.removeClass("util-bar-module-firefly-visible");else if("loggingIn"!==i){this.$fireflyModule.addClass("util-bar-module-firefly-visible");var a=h.getFireflyViewsCookie();a&&(1===a.viewCount||a.viewsRemaining<2)&&e.delay(e.bind(function(){this.openFireflyout()},this),0)}}},openFireflyout:function(){this.$fireflyBtn.trigger("click")},openComments:function(){this.$commentsBtn.trigger("click")},onHeaderFixed:function(){this.$primaryModules.css({position:"fixed",top:"auto"})},onHeaderUnfixed:function(){this.$primaryModules.css({position:"absolute",top:""})},onClickUtilityBtn:function(i){var s=t(i.currentTarget);if(s.data("popup-callback")){var n=s.data("popup-callback");d[n]()}else if("A"!==s.prop("tagName")){i.preventDefault();var o=s.data("module-name"),r=s.data("module-section")||"";this.subviews[o]?r&&r!==this.subviews[o].activeSection?this.subviews[o].open(r):this.subviews[o].close&&this.subviews[o].close():(e.each(this.subviews,function(t){t&&t.close&&t.close()}),l.getSiteModuleByName(o).done(e.bind(function(t){this.destroyed||(this.subviews[t.name]=new t.ModuleClass(e.extend({el:t.selector,onDestroy:this.onDestroySubview},t.options)),this.subviews[t.name].open&&this.subviews[t.name].open(r))},this)).fail(function(){console.error("Failed to load utility bar module: "+o+".js")}))}},onDestroySubview:function(t){e.each(this.subviews,function(e,i){e===t&&(this.subviews[i]=null)},this)},show:function(){this.$el.addClass("show")},hide:function(){this.$el.removeClass("show")},destroy:function(t){this.destroyed=!0,this.$el.css("padding-top",n.getScrollPosition()),this.$primaryModules.css("position","absolute"),this.$secondaryModules.css("position","absolute"),r.prototype.destroy.call(this,t)}});return u}),define("modules/stories/recommended-flyout",["jquery","underscore","baseview","utils","state","managers/cachemanager"],function(t,e,i,s,n,o){var r=i.extend({events:{"click .closed":"toggle","click .recommended-flyout-close":"toggle"},initialize:function(){e.bindAll(this,"scroll_listener","fetch_trending_stories"),this.isOpen=!1,this.forcedStatus=!1,this.hasOpened=!1,this.rendered=!1,this.$flyout=this.$(".recommended-flyout"),this.$flyoutWrap=this.$(".recommended-flyout-wrap"),this.$flyoutTemplate=this.$("#recommended-flyout-template"),this.$win=s.get("win"),this.winHeight=this.$win.height(),this.trackLimit=10,this.trendingUrl="/feeds/recommend/trending.json",this.mostPopularUrl="/feeds/recommend/most-popular.json",this.track_asset(),this.get_recommendation(),i.prototype.initialize.apply(this,arguments)},bind:function(){var t=e.throttle(this.scroll_listener,100);this.$win.on("scroll."+this.cid,t)},unbind:function(){this.$win.off("."+this.cid)},get_recommendation:function(){var t=this;o.getValue("recommendation-trending_stories",this.fetch_trending_stories,5).done(function(e){t.render_recommendation(e)}).fail(function(){t.render_fallback()})},render_fallback:function(){var t=this;this.fallback_story?this.render(this.fallback_story):this.next_story_check=setInterval(function(){t.collection_loaded&&(t.fallback_story&&t.render(t.fallback_story),clearInterval(t.next_story_check))},500)},storyCollectionLoaded:function(t,e){if(this.collection_loaded=!0,this.$trigger_dom=this.$el.next(),this.trigger_dom_offset=this.$trigger_dom.offset().top,this.bind(),t&&t.length>0&&e>-1){var i=t[e+1];this.fallback_story={image_1_1:i.image,title:i.headline,url:i.links}}},fetch_trending_stories:function(){return n.fetchData(this.trendingUrl)},render_recommendation:function(t){var e=this.get_tracker();this.remove_viewed_assets(e,t);var i=this.generate_user_ssts_preference(e),s=this.match_trending_stories(i,t);s?(this.remove_asset_from_trending_stories(s.asset_id,t),this.render(s)):this.render_fallback()},generate_user_ssts_preference:function(t){t||(t=this.get_tracker());for(var e=[],i=this.generate_nodes_priority_list(t.sstsTree),s=0;s<i.length;s+=1){var n=i[s];e.push(this.get_node_ssts_path(n))}return e},generate_nodes_priority_list:function(t){for(var e=[],i=function(t,e){return t.weight<e.weight},s=0;s<t.nodes.length;s+=1){var n=t.nodes[s],o=[];this._add_node_weight(n),e.push(n),this._get_node_children(n,o);for(var r=o.length-1;r>=0;r-=1){var a=o[r];this._add_node_weight(a),e.push(a)}}return e.sort(i),e},_add_node_weight:function(t){if(t.parent){var e=.51;t.weight=t.count,t.count>t.parent.count*e&&(t.weight=t.count+t.parent.count)}else t.weight=t.count},_get_node_children:function(t,e){for(var i=0;i<t.nodes.length;i+=1){var s=t.nodes[i];s.parent=t,e.push(s),s.nodes.length&&this._get_node_children(s,e)}},match_trending_stories:function(t,e){for(var i=e.trending,s=0;s<t.length;s+=1){for(var n=t[s],o=e.sections,r=0;r<n.length;r+=1){var a=n[r];if(!o[a])break;o=o[a],r===n.length-1&&(i=o.ids)}if(i!==e.trending)break}var l=e.articles[i[0]];return l},get_node_ssts_path:function(t){for(var e=[t.ssts];t.parent&&t.parent.ssts;)e.unshift(t.parent.ssts),t=t.parent;return e},insert_node:function(t,i){var s=t.ssts.split("/"),n=i.nodes,o=function(t,e){return t.count<e.count};i.count+=1;for(var r=0;r<s.length;r+=1){var a=s[r],l=e.findWhere(n,{ssts:a});l?l.count+=1:(l={ssts:a,count:1,nodes:[]},n.push(l)),n.sort(o),n=l.nodes}},remove_node:function(t,i){for(var s=t.ssts.split("/"),n=i.nodes,o=0;o<s.length;o+=1){var r=s[o],a=e.findWhere(n,{ssts:r});if(a){if(0===o&&(i.count-=1),1===a.count){n.splice(e.indexOf(n,a),1);break}a.count-=1,n=a.nodes}}},remove_viewed_assets:function(t,e){for(var i=0;i<t.history.length;i+=1){var s=t.history[i];this.remove_asset_from_trending_stories(s.asset_id,e)}},remove_asset_from_trending_stories:function(t,i){var s=i.articles[t];if(s){i.trending=e.without(i.trending,t);for(var n=s.ssts.split("/"),o=i.sections,r=0;r<n.length;r+=1){var a=n[r];o=o[a],o.ids=e.without(o.ids,t)}delete i.articles[t]}},track_asset:function(){var t=n.getActivePageInfo(),e=this.get_tracker(),i=t.assetid,s=this.is_unique_tracking_asset(i),o=t.ssts,r={asset_id:i,ssts:o};if(i&&o){if(e.history.length>=this.trackLimit){var a=e.history[e.history.length-1];this.remove_node(a,e.sstsTree),e.history.splice(e.history.length-1,1)}return e.history.unshift(r),s&&this.insert_node(r,e.sstsTree),localStorage.setItem("recommendation",JSON.stringify(e)),e}return!1},is_unique_tracking_asset:function(t){for(var e=this.get_tracker(),i=!0,s=0;s<e.history.length;s+=1)if(e.history[s].asset_id===t){e.history.splice(s,1),i=!1;break}return i},get_tracker:function(){return this.tracker?this.tracker:(this.tracker=localStorage.getItem("recommendation"),this.tracker=this.tracker?JSON.parse(this.tracker):{history:[],sstsTree:{count:0,nodes:[]}},this.tracker)},scroll_listener:function(){var t=s.getScrollPosition(),e=t+this.winHeight;this.forcedStatus||(this.trigger_dom_offset<=e?this.open_flyout():this.close_flyout())},render:function(t){try{var i=e.template(this.$flyoutTemplate.html(),{data:t});this.$flyout.html(i),this.rendered=!0}catch(s){console.error("failed rendering flyout template",s)}},toggle:function(t){t.preventDefault(),this.forcedStatus=!0,this.isOpen?this.close_flyout():this.open_flyout()},open_flyout:function(){!this.isOpen&&this.rendered&&(this.animate(this.$flyoutWrap,"width",360,350,"ease-out"),this.$flyout.removeClass("closed"),this.isOpen=!0,this.hasOpened=!0)},close_flyout:function(){this.hasOpened&&this.isOpen&&(this.animate(this.$flyoutWrap,"width",24,250,"ease-out"),this.$flyout.addClass("closed"),this.isOpen=!1)},destroy:function(t){t&&this.$el.remove(),this.unbind(),clearInterval(this.next_story_check),i.prototype.destroy.apply(this,arguments)}});return r}),define("apps/live_app/live-app-app",["jquery","underscore","base-app","site-manager"],function(t,e,i,s){var n=i.extend({activateLoader:function(){window.scrollTo(0,0),this.$el.addClass("has-live-app-global-loader")},deactivateLoader:function(){window.scrollTo(0,0),this.$el.removeClass("has-live-app-global-loader")},animateRevealApp:function(){return s.getHeader().setClosedFixed(),i.prototype.animateRevealApp.apply(this,arguments)},afterAppRemove:function(){s.getHeader().restoreDefaultState()}});return n}),define("modules/stories/expand-faq",["jquery","baseview"],function(t,e){var i=e.extend({events:{"click a":"expandFaq"},expandFaq:function(e){var i=t(e.target),s=i.next();s.is(":visible")?(i.parent().removeClass("active"),s.slideUp(200)):(i.parent().addClass("active"),s.slideDown(200))}});return i}),define("modules/fronts/snapshots",["jquery","underscore","baseview","state","cookie"],function(t,e,i,s){var n=i.extend({el:".front-galleries-module",events:{"click a.vote":"revealQuickQuestion","click .snap-vote a.cancel":"revealSnapshotTeaser","click a.snap-vote-btn":"registerVote"},initialize:function(){i.prototype.initialize.apply(this,arguments),this.render()},render:function(){if(t("#snapshots").length<=0){var e=this.$(".js-fg-nav-list"),i=e.find("li:first-child"),s=e.data("item-class")||"",n=e.data("link-class")||"";i.after('<li data-id="gallery" id="snapshots" class="front-gallery-item news-theme-border-hover '+s+'" data-href="/services/snapshots/gallery/" data-theme="news-theme-border"><a class="front-gallery-link '+n+'" href="/services/snapshots/gallery/" data-href="/services/snapshots/gallery/">Snapshots</a></li>')}},revealQuickQuestion:function(e){var i=t(e.currentTarget).closest(".snapshot-card");t(".snapshot",i).hide(),t(".snap-vote",i).not(".results").fadeIn()},revealSnapshotTeaser:function(e){var i=t(e.currentTarget).closest(".snapshot-card");t(".snap-vote",i).hide(),t(".snapshot",i).fadeIn()},revealResults:function(e,i){var s=t(e.currentTarget).closest(".snapshot-card");s.find(".snap-vote.results").length?s.find(".snap-vote.results").replaceWith(i):s.append(i),t(".snap-vote",s).hide(),t(".snap-vote.results",s).fadeIn()},registerVote:function(i){var n=(t(i.currentTarget).closest(".snapshot-card"),t(i.currentTarget).attr("data-answer-id")),o="/services/snapshots/vote/"+n+"/";t(i.currentTarget).addClass("loading");var r=t(".slide.active[data-qqid]",this.el).attr("data-qqid");t.cookie(r)&&(o="/services/snapshots/get/"+r+"/"),this.ajax=s.fetchData(o).done(e.bind(function(s){var n=e.pluck(s.question[0].location[0].answer,"answerCount"),o=e.reduce(n,function(t,e){return t+parseFloat(e)},0),a=s.question[0].location[0].answer.length-1,l=0;e.each(s.question[0].location[0].answer,function(t,e){var i=Math.round(parseFloat(t.answerCount)/o*100);e===a?i=100-l:l+=i,t.answerPercent=i});var h=t("#snapshot-results"),c=e.template(h.html(),{data:s.question[0]});this.revealResults(i,c),t(i.currentTarget).removeClass("loading"),t.cookie(r,!0)},this))}});return n}),define("modules/sports/sports-video",["jquery","underscore","baseview","modules/global/brightcove-video"],function(t,e,i,s){"use strict";var n=s.extend({events:function(){var t=s.prototype.events;return e.isFunction(t)&&(t=t()),e.extend({},t,{"click .videoStillPlay":"swapImageForVideo","click .hero-3up-image-1":"swapImageForVideo","click .stagfront-hero-3up-text-1":"swapImageForVideo"})},initialize:function(t){this.$(".util-bar-primary-modules").addClass("util-bar-primary-modules-topic"),this.$(".util-bar-primary-modules-topic").removeClass("util-bar-primary-modules"),s.prototype.initialize.call(this,t)},swapImageForVideo:function(e){t(this.$(".parent-label.sports")[0]).css("display","none"),s.prototype.swapImageForVideo.call(this,e)},destroy:function(){s.prototype.destroy.call(this,!1)}});return n}),define("ui/generic-paginator",["jquery","underscore","backbone","baseview"],function(t,e,i,s){var n=s.extend({events:{"click .paginator-indicator-target":"onPaginatorClick"},initialize:function(e){this.$pageElements=this.$(".paginator-indicator-target"),e=t.extend({onBeforePaginator:null,onGoTo:null},e),s.prototype.initialize.call(this,e)},onPaginatorClick:function(e){e&&e.preventDefault();var i=t(e.currentTarget).index();if(this.options.onBeforePaginator){var s=this.options.onBeforePaginator(i,e);if(!s)return!1}this.goToPage(i)},goToPage:function(t){if(0!==this.$pageElements.length){0>t?t=0:t>=this.$pageElements.length&&(t=this.$pageElements.length-1);var e=this.$pageElements.eq(t);this.$(".paginator-indicator-bullet").removeClass("active"),e.find(".paginator-indicator-bullet").addClass("active"),this.options.onGoTo&&this.options.onGoTo(t)}},goToNextPage:function(t){var e=this.$(".paginator-indicator-bullet.active"),i=e.parent().index();i<this.$pageElements.length-1?this.goToPage(i+1):t&&this.goToPage(0)},goToPrevPage:function(t){var e=this.$(".paginator-indicator-bullet.active"),i=e.parent().index();i>0?this.goToPage(i-1):t&&this.goToPage(this.$pageElements.length-1)}});return n}),define("modules/fronts/featured-content",["jquery","underscore","baseview","utils","ui/generic-paginator"],function(t,e,i,s,n){var o=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){e.bindAll(this,"automate","goTo"),s=t.extend({transition:{interval:15e3}},s),this.subviews={},this.moveMe=this.$(".fcpm-items-wrap"),this.viewport=this.moveMe.parent(),this.subviews.paginator=new n({el:this.$(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(t){this.stoptimer(),i.prototype.destroy.call(this,t)},goTo:function(t){var e=this.viewport.outerWidth(),i=e*t*-1;this.animate(this.moveMe,"left",i+"px",450,"ease-in-out"),s.lazyLoadImage(this.moveMe.find("img"))},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return o}),define("third-party-apis/facebook/facebook",["jquery","underscore","third-party-apis/base-third-party-api"],function(t,e,i){"use strict";var s=i.extend({initialize:function(){this._config=this.getApiSiteConfig("FACEBOOK"),this._config&&(this._appid=this._config.APPID,this._channelUrl=window.location.protocol+"//"+window.location.host+window.site_static_url+"html/channel.html"),i.prototype.initialize.call(this)},_handleLoadScript:function(){return this._facebookPromise||(this._facebookPromise=t.Deferred(e.bind(function(i){return this._config.ENABLED?void t.ajax("//connect.facebook.net/en_US/all.js",{cache:!0,data:{},dataType:"script"}).done(e.bind(function(){FB?(this._initializeFacebook(),i.resolve(FB)):i.reject()},this)).fail(function(){i.reject()}):void i.reject()},this)).promise()),this._facebookPromise},_initializeFacebook:function(){FB.init({appId:this._appid,channelUrl:this._channelUrl,status:!0,cookie:!0,xfbml:!1})},getUserPermissions:function(){return this._config.PERMISSIONS}});return new s}),define("modules/stories/share-facebook",["jquery","underscore","backbone","baseview","pubsub","utils","third-party-apis/facebook/facebook"],function(t,e,i,s,n,o,r){var a=s.extend({events:{"click .util-bar-share-submit-btn-facebook":"onClickPostBtn","click .util-bar-success-link-facebook":"onClickPostLink"},initialize:function(t){e.bindAll(this,"fbShareCallback"),s.prototype.initialize.call(this,t)},onClickPostBtn:function(){this.$loading=this.$$(".util-bar-share-loading-facebook"),this.$status=this.$$(".util-bar-share-status-text-facebook"),this.$message=this.$$(".util-bar-share-message-facebook"),this.$successPane=this.$$(".util-bar-flyout-pane-success-facebook"),this.$successLink=this.$$(".util-bar-success-link-facebook"),this.$successDescription=this.$$(".util-bar-success-description-facebook"),this.$flyoutSection=this.$$(".util-bar-flyout-section-facebook"),this.fbShare()},fbShare:function(){this.$loading.show();var t={method:"feed",link:this.$message.data("link"),picture:this.$message.data("image"),name:this.$message.data("title")};r.loadScript().done(e.bind(function(){FB.ui(t,this.fbShareCallback)},this))},fbShareCallback:function(e){if(e)if(e.error)this.$loading.hide(),this.$status.text("An error occurred, try again.");else{if(this.$successLink.remove(),e.post_id){var i=e.post_id.split("_");if(i.length>=2){var s="https://www.facebook.com/"+i[0]+"/posts/"+i[1],o=t('<a class="util-bar-success-link-facebook" href="'+s+'">View the post.</a>');this.$successDescription.append(o)}}this.$loading.hide(),this.$flyoutSection.hide(),this.$successPane.show(),n.trigger("uotrack","UtilityBarShareFacebook")}else this.$loading.hide()},onClickPostLink:function(e){e.preventDefault();var i=t(e.target).attr("href");o.openPopup(i,1e3,600)}});return a}),define("ui/loader",["jquery","underscore","baseview","pubsub","utils"],function(t,e,i,s,n){"use strict";var o=i.extend({initialize:function(e){this.options=t.extend({msg:""},e),this.win=n.get("win"),this.body=n.get("body"),this.el=t(this.options.el),this.msg=this.options.msg,this.render()},render:function(){var e=t("<div>").addClass("loading-icon");this.$loader=t("<div>").addClass("ui-loader"),this.$target=this.$el,this.$target.append(this.$loader.append(e).append(t("<span>").html(this.msg))),this.$el=this.$loader},destroy:function(){this.hide(),i.prototype.destroy.apply(this,arguments)},show:function(){this.$loader.addClass("active")},hide:function(){this.$loader.removeClass("active")}});return o}),define("modules/fronts/front-galleries",["jquery","underscore","backbone","pubsub","baseview","utils","modules/carousel/carousel","ui/loader","state"],function(t,e,i,s,n,o,r,a,l){"use strict";var h=n.extend({empty:!0,events:{"click .front-gallery-link":"select"},initialize:function(){if(this.$galleries=this.$(".front-gallery"),this.$navItems=this.$(".front-gallery-item"),e.bindAll(this,"switchGallery"),n.prototype.initialize.call(this,{}),this.subviews.loader=new a({el:this.$galleries.parent()}),this.$galleries.find(".slide.active").length){var t=this.$(".front-gallery.selected");this._initializeCarousel(t,t.index(),this.$navItems.filter(".selected").find("a").attr("href")),this.empty=!1}else{var i=this.$navItems.first().find("a").attr("href");"undefined"!=typeof i&&i.length>1&&this.fetchData(i,0,this.switchGallery)}},_initializeCarousel:function(t,e,i){var s=new r({ads:!0,linkPath:i,el:t.find(".galleries"),fullScreen:!0});return this.subviews["gallery"+e]=s,s},onCardWidthChange:function(t){this.currentCardInfo&&this.currentCardInfo.primaryFlexWidth===t.primaryFlexWidth||this.triggerEvent("viewportResize"),this.currentCardInfo=t
},fetchData:function(t,e,i){var s=this,n=!0,o=this.$el.data("layout-type"),r=this.$(".front-gallery.selected");r.length&&(r.css({opacity:1}),this.animate(r,"opacity",0,200).done(function(){n&&s.loading(!0)})),o&&(t="/"+o+t),l.fetchHtml("/front-gallery"+t).done(function(s){i(s,e,t)}).always(function(){n=!1,s.loading(!1)})},loading:function(t){t?this.subviews.loader.show():this.subviews.loader.hide()},select:function(e){var i=t(e.currentTarget),s=i.attr("href"),n=i.parent(),o=n.index(),r=this.$galleries.eq(o);-1===s.indexOf("://")&&(r.find(".galleries").length>0?this.switchGallery(null,o,s):this.fetchData(s,o,this.switchGallery),e&&e.preventDefault());var a=this.$navItems.filter(".selected"),l=a.attr("data-theme")||"",h=n.attr("data-theme")||"";a.removeClass(l+" selected"),n.addClass(h+" selected")},switchGallery:function(t,e,i){var s=this.$galleries.eq(e);if(this.$galleries.removeClass("selected"),s.addClass("selected"),t&&s.html(t),this.subviews["gallery"+e])this.trackGalleryChange(this.subviews["gallery"+e]);else{var n=this._initializeCarousel(s,e,i);this.empty||this.trackGalleryChange(n)}s.css({opacity:0}),this.animate(s,"opacity",1,200)},trackGalleryChange:function(t){t._trackSlideChange()}});return h}),define("modules/sports/sports-gallery-sponsorship-skin",["jquery","underscore","baseview","pubsub"],function(t,e,i,s){"use strict";var n=i.extend({initialize:function(n){n=t.extend({imageSkinTop:"",imageSkinRight:"",imageSkinRightHeight:0,imageSkinBottom:"",imageSkinLeft:"",imageSkinLeftHeight:0,htmlBackground:"",clickThru:""},n),this.$background=t(""),e.bindAll(this,"showSkin","hideSkin","setupBackground"),i.prototype.initialize.call(this,n),s.on("carousel:sidebarOpened",this.showSkin),s.on("carousel:sidebarClosed",this.hideSkin)},destroy:function(t){this.$background&&(this.$background.remove(),this.$background=null),s.off("carousel:sidebarOpened",this.showSkin),s.off("carousel:sidebarClosed",this.hideSkin),i.prototype.destroy.call(this,t)},hideSkin:function(){this.$background.hide()},render:function(){this.setupBackground(),this.options.startVisible()&&this.showSkin()},showSkin:function(){this.options.sidebarAds()&&this.$background.parent().hasClass("active")&&this.$background.show()},setupBackground:function(){if("Yes"===this.options.hasSkin||!this.options.sponsorshipHtml){this.$background=t(e.template(this.options.htmlBackground,this.options));var i=t(this.options.galleryClass).height();if(""===this.options.imageSkinTop&&this.$background.remove(".sp-galleries-skin-top"),""===this.options.imageSkinRight)this.$background.remove(".sp-galleries-skin-right");else{var s=(i-this.options.imageSkinRightHeight)/2;this.$background.children(".sp-galleries-skin-right").css("top",s)}if(""===this.options.imageSkinBottom&&this.$background.remove(".sp-galleries-skin-bottom"),""===this.options.imageSkinLeft)this.$background.remove(".sp-galleries-skin-left");else{var n=(i-this.options.imageSkinLeftHeight)/2;this.$background.children(".sp-galleries-skin-left").css("top",n)}this.hideSkin(),this.$el.after(this.$background)}}});return n}),define("modules/sports/sports-carousel-gallery",["jquery","underscore","backbone","baseview","pubsub","utils","modules/global/taboola","modules/carousel/gallery","directAdPosition","modules/sports/sports-gallery-sponsorship-skin","adLogger"],function(t,e,i,s,n,o,r,a,l,h){var c=a.extend({initialize:function(i){e.bindAll(this,"onAdReady","_initializeAds","startVisible","teardownSponsorshipAd"),i=t.extend({galleryClass:".sports-front-galleries-primary"},i),a.prototype.initialize.call(this,i)},_initializeAds:function(){if(this.options.ads){this.galleryData=this.$el.data()||{};var t=this.getAdTargeting();if(this.teardownSponsorshipAd(),this.$sponsorshipAd.length){var e=this._getSlideIn(this.index).data("qqid");t.snapshotid=e,this.subviews.sponsorshipAd=new l({el:this.$sponsorshipAd,adPlacement:"sponsor_logo/"+this.$el.data("cst"),adSizes:["sponsor_logo"],targeting:t,onAdReady:this.onAdReady})}}},onAdReady:function(e,i){"sponsorshiplogo"===i&&"Yes"===e.hasSkin&&(this.subviews.sponsorshipSkin=new h(t.extend({el:this.$sponsorshipAd,startVisible:this.startVisible,sidebarAds:this.options.sidebarAds,galleryClass:this.options.galleryClass},e)),this.subviews.sponsorshipSkin.render())},startVisible:function(){return this.options.isSideBarOpen()&&this.options.sidebarAds()?!0:!1},teardownSponsorshipAd:function(){this.$sponsorshipAd=this.$el.closest(this.options.galleryClass).find(".sp-galleries-sponsored-by"),this.$sponsorshipSkin=this.$el.closest(this.options.galleryClass).find(".sp-galleries-skin"),this.$sponsorshipAd.children().empty(),this.$sponsorshipSkin.remove()},refreshSponsorshipAd:function(){},refreshSportsSponsorshipAd:function(){this.teardownSponsorshipAd();var t=this.getAdTargeting();this.subviews.sponsorshipAd.setTargeting(t),this.subviews.sponsorshipAd.refreshPosition()}});return c}),define("modules/sports/sports-front-carousel",["jquery","underscore","utils","pubsub","modules/carousel/carousel","modules/sports/sports-carousel-gallery"],function(t,e,i,s,n,o){"use strict";var r=n.extend({events:function(){var t=n.prototype.events;return e.isFunction(t)&&(t=t()),e.extend({},t,{mouseenter:"mouseEnter",click:"mouseClick"})},initialize:function(o){this.$primary=t(".sports-front-galleries-primary"),this.$module=t(".sports-front-galleries-module"),this.$closer=t(".gallery-sidebar-close"),this.$sidebar=t(".gallery-sidebar-ad"),this.$counter=t(".gallery-count"),this.$cardfilm=t(".card-film"),this.$cardcolor=t(".card-suspender-color"),this.$suspender=t(".sports-front-galleries-suspender"),this.$caption=t(".gallery-sidebar-ad .caption").html(),e.bindAll(this,"mouseScroll","mouseClick","mouseEnter","isSideBarOpen","sidebarCaption"),n.prototype.initialize.call(this,o),this.sidebarCaption(),s.on("carousel:switchSlide",e.bind(function(){this.captionPoll=setInterval(this.sidebarCaption,200)},this)),s.on("gallery:clickSidebar",e.bind(function(){this.showSidebar()},this)),this.$win=i.get("win"),this.$win.on("scroll."+this.cid,this.mouseScroll),this.$win.on("click."+this.cid,this.mouseClick)},_initializeGallery:function(t,e,i,s){this.subviews.gallery=new o({ads:i,el:s?this.$(s):this.$el,index:this.index,imageLazySrcAttr:t,slideTransition:e,carousel:this,isSideBarOpen:this.isSideBarOpen,sidebarAds:this.options.sidebarAds})},sidebarCaption:function(){var e=t(".gallery-sidebar-ad .caption"),i=t(".selected .active .gallery-viewport-caption").html();i!=this.$caption&&(this.$caption=i,clearInterval(this.captionPoll)),i?e.html(i):e.empty()},openSidebar:function(t){t&&(t.preventDefault(),t.stopPropagation());var i=parseInt(this.$sidebar.outerWidth()+1,10),n=null;this.$sidebar.hasClass("active")||(this.$sidebar.addClass("active"),n=this.animate(this.$sidebar,"right",-i+"px",250,"ease-in-out").promise().done(e.bind(function(){this.options&&this.options.onSidebarAfterReveal&&this.options.onSidebarAfterReveal(),s.trigger("carousel:sidebarOpened")},this)))},showSidebar:function(){var t=parseInt(this.$sidebar.outerWidth(),10);this.$sidebar.hasClass("active")||(this.$sidebar.addClass("active"),this.$primary.addClass("active"),this.$sidebar.css({right:-t+"px",transition:""}),this.options&&this.options.onSidebarAfterReveal&&this.options.onSidebarAfterReveal(),this.$closer.addClass("active"))},isSideBarOpen:function(){return!this.$cardfilm.hasClass("inactive")},mouseEnter:function(){},mouseScroll:function(){if(this.$sidebar.hasClass("active")){var e=this.$sidebar.outerHeight(),i=this.$module.position().top,s=t(window).scrollTop(),n=t(window).outerHeight();(s>i+e+90||i>s+n-130)&&this.$closer.click()}},mouseClick:function(t){if(this.$sidebar.hasClass("active")){s.trigger("carousel:cardfilmActive");var e=this.$module.offset().top,i=this.$module.offset().left,n=this.$module.outerWidth()+this.$sidebar.outerWidth(),o=this.$sidebar.outerHeight();t.pageX<i||t.pageX>i+n||t.pageY<e||t.pageY>e+o?this.$closer.click():this.$closer.hasClass("active")||(this.$closer.addClass("active"),this.$cardfilm.removeClass("inactive"),this.$module.css("z-index",501),this.$suspender.css("background-color",this.$cardcolor.css("background-color")))}},destroy:function(t){clearInterval(this.captionPoll),this.$win.off("."+this.cid),t&&this.$el.parent().remove(),s.off("carousel:switchSlide"),s.off("gallery:clickSidebar"),n.prototype.destroy.call(this,!1)}});return r}),define("modules/sports/sports-front-galleries",["jquery","underscore","baseview","pubsub","modules/stories/share-facebook","modules/fronts/front-galleries","modules/sports/sports-front-carousel","ui/loader","directAdPosition"],function(t,e,i,s,n,o,r,a,l){"use strict";var h=o.extend({events:function(){var t=o.prototype.events;return e.isFunction(t)&&(t=t()),e.extend({},t,{"click .util-bar-flyout-nav-btn":"onClickFlyoutNavBtn","click .gallery-sidebar-close":"closeSidebar","click .fullscreen":"launchFullscreen","click .sidebar-gallery-btn, .thumb-link":"clickPhoto"})},initialize:function(){if(this.$primary=t(".sports-front-galleries-primary"),this.$module=t(".sports-front-galleries-module"),this.$closer=this.$(".gallery-sidebar-close"),this.$sidebar=this.$(".gallery-sidebar-ad"),this.$counter=t(".gallery-count"),this.$toolbox=this.$(".gallery-sidebar-toolbox"),this.$cardfilm=t(".card-film"),this.$cardcolor=t(".card-suspender-color"),this.$suspender=t(".sports-front-galleries-suspender"),this.$(".front-gallery.snapshot-placeholder").remove(),this.$galleries=this.$(".front-gallery"),this.$navItems=this.$(".front-gallery-item"),this.$titles=this.$(".gallery-sidebar-title"),this.$partnerSlot=t(".sp-galleries-partner-slot"),this.$sidebarBtn=this.$(".sidebar-gallery-btn"),e.bindAll(this,"switchGallery","setupAd","refreshAd","sidebarAds","resetGallery","clickPhoto"),i.prototype.initialize.call(this,{}),s.on("carousel:switchSlide",e.bind(function(){this.refreshAd()},this)),s.on("gallery:hideSidebar",e.bind(function(){this.hideSidebar()},this)),this.subviews.loader=new a({el:this.$galleries.parent()}),this.$galleries.find(".slide.active").length){var o=this.$(".front-gallery.selected"),l=this.$(".front-gallery");this.subviews["gallery"+l.index(o)]=new r({ads:!0,linkPath:this.$navItems.filter(".selected").find("a").attr("href"),el:o.find(".galleries"),fullScreen:!0,onSidebarAfterReveal:this.setupAd,sidebarAds:this.sidebarAds}),this.empty=!1}else{var h=this.$navItems.first().find("a").attr("href");"undefined"!=typeof h&&h.length>1&&this.fetchData(h,0,this.switchGallery)}this.$(".util-bar-flyout-section").hide(),this.subviews.facebook=new n({el:this.$(".util-bar-flyout-share")})},_initializeAds:function(){this.$sponsorshipAd||(this.$sponsorshipAd=t('<div class="partner-placement poster" data-monetization-id="sp-gallery" data-monetization-sizes="mediumrectangle"></div>'),this.$partnerSlot.append(this.$sponsorshipAd))},renderCardInfo:function(t){this.currentCardInfo=t},onCardWidthChange:function(t){this.currentCardInfo=t,this.sidebarAds()?(this.setupAd(),this.$sidebar.hasClass("active")&&s.trigger("carousel:cardfilmActive")):(this.teardownAd(),this.$sidebar.hasClass("active")&&s.trigger("carousel:sidebarClosed"))},sidebarAds:function(){return this.currentCardInfo?this.currentCardInfo.sidebarAds:!1},switchGallery:function(e,i,s){var n=this.$galleries.eq(i);this.$galleries.removeClass("selected"),n.addClass("selected");var o=this.$toolbox.eq(i);this.$toolbox.length>1&&this.$toolbox.removeClass("selected"),o.addClass("selected"),this.$(".util-bar-flyout-nav-btn").removeClass("active");var a=this.$titles.eq(i);this.$titles.length>1&&this.$titles.removeClass("selected"),a.addClass("selected");var l=this.$(".gallery-sidebar-ad .caption"),h=n.find(".active .gallery-viewport-caption").html();if(this.resetSections(),l.html(h),e){n.html(e);var c='<div class="gallery-count"><div>'+n.find(".thumb-item").length+'</div><div class="line">Photos</div></div>';n.append(c),this.$counter=t(".gallery-count")}if(this.subviews["gallery"+i])this.trackGalleryChange(this.subviews["gallery"+i]),this.subviews["gallery"+i].subviews.gallery&&this.subviews["gallery"+i].subviews.gallery.refreshSportsSponsorshipAd&&this.subviews["gallery"+i].subviews.gallery.refreshSportsSponsorshipAd(),this.teardownAd(),this.setupAd();else{var d=this.subviews["gallery"+i]=new r({ads:!0,el:n.find(".galleries"),fullScreen:!0,linkPath:s,onSidebarAfterReveal:this.setupAd,sidebarAds:this.sidebarAds});this.empty||(this.trackGalleryChange(d),this.empty=!1)}n.css({opacity:0}),this.animate(n,"opacity",1,200)},launchFullscreen:function(){t(".front-gallery.selected .fullscreen").click()},setupAd:function(){var t=this.$(".front-gallery").index(this.$(".front-gallery.selected"));if(this.sidebarAds()){this.adSetup=!0,this._initializeAds();var e={};this.subviews["gallery"+t].subviews.gallery&&this.subviews["gallery"+t].subviews.gallery.getAdTargeting&&(e=this.subviews["gallery"+t].subviews.gallery.getAdTargeting());var i=this.$(".front-gallery.selected .galleries").data();this.subviews.sponsorshipAd=new l({el:this.$sponsorshipAd,adPlacement:"poster_gallery_companion/"+i.cst,adSizes:["mediumrectangle"],targeting:e})}},onClickFlyoutNavBtn:function(e){var i=t(e.currentTarget),n=t(e.currentTarget).data("share-method"),o=t(e.currentTarget).data("share-title"),r=t(e.currentTarget).data("share-link"),a="SportsGallery"+n;s.trigger("uotrack",a),n&&this.showSection(i.parent().parent(),n),this.$closer.hasClass("active")||(this.$closer.addClass("active"),this.$cardfilm.removeClass("inactive"),this.$module.css("z-index",501),this.$suspender.css("background-color",this.$cardcolor.css("background-color"))),"facebook"==n&&(this.$(".util-bar-share-message-facebook").data("link",r),this.$(".util-bar-share-message-facebook").data("title",o),this.resetSections(),this.$(".gallery-sidebar-ad .caption").empty(),this.subviews.facebook.onClickPostBtn(e),e.preventDefault())},showSection:function(t,e){this.resetSections(),this.activeSection=e,this.$(".util-bar-flyout-nav-btn-"+e).addClass("active")},resetSections:function(){this.$(".util-bar-flyout-nav-btn").removeClass("active"),this.$(".util-bar-flyout-pane-success").hide()},resetGallery:function(){this.resetSections(),this.$primary.removeClass("active"),this.$closer.removeClass("active"),this.$cardfilm.addClass("inactive"),this.$sidebar.removeClass("active"),this.$module.css("z-index","auto")},closeSidebar:function(t){t&&(t.preventDefault(),t.stopPropagation());var i=(parseInt(this.$sidebar.outerWidth()+1,10),null);this.$sidebar.hasClass("active")&&(s.trigger("carousel:sidebarClosed"),this.$(".util-bar-flyout-nav-btn").removeClass("active"),i=this.animate(this.$sidebar,"right",0,250,"ease-in-out"),i.done(e.bind(function(){this.resetGallery()},this)),this.teardownAd()),this.$sidebarBtn.addClass("active")},hideSidebar:function(){parseInt(this.$sidebar.outerWidth()+1,10);this.$sidebar.hasClass("active")&&(this.$(".util-bar-flyout-nav-btn").removeClass("active"),this.$sidebar.css({right:0,transition:""}),this.resetGallery(),this.teardownAd())},refreshAd:function(){this.subviews.sponsorshipAd&&this.subviews.sponsorshipAd.refreshPosition&&this.subviews.sponsorshipAd.refreshPosition()},teardownAd:function(){this.subviews.sponsorshipAd&&this.adSetup&&(delete this.adSetup,this.$sponsorshipAd.empty(),this.subviews.sponsorshipAd.destroy(),delete this.subviews.sponsorshipAd)},clickPhoto:function(t){if(this.$sidebarBtn.hasClass("active")){t&&(t.preventDefault(),t.stopPropagation());var e=this.$(".front-gallery.selected"),i=this.$(".front-gallery");this.subviews["gallery"+i.index(e)].openSidebar(),this.$closer.addClass("active"),this.$sidebarBtn.removeClass("active"),this.$primary.hasClass("active")||this.$primary.addClass("active"),this.$cardfilm.removeClass("inactive")}},destroy:function(t){s.off("carousel:switchSlide"),s.off("gallery:hideSidebar"),o.prototype.destroy.call(this,t)}});return h}),define("modules/sports/sports-popup-media-view",["jquery","underscore","backbone","pubsub","baseview","modules/sports/sports-front-galleries","modules/global/brightcove-video","state","ui/loader"],function(t,e,i,s,n,o,r,a,l){var h=n.extend({el:"body",events:{"click .video-popup-close":"hideVideo","click .popup-media-video":"showVideo","click .popup-media-gallery":"showGallery","click .gallery-sidebar-close.active":"hideGallery"},initialize:function(i){n.prototype.initialize.call(this,i),this.$cardfilm=this.$(".sports-popup-media-module .popup-film"),this.$title=this.$(".sports-popup-media-module .gallery-sidebar-title"),this.$video=this.$(".sports-popup-media-module .video-wrapper"),this.$gallery=this.$(".sports-popup-media-module .gallery-wrapper"),this.$galleryLinks=this.$(".sports-popup-media-module .gallery-link-wrapper"),this.$galleryCount=0,e.bindAll(this,"prepareMedia","updateShareTools","lightsOn","lightsOut","hideGallery","showGallery","hideVideo","showVideo"),s.on("carousel:sidebarClosed",e.bind(function(){this.hideGallery()},this)),this.pattern="/popup-media-link",this.prepareMedia(),s.on("showmore:headlines",this.prepareMedia),this.subviews.gallery=new o({el:t(".stagfront-content")}),this.subviews.loader=new l({el:this.$video})},prepareMedia:function(){var e=this;this.$(".hero-asset-open").addClass("hero-asset-popup"),this.$(".anchor, .hero-asset-popup a").each(function(){var e=t(this).attr("href");void 0===e&&(e=t(this).data("href")),void 0!==e&&(0===e.indexOf("/picture-gallery/")?t(this).addClass("popup-media-gallery"):0===e.indexOf("/videos/")&&t(this).addClass("popup-media-video"))}),this.$(".popup-media-gallery").each(function(i){if(i>=e.$galleryCount){var s=t(this).attr("href"),n=s.split("/").slice(-2,-1)[0];t(this).data("id",n);var o='<div class="front-gallery-item"><a id="link'+n+'" class="front-gallery-link" href="'+s+'"></a></div>';e.$galleryLinks.append(o);var r='<div id="'+n+'" class="front-gallery" data-vr-contentbox="gallery-'+i+'"></div>';e.$(".front-gallery").last().after(r)}}),this.$galleryCount=this.$(".front-gallery-item").length,this.$(".gallery-sidebar-close").addClass("active"),this.hideGallery(),this.hideVideo()},lightsOn:function(){this.$cardfilm.hasClass("inactive")||this.$cardfilm.addClass("inactive")},lightsOut:function(e){t(e.currentTarget);e.preventDefault(),this.$cardfilm.removeClass("inactive")},hideGallery:function(){this.lightsOn(),this.$gallery.hide(),s.trigger("gallery:hideSidebar")},showGallery:function(e){this.lightsOut(e);var i=t(e.currentTarget);this.$galleryLinks.find("#link"+i.data("id")).click();var n=i.find("h1, h3 span").html();this.$title.html(n);var o=t(window).outerWidth();o>1080?this.$gallery.css("left",(o-1080)/2):this.$gallery.css("left",(o-720)/2),this.updateShareTools(i.attr("href")),s.trigger("gallery:clickSidebar"),this.$gallery.show()},hideVideo:function(){this.lightsOn(),this.subviews.video&&this.subviews.video.pauseVideo(),this.$video.hide()},showVideo:function(e){var i=this,s=t(e.currentTarget),n=s.attr("href"),o=t(window).outerWidth();this.$video.css("left",(o-this.$video.width())/2);this.$(".popup-media-video").index(s);this.lightsOut(e),this.$video.show(),this.subviews.loader.show(),a.fetchHtml(n).done(function(t){var e=t.find(".asset .video"),s=i.$(".video-wrapper .video-slot");s.html(e),s.html(s.html().replace("usat_shareFunction","default_shareFunction")),i.subviews.video=new r({el:e,autostart:!0}),i.subviews.loader.hide()})},updateShareTools:function(t){var e=this.$(".gallery-sidebar-ad .util-bar-flyout-nav-btn-facebook");e.data("share-link",e.data("share-link").replace(this.pattern,t));var i=this.$(".gallery-sidebar-ad .util-bar-flyout-nav-btn-twitter");i.attr("href",i.attr("href").replace(this.pattern,t));var s=this.$(".gallery-sidebar-ad .util-bar-flyout-nav-btn-googleplus");s.attr("href",s.attr("href").replace(this.pattern,t));var n=this.$(".gallery-sidebar-ad .util-bar-flyout-nav-btn-linkedin");n.attr("href",n.attr("href").replace(this.pattern,t)),this.pattern=t},destroy:function(){s.off("showmore:headlines"),s.off("carousel:sidebarClosed"),n.prototype.destroy.apply(this,arguments)}});return h}),define("partner/asset-sponsorship",["jquery","underscore","baseview"],function(t,e,i){"use strict";var s=i.extend({backgroundTemplate:"<%= sponsorshipHtml %>",logoTemplate:'<div class="sponsor" style="display:table-cell;"><div class="sponsor-logo-box"><img src="<%= imageLogo %>" alt="<%= imageLogoAlt %>" class="sponsor-logo-img"><span class="sponsor-logo-byline">Sponsored by <br/><%= imageLogoAlt %></span></div></div>',initialize:function(e){e=t.extend({imageSkinLeft:null,imageSkinRight:null,clickThru:null,imageLogo:null,imageLogoAlt:null},e),i.prototype.initialize.call(this,e)},destroy:function(t){this.$background&&(this.$background.remove(),this.$background=null),this.$logo&&(this.$logo.remove(),this.$logo=null),i.prototype.destroy.call(this,t)},render:function(){this.setupBackground(),this.setupLogo()},setupBackground:function(){"Yes"!==this.options.hasSkin&&this.options.sponsorshipHtml||(this.$background=t(e.template(this.backgroundTemplate,this.options)),this.$el.parent().append(this.$background))},setupLogo:function(){var i=this.$(".content-bar-top .title").eq(0);i.length&&(this.$logo=t(e.template(this.logoTemplate,this.options)),i.after(this.$logo))}});return s}),define("modules/partner/poster-ad-asset",["jquery","underscore","baseview","state","sharedAdPosition","partner/asset-sponsorship"],function(t,e,i,s,n,o){"use strict";var r=i.extend({initialize:function(t){e.bindAll(this,"onAdReady"),window.site_config.ADS&&window.site_config.ADS.GALLERY&&window.site_config.ADS.GALLERY.REFRESH&&(this.pubSub={"carousel:refreshAd":this.refreshAdPosition}),i.prototype.initialize.call(this,t);var s=this.$el.data("sizes");s&&(s=s.split(",")),this.subviews.posterad=new n({el:this.$el,adSizes:s||["mediumrectangle","halfpage","portrait","filmstrip"],adPlacement:"poster",adType:"sponsorship",defaultPosition:!0,onAdReady:this.onAdReady})},refreshAdPosition:function(){this.subviews.posterad.refreshPosition()},onAdReady:function(e,i){this.subviews.posterad.show(),"sponsorship"===i&&(this.subviews.sponsorshipad&&this.subviews.sponsorshipad.destroy(),this.subviews.sponsorshipad=new o(t.extend({el:s.getActiveApp().$(".asset")},e)),this.subviews.sponsorshipad.render())}});return r}),define("modules/ballot/ballot",["jquery","underscore","pubsub","baseview"],function(t,e,i,s){"use strict";var n=s.extend({events:{"click .ballot-submit-answers":"onSubmitBallot","click .ballot-answer":"selectAnswer"},initialize:function(){s.prototype.initialize.call(this),e.bindAll(this,"onSubmitBallot","onCompleteSubmit"),this.$ballotForm=this.$(".ballot-form"),this.hasSubmitted=!1},onSubmitBallot:function(e){return this.answerSelected?(e.preventDefault(),t.ajax({type:"POST",url:this.$ballotForm.attr("action"),data:this.$ballotForm.serializeArray(),timeout:1e3,complete:this.onCompleteSubmit}),this.$el.addClass("ballot-show-results"),this.$(".ballot-ts-results").show(),this.$(".ballot-answer").removeClass("ballot-inactive ballot-selected"),this.hasSubmitted=!0,void i.trigger("uotrack","ballotsubmitted")):void this.setError("Please select an answer before submitting.")},setError:function(t){this.$(".ballot-error").show().text(t)},hideError:function(){this.$(".ballot-error").hide()},onCompleteSubmit:function(){},selectAnswer:function(e){if(this.answerSelected=!0,this.hideError(),!this.hasSubmitted&&!this.$ballotForm.data("disabled")){var s=t(e.currentTarget),n=s.data("key"),o=s.find(".ballot-answer-input");o.prop("checked",!0);var r=s.parents("ul").eq(0),a=r.find("li");a.each(function(e,i){var o=t(i);n!=t(i).data("key")?o.addClass("ballot-inactive").removeClass("ballot-selected"):s.removeClass("ballot-inactive").addClass("ballot-selected")}),i.trigger("uotrack","ballotanswerselected"),this.$(".ballot-submit-answers").removeClass("ballot-disabled")}}});return n}),define("modules/partner/poster-ad-asset2",["jquery","underscore","baseview","state","site-manager","utils","admanager","directAdPosition"],function(t,e,i,s,n,o,r,a){"use strict";var l=i.extend({initialize:function(r){e.bindAll(this,"_overlayScrollListener","_handleResizeWindow","onSecondAdReady","_isInViewport"),r=t.extend({minTimeForAd:5e3,topMargin:30,disableRefresh:o.getNested(window.site_vars,"ads","poster_scroll_refresh_disabled")},r);var a=s.getActiveApp();this.$win=o.get("win"),this.header=n.getHeader(),this.overlayScrollListenerThrottle=e.throttle(this._overlayScrollListener,16,{leading:!1,trailing:!0}),this.$win.on("scroll."+this.cid,this.overlayScrollListenerThrottle).on("resize."+this.cid,this._handleResizeWindow),this._handleResizeWindow(),this._setArticleDimensions(),this.posterAd2Height=0,this.pubSub={"breakingbar:after:open":this._overlayScrollListener,"breakingbar:after:close":this._overlayScrollListener,"gravity:open":this._handleResizeWindow},this.$adEl=this.$(".poster-scroll-ad"),this.$otherAds=a.$(".partner-asset-right-ad,.datasphere-community-module"),i.prototype.initialize.call(this,r)},_overlayScrollListener:function(){return this.moduleOffsetTop=this.$el.offset().top,this._getModuleHeight()<(this.posterAd2Height||250)?void this.hide():(this._goToState(this._getCurrentState()),void this._handleRequestAds())},_getCurrentState:function(){return this._isOtherAdinViewPort()||!this._isInViewport(this.$el,this._getModuleHeight())?"hidden":this._shouldDockBottom()?"dockBottom":this._shouldFixAd()?"fixed":"dockTop"},_goToState:function(t){t!==this.state&&("hidden"===this.state&&this.$adEl.css("opacity","1"),"hidden"===t?this.$adEl.css("opacity","0"):"fixed"===t?this.$adEl.css({position:"fixed",top:this._getHeaderHeight()+this.options.topMargin}):"dockTop"===t?this.$adEl.css({position:"static",top:"auto"}):"dockBottom"===t&&this._dockBottom(),this.state=t)},_shouldFixAd:function(){return this.moduleOffsetTop-this.options.topMargin<this._getViewportOffset()},_getViewportOffset:function(){return o.getScrollPosition()+this._getHeaderHeight()},_shouldDockBottom:function(){var t=this._getModuleOffsetBottom()-this.posterAd2Height-this.options.topMargin;return t<this._getViewportOffset()},_getHeaderHeight:function(){return this.header?this.header.getFixedHeight():0},_isOtherAdinViewPort:function(){return void 0!==e.find(this.$otherAds,function(t){return this._isInViewport(t)},this)},_isInViewport:function(e,i){var s=t(e),n=s.offset().top,o=n+(i||s.outerHeight()),r=this._getViewportOffset(),a=r+this.winHeight-this._getHeaderHeight();return!(r>o||n>a)},_isTimeToRefresh:function(){if(this.lastAdRefreshedTime){var t=(new Date).getTime();return t-this.lastAdRefreshedTime>=this.options.minTimeForAd}return!0},_getModuleHeight:function(){return this.articleOffsetTop+this.articleHeight-this.moduleOffsetTop},_getModuleOffsetBottom:function(){return this.moduleOffsetTop+this._getModuleHeight()},_hasScrolledAViewportHeight:function(){var t=o.getScrollPosition(),e=Math.abs(t-this.scrollTopAdRequestedAt);return e>=this.winHeight},_handleResizeWindow:function(){this.winHeight=this.$win.height(),this._setArticleDimensions()},_handleRequestAds:function(){"dockTop"!==this.state||this.subviews.ad?("fixed"===this.state&&!this.subviews.ad||"fixed"===this.state&&!this.options.disableRefresh&&this._hasScrolledAViewportHeight()&&this._isTimeToRefresh())&&this._requestAd():this._requestAd()},_dockBottom:function(){this.$adEl.css({position:"absolute",top:this.articleHeight-this.posterAd2Height+this.articlePositionTop})},_setArticleDimensions:function(){var t=s.getActiveApp().$("article > div[role=main]");t.length&&(this.articleHeight=t.height(),this.articleOffsetTop=t.offset().top,this.articlePositionTop=t.position().top)},_requestAd:function(){r.getActiveSlotStatistics().done(e.bind(function(t){var i=this.subviews.ad;if(i){if(!i.isAdReady())return;i.refreshPosition()}else{var n=["mediumrectangle"],r=600+this.options.topMargin,l=e.findWhere(t.high_impact_info,{adType:"gravity"});this._getModuleHeight()>=r&&this.winHeight-this._getHeaderHeight()>=r&&(n=n.concat(["halfpage","portrait","filmstrip"])),this.subviews.ad=new a({el:this.$adEl,adSizes:n,adPlacement:"poster_scroll",adType:"poster",onAdReady:this.onSecondAdReady,pageInfo:s.getActivePageInfo(),targeting:l?{creativeid:l.ecid}:{}})}this.scrollTopAdRequestedAt=o.getScrollPosition()},this))},onSecondAdReady:function(){this.subviews.ad.show(),this.posterAd2Height=this.$adEl.outerHeight(),this.lastAdRefreshedTime=(new Date).getTime(),this._overlayScrollListener(),"dockBottom"===this.state&&this._dockBottom()},destroy:function(t){this.$win.off("."+this.cid),i.prototype.destroy.call(this,t)}});return l}),define("modules/ugc/ugc-user",["jquery","underscore","baseview","user-manager","pubsub","managers/cachemanager","state"],function(t,e,i,s,n,o,r){"use strict";var a=i.extend({initialize:function(){this.pubSub={"user:statuschange":this._onUserStatusChange},e.bindAll(this,"_getFilemobileUserInfo"),this._loginPromise=t.Deferred(),this._onUserStatusChange(null,s.getLoginStatus()),i.prototype.initialize.call(this)},_onUserStatusChange:function(e,i){this._loginState=i,"pending"===this._loginPromise.state()||"loggedIn"!==i&&"loggingIn"!==i||(this._loginPromise=t.Deferred()),"loggedIn"===i?(this._loginState="loggingIn",this._loginPromise.resolve(),n._events["ugc:user:statuschange"]&&this.getUserInfo()):(("loggedOut"===i||"loginFailed"===i)&&(this._loginPromise.reject(),this.logoutUser()),n.trigger("ugc:user:statuschange",i))},getUserInfo:function(){var i=this._loginState;return"loggingIn"===i||"loggedIn"===i||"loggedIn"===s.getLoginStatus()?this._loginPromise.then(e.bind(function(){return o.getValue("filemobileuserinfo",this._getFilemobileUserInfo)},this)):t.Deferred().reject()},getUserManagerUserData:function(){var t=s.getAccount();return t&&t.getUserFirstName()?{firstname:t.getUserFirstName(),lastname:t.getUserLastName(),avatar:t.getUserAvatar()}:{}},_getCoreUserInfo:function(){return s.getCoreUserInfo().then(e.bind(function(e){return t.extend({},e,this.getUserManagerUserData())},this),function(){console.warn("failed to get user core info!")})},_getFilemobileUserInfo:function(){return this._getCoreUserInfo().then(function(e){return r.fetchData("/filemobile/getfmsession/",{type:"POST",data:{coreuserid:e.CoreUserId,atyponsessiontoken:e.AtyponSessionKey}}).then(function(i){if("valid"===i.success.status.state){var s=i.success.response;return e.sessiontoken=s.FileMobileSessionToken,e.fmid=s.FileMobileId,e}return console.warn("unable to validate filemobile user!"),t.Deferred().reject()},function(){console.warn("unable to get filemobile user data!")})}).done(e.bind(function(t){this._loginState="loggedIn",n.trigger("ugc:user:statuschange",this._loginState,t)},this)).fail(e.bind(function(){this._loginState="loginFailed",n.trigger("ugc:user:statuschange",this._loginState)},this))},getLoginState:function(){return this._loginState},logoutUser:function(){o.clearValue("filemobileuserinfo")}});return new a}),define("ui/tooltip",["jquery","underscore","baseview"],function(t,e,i){"use strict";var s=i.extend({initialize:function(s){s=t.extend({text:this.$el.data("tooltip-text"),customPanelClass:"",showEvent:"mouseenter",hideEvent:"mouseleave",onShow:null,onHide:null,position:"right"},s),i.prototype.initialize.call(this,s),this._tooltipText=this.options.text,this.$tooltipPanel=this._buildHtml(this.$el),this.$tooltipPanel.addClass("ui-tooltip-panel-"+this.options.position),e.bindAll(this,"show","hide"),this._addTriggerEvent(this.options.showEvent,this.show),this._addTriggerEvent(this.options.hideEvent,this.hide)},_addTriggerEvent:function(t,e){t&&this.$el.on(t+"."+this.cid,e)},_buildHtml:function(e){var i=t('<div class="ui-tooltip">');e.wrap(i);var s=t('<div class="ui-tooltip-panel '+this.options.customPanelClass+'">'+this.options.text+"</div>");return s.insertAfter(e),s},isPanelShowing:function(){return this._isPanelShowing},show:function(){this.$tooltipPanel.css(this._getPositionCss(this.options.position)),this.$tooltipPanel.stop().fadeIn(400),this._isPanelShowing=!0,this.options.onShow&&this.options.onShow()},hide:function(){this.$tooltipPanel.stop().fadeOut(400),this._isPanelShowing=!1,this.options.onHide&&this.options.onHide()
},_getPositionCss:function(t){var e=10,i=this.$tooltipPanel.outerHeight(),s=this.$tooltipPanel.outerWidth(),n=this.$el.outerWidth(),o=this.$el.outerHeight();return"right"===t?{top:-(i/2)+o/2,left:n+e}:"left"===t?{top:-(i/2)+o/2,right:n+e}:"top"===t?{bottom:o+e,left:-(s/2)+n/2}:"bottom"===t?{top:o+e,right:-(s/2)+n/2}:{}},getText:function(){return this._tooltipText},setText:function(t){this.$tooltipPanel.text(t),this._tooltipText=t,this.isPanelShowing()&&this.$tooltipPanel.css(this._getPositionCss(this.options.position))},destroy:function(t){this.$el.off("."+this.cid),this.$el.unwrap(),this.$tooltipPanel.remove(),i.prototype.destroy.call(this,t)}});return s}),define("modules/ugc/report-abuse",["jquery","underscore","baseview","state","modules/ugc/ugc-user","ui/tooltip","user-manager","easing"],function(t,e,i,s,n,o,r){"use strict";var a=i.extend({events:{"click .ugc-media-item-report-abuse-link":"onReportAbuseItemClick"},initialize:function(e){e=t.extend({tooltipOptions:null},e),this.pubSub={"user:statuschange":this.onUserStatusChange},i.prototype.initialize.call(this,e),this.$reportAbuseLinks=this.$(".ugc-media-item-report-abuse-link"),this.reportAbuseSubviewIndex=0,this.subviewPrefix="reportAbuseItem",this.setupReportAbuseItems(this.$reportAbuseLinks)},setupReportAbuseItems:function(t){e.each(t,function(t){this._setupTooltipView(this.getTooltipOptions(t))},this)},getTooltipOptions:function(e){var i=t.extend({el:e,text:this.getReportAbuseText(),position:"left"},this.options.tooltipOptions),s="ugc-media-item-report-abuse",n=s+"-tooltip-panel",o=s+"-tooltip-text";return i.customPanelClass&&(i.customPanelClass=n+" "+i.customPanelClass),i.customTextClass&&(i.customTextClass=o+" "+i.customTextClass),i},_setupTooltipView:function(t){var e=this.subviewPrefix+this.reportAbuseSubviewIndex;this.subviews[e]||(this.subviews[e]=new o(t),this.reportAbuseSubviewIndex++)},getReportAbuseText:function(){return"loggedIn"===n.getLoginState()?this.getLoggedInText():this.getLoggedOutText()},getLoggedOutText:function(){return"Please sign in to report as inappropriate"},getLoggedInText:function(){return"Report as inappropriate"},onReportAbuseItemClick:function(i){var s=t(i.currentTarget),o=this.$reportAbuseLinks.index(s),a=this.subviews[this.subviewPrefix+o],l=s.data(),h="loggedIn"===r.getLoginStatus();!s.hasClass("ugc-media-item-report-abuse-sent")&&h&&n.getUserInfo().done(e.bind(function(t){a.setText("Reporting..."),this.reportAbuse(t.fmid,l.mediaId).done(e.bind(function(){this.onReportAbuseSuccess(a,s)},this)).fail(e.bind(function(){this.onReportAbuseFail(a,s)},this))},this))},onReportAbuseSuccess:function(t,e){e.removeClass("ugc-media-item-report-abuse-failed"),e.addClass("ugc-media-item-report-abuse-sent"),t.setText("Reported")},onReportAbuseFail:function(t,e){e.addClass("ugc-media-item-report-abuse-failed"),t.setText("There was a problem reporting abuse.")},update:function(t){this.setupReportAbuseItems(t)},onUserStatusChange:function(t,e){var i;i="loggedIn"===e?this.getLoggedInText():this.getLoggedOutText(),this.setTextForItems(i)},setTextForItems:function(t){e.each(this.subviews,function(e){e.setText(t)},this)},reportAbuse:function(t,e){var i={method:"POST",data:{fmuserid:t,mediaitemid:e}};return s.fetchData("/yourtake/reportabuse/",i)}});return a}),define("modules/carousel/carousel-fullscreen",["jquery","exports","underscore","backbone","baseview","utils","state","site-manager","modules/carousel/carousel-autosize"],function(t,e,i,s,n,o,r,a,l){var h=l.extend({initialize:function(e){i.bindAll(this,"handleKeyPress","close"),e=t.extend({scrollerColor:"dark"},e),this.$body=o.get("body"),this.$doc=o.get("document"),this.carousel=e.carousel,this.parent=e.parent,r.registerFullScreenView(this),a.getHeader().setClosedFixed(!0),a.scrollTop(0),this.$doc.on("keydown."+this.cid,this.handleKeyPress),this.$body.on("click."+this.cid,".close",this.close),this.launch(),l.prototype.initialize.call(this,e)},close:function(e){e&&e.preventDefault(),a.getHeader().restoreLastState(),this.animate(this.$el.parent(),"opacity",0,300,"ease-in-out").done(i.bind(function(){this.destroy(!0),r.clearFullScreenView().done(i.bind(function(){if(this.carousel){var e=t(".thumbs li",this.parent);e.eq(this.index).click()}},this))},this))},destroy:function(t){this.$doc.off("."+this.cid),this.$body.off("."+this.cid),t&&this.$el.parent().remove(),l.prototype.destroy.call(this,!1)},launch:function(){var e=t('<article class="gallery fullscreen" style="opacity: 0"><a class="close" href="#"></a><div class="ui-film fullscreen"></div></article>'),i=this.parent.clone();i.find(".viewport").removeClass("hover");var s=i.find(".partner-placement");if(s.length){var n=s.attr("id")+"_fs";s.attr("id",n).attr("data-slot-id",n)}e.append(i),this.$body.append(e),this.animate(e,"opacity",1,300,"ease-in-out"),this.setElement(i)},handleKeyPress:function(t){return 37===t.keyCode?(this.prevSlide(),!1):39===t.keyCode?(this.nextSlide(),!1):27===t.keyCode?(this.close(),!1):void 0}});return h}),define("modules/global/livevideo",["jquery","underscore","backbone","pubsub","state","utils","modules/global/brightcove-video"],function(t,e,i,s,n,o,r){var a=i.View.extend({events:{"click #close_modal_link":"close"},initialize:function(e){this.m_uiModal={},this.m_uiModalBgrnd={},this.win=o.get("win")[0],this.body=o.get("body"),this.service=e&&e.service?e.service:"/services/livevideos/",n.registerFullScreenView(this),this.win.gannett={};var i=this;this.win.gannett.videoplayer_modal={openPopup:function(){var e="/livevideos/popout/",s=t("#videoplayer_modal .video-title").text(),n=t("#videoplayer_modal .sponsor-text").text(),r=t("#videoplayer_modal .video-logo").attr("src"),a=t("#videoplayer_modal").attr("data-assetid");e+="?videoid="+a+"&description="+s+"&sponsor="+n+"&sourcelogo="+r,a&&(o.openPopup(e,640,440),i.close())}}},loadLiveVideo:function(e){var i=this;n.fetchHtml(this.service+e).done(function(e){i.body.append(e),i.video=new r({el:t("#videoplayer_modal"),autostart:!0,live:!0}),i.m_uiModal=t("#videoplayer_modal"),i.m_uiModalBgrnd=t("#lightbox"),i.m_uiModal.show(),i.m_uiModalBgrnd.fadeIn(300),i.setElement("#videoplayer_modal")})},close:function(){if(this.m_uiModal){n.clearFullScreenView();var t=this.m_uiModalBgrnd;this.destroy(!0),this.m_uiModalBgrnd.fadeOut(300,function(){t.remove()}),this.m_uiModal=null,this.m_uiModalBgrnd=null,this.win.gannett={}}},destroy:function(t){this.video&&this.video.destroy(!0),this.undelegateEvents(),t&&this.remove()}});return a}),define("modules/global/breaking-news",["jquery","underscore","baseview","pubsub","utils","state","modules/global/barrier","modules/global/livevideo","easing","animatecolors"],function(t,e,i,s,n,o,r,a){"use strict";var l=i.extend({events:{"click #breaking a":"onClickBreakingBtn","click #breaking .close-btn":"onClickCloseBreakingBtn"},breakingColors:{breaking:{normal:"rgb(247,0,0)",highlight:"rgb(191,49,49)"},live:{normal:"rgb(0,170,255)",highlight:"rgb(0,145,218)"},developing:{normal:"rgb(0,170,255)",highlight:"rgb(0,145,218)"}},breakingBarHeight:0,initialize:function(s){s=t.extend({slideSpeed:200,onBreakingNewsChange:null},s),e.bindAll(this,"updateBreakingBar","checkBreakingNewsBarrier"),this.lastUpdate=localStorage.getItem("breakingLastUpdateClosed"),this.initBreakingBar=setTimeout(this.updateBreakingBar,1e3),this.breakingBarPoll=setInterval(this.updateBreakingBar,91e3),this.barrier=new r,i.prototype.initialize.call(this,s)},destroy:function(){clearTimeout(this.initBreakingBar),clearInterval(this.breakingBarPoll),i.prototype.destroy.apply(this,arguments)},getHeight:function(){return this.breakingBarHeight},onClickCloseBreakingBtn:function(){this.closeBreakingBar(!0),s.trigger("uotrack","breakingnewsbarexit")},onClickBreakingBtn:function(e){var i=t(e.currentTarget).attr("href");if(i.indexOf("livevideoassetid")>0){var s=new a;s.loadLiveVideo(i.split("#")[1].split("=")[1]),e.preventDefault()}},closeBreakingBar:function(t){return this.breakingBarHeight?(t&&localStorage.setItem("breakingLastUpdateClosed",this.lastUpdate),this.breakingBarHeight=0,this.options.onBreakingNewsChange&&this.options.onBreakingNewsChange(!1),this.animate(this.$el,"height",0,this.options.slideSpeed).done(e.bind(function(){this.$el.css("background-color",""),this.$el.hide(),s.trigger("breakingbar:after:close")},this))):!1},openBreakingBar:function(){this.$el.show();var t=this.$("#breaking").outerHeight();t!=this.breakingBarHeight&&(this.breakingBarHeight=t,this.options.onBreakingNewsChange&&this.options.onBreakingNewsChange(!0),this.animate(this.$el,"height",this.breakingBarHeight,this.options.slideSpeed).done(this.onCompleteOpenBreakingBar))},onCompleteOpenBreakingBar:function(){s.trigger("breakingbar:after:open")},updateBreakingBar:function(){this.busyCheckingBreakingNews||(this.busyCheckingBreakingNews=!0,o.fetchHtml("/services/breaking-news/nav-bar/").done(this.checkBreakingNewsBarrier))},addToBarrier:function(t,e,i){this.barrier.add(t,e,i)},checkBreakingNewsBarrier:function(t){var i=t.find("#breaking");return i.length?void this.barrier.wait().done(e.bind(function(){this.parseBreakingNews(i)},this)):void(this.busyCheckingBreakingNews=!1)},parseBreakingNews:function(t){try{var e=t.data("type"),i=t.data("lastUpdate");if(this.lastUpdate!=i){this.$el.html(t).stop(),this.lastUpdate=i;var s=this.breakingBarHeight>0;if(this.openBreakingBar(),s){var n=this.breakingColors[e].highlight,o=this.breakingColors[e].normal;this.$("#breaking").animate({backgroundColor:n}).animate({backgroundColor:o})}}}catch(r){this.closeBreakingBar()}finally{this.busyCheckingBreakingNews=!1}}});return l}),define("modules/header/site-nav-dropdown",["jquery","underscore","backbone","baseview","state","easing"],function(t,e,i,s){"use strict";var n=s.extend({events:{mouseenter:"onMouseEnter",mouseleave:"onMouseLeave","click .site-nav-dropdown":"closeDropdown"},initialize:function(t){e.bindAll(this,"openDropdown","closeDropdown"),this.fadeSpeed=80,this.showDelay=120,this.$dropdown=this.$(".site-nav-dropdown"),s.prototype.initialize.call(this,t)},onMouseEnter:function(t){clearTimeout(this.hideTimer),this.isMouseOnDropdown=!0,this.openDropdown(t)},onMouseLeave:function(t){this.isMouseOnDropdown=!1,this.hideTimer=setTimeout(e.partial(this.closeDropdown,t),this.hideDelay)},closeDropdown:function(t){!this.isDropdownOpen||"mouseout"==t.type&&this.isMouseOnDropdown||(this.isDropdownOpen=!1,this.animate(this.$dropdown,"opacity",0,this.fadeSpeed).done(e.bind(function(){this.$dropdown.css("display","none")},this)),this.$el.removeClass("site-nav-active-item"))},openDropdown:function(t){this.isDropdownOpen||"mouseover"==t.type&&!this.isMouseOnDropdown||(this.isDropdownOpen=!0,this.$el.addClass("site-nav-active-item"),this.$dropdown.css("display","block"),this.animate(this.$dropdown,"opacity",1,this.fadeSpeed))}});return n}),define("modules/header/site-nav-more-module",["underscore","modules/header/site-nav-dropdown"],function(t,e){"use strict";var i=e.extend({initialize:function(t){this.$navDropdown=this.$(".site-nav-dropdown"),this.$navDropdownList=this.$(".site-nav-more-dropdown-list"),this.$navDropdownItems=this.$(".site-nav-more-dropdown-item"),e.prototype.initialize.call(this,t)},convertColumnLayout:function(t){var e="1col"==t?"2col":"1col";this.$navDropdown.removeClass("site-nav-more-dropdown-"+e).addClass("site-nav-more-dropdown-"+t),this.$navDropdownList.removeClass("site-nav-more-dropdown-list-"+e).addClass("site-nav-more-dropdown-list-"+t),this.$navDropdownItems.removeClass("site-nav-more-dropdown-item-"+e).addClass("site-nav-more-dropdown-item-"+t)}});return i}),define("modules/global/header",["jquery","underscore","baseview","pubsub","utils","state","managers/routemanager","modules/global/breaking-news","directAdPosition","modules/header/site-nav-more-module","easing","animatecolors"],function(t,e,i,s,n,o,r,a,l,h){"use strict";var c=i.extend({el:".site-header",events:{"click .site-nav-search-link":"onClickNavSearchIcon","click .site-masthead-search-close-btn":"onClickSearchCloseBtn","click .site-masthead-search-btn-div":"onClickSearchBtnDiv"},navHeaderHeight:40,mastheadHeight:80,fixedHeaderThreshold:80,hoverDropdownDelay:120,TWO_COL_THRESHOLD:5,SITE_NAV_HIDDEN_CLASS:"site-nav-item-hidden",SITE_NAV_MORE_VISIBLE_CLASS:"site-nav-more-dropdown-item-visible",initialize:function(){this.isMulti=!!this.$el.attr("data-multi-header"),this.isThirdParty=!!this.$el.attr("data-third-party"),this.$win=n.get("win"),this.$top=n.get("scrollEl"),this.$siteHeaderInnerWrap=this.$(".site-header-inner-wrap"),this.$siteMasthead=this.$(".site-masthead"),this.$searchWrap=this.$(".site-masthead-search-wrap"),this.$navLogo=this.$(".site-nav-logo-item"),this.$navLogoLink=this.$(".site-nav-logo-link"),this.$navMoreItem=this.$(".site-nav-more-item"),this.$navLogoImg=this.$navLogo.find(".site-nav-logo-img"),this.$searchCancelBtn=this.$(".site-masthead-search-close-btn"),this.navLogoImgWidth=this.$navLogoImg.outerWidth(!0),this.$specialOffersMastheadAd=this.$(".site-masthead-special-offers-ad"),this.$subscribeWrap=this.$(".site-masthead-subscribe-wrap"),this.$siteMoreDropdownItems=this.$(".site-nav-more-dropdown-item:not(.site-nav-more-dropdown-item-hidden)"),this.$searchInput=this.$$(".site-masthead-search-form-input"),this.navHeight=this.$siteHeaderInnerWrap.outerHeight(),this.minHeight=this.$el.outerHeight(),e.bindAll(this,"onBreakingNewsChange","onFixingScroll","onClosingScroll","_handleOnAdReady","_onResizeWindow"),this.slideSpeed=200,n.set("headerHeight",this.navHeight),this.slideEasing="ease-out";var t=this.$el.data("open"),s=this.$el.data("fixed"),o=this.$el.data("default-open")||!1,r=this.$el.data("default-fixed")||!1;void 0===t&&(t=o),void 0===s&&(s=r),this.state={open:t,defaultOpen:o,fixed:s,defaultFixed:r,hasFixingScroller:!1,hasClosingScroller:!1},this.pubSub={"user:statuschange":this._loginStatus,"page:load":this._onResizeWindow,"header:open":this.navAutoFitItems,"header:closed":this.navAutoFitItems},i.prototype.initialize.apply(this,arguments),this.start(),s||(this._setState({hasFixingScroller:!0}),n.getScrollPosition()&&this.onFixingScroll())},start:function(){this.loadHeaderModules(),this.subviews.breakingbar=new a({el:this.$("#breaking-bar"),slideSpeed:this.slideSpeed,onBreakingNewsChange:this.onBreakingNewsChange}),this._buildSpecialOffersMastheadAd(),this.moreLayout="1col",this.isThirdParty||(this.subviews.moreModule=new h({el:this.$navMoreItem[0]}));var t=e.throttle(this._onResizeWindow,500);this.$win.on("resize."+this.cid,t),this.navAutoFitStart()},navAutoFitStart:function(){this.$siteNavDynamicPrimaryItems=this.$(".site-nav-primary-item:not(.site-nav-more-item,.site-nav-logo-item,.site-nav-always-visible-item,.site-nav-spacer-item)"),this.$siteNavAlwaysVisibleItems=this.$(".site-nav-always-visible-item,.site-nav-secondary-item"),this.siteNavDynamicItemsWidths=this.getNavGroupWidths(this.$siteNavDynamicPrimaryItems),this.siteNavAlwaysVisibleItemsWidths=this.getNavGroupWidths(this.$siteNavAlwaysVisibleItems),this.siteNavMoreItemWidth=this.$navMoreItem.outerWidth(),this.siteNavAlwaysVisibleItemsTotalWidth=e.reduce(this.siteNavAlwaysVisibleItemsWidths,function(t,e){return t+e},0),this.siteNavLogoWidth=this.navLogoImgWidth-10,this.isThirdParty||(this.hiddenPrimaryItemsCount=0),this._updateMastheadWidth(),this.navRevealed||(this.isThirdParty||0!==this.hiddenPrimaryItemsCount||this.$navMoreItem.addClass(this.SITE_NAV_HIDDEN_CLASS),this.$(".site-nav-item").addClass("site-nav-item-visible"),this.navRevealed=!0)},navAutoFitItems:function(){var t=this.state.open?0:this.siteNavLogoWidth,e=this.isThirdParty?0:this.siteNavMoreItemWidth,i=this.siteNavAlwaysVisibleItemsTotalWidth+t,s=this.siteNavDynamicItemsWidths.length;this.firstHiddenNavItemIndex||(this.firstHiddenNavItemIndex=s);for(var n=0;n<this.siteNavDynamicItemsWidths.length;n++){var o=this.siteNavDynamicItemsWidths[n];if(i+o>this.mastheadWidth){if(i+e<=this.mastheadWidth){s=n;break}for(var r=n-1;r>=0;r--){var a=this.siteNavDynamicItemsWidths[r];if(i+e-a<=this.mastheadWidth){s=r;break}i-=a}break}i+=o}if(s!==this.firstHiddenNavItemIndex){var l=s<this.firstHiddenNavItemIndex,h=l?s:this.firstHiddenNavItemIndex,c=l?this.firstHiddenNavItemIndex:s;this.togglePrimaryNavItems(s,h,c),this.toggleMoreNavItems(s,h,c),this.firstHiddenNavItemIndex=s}},togglePrimaryNavItems:function(t,e,i){this.$siteNavDynamicPrimaryItems.slice(e,i).toggleClass(this.SITE_NAV_HIDDEN_CLASS)},toggleMoreNavItems:function(t,e,i){if(!this.isThirdParty){var s=t<this.firstHiddenNavItemIndex,n=this.siteNavDynamicItemsWidths.length-t,o=this.willMoreDropdownAppear(n)||this.willMoreDropdownHide(n);if(this.$siteMoreDropdownItems.slice(e,i).toggleClass(this.SITE_NAV_MORE_VISIBLE_CLASS),o){var r=0===n;this.$navMoreItem.toggleClass(this.SITE_NAV_HIDDEN_CLASS,r),this.allPrimaryNavItemsShown=!s}this.hiddenPrimaryItemsCount=n,this._updateMoreColumnLayout()}},willMoreDropdownAppear:function(t){return 0===t&&this.hiddenPrimaryItemsCount>0},willMoreDropdownHide:function(t){return 0===this.hiddenPrimaryItemsCount&&t>0},getNavGroupWidths:function(i){return e.map(i,function(e){return t(e).outerWidth()})},_updateMastheadWidth:function(){var t=this.$siteMasthead.outerWidth();if(t!==this.mastheadWidth){var e=t>this.mastheadWidth?"wider":"narrower";this.mastheadWidth=t,"wider"===e&&this.allPrimaryNavItemsShown||this.navAutoFitItems()}},_updateMoreColumnLayout:function(){this.isThirdParty||(this.hiddenPrimaryItemsCount>this.TWO_COL_THRESHOLD&&"2col"!=this.moreLayout?(this.subviews.moreModule.convertColumnLayout("2col"),this.moreLayout="2col"):"1col"!=this.moreLayout&&(this.subviews.moreModule.convertColumnLayout("1col"),this.moreLayout="1col"))},_onResizeWindow:function(){this._updateMastheadWidth()},_buildSpecialOffersMastheadAd:function(){!this.subviews.specialOffersMastheadAd&&this.$specialOffersMastheadAd.length&&(this.subviews.specialOffersMastheadAd=new l({el:this.$specialOffersMastheadAd,adSizes:[122,50],adPlacement:"consumer_sales-masthead",onAdReady:this._handleOnAdReady}))},_handleOnAdReady:function(){this.$subscribeWrap.remove(),this.$specialOffersMastheadAd.addClass("site-masthead-subscribe-wrap-visible"),this.subviews.specialOffersMastheadAd.showAd()},destroy:function(){this._unregisterFixingScroller(),this.$win.off("."+this.cid),clearTimeout(this.headerTransparencyTimeout),i.prototype.destroy.call(this)},_loginStatus:function(t,e,i){"firefly"===t&&("loggedIn"===e&&i&&i.hasMarketAccess?this.$subscribeWrap.removeClass("site-masthead-subscribe-wrap-visible"):"loggingIn"!==e&&this.$subscribeWrap.addClass("site-masthead-subscribe-wrap-visible"))},isFixedAndClosed:function(t){return!(t.open||!t.fixed||t.hasFixingScroller||t.hasClosingScroller)},_setState:function(t){var i,n="";e.each(t,function(e,s){this.state[s]!==e&&("fixed"===s?e?(this.$siteHeaderInnerWrap.addClass("site-header-inner-wrap-fixed"),n+=" header:fixed"):(this.$siteHeaderInnerWrap.removeClass("site-header-inner-wrap-fixed"),n+=" header:unfixed"):"open"===s?(i=this.state.fixed===!0&&(void 0===t.fixed||t.fixed===!0)||void 0!==t.hasFixingScroller&&this.state.hasFixingScroller!==t.hasFixingScroller,this._setMasthead(e,i),n+=e?" header:open":" header:closed"):"hasFixingScroller"===s?e?this._registerFixingScroller():this._unregisterFixingScroller():"hasClosingScroller"===s?e?this._registerClosingScroller():this._unregisterClosingScroller():console.warn("Unknown state key: "+s))},this),this._checkTransition(this.state,t),e.extend(this.state,t),n&&s.trigger(n)},_checkTransition:function(e,i){i=t.extend({},e,i);var s=this.isFixedAndClosed(e),n=this.isFixedAndClosed(i),o=e.open!==i.open;s!==n&&(n?this._transitionToCloseFixed(o):this._transitionFromCloseFixed(o))},_transitionToCloseFixed:function(t){this.navHeight=this.navHeaderHeight,this.updateHeaderMinHeight(t)},_transitionFromCloseFixed:function(t){this.navHeight=this.navHeaderHeight+this.mastheadHeight,this.updateHeaderMinHeight(t)},_registerFixingScroller:function(){this.isMulti||(this.hasFixingScroller?console.warn("Attempting to register headerFixingScroller twice"):(this.hasFixingScroller=!0,this.$win.on("scroll.headerFixingScroller",e.throttle(this.onFixingScroll,20))))},_unregisterFixingScroller:function(){this.hasFixingScroller=!1,this.$win.off(".headerFixingScroller")},onFixingScroll:function(){var t=n.getScrollPosition()>=this.mastheadHeight;t!==this.state.fixed&&this._setState(t?{open:!1,fixed:!0}:{open:!0,fixed:!1})},_registerClosingScroller:function(){this.isApple||this.isMulti||(this.hasClosingScroller?console.warn("Attempting to register headerFixingScroller twice"):(this.hasClosingScroller=!0,this.$win.on("scroll.headerClosingScroller",e.throttle(this.onClosingScroll,20))))},_unregisterClosingScroller:function(){this.hasClosingScroller=!1,this.$win.off(".headerClosingScroller")},onClosingScroll:function(){this._setState({open:!1,fixed:!0,hasClosingScroller:!1}),this.transparencySetup&&!this.headerIsTransparent&&this.toggleTransparency(!0)},loadHeaderModules:function(){this.$(".headermodules").each(e.bind(function(e,i){try{var s=JSON.parse(t(i).html()).js_modules||[];this.buildModules(s)}catch(n){console.error("Failure loading header modules",n)}},this))},onClickNavSearchIcon:function(t){t.preventDefault(),this.$searchInput.focus(),this.state.open||(this._setState({open:!0,fixed:!0,hasClosingScroller:!0}),this.$searchCancelBtn.addClass("site-masthead-search-close-btn-visible"),this.transparencySetup&&this.headerIsTransparent&&this.toggleTransparency(!1))},scrollTop:function(t,e){if(!e)if(this.state.open){var i=n.getScrollPosition();if(t<this.fixedHeaderThreshold&&i<this.fixedHeaderThreshold)return i}else this.state.hasFixingScroller&&t<this.fixedHeaderThreshold&&(t=this.fixedHeaderThreshold);return this.$top.scrollTop(t),t},isFixed:function(){return this.state.fixed},setOpenFixed:function(e){e&&(this.lastState=t.extend({},this.state)),this._setState({open:!0,fixed:!0,hasFixingScroller:!1,hasClosingScroller:!1})},getFixedHeight:function(){return this.isFixedAndClosed(this.state)?this.minHeight:this.minHeight-this.mastheadHeight},setFixingScroller:function(t){this._setState(t?{hasFixingScroller:!0,hasClosingScroller:!1}:{hasFixingScroller:!1,hasClosingScroller:!1})},setClosedFixed:function(e){e&&(this.lastState=t.extend({},this.state)),this._setState({open:!1,fixed:!0,hasFixingScroller:!1,hasClosingScroller:!1})},restoreLastState:function(){this.lastState&&(this._setState(this.lastState),this.lastState=null)},restoreDefaultState:function(){this._setState({open:this.state.defaultOpen,fixed:this.state.defaultFixed,hasFixingScroller:!this.state.defaultFixed,hasClosingScroller:!1})},onClickSearchBtnDiv:function(e){t(e.currentTarget).parents("form").trigger("submit")},onClickSearchCloseBtn:function(){o.getActiveApp().isSearchPage?r.goTo("/"):(this._setState({open:!1,fixed:!0,hasClosingScroller:!1}),this.transparencySetup&&!this.headerIsTransparent&&this.toggleTransparency(!0))},_collapseMasthead:function(t){t?this.animate(this.$searchWrap,"height",0,this.slideSpeed,this.slideEasing).always(e.bind(function(){this.$searchCancelBtn.length&&this.$searchCancelBtn.removeClass("site-masthead-search-close-btn-visible")},this)):this.$searchWrap.css("height",0),this.toggleNavLogo(!0,!0)},_expandMasthead:function(t){t?this.animate(this.$searchWrap,"height",this.mastheadHeight+"px",this.slideSpeed,this.slideEasing).done(e.bind(function(){this.$searchInput.focus()},this)):this.$searchWrap.css("height",this.mastheadHeight),this.toggleNavLogo(!0,!1)},_setMasthead:function(t,e){t?this._expandMasthead(e):this._collapseMasthead(e)},getExpandedHeight:function(){return this.minHeight},getScrollOffset:function(){return this.isFixed()?this.minHeight!=this.navHeaderHeight?this.minHeight-this.navHeaderHeight:this.minHeight:0},getFixedThreshold:function(){return this.fixedHeaderThreshold},getCollapsedHeight:function(){return this.navHeaderHeight},getCurrentHeight:function(){return this.navHeight},toggleNavLogo:function(t,e){var i=e?1:0,s=e?this.navLogoImgWidth:0;this.$navLogoImg.css("opacity",i),this.$navLogoLink.css("width",s)},updateHeaderMinHeight:function(t){this.minHeight=this.navHeight+(this.subviews.breakingbar?this.subviews.breakingbar.getHeight():0),t?this.animate(this.$el,"min-height",this.minHeight,this.slideSpeed):this.$el.css("min-height",this.minHeight)},onBreakingNewsChange:function(t){this.updateHeaderMinHeight(),t?s.trigger("breakingbar:before:open",this.minHeight,this.options.slideSpeed):s.trigger("breakingbar:before:close",this.minHeight,this.options.slideSpeed)},updateNavigation:function(t){var e,i,n,o="site-nav-active-span",r="site-nav-active-item";for(this.$("."+o).removeClass(o),this.$("."+r).removeClass(r),t=t||"home",n=t.indexOf("?"),-1!==n&&(t=t.substring(0,n)),"/"===t[0]&&(t=t.substring(1)),"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t=t.replace(/[^_a-zA-Z0-9\-/]/g,""),e=t?t.split("/"):["home"];e.length&&(i=this.$(".site-nav-"+e.join("-")+"-item"),!i.length);)e=e.splice(0,e.length-1);var a=e.join("-");s.trigger("update:navigation",a),i&&i.length&&(this.$(".site-nav-"+a+"-span").addClass(o),i.addClass(r))},setupTransparency:function(){this.siteHeaderInnerWrapBg=this.$siteHeaderInnerWrap.css("background"),this.$siteHeaderInnerWrap.addClass("transparent-transition").css("background",""),this.transparencySetup=!0},destroyTransparency:function(){this.$siteHeaderInnerWrap.removeClass("transparent-transition"),this.$el.removeClass("transparent-header"),this.transparencySetup=!1,this.headerTransparencyTimeout=e.delay(e.bind(function(){this.$siteHeaderInnerWrap.css("background",this.siteHeaderInnerWrapBg)},this),350)},toggleTransparency:function(t){this.transparencySetup||this.setupTransparency(),t?(this.$el.addClass("transparent-header"),this.headerIsTransparent=!0):(this.$el.removeClass("transparent-header"),this.headerIsTransparent=!1)}});return c}),function(t,e){function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function s(t){return"undefined"==typeof t}var n={},o=t.TraceKit,r=[].slice,a="?";n.noConflict=function(){return t.TraceKit=o,n},n.wrap=function(t){function e(){try{return t.apply(this,arguments)}catch(e){throw n.report(e),e}}return e},n.report=function(){function e(t){l.push(t)}function s(t){for(var e=l.length-1;e>=0;--e)l[e]===t&&l.splice(e,1)}function o(t,e){var s=null;if(!e||n.collectWindowErrors){for(var o in l)if(i(l,o))try{l[o].apply(null,[t].concat(r.call(arguments,2)))}catch(a){s=a}if(s)throw s}}function a(e){var i=r.call(arguments,1);if(c){if(h===e)return;var s=c;c=null,h=null,o.apply(null,[s,null].concat(i))}var a=n.computeStackTrace(e);throw c=a,h=e,t.setTimeout(function(){h===e&&(c=null,h=null,o.apply(null,[a,null].concat(i)))},a.incomplete?2e3:0),e}var l=[],h=null,c=null,d=t.onerror;return t.onerror=function(t,e,i){var s=null;if(c)n.computeStackTrace.augmentStackTraceWithInitialElement(c,e,i,t),s=c,c=null,h=null;else{var r={url:e,line:i};r.func=n.computeStackTrace.guessFunctionName(r.url,r.line),r.context=n.computeStackTrace.gatherContext(r.url,r.line),s={mode:"onerror",message:t,url:document.location.href,stack:[r],useragent:navigator.userAgent}}return o(s,"from window.onerror"),d?d.apply(this,arguments):!1},a.subscribe=e,a.unsubscribe=s,a}(),n.computeStackTrace=function(){function e(e){function i(){try{return new t.XMLHttpRequest}catch(e){return new t.ActiveXObject("Microsoft.XMLHTTP")}}if(!n.remoteFetching)return"";try{var s=i();return s.open("GET",e,!1),s.send(""),s.responseText}catch(o){return""}}function o(t){if(!i(x,t)){var s="";-1!==t.indexOf(document.domain)&&(s=e(t)),x[t]=s?s.split("\n"):[]}return x[t]}function r(t,e){var i,n=/function ([^(]*)\(([^)]*)\)/,r=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,l="",h=10,c=o(t);if(!c.length)return a;for(var d=0;h>d;++d)if(l=c[e-d]+l,!s(l)){if(i=r.exec(l))return i[1];if(i=n.exec(l))return i[1]}return a}function l(t,e){var i=o(t);if(!i.length)return null;var r=[],a=Math.floor(n.linesOfContext/2),l=a+n.linesOfContext%2,h=Math.max(0,e-a-1),c=Math.min(i.length,e+l-1);e-=1;for(var d=h;c>d;++d)s(i[d])||r.push(i[d]);return r.length>0?r:null}function h(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,"\\$&")}function c(t){return h(t).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function d(t,e){for(var i,s,n=0,r=e.length;r>n;++n)if((i=o(e[n])).length&&(i=i.join("\n"),s=t.exec(i)))return{url:e[n],line:i.substring(0,s.index).split("\n").length,column:s.index-i.lastIndexOf("\n",s.index)-1};return null}function u(t,e,i){var s,n=o(e),r=new RegExp("\\b"+h(t)+"\\b");return i-=1,n&&n.length>i&&(s=r.exec(n[i]))?s.index:null}function p(e){for(var i,s,n,o,r=[t.location.href],a=document.getElementsByTagName("script"),l=""+e,u=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]*)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,p=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,f=0;f<a.length;++f){var g=a[f];g.src&&r.push(g.src)}if(n=u.exec(l)){var m=n[1]?"\\s+"+n[1]:"",v=n[2].split(",").join("\\s*,\\s*");i=h(n[3]).replace(/;$/,";?"),s=new RegExp("function"+m+"\\s*\\(\\s*"+v+"\\s*\\)\\s*{\\s*"+i+"\\s*}")}else s=new RegExp(h(l).replace(/\s+/g,"\\s+"));if(o=d(s,r))return o;if(n=p.exec(l)){var y=n[1];if(i=c(n[2]),s=new RegExp("on"+y+"=[\\'\"]\\s*"+i+"\\s*[\\'\"]","i"),o=d(s,r[0]))return o;if(s=new RegExp(i),o=d(s,r))return o}return null}function f(t){if(!t.stack)return null;for(var e,i,s=/^\s*at (?:((?:\[object object\])?\S+) )?\(?((?:file|http|https):.*?):(\d+)(?::(\d+))?\)?\s*$/i,n=/^\s*(\S*)(?:\((.*?)\))?@((?:file|http|https).*?):(\d+)(?::(\d+))?\s*$/i,o=t.stack.split("\n"),h=[],c=/^(.*) is undefined$/.exec(t.message),d=0,p=o.length;p>d;++d){if(e=n.exec(o[d]))i={url:e[3],func:e[1]||a,args:e[2]?e[2].split(","):"",line:+e[4],column:e[5]?+e[5]:null};else{if(!(e=s.exec(o[d])))continue;i={url:e[2],func:e[1]||a,line:+e[3],column:e[4]?+e[4]:null}}!i.func&&i.line&&(i.func=r(i.url,i.line)),i.line&&(i.context=l(i.url,i.line)),h.push(i)}return h[0]&&h[0].line&&!h[0].column&&c&&(h[0].column=u(c[1],h[0].url,h[0].line)),h.length?{mode:"stack",name:t.name,message:t.message,url:document.location.href,stack:h,useragent:navigator.userAgent}:null}function g(t){for(var e,i=t.stacktrace,s=/ line (\d+), column (\d+) in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\) in (.*):\s*$/i,n=i.split("\n"),o=[],a=0,h=n.length;h>a;a+=2)if(e=s.exec(n[a])){var c={line:+e[1],column:+e[2],func:e[3]||e[4],args:e[5]?e[5].split(","):[],url:e[6]};if(!c.func&&c.line&&(c.func=r(c.url,c.line)),c.line)try{c.context=l(c.url,c.line)}catch(d){}c.context||(c.context=[n[a+1]]),o.push(c)}return o.length?{mode:"stacktrace",name:t.name,message:t.message,url:document.location.href,stack:o,useragent:navigator.userAgent}:null}function m(e){var s=e.message.split("\n");if(s.length<4)return null;var n,a,h,u,p=/^\s*Line (\d+) of linked script ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,f=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,g=/^\s*Line (\d+) of function script\s*$/i,m=[],v=document.getElementsByTagName("script"),y=[];for(a in v)i(v,a)&&!v[a].src&&y.push(v[a]);for(a=2,h=s.length;h>a;a+=2){var b=null;if(n=p.exec(s[a]))b={url:n[2],func:n[3],line:+n[1]};else if(n=f.exec(s[a])){b={url:n[3],func:n[4]};var w=+n[1],_=y[n[2]-1];if(_&&(u=o(b.url))){u=u.join("\n");var x=u.indexOf(_.innerText);x>=0&&(b.line=w+u.substring(0,x).split("\n").length)}}else if(n=g.exec(s[a])){var k=t.location.href.replace(/#.*$/,""),C=n[1],S=new RegExp(c(s[a+1]));u=d(S,[k]),b={url:k,line:u?u.line:C,func:""}}if(b){b.func||(b.func=r(b.url,b.line));var T=l(b.url,b.line),$=T?T[Math.floor(T.length/2)]:null;b.context=T&&$.replace(/^\s*/,"")===s[a+1].replace(/^\s*/,"")?T:[s[a+1]],m.push(b)}}return m.length?{mode:"multiline",name:e.name,message:s[0],url:document.location.href,stack:m,useragent:navigator.userAgent}:null}function v(t,e,i,s){var n={url:e,line:i};if(n.url&&n.line){t.incomplete=!1,n.func||(n.func=r(n.url,n.line)),n.context||(n.context=l(n.url,n.line));
var o=/ '([^']+)' /.exec(s);if(o&&(n.column=u(o[1],n.url,n.line)),t.stack.length>0&&t.stack[0].url===n.url){if(t.stack[0].line===n.line)return!1;if(!t.stack[0].line&&t.stack[0].func===n.func)return t.stack[0].line=n.line,t.stack[0].context=n.context,!1}return t.stack.unshift(n),t.partial=!0,!0}return t.incomplete=!0,!1}function y(t,e){for(var i,s,o,l=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,h=[],c={},d=!1,f=y.caller;f&&!d;f=f.caller)if(f!==b&&f!==n.report){if(s={url:null,func:a,line:null,column:null},f.name?s.func=f.name:(i=l.exec(f.toString()))&&(s.func=i[1]),o=p(f)){s.url=o.url,s.line=o.line,s.func===a&&(s.func=r(s.url,s.line));var g=/ '([^']+)' /.exec(t.message||t.description);g&&(s.column=u(g[1],o.url,o.line))}c[""+f]?d=!0:c[""+f]=!0,h.push(s)}e&&h.splice(0,e);var m={mode:"callers",name:t.name,message:t.message,url:document.location.href,stack:h,useragent:navigator.userAgent};return v(m,t.sourceURL||t.fileName,t.line||t.lineNumber,t.message||t.description),m}function b(t,e){var i=null;e=null==e?0:+e;try{if(i=g(t))return i}catch(s){if(_)throw s}try{if(i=f(t))return i}catch(s){if(_)throw s}try{if(i=m(t))return i}catch(s){if(_)throw s}try{if(i=y(t,e+1))return i}catch(s){if(_)throw s}return{mode:"failed"}}function w(t){t=(null==t?0:+t)+1;try{throw new Error}catch(e){return b(e,t+1)}return null}var _=!1,x={};return b.augmentStackTraceWithInitialElement=v,b.guessFunctionName=r,b.gatherContext=l,b.ofCaller=w,b}(),function(){var e=function(e){var i=t[e];t[e]=function(){var t=r.call(arguments),e=t[0];return"function"==typeof e&&(t[0]=n.wrap(e)),i.apply?i.apply(this,t):i(t[0],t[1])}};e("setTimeout"),e("setInterval")}(),function(t){if(t){var i=t.event.add;t.event.add=function(e,s,o,r,a){var l;return o.handler?(l=o.handler,o.handler=n.wrap(o.handler)):(l=o,o=n.wrap(o)),o.guid=l.guid?l.guid:l.guid=t.guid++,i.call(this,e,s,o,r,a)};var s=t.fn.ready;t.fn.ready=function(t){return s.call(this,n.wrap(t))};var o=t.ajax;t.ajax=function(i,s){var r,a=["complete","error","success"];for("object"==typeof i&&(s=i,i=e),s=s||{};r=a.pop();)t.isFunction(s[r])&&(s[r]=n.wrap(s[r]));try{return o.call(this,i,s)}catch(l){throw n.report(l),l}}}}(t.jQuery),n.remoteFetching||(n.remoteFetching=!0),n.collectWindowErrors||(n.collectWindowErrors=!0),(!n.linesOfContext||n.linesOfContext<1)&&(n.linesOfContext=11),t.TraceKit=n}(window),function(t,e){"use strict";function i(t){for(var e=$.exec(t),i={},s=14;s--;)i[T[s]]=e[s]||"";return i}function s(t){return"undefined"==typeof t}function n(t){return"function"==typeof t}function o(t,e){var i,n;if(s(t.length))for(i in t)t.hasOwnProperty(i)&&e.call(null,i,t[i]);else for(i=0,n=t.length;n>i;i++)e.call(null,i,t[i])}function r(){if(C)return C;var t=["sentry_version=2.0","sentry_client=raven-js/"+S.VERSION];return y&&t.push("sentry_key="+y),C="?"+t.join("&")}function a(t,e){var i,s,n=[],o=0;if(t.stack&&(i=t.stack.length))for(;i>o;o++)s=l(t.stack[o]),s&&n.push(s);c(t.name,t.message,t.url,t.lineno,n,e)}function l(t){if(t.url){var e={filename:t.url,lineno:t.line,colno:t.column,"function":t.func||"?"},i=h(t);if(i)for(var s=3,n=["pre_context","context_line","post_context"];s--;)e[n[s]]=i[s];return e.in_app=!/(Raven|TraceKit)\./.test(e["function"]),e}}function h(t){if(t.context&&x.fetchContext){for(var e=t.context,i=~~(e.length/2),n=e.length,o=!1;n--;)if(e[n].length>300){o=!0;break}if(o){if(s(t.column))return;return[[],e[i].substr(t.column,50),[]]}return[e.slice(0,i),e[i],e.slice(i+1)]}}function c(t,e,i,s,n,o){var r,a,l;for(l=x.ignoreErrors.length;l--;)if(e===x.ignoreErrors[l])return;for(n&&n.length?(r={frames:n},i=i||n[0].filename):i&&(r={frames:[{filename:i,lineno:s}]}),l=x.ignoreUrls.length;l--;)if(x.ignoreUrls[l].test(i))return;a=s?e+" at "+s:e,p(d({"sentry.interfaces.Exception":{type:t,value:e},"sentry.interfaces.Stacktrace":r,culprit:i,message:a},o))}function d(t,e){return e?(o(e,function(e,i){t[e]=i}),t):t}function u(){var e={url:t.location.href,headers:{"User-Agent":navigator.userAgent}};return t.document.referrer&&(e.headers.Referer=t.document.referrer),e}function p(t){g()&&(t=d({project:b,logger:x.logger,site:x.site,platform:"javascript","sentry.interfaces.Http":u()},t),v&&(t["sentry.interfaces.User"]=v),n(x.dataCallback)&&(t=x.dataCallback(t)),f(t))}function f(t){(new Image).src=m+r()+"&sentry_data="+encodeURIComponent(JSON.stringify(t))}function g(){return _?m?!0:(t.console&&console.error&&console.error("Error: Raven has not been configured."),!1):!1}var m,v,y,b,w=t.Raven,_=!s(t.JSON),x={logger:"javascript",ignoreErrors:[],ignoreUrls:[]},k=TraceKit.noConflict();k.remoteFetching=!1;var C,S={VERSION:"1.0.8",noConflict:function(){return t.Raven=w,S},config:function(e,s){var n=i(e),r=n.path.lastIndexOf("/"),a=n.path.substr(1,r);return s&&s.ignoreErrors&&t.console&&console.warn&&console.warn("DeprecationWarning: `ignoreErrors` is going to be removed soon."),s&&o(s,function(t,e){x[t]=e}),x.ignoreErrors.push("Script error."),y=n.user,b=~~n.path.substr(r+1),m="//"+n.host+(n.port?":"+n.port:"")+"/"+a+"api/"+b+"/store/",n.protocol&&(m=n.protocol+":"+m),x.fetchContext&&(k.remoteFetching=!0),S},install:function(){return g()?(k.report.subscribe(a),S):void 0},context:function(t,i,s){n(t)&&(s=i||[],i=t,t=e),S.wrap(t,i).apply(this,s)},wrap:function(t,i){return n(t)&&(i=t,t=e),function(){try{i.apply(this,arguments)}catch(e){throw S.captureException(e,t),e}}},uninstall:function(){return k.report.unsubscribe(a),S},captureException:function(t,e){if("string"==typeof t)return S.captureMessage(t,e);try{k.report(t,e)}catch(i){if(t!==i)throw i}return S},captureMessage:function(t,e){return p(d({message:t},e)),S},setUser:function(t){return v=t,S}},T="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),$=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;t.Raven=S,"function"==typeof define&&define.amd&&define("raven",[],function(){return S})}(window),define("raven.setup",["raven"],function(t){var e=window.site_config.SENTRY;if(e&&e.CHANCE&&e.DSN){t.config(e.DSN).install();var i=window.onerror;window.onerror=function(){window.site_config.SENTRY.CHANCE>Math.random()&&i.apply(window,arguments)}}return t}),define("fwinfo",["jquery","underscore"],function(){function t(){if(!n&&(n={},document.cookie.match(/\bfwutil=([^\;]*)/))){var t,e,o,r=RegExp.$1.split(i),a=r.length;for(t=0;a>t;t++)e=r[t].split(s),o=e.length,2==o&&(n[e[0]]=decodeURIComponent(e[1]))}}function e(){var t,e="fwutil=",o="";for(t in n)n.hasOwnProperty(t)&&(e+=o+t+s+encodeURIComponent(n[t]),o=i);document.cookie=e+";path=/"}var i="~",s=":",n=null,o={setsessionvalue:function(i,s){n||t(),n[i]=s,e()},getsessionvalue:function(e){return n||t(),n[e]},getandclearsessionvalue:function(t){var e=o.getsessionvalue(t);return e?(o.setsessionvalue(t,""),e):null}};return o}),define("api/analytics",["pubsub"],function(t){return{trackEvent:function(e,i){t.trigger("track",{label:e,url:i})},trackPageView:function(e){t.trigger("analytics:pageload",{ssts:e.ssts||"bugpages",cst:e.cst||"undefined",contenttype:e.contentType,pathName:e.pathName})}}}),define("analytics/settealium",["jquery","underscore","pubsub","fwinfo","utils","managers/routemanager","user-manager","api/analytics"],function(t,e,i,s,n,o,r){function a(t,e){d?d.push([t,e]):l(t,e)}function l(t,e){for(var i in e)e.hasOwnProperty(i)&&e[i]&&(e[i]=(""+e[i]).toLowerCase());window.utag.track(t,e)}function h(t){if(-1!=t.indexOf("|")){var e="n/a",i=[p.data.contenttype||e,p.data.section||e,t];t=i.join("|"),/[|](\d+|n\/a)$/.test(t)||(t+="|"+e)}return t}var c={},d=[],u=function(){window.tealium_url&&this.initialize(window.tealium_url)};u.prototype={initialize:function(t){this.data={},this.pubSub={"analytics:pageload":this.page_load,heattrack:this.heattrack,abtesttrack:this.abtesttrack,"page:load":this.page_load,"site:refresh":this.site_refresh,"slide:change":this.slide_change,"user:logout":this.clear_user_data,uotrack:this.uotrack,"video:load":this.video_load,track:this.track,vitrack:this.vitrack},i.attach(this.pubSub,this),n.loadScript(t,"utag").done(function(){e.each(d,function(t){l(t[0],t[1])}),d=null}).fail(e.bind(function(){d=null,this.destroy()},this))},ready:function(){},destroy:function(){i.unattach(this.pubSub,this)},relevant_data:function(t,e){var i=t.cst.replace(/\/\/*$/,"").split("/"),n=new Date(18e5*parseInt((new Date).getTime()/18e5,10)),o=n.getHours(),r=location.hash.match(/\bht=([^&]*)/)&&RegExp.$1,a=window.location.search.match(/[?&]csp=([^&]*)/i)&&RegExp.$1,l=t.ssts.split("/"),h="";return this.clickName=r||s.getandclearsessionvalue("clickName"),this.clickPage=s.getandclearsessionvalue("clickPage"),t.ab_test_id&&(h=t.ab_test_id+"|"+(t.ab_test_variant||"control")),{assetid:t.assetid,atyponuserid:p.data.atypon_id,blogname:t.blogname||"",byline:t.byline||"",category:i[0],clickName:this.clickName,clickPage:this.clickPage,contenttype:t.contenttype,cst:i.slice(0,3).join(":"),dayofweek:"sunday monday tuesday wednesday thursday friday saturday".split(" ")[(new Date).getDay()],eventtype:e,gcionid:document.cookie.match(/\bGCIONID=([^;]*)/)&&RegExp.$1,halfhour:1+(o+11)%12+":"+function(t){return t.substr(t.length-2)}("0"+n.getMinutes())+(o>11?" pm":" am"),linkTrackVars:"prop1",numPageViewsLeft:t.numPageViewsLeft,pathName:t.pathName||"",prevpath:s.getandclearsessionvalue("prevpath"),priority_asset:t.priority_asset||"",published_date:t.published_date||"",referrerhost:r?document.referrer.split("/")[2]:"",refreshed:s.getandclearsessionvalue("refreshed"),searchkeywords:t.searchkeywords,section:l[0],ssts:l.join(":"),subcategory:i.slice(0,2).join(":"),subsection:l.slice(0,2).join(":"),templatetype:t.templatetype,topic:l.slice(0,3).join(":"),typeofday:((new Date).getDay()+8)%7>1?"weekday":"weekend",user_status:p.data.user_status||"",coreuserid:p.data.core_user_id||"",videoincluded:t.videoincluded||"no",taxonomykeywords:t.taxonomykeywords||"",gallerytitle:t.gallerytitle||"",galleryindex:t.galleryindex||"",queryparamtrack:a||"",viralVideoDomain:"",videoContentProvider:"",videoFulllengthUrl:"",videoName:"",videoPlayerName:"",keywords:"",videoDuration:"",milestonetrack:"",videotranscript:"",noinitialanalytics:t.noinitialanalytics||"",ab_test_id:t.ab_test_id||"",ab_test_variant:h}},clear_user_data:function(){p.data={}},page_load:function(t){var e;t.noinitialanalytics||(c=e=p.relevant_data(t,"page:load"),p.data.contenttype=e.contenttype,p.data.section=e.section,s.setsessionvalue("prevpath",document.location.pathname),"loggingIn"===r.getLoginStatus()||"loggedIn"===r.getLoginStatus()?r.getCoreUserInfo().then(function(t){p.data.atypon_id=e.atyponuserid=t.AtyponId,p.data.core_user_id=e.coreuserid=t.CoreUserId,p.data.user_status=e.user_status=t.UserLicenseType;var i=r.getAccount("firefly");n.getNested(i,"user","hasMarketAccess")&&(p.data.numPageViewsLeft=e.numPageViewsLeft="authorized"),a("view",e)},function(){a("view",e)}):(p.data.user_status=e.user_status="none",a("view",e)))},track:function(t){t=t||{};var e=t.url,i=this._getLabel(t.event,t.label);e&&o.getInfo(e)?this.heattrack(i):i&&this.uotrack(i)},_getLabel:function(e,i){if(e){var s=t(e.currentTarget);return s.data("trackLabel")||s.data("uotrack")||s.data("ht")||i}return i},uotrack:function(t){"string"!=typeof t&&(console.error("uotrack has been given a non-string event argument",t),t=(t||{}).prop41||"somethingbad");var e=t.match(/{% *[a-z0-9_]* *%}/gi);if(e)for(var i=0;i<e.length;i++){var s=e[i],n=s.match(/{% *([a-z0-9_]*) *%}/)&&RegExp.$1;t=t.replace(s,c[n])}t=h(t);var o={clickName:t,clickPage:location.href,eventtype:"uotrack",linkTrackEvents:"None",linkTrackVars:"prop41,prop64"};a("link",o)},vitrack:function(t){"string"!=typeof t&&(console.error("vitrack has been given a non-string event argument",t),t=(t||{}).prop9||"somethingbad");var e={milestonetrack:t,eventtype:"vitrack",linkTrackEvents:"None",linkTrackVars:"prop9"};a("link",e)},abtesttrack:function(t){var e={ab_test_variant_success:t,eventtype:"abtesttrack",linkTrackEvents:"event76",linkTrackVars:"prop27"};a("link",e)},site_refresh:function(t){s.setsessionvalue("refreshed",t)},heattrack:function(t){t&&(t=h(t),s.setsessionvalue("clickName",t)),s.setsessionvalue("clickPage",location.href)},slide_change:function(t){var e,i,n=c;try{e=t.cst.split("/"),i=t.ssts.split("/")}catch(o){return void console.error("Invalid page",o.stack||o.stacktrace||o.message)}n.byline="",n.clickName=s.getandclearsessionvalue("clickName"),n.contenttype=t.contenttype,n.videoincluded=t.videoincluded||"no",n.gallerytitle=t.gallery_title,n.galleryindex=t.gallery_index,n.assetid=t.gallery_id,n.eventtype="slide:change",n.templatetype="",n.category=e[0],n.cst=e.slice(0,3).join(":"),n.published_date=t.publishedDate||"",n.refreshed="",n.section=i[0],n.ssts=i.join(":"),n.subcategory=e.slice(0,2).join(":"),n.subsection=i.slice(0,2).join(":"),n.topic=i.slice(0,3).join(":"),n.pathName=t.pathName||"",n.viralVideoDomain="",n.videoContentProvider="",n.videoFulllengthUrl="",n.videoName="",n.videoDuration="",n.videoPlayerName="",n.keywords="",n.milestonetrack="",n.videotranscript="",a("view",n)},video_load:function(t){var e=c,i=location.hash.match(/\bht=([^&]*)/)&&RegExp.$1;e.byline="",e.clickName=i||s.getandclearsessionvalue("clickName"),e.clickPage=s.getandclearsessionvalue("clickPage"),e.category=t.category||"",e.cst=t.cst||"",e.assetid=t.assetid||"",e.published_date=t.publishedDate||"",e.refreshed="",e.section=t.section||"",e.ssts=t.ssts||"",e.subcategory=t.subcategory||"",e.subsection=t.subsection||"",e.topic=t.topic||"",e.videoPlayerName=t.videoplayername||"",e.prevpath=s.getandclearsessionvalue("prevpath"),e.completion=t.completion||"",e.keywords=t.keywords||"",e.taxonomykeywords=t.keywords||"",e.contenttype=t.contenttype||"",e.videoName=t.videoName||"",e.videoDuration=t.videoDuration||"",e.eventtype=t.eventtype||"",e.pathName=t.pathName||"",e.videoContentID=t.contentid||"",e.viralVideoDomain=t.viralVideoDomain||"",e.videoContentProvider=t.videocontentprovider||"",e.templatetype=t.templatetype||"",e.noinitialanalytics=!1,e.videoincluded="yes",e.videoFulllengthUrl=t.videoFulllengthUrl||"",e.milestonetrack=t.milestonetrack||"",e.videotranscript=t.videotranscript||"",a("view",e),s.setsessionvalue("prevpath",document.location.pathname)}};var p=new u;return p}),define("third-party-apis/google/google",["jquery","underscore","third-party-apis/base-third-party-api"],function(t,e,i){"use strict";var s=i.extend({initialize:function(){i.prototype.initialize.call(this)},_handleLoadScript:function(){return this._loadJSApiScriptPromise||(this._loadJSApiScriptPromise=t.Deferred(),t.ajax("https://www.google.com/jsapi",{cache:!0,dataType:"script"}).done(e.bind(function(){this._loadJSApiScriptPromise.resolve()},this))),this._loadJSApiScriptPromise.promise()},_handleLoadApi:function(){return console.error("loadGoogleApi failed: unimplemented api!"),t.Deferred().reject("unimplemented feature")},loadGoogleApi:function(e,i,s){var n=t.Deferred();return this.loadScript().done(function(){var t=s||{},o=t.callback;t.callback=function(){n.resolve(),o&&o()},google.load.call(this,e,i,t)}),n.promise()}});return s}),define("user-accounts/base-user-account",["jquery","underscore","pubsub","baseview","managers/cachemanager"],function(t,e,i,s,n){"use strict";var o=s.extend({initialize:function(t){e.bindAll(this,"_handleGetCoreUserInfo","logout"),s.prototype.initialize.call(this,t)},getUserInfo:function(){return this.loginPromise?this.loginPromise.then(e.bind(function(){return this._handleGetUserInfo()},this)):t.Deferred().reject("account not logged in")},_handleGetUserInfo:function(){return console.error("getUserInfo failed: unimplemented function!"),t.Deferred().reject("unimplemented feature")},getCoreUserInfo:function(){return this.loginPromise?this.loginPromise.then(e.bind(function(){return n.getValue("coreuserinfo",this._handleGetCoreUserInfo).done(function(e){t.cookie("atyponid",e.AtyponId,{expires:14,path:"/",domain:window.site_vars.base_url})})},this)):t.Deferred().reject("account not logged in")},_handleGetCoreUserInfo:function(){return t.Deferred(e.bind(function(e){t.ajax("/user-service/getcoreuser/"+this.getUserId()+"/"+this.getName(),{type:"POST",data:{token:this.getUserToken()}}).done(function(t){t&&t.success&&t.success.status?"valid"===t.success.status.state?e.resolve(t.success.response):e.reject(t.success.status.message):e.reject("unable to get core user data, invalid response!")}).fail(function(){e.reject("unable to get core user data!")})},this)).promise()},login:function(t){var i=this.getLoginStatus();return"loggingOut"===i?this.logoutPromise.then(e.bind(function(){return this.login(t)},this),e.bind(function(){return this.login(t)},this)):("loggedIn"!==i&&"loggingIn"!==i&&this._triggerLogin(t),this.loginPromise)},_triggerLogin:function(t){this.loginPromise=this._handleLogin(t),"pending"===this.loginPromise.state()&&this._onLoginStatusChange(),this.loginPromise.always(e.bind(function(){this._onLoginStatusChange.apply(this,arguments)},this))},getLoginStatus:function(){return this.logoutPromise?"loggingOut":this.loginPromise?"rejected"===this.loginPromise.state()?"loginFailed":"pending"===this.loginPromise.state()?"loggingIn":"loggedIn":"loggedOut"},_onLoginStatusChange:function(){i.trigger.apply(i,["user:statuschange",this.getName(),this.getLoginStatus()].concat(Array.prototype.slice.call(arguments,0)))},_handleLogin:function(){return console.error("Login failed: unimplemented function!"),t.Deferred().reject("unimplemented feature")},_flushCaches:function(){n.clearValue("coreuserinfo")},logout:function(){var e=this.getLoginStatus();return"loggingOut"===e?this.logoutPromise:"loggingIn"===e?this.loginPromise.then(this.logout,this.logout):"loggedOut"!==e?this._triggerLogout():t.Deferred().resolve()},_triggerLogout:function(){this._flushCaches(),this.loginPromise=null;var t=this._handleLogout().always(e.bind(function(){this.logoutPromise=null,this._onLoginStatusChange()},this));return"pending"===t.state()&&(this.logoutPromise=t,this._onLoginStatusChange()),t},_handleLogout:function(){return t.Deferred().resolve()},whenLoggedIn:function(){return this.loginPromise?this.loginPromise:t.Deferred().reject()},getUserToken:function(){return""},getUserId:function(){return""},getUserAvatar:function(){return""},getUserFirstName:function(){return""},getUserLastName:function(){return""},getName:function(){throw"No name defined"}});return o}),define("user-accounts/facebook-user-account",["jquery","underscore","pubsub","user-accounts/base-user-account","user-manager","third-party-apis/facebook/facebook","cookie"],function(t,e,i,s,n,o){"use strict";var r=s.extend({initialize:function(t){s.prototype.initialize.call(this,t),this.user={},n.registerAccount(this)},_handleGetUserInfo:function(){return o.loadScript().then(function(){return t.Deferred(function(t){FB.api("/me?fields=name,first_name,last_name,gender,picture",function(e){!e||e.error?(console.error("Facebook returned erroneous response!",e),t.reject(e)):t.resolve(e)})})})},_handleLogin:function(t){var i;return i=t?this._getLoginStatus():this._loginUser(),i.then(e.bind(function(t){return this.sessionToken=t.accessToken,this._handleGetUserInfo()},this)).done(e.bind(function(t){this.user=t},this)).fail(e.bind(function(t){"unknown"===t&&this.logout()},this))},_getLoginStatus:function(){return o.loadScript().then(function(){return t.Deferred(function(t){FB.getLoginStatus(function(e){"connected"===e.status?t.resolve(e.authResponse):t.reject(e.status)})})})},_loginUser:function(){return o.loadScript().then(function(){return t.Deferred(function(t){FB.login(function(e){"connected"===e.status?t.resolve(e.authResponse):t.reject(e.status)},{scope:o.getUserPermissions()})})})},_handleLogout:function(){return this.user={},this.sessionToken=null,o.loadScript().then(function(){FB.logout()})},getName:function(){return"facebook"},getUserToken:function(){return this.sessionToken},getUserId:function(){return this.user.id},getUserAvatar:function(){return this.user.picture&&this.user.picture.data?this.user.picture.data.url:""},getUserFirstName:function(){return this.user.first_name},getUserLastName:function(){return this.user.last_name}});return new r}),define("third-party-apis/google/googleplus",["jquery","underscore","third-party-apis/base-third-party-api"],function(t,e,i){"use strict";var s=i.extend({initialize:function(){var t=this.getApiSiteConfig("GOOGLEPLUS");t&&(this._clientid=t.CLIENTID,this._plusonejslib=t.JSLIBURL,this._cookiePolicy=t.COOKIEPOLICY,this._appPackageName=t.APPPACKAGENAME,this._logoutUrl=t.LOGOUT_URL),i.prototype.initialize.call(this)},_handleLoadScript:function(){return this._loadScriptPromise||(this._loadScriptPromise=t.Deferred(),this.setupOnLoadCallbacks("afterLoadGPScript",e.bind(function(){this._loadGooglePlusApi().done(e.bind(function(){this._loadScriptPromise.resolve()},this))},this)),t.ajax(this._plusonejslib,{data:{onload:"afterLoadGPScript"},cache:!0,dataType:"script"})),this._loadScriptPromise.promise()},_loadGooglePlusApi:function(){var i=t.Deferred();return gapi.client.load("plus","v1",e.bind(function(){gapi.auth.init(function(){i.resolve()})},this)),i.promise()},getUserInfo:function(){var e=t.Deferred();return this.userInfo?e.resolveWith(this,[this.userInfo]):this.loadScript().done(function(){var t=gapi.client.plus.people.get({userId:"me"});t.execute(function(t){t.error?(console.error("Google returned erroneous response!",t),e.reject()):e.resolveWith(this,[t])})}),e.promise()},signInUser:function(){var i=t.Deferred();return this.loadScript().done(e.bind(function(){gapi.auth.authorize({client_id:this._clientid,requestvisibleactions:"http://schemas.google.com/AddActivity",scope:"https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile",apppackagename:this._appPackageName,approvalprompt:"force",immediate:!1},e.bind(function(t){t.access_token?i.resolveWith(this,[t]):t.error&&(console.log("There was an error: "+t.error),i.rejectWith(this,[t]))},this))},this)),i.promise()},signOutUser:function(i){var s=t.Deferred();return this.loadScript().done(e.bind(function(){t.ajax({type:"GET",url:this._logoutUrl,data:{token:i},async:!1,contentType:"application/json",dataType:"jsonp",success:function(){s.resolve()},error:function(){s.reject()}})},this)),s.promise()},getAuthStatus:function(){var i=t.Deferred();return this.loadScript().done(e.bind(function(){gapi.auth.authorize({client_id:this._clientid,scope:"https://www.googleapis.com/auth/plus.login",immediate:!0},function(t){i.resolve(t)})},this)),i.promise()}});return new s}),define("user-accounts/googleplus-user-account",["jquery","underscore","user-manager","user-accounts/base-user-account","third-party-apis/google/googleplus","cookie"],function(t,e,i,s,n){"use strict";var o=s.extend({initialize:function(t){s.prototype.initialize.call(this,t),this.user={},i.registerAccount(this)},_handleGetUserInfo:function(){return n.getUserInfo().done(e.bind(function(t){this.user=t},this))},_handleLogin:function(t){var i=t?"getAuthStatus":"signInUser";return n[i]().then(e.bind(function(t){return this.sessionToken=t.access_token,this._handleGetUserInfo()},this)).fail(e.bind(function(){this.logout()},this))},_handleLogout:function(){return this.sessionToken?n.signOutUser(this.sessionToken):t.Deferred().resolve()},getName:function(){return"google"},getUserToken:function(){return this.sessionToken},getUserId:function(){return this.user.id},getUserAvatar:function(){return this.user.image?this.user.image.url:""},getUserFirstName:function(){return this.user.name?this.user.name.givenName:""},getUserLastName:function(){return this.user.name?this.user.name.familyName:""}});return new o}),define("modules/sports/sports-more-teams",["jquery","underscore","backbone","baseview","utils","easing"],function(t,e,i,s,n){var o=s.extend({events:{"click .sp-more-teams-next-arrow":"onArrowClick","click .sp-more-teams-prev-arrow":"onArrowClick","click .sp-more-teams-nav-item-link":"onPaginationLinkClick"},initialize:function(){s.prototype.initialize.call(this,this.options),e.bindAll(this,"setup","update"),this.$viewport=this.$(".sp-more-teams-viewport"),this.$divisions=this.$viewport.find(".sp-more-teams-division"),this.divisionsCount=this.$divisions.length,this.$scroller=this.$(".sp-more-teams-scroll"),this.$arrows=this.$(".sp-more-teams-next-arrow, .sp-more-teams-prev-arrow"),this.$indicator=this.$(".sp-more-teams-nav-indicator"),this.$paginationLinks=this.$(".sp-more-teams-nav-item-link"),this.$navBelt=this.$(".sp-more-teams-nav-belt"),this.$navItemWrapper=this.$(".sp-more-teams-nav-item-wrap"),this.$navItems=this.$navItemWrapper.find(".sp-more-teams-nav-item"),this.$win=n.get("win");var t=e.throttle(this.update,1e3);this.$win.on("resize."+this.cid,t),this.currentDivisionIndex=this.$divisions.index(this.$divisions.filter(".current")),this.setup()},setup:function(){this._addTileSpacing(),this._addNavItemSpacing(),this._setupTicks(),this.scrollTo(this.currentDivisionIndex)},update:function(){this._addTileSpacing(),this._addNavItemSpacing(),this._setupTicks(),this.moveScroller(this.getAnimPosition(this.currentDivisionIndex)),this.moveIndicator(this.currentDivisionIndex)},_addNavItemSpacing:function(){var i,s=this.$navItemWrapper.width(),n=this.$navItems.length,o=0;this.$navItems.each(function(){o+=t(this).outerWidth()}),i=(s-o)/(2*n-2),i=parseInt(i,0),e.each(this.$navItems,function(e,s){var n=t(e),o=s+1,r=i+"px";1===o?n.css("margin-right",r):o===this.$navItems.length?n.css("margin-left",r):(n.css("margin-right",r),n.css("margin-left",r))},this)},_addTileSpacing:function(){e.each(this.$divisions,function(e){var i,s=t(e),n=s.find(".sp-more-teams-division-team-tile"),o=n.length,r=100/o;i=parseInt(this.$viewport.width(),0),s.width(i),n.each(function(){t(this).width(r+"%")})},this)},_setupTicks:function(){var i=this.$navBelt,s=i.find(".sp-more-teams-nav-indicator-tick"),n=s.eq(0).width(),o=s.length-1;e.each(s,function(e,s){var r=i.width()/o*s-n/2;t(e).css("left",r+"px")},this)},onArrowClick:function(e){var i,s=t(e.currentTarget),n=this.divisionsCount-1;e.preventDefault(),s.hasClass("sp-more-teams-prev-arrow")?(i=this.currentDivisionIndex-1,n>i&&this.scrollTo(i)):(i=this.currentDivisionIndex+1,i>0&&this.scrollTo(i))},onPaginationLinkClick:function(e){var i=this.$paginationLinks.index(t(e.currentTarget));e.preventDefault(),this.scrollTo(i)},scrollTo:function(t){var i,s=this.$divisions.eq(t),n=this.divisionsCount-1;s.hasClass("active")||(i=this.getAnimPosition(t),this.$divisions.removeClass("active"),this.$arrows.show(),0===n?(this.$arrows.filter(".sp-more-teams-next-arrow").hide(),this.$arrows.filter(".sp-more-teams-prev-arrow").hide()):t===n?this.$arrows.filter(".sp-more-teams-next-arrow").hide():0===t&&this.$arrows.filter(".sp-more-teams-prev-arrow").hide(),this.moveScroller(i).done(e.bind(function(){s.addClass("active"),this.moveIndicator(t)},this)),this.currentDivisionIndex=t)},moveScroller:function(i){return t.Deferred(e.bind(function(t){this.$scroller.stop().animate({left:i+"px"},200,"easeInOutQuad",function(){t.resolve()})},this))},moveIndicator:function(t){var e,i=this.$navItems.length-1;e=this.$navBelt.width()/i*t-this.$indicator.width()/2,this.$indicator.stop().animate({left:e+"px"},100,"linear"),this.$paginationLinks.removeClass("sp-more-teams-nav-item-link-active"),this.$paginationLinks.eq(t).addClass("sp-more-teams-nav-item-link-active")},getAnimPosition:function(t){return-(this.$viewport.outerWidth()*t)},destroy:function(t){this.$win.off("."+this.cid),s.prototype.destroy.call(this,t)}});return o}),define("modules/interactive-poll",["jquery","underscore","baseview","pubsub","utils","state","cookie"],function(t,e,i,s,n,o){var r=i.extend({events:{"click .story-poll-choices .story-poll-vote-btn":"registerVote","click .story-poll-results-btn":"revealResults","click .poll-vote-results .story-poll-vote-btn":"revealChoices"},initialize:function(){this.poll_id=this.$el.attr("data-pollid"),this.user_id="unauthenticated",t.cookie(this.poll_id)&&this.revealResults(),i.prototype.initialize.apply(this,arguments)},revealResults:function(i){var s=this.$(".quickpoll-results"),n=this.$(".story-poll-choices"),r=this.$(".story-poll-chart"),a="/polls/get/"+this.poll_id+"/";o.fetchData(a).done(e.bind(function(o){var a=e.pluck(o[0].answer,"count"),l=e.reduce(a,function(t,e){return t+parseFloat(e)},0),h=0===l?!0:!1,c=0;isNaN(i)||(l+=1,t.cookie(this.poll_id,!0)),e.each(o[0].answer,function(t,e){var s;h?s=i==e?100:0:(i==e+1&&(t.count+=1),s=Math.round(parseFloat(t.count)/l*100)),c+=s,t.percent=s,t.percent_width=.8*s});var d=e.template(s.html(),{data:o[0],total:l});n.hide(),r.html(d).fadeIn(),t.cookie(this.poll_id)&&t(".poll-vote-results .story-poll-vote-wrapper").hide(),r.css("height","auto")},this))},registerVote:function(){var t=this.$(".story-poll-answer:checked").val(),i="/polls/save/"+this.poll_id+"/"+this.user_id+"/"+t+"/";return o.fetchData(i,{method:"post"}).done(e.bind(function(e){e&&(s.trigger("uotrack","pollvote"),this.revealResults(t))},this)),!1},revealChoices:function(){var t=this.$(".story-poll-choices"),e=this.$(".story-poll-chart");e.hide(),t.fadeIn()}});return r}),define("user-accounts/firefly-user-account",["jquery","underscore","pubsub","user-accounts/base-user-account","user-manager","utils","third-party-apis/firefly/firefly","cookie"],function(t,e,i,s,n,o,r){"use strict";var a=s.extend({initialize:function(t){s.prototype.initialize.call(this,t),this.user={},n.registerAccount(this),n.loginUser("firefly")},_handleGetUserInfo:function(){return r.getUserInfo().done(e.bind(function(t){this.user=t},this))},_handleGetCoreUserInfo:function(){return r.getUserInfo().then(e.bind(function(t){for(var e={CoreUserId:o.getNested(t,"userService","coreUserId"),AtyponSessionKey:this.getUserToken(),GooglePlusId:void 0,AtyponId:t.userId,UserLicenseType:t.userLicenseType,FaceBookId:void 0,FileMobileId:void 0},i=o.getNested(t,"userService","identities")||[],s=0;s<i.length;s++){var n=i[s];"Facebook"===n.ProviderName?e.FaceBookId=n.ProviderUserId:"Google"===n.ProviderName?e.GooglePlusId=n.ProviderUserId:"Filemobile"===n.ProviderName&&(e.FileMobileId=n.ProviderUserId)}return e},this))},getUserInfo:function(){return r.getUserInfo()},getViewsCookie:function(){return r.getFireflyViewsCookie()||{}},_handleLogin:function(t){var i;return i=t?"getLoginStatus":"loginUser",r[i]().then(e.bind(function(){return this._handleGetUserInfo()},this),e.bind(function(){this.logout()},this))},_handleLogout:function(){return this.getUserToken()?r.logoutUser(this.sessionToken):t.Deferred().resolve()},getName:function(){return"firefly"},getUserToken:function(){return t.cookie("sessionKey")},getUserId:function(){return this.user.userId},getUserAvatar:function(){return this.user.picture&&this.user.picture.data?this.user.picture.data.url:""},getUserFirstName:function(){return this.user.firstName},getUserLastName:function(){return this.user.lastName}});return new a}),define("modules/users/site-nav-firefly-module",["jquery","underscore","modules/header/site-nav-dropdown","pubsub","utils","user-manager","user-accounts/firefly-user-account"],function(t,e,i,s,n,o){"use strict";var r=i.extend({initialize:function(t){this.pubSub={"page:load":this.updateRedirectURLs,"user:statuschange":this.showLoggedInStatus},this.$siteNavDropdown=this.$(".site-nav-dropdown"),this.$navSpan=this.$(".site-nav-firefly-span"),this.$name=this.$(".site-nav-firefly-user-display-name"),this.events=e.extend({},i.prototype.events,this.events),i.prototype.initialize.call(this,t)},updateRedirectURLs:function(){var e=n.getPageUrl(),i="?onSuccessRedirectURL="+encodeURIComponent(e);t(".sam-returns").each(function(e,s){var n=t(s),o=n.attr("href");if("string"==typeof o){var r=o.split(/[\?\&]/),a="";r.length>2&&(a="&"+r.slice(2).join("&")),n.attr("href",r[0]+i+a)}})},showLoggedInStatus:function(t,e,i){"firefly"===t&&(this.$navSpan&&this.$navSpan.addClass("loaded"),"loggedIn"===e?this.showLoggedInUser(i):"loggingIn"!==e&&this.showLoggedOutUser())
},showLoggedOutUser:function(){this.$siteNavDropdown.removeClass("authenticated"),this.$siteNavDropdown.removeClass("subscribed"),this.$name.html("")},showLoggedInUser:function(t){var e=o.getAccount("firefly");this.$siteNavDropdown.addClass("authenticated"),t.hasMarketAccess&&this.$siteNavDropdown.addClass("subscribed"),this.$name.html(e.getUserFirstName()+" "+e.getUserLastName())}});return r}),define("modules/travel/travel-featured-content",["jquery","underscore","baseview","state","utils","ui/generic-paginator"],function(t,e,i,s,n,o){var r=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){s=t.extend({transition:{interval:15e3}},s),e.bindAll(this,"automate","goTo"),this.subviews={},this.moveMe=t(this.$el).find(".travel-featured-content-wrapper"),this.viewport=this.moveMe.parent(),this.slides=t(this.$el).find(".travel-featured-content-slide"),this.moveMe.width(this.moveMe.width()*this.moveMe.children().length),this.slides.length>1&&(this.subviews.paginator=new o({el:t(this.$el).find(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer())),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(t){this.stoptimer(),i.prototype.destroy.call(this,t)},goTo:function(t){var e=this.viewport.outerWidth(),i=e*t;this.animate(this.moveMe,"left","-"+(i+1)+"px",450,"ease-in-out")},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return r}),define("form/dropdown",["jquery","underscore","form/base-form-element","ui/dropdown"],function(t,e,i,s){"use strict";var n=i.extend({events:{change:"onChange"},initialize:function(n){n=t.extend({onSelect:null,dropdownContentClass:null},n),e.bindAll(this,"refresh","onDivDropdownSelect"),this.$el.hide(),this.selectOptionItems=this.$("option"),this.dropdownDiv=this._buildDropdownHtml(this.selectOptionItems),this.$el.attr("tabindex","-1"),this.dropdownDiv.insertAfter(this.$el),i.prototype.initialize.call(this,n),this.subviews.dropdown=new s({el:this.dropdownDiv,onSelect:this.onDivDropdownSelect})},_buildDropdownHtml:function(e){var i=t('<div class="'+this.$el.attr("class")+'"></div>');this.options.dropdownContentClass&&i.addClass(this.options.dropdownContentClass);var s=t('<div class="ui-dropdown-value ui-btn"></div>'),n=t('<div class="ui-dropdown-content"></div>'),o=this._buildDropdownHtmlItems(e);return i.attr("class",this.$el.attr("class")),i.attr("tabindex",this.$el.attr("tabindex")||0),i.append(s).append(n),n.append(o),i},_buildDropdownHtmlItems:function(i){var s=t('<ul class="ui-dropdown-items-container"></ul>');return i.each(e.bind(function(e,i){var n=t(i),o=n.val(),r=n.html(),a=t('<li class="ui-dropdown-item" data-value="'+o+'">'+r+"</li>");n.is(":selected")&&a.attr("data-selected","selected"),s.append(a)},this)),s},refresh:function(e){var i=this._buildDropdownHtmlItems(t(e));this.subviews.dropdown.refresh(i.html()),this.$el.html(e)},getUIElement:function(){return this.dropdownDiv},getType:function(){return"dropdown"},reset:function(){this.subviews.dropdown.reset(),this.$el.val("")},onDivDropdownSelect:function(t,e,i){this.$el.val(t),this.options.onSelect&&this.options.onSelect(t,e,i)},onChange:function(){this.subviews.dropdown.setValue(this.$el.val())},destroy:function(t){this.dropdownDiv.remove(),i.prototype.destroy.call(this,t)}});return n}),define("form/checkbox",["jquery","underscore","form/base-form-element"],function(t,e,i){"use strict";var s=i.extend({events:{click:"onCheckboxInputClick"},initialize:function(s){s=t.extend({onClick:null},s),i.prototype.initialize.call(this,s),e.bindAll(this,"onCheckboxClick"),this.checkboxDiv=this._buildDivCheckbox(this.$el),this.isCheckedByDefault=this.$el.is(":checked")},_buildDivCheckbox:function(i){var s=t('<div class="'+i.attr("class")+'" data-name="'+i.attr("name")+'" data-value="'+i.val()+'"></div>'),n=this.$el.closest("form").find('label[for="'+i.attr("id")+'"]');i.is(":checked")&&s.addClass("ui-checkbox-checked"),i.is(":disabled")&&s.addClass("ui-checkbox-disabled"),s.on("keydown."+this.cid+" click."+this.cid,e.bind(function(t){"keydown"===t.type?this.onKeyDown(t):this.onCheckboxClick(t)},this));var o=i.attr("tabindex");i.attr("tabindex","-1"),o?s.attr("tabindex",o):s.attr("tabindex","0");var r=this._buildDivCheckboxLabel(n);return s.append(r),n.hide(),s.insertAfter(i),s},_buildDivCheckboxLabel:function(e){var i=t('<span class="ui-checkbox-label"></span>');return i.text(e.length?e.text():this.$el.val()),i},onKeyDown:function(t){var e=t.keyCode?t.keyCode:t.which;(32===e||13===e)&&(t.preventDefault(),this.onCheckboxClick(t))},check:function(){this.checkboxDiv.addClass("ui-checkbox-checked"),this.$el.prop("checked",!0)},unCheck:function(){this.checkboxDiv.removeClass("ui-checkbox-checked"),this.$el.prop("checked",!1)},onCheckboxClick:function(){var t;this.checkboxDiv.hasClass("ui-checkbox-checked")?(this.unCheck(),t=!1):(this.check(),t=!0),this.options.onClick&&this.options.onClick(this.checkboxDiv,t)},getUIElement:function(){return this.checkboxDiv},getType:function(){return"checkbox"},reset:function(){this.isCheckedByDefault?this.check():this.unCheck()},onCheckboxInputClick:function(t){this.onCheckboxClick(t)},destroy:function(t){this.checkboxDiv.off("."+this.cid),this.checkboxDiv.remove(),i.prototype.destroy.call(this,t)}});return s}),define("form/radio-button",["jquery","underscore","form/base-form-element"],function(t,e,i){"use strict";var s=i.extend({events:{click:"onRadioInputClick"},initialize:function(e){e=t.extend({onClick:null},e),i.prototype.initialize.call(this,e),this.radioDiv=this._buildDivRadio(this.$el)},_buildDivRadio:function(i){var s=t('<div class="'+i.attr("class")+'" data-name="'+i.attr("name")+'" data-value="'+i.val()+'"></div>'),n=this.$el.closest("form").find('label[for="'+i.attr("id")+'"]');i.is(":checked")&&s.addClass("ui-radio-selected"),i.is("disabled")&&s.addClass("ui-radio-disabled"),s.on("keydown."+this.cid+" click."+this.cid,e.bind(function(t){"keydown"===t.type?this.onKeyDown(t):this.onRadioClick(t)},this));var o=i.attr("tabindex");i.attr("tabindex","-1"),o?s.attr("tabindex",o):s.attr("tabindex","0");var r=this._buildDivRadioLabel(n);return s.append(r),n.hide(),s.insertAfter(i),s},_buildDivRadioLabel:function(e){var i=t('<span class="ui-radio-label"></span>');return i.text(e.length?e.text():this.$el.val()),i},select:function(){this.radioDivs||(this.radioDivs=this.$el.closest("form").find("div.ui-radio[data-name="+this.$el.attr("name")+"]")),this.radioDivs.removeClass("ui-radio-selected"),this.radioDiv.addClass("ui-radio-selected"),this.options.onClick&&this.options.onClick(this.radioDiv)},onKeyDown:function(t){var e=t.keyCode?t.keyCode:t.which;(32===e||13===e)&&(t.preventDefault(),this.onRadioClick(t))},onRadioClick:function(t){t.preventDefault(),this.radioDiv.hasClass("ui-radio-selected")||(this.select(),this.$el.prop("checked",!0))},onRadioInputClick:function(t){this.onRadioClick(t)},getUIElement:function(){return this.radioDiv},getType:function(){return"radio"},destroy:function(t){this.radioDiv.off("."+this.cid),this.radioDiv.remove(),i.prototype.destroy.call(this,t)}});return s}),function(t){"function"==typeof define&&define.amd?define("libs/jqueryui/core",["jquery"],t):t(jQuery)}(function(t){function e(e,s){var n,o,r,a=e.nodeName.toLowerCase();return"area"===a?(n=e.parentNode,o=n.name,e.href&&o&&"map"===n.nodeName.toLowerCase()?(r=t("img[usemap='#"+o+"']")[0],!!r&&i(r)):!1):(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||s:s)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}t.ui=t.ui||{},t.extend(t.ui,{version:"1.11.1",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var i=this.css("position"),s="absolute"===i,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var e=t(this);return s&&"static"===e.css("position")?!1:n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==i&&o.length?o:t(this[0].ownerDocument||document)},uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,s){return!!t.data(e,s[3])},focusable:function(i){return e(i,!isNaN(t.attr(i,"tabindex")))},tabbable:function(i){var s=t.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&e(i,!n)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(e,i){function s(e,i,s,o){return t.each(n,function(){i-=parseFloat(t.css(e,"padding"+this))||0,s&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),o&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),r={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(e){return void 0===e?r["inner"+i].call(this):this.each(function(){t(this).css(o,s(this,e)+"px")})},t.fn["outer"+i]=function(e,n){return"number"!=typeof e?r["outer"+i].call(this,e):this.each(function(){t(this).css(o,s(this,e,!0,n)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:function(e){return function(i,s){return"number"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),s&&s.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var i,s,n=t(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),t.ui.plugin={add:function(e,i,s){var n,o=t.ui[e].prototype;for(n in s)o.plugins[n]=o.plugins[n]||[],o.plugins[n].push([i,s[n]])},call:function(t,e,i,s){var n,o=t.plugins[e];if(o&&(s||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(n=0;n<o.length;n++)t.options[o[n][0]]&&o[n][1].apply(t.element,i)}}}),function(t){"function"==typeof define&&define.amd?define("libs/jqueryui/datepicker",["jquery","./core"],t):t(jQuery)}(function(t){function e(t){for(var e,i;t.length&&t[0]!==document;){if(e=t.css("position"),("absolute"===e||"relative"===e||"fixed"===e)&&(i=parseInt(t.css("zIndex"),10),!isNaN(i)&&0!==i))return i;t=t.parent()}return 0}function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.regional.en=t.extend(!0,{},this.regional[""]),this.regional["en-US"]=t.extend(!0,{},this.regional.en),this.dpDiv=s(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function s(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(i,"mouseout",function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",n)}function n(){t.datepicker._isDisabledDatepicker(r.inline?r.dpDiv.parent()[0]:r.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))}function o(e,i){t.extend(e,i);for(var s in i)null==i[s]&&(e[s]=i[s]);return e}t.extend(t.ui,{datepicker:{version:"1.11.1"}});var r;return t.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return o(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var s,n,o;s=e.nodeName.toLowerCase(),n="div"===s||"span"===s,e.id||(this.uuid+=1,e.id="dp"+this.uuid),o=this._newInst(t(e),n),o.settings=t.extend({},i||{}),"input"===s?this._connectDatepicker(e,o):n&&this._inlineDatepicker(e,o)},_newInst:function(e,i){var n=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:n,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?s(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var s=t(e);i.append=t([]),i.trigger=t([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),t.data(e,"datepicker",i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var s,n,o,r=this._get(i,"appendText"),a=this._get(i,"isRTL");i.append&&i.append.remove(),r&&(i.append=t("<span class='"+this._appendClass+"'>"+r+"</span>"),e[a?"before":"after"](i.append)),e.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&e.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),o=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:o,alt:n,title:n}):t("<button type='button'></button>").addClass(this._triggerClass).html(o?t("<img/>").attr({src:o,alt:n,title:n}):n)),e[a?"before":"after"](i.trigger),i.trigger.click(function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,s,n,o=new Date(2009,11,20),r=this._get(t,"dateFormat");r.match(/[DM]/)&&(e=function(t){for(i=0,s=0,n=0;n<t.length;n++)t[n].length>i&&(i=t[n].length,s=n);return s},o.setMonth(e(this._get(t,r.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(e(this._get(t,r.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),t.input.attr("size",this._formatDate(t,o).length)}},_inlineDatepicker:function(e,i){var s=t(e);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),t.data(e,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,s,n,r){var a,l,h,c,d,u=this._dialogInst;return u||(this.uuid+=1,a="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+a+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),t("body").append(this._dialogInput),u=this._dialogInst=this._newInst(this._dialogInput,!1),u.settings={},t.data(this._dialogInput[0],"datepicker",u)),o(u.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(u,i):i,this._dialogInput.val(i),this._pos=r?r.length?r:[r.pageX,r.pageY]:null,this._pos||(l=document.documentElement.clientWidth,h=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+c,h/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),u.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],"datepicker",u),this},_destroyDatepicker:function(e){var i,s=t(e),n=t.data(e,"datepicker");s.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty())},_enableDatepicker:function(e){var i,s,n=t(e),o=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,s,n=t(e),o=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;e<this._disabledInputs.length;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,i,s){var n,r,a,l,h=this._getInst(e);return 2===arguments.length&&"string"==typeof i?"defaults"===i?t.extend({},t.datepicker._defaults):h?"all"===i?t.extend({},h.settings):this._get(h,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),void(h&&(this._curInst===h&&this._hideDatepicker(),r=this._getDateDatepicker(e,!0),a=this._getMinMaxDate(h,"min"),l=this._getMinMaxDate(h,"max"),o(h.settings,n),null!==a&&void 0!==n.dateFormat&&void 0===n.minDate&&(h.settings.minDate=this._formatDate(h,a)),null!==l&&void 0!==n.dateFormat&&void 0===n.maxDate&&(h.settings.maxDate=this._formatDate(h,l)),"disabled"in n&&(n.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(t(e),h),this._autoSize(h),this._setDate(h,r),this._updateAlternate(h),this._updateDatepicker(h))))},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,s,n,o=t.datepicker._getInst(e.target),r=!0,a=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),r=!1;break;case 13:return n=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",o.dpDiv),n[0]&&t.datepicker._selectDay(e.target,o.selectedMonth,o.selectedYear,n[0]),i=t.datepicker._get(o,"onSelect"),i?(s=t.datepicker._formatDate(o),i.apply(o.input?o.input[0]:null,[s,o])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),r=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),r=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,a?1:-1,"D"),r=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),r=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,a?-1:1,"D"),r=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),r=e.ctrlKey||e.metaKey;break;default:r=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):r=!1;r&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var i,s,n=t.datepicker._getInst(e.target);return t.datepicker._get(n,"constrainInput")?(i=t.datepicker._possibleChars(t.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(e){var i,s=t.datepicker._getInst(e.target);if(s.input.val()!==s.lastVal)try{i=t.datepicker.parseDate(t.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,t.datepicker._getFormatConfig(s)),i&&(t.datepicker._setDateFromField(s),t.datepicker._updateAlternate(s),t.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(i){if(i=i.target||i,"input"!==i.nodeName.toLowerCase()&&(i=t("input",i.parentNode)[0]),!t.datepicker._isDisabledDatepicker(i)&&t.datepicker._lastInput!==i){var s,n,r,a,l,h,c;s=t.datepicker._getInst(i),t.datepicker._curInst&&t.datepicker._curInst!==s&&(t.datepicker._curInst.dpDiv.stop(!0,!0),s&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),n=t.datepicker._get(s,"beforeShow"),r=n?n.apply(i,[i,s]):{},r!==!1&&(o(s.settings,r),s.lastVal=null,t.datepicker._lastInput=i,t.datepicker._setDateFromField(s),t.datepicker._inDialog&&(i.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(i),t.datepicker._pos[1]+=i.offsetHeight),a=!1,t(i).parents().each(function(){return a|="fixed"===t(this).css("position"),!a}),l={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,s.dpDiv.empty(),s.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(s),l=t.datepicker._checkOffset(s,l,a),s.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":a?"fixed":"absolute",display:"none",left:l.left+"px",top:l.top+"px"}),s.inline||(h=t.datepicker._get(s,"showAnim"),c=t.datepicker._get(s,"duration"),s.dpDiv.css("z-index",e(t(i))+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[h]?s.dpDiv.show(h,t.datepicker._get(s,"showOptions"),c):s.dpDiv[h||"show"](h?c:null),t.datepicker._shouldFocusInput(s)&&s.input.focus(),t.datepicker._curInst=s))}},_updateDatepicker:function(e){this.maxRows=4,r=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var i,s=this._getNumberOfMonths(e),o=s[1],a=17,l=e.dpDiv.find("."+this._dayOverClass+" a");l.length>0&&n.apply(l.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),o>1&&e.dpDiv.addClass("ui-datepicker-multi-"+o).css("width",a*o+"em"),e.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,s){var n=e.dpDiv.outerWidth(),o=e.dpDiv.outerHeight(),r=e.input?e.input.outerWidth():0,a=e.input?e.input.outerHeight():0,l=document.documentElement.clientWidth+(s?0:t(document).scrollLeft()),h=document.documentElement.clientHeight+(s?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?n-r:0,i.left-=s&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=s&&i.top===e.input.offset().top+a?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>l&&l>n?Math.abs(i.left+n-l):0),i.top-=Math.min(i.top,i.top+o>h&&h>o?Math.abs(o+a):0),i},_findPos:function(e){for(var i,s=this._getInst(e),n=this._get(s,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[n?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,s,n,o,r=this._curInst;!r||e&&r!==t.data(e,"datepicker")||this._datepickerShowing&&(i=this._get(r,"showAnim"),s=this._get(r,"duration"),n=function(){t.datepicker._tidyDialog(r)},t.effects&&(t.effects.effect[i]||t.effects[i])?r.dpDiv.hide(i,t.datepicker._get(r,"showOptions"),s,n):r.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,o=this._get(r,"onClose"),o&&o.apply(r.input?r.input[0]:null,[r.input?r.input.val():"",r]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),s=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents("#"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest("."+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==s)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,s){var n=t(e),o=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(o,i+("M"===s?this._get(o,"showCurrentAtPos"):0),s),this._updateDatepicker(o))},_gotoToday:function(e){var i,s=t(e),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(e,i,s){var n=t(e),o=this._getInst(n[0]);o["selected"+("M"===s?"Month":"Year")]=o["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(n)},_selectDay:function(e,i,s,n){var o,r=t(e);t(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(r[0])||(o=this._getInst(r[0]),o.selectedDay=o.currentDay=t("a",n).html(),o.selectedMonth=o.currentMonth=i,o.selectedYear=o.currentYear=s,this._selectDate(e,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var s,n=t(e),o=this._getInst(n[0]);i=null!=i?i:this._formatDate(o),o.input&&o.input.val(i),this._updateAlternate(o),s=this._get(o,"onSelect"),s?s.apply(o.input?o.input[0]:null,[i,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var i,s,n,o=this._get(e,"altField");o&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),s=this._getDate(e),n=this.formatDate(i,s,this._getFormatConfig(e)),t(o).each(function(){t(this).val(n)}))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(e,i,s){if(null==e||null==i)throw"Invalid arguments";if(i="object"==typeof i?i.toString():i+"",""===i)return null;var n,o,r,a,l=0,h=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof h?h:(new Date).getFullYear()%100+parseInt(h,10),d=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,u=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,g=-1,m=-1,v=-1,y=-1,b=!1,w=function(t){var i=n+1<e.length&&e.charAt(n+1)===t;return i&&n++,i},_=function(t){var e=w(t),s="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,n="y"===t?s:1,o=new RegExp("^\\d{"+n+","+s+"}"),r=i.substring(l).match(o);if(!r)throw"Missing number at position "+l;return l+=r[0].length,parseInt(r[0],10)},x=function(e,s,n){var o=-1,r=t.map(w(e)?n:s,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(r,function(t,e){var s=e[1];return i.substr(l,s.length).toLowerCase()===s.toLowerCase()?(o=e[0],l+=s.length,!1):void 0}),-1!==o)return o+1;throw"Unknown name at position "+l},k=function(){if(i.charAt(l)!==e.charAt(n))throw"Unexpected literal at position "+l;l++};for(n=0;n<e.length;n++)if(b)"'"!==e.charAt(n)||w("'")?k():b=!1;else switch(e.charAt(n)){case"d":v=_("d");break;case"D":x("D",d,u);break;case"o":y=_("o");
break;case"m":m=_("m");break;case"M":m=x("M",p,f);break;case"y":g=_("y");break;case"@":a=new Date(_("@")),g=a.getFullYear(),m=a.getMonth()+1,v=a.getDate();break;case"!":a=new Date((_("!")-this._ticksTo1970)/1e4),g=a.getFullYear(),m=a.getMonth()+1,v=a.getDate();break;case"'":w("'")?k():b=!0;break;default:k()}if(l<i.length&&(r=i.substr(l),!/^\s+/.test(r)))throw"Extra/unparsed characters found in date: "+r;if(-1===g?g=(new Date).getFullYear():100>g&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c>=g?0:-100)),y>-1)for(m=1,v=y;;){if(o=this._getDaysInMonth(g,m-1),o>=v)break;m++,v-=o}if(a=this._daylightSavingAdjust(new Date(g,m-1,v)),a.getFullYear()!==g||a.getMonth()+1!==m||a.getDate()!==v)throw"Invalid date";return a},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(t,e,i){if(!e)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,r=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,a=(i?i.monthNames:null)||this._defaults.monthNames,l=function(e){var i=s+1<t.length&&t.charAt(s+1)===e;return i&&s++,i},h=function(t,e,i){var s=""+e;if(l(t))for(;s.length<i;)s="0"+s;return s},c=function(t,e,i,s){return l(t)?s[e]:i[e]},d="",u=!1;if(e)for(s=0;s<t.length;s++)if(u)"'"!==t.charAt(s)||l("'")?d+=t.charAt(s):u=!1;else switch(t.charAt(s)){case"d":d+=h("d",e.getDate(),2);break;case"D":d+=c("D",e.getDay(),n,o);break;case"o":d+=h("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=h("m",e.getMonth()+1,2);break;case"M":d+=c("M",e.getMonth(),r,a);break;case"y":d+=l("y")?e.getFullYear():(e.getYear()%100<10?"0":"")+e.getYear()%100;break;case"@":d+=e.getTime();break;case"!":d+=1e4*e.getTime()+this._ticksTo1970;break;case"'":l("'")?d+="'":u=!0;break;default:d+=t.charAt(s)}return d},_possibleChars:function(t){var e,i="",s=!1,n=function(i){var s=e+1<t.length&&t.charAt(e+1)===i;return s&&e++,s};for(e=0;e<t.length;e++)if(s)"'"!==t.charAt(e)||n("'")?i+=t.charAt(e):s=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),s=t.lastVal=t.input?t.input.val():null,n=this._getDefaultDate(t),o=n,r=this._getFormatConfig(t);try{o=this.parseDate(i,s,r)||n}catch(a){s=e?"":s}t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),t.currentDay=s?o.getDate():0,t.currentMonth=s?o.getMonth():0,t.currentYear=s?o.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,s){var n=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},o=function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,o=n.getFullYear(),r=n.getMonth(),a=n.getDate(),l=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,h=l.exec(i);h;){switch(h[2]||"d"){case"d":case"D":a+=parseInt(h[1],10);break;case"w":case"W":a+=7*parseInt(h[1],10);break;case"m":case"M":r+=parseInt(h[1],10),a=Math.min(a,t.datepicker._getDaysInMonth(o,r));break;case"y":case"Y":o+=parseInt(h[1],10),a=Math.min(a,t.datepicker._getDaysInMonth(o,r))}h=l.exec(i)}return new Date(o,r,a)},r=null==i||""===i?s:"string"==typeof i?o(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return r=r&&"Invalid Date"===r.toString()?s:r,r&&(r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)),this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var s=!e,n=t.selectedMonth,o=t.selectedYear,r=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=r.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=r.getMonth(),t.drawYear=t.selectedYear=t.currentYear=r.getFullYear(),n===t.selectedMonth&&o===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(s?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),s="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){t.datepicker._adjustDate(s,-i,"M")},next:function(){t.datepicker._adjustDate(s,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(s)},selectDay:function(){return t.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(s,this,"Y"),!1}};t(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,s,n,o,r,a,l,h,c,d,u,p,f,g,m,v,y,b,w,_,x,k,C,S,T,$,A,P,I,D,M,E,L,F,z,O,R,N,B=new Date,j=this._daylightSavingAdjust(new Date(B.getFullYear(),B.getMonth(),B.getDate())),U=this._get(t,"isRTL"),H=this._get(t,"showButtonPanel"),q=this._get(t,"hideIfNoPrevNext"),V=this._get(t,"navigationAsDateFormat"),W=this._getNumberOfMonths(t),G=this._get(t,"showCurrentAtPos"),Y=this._get(t,"stepMonths"),Z=1!==W[0]||1!==W[1],X=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),K=this._getMinMaxDate(t,"min"),J=this._getMinMaxDate(t,"max"),Q=t.drawMonth-G,te=t.drawYear;if(0>Q&&(Q+=12,te--),J)for(e=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-W[0]*W[1]+1,J.getDate())),e=K&&K>e?K:e;this._daylightSavingAdjust(new Date(te,Q,1))>e;)Q--,0>Q&&(Q=11,te--);for(t.drawMonth=Q,t.drawYear=te,i=this._get(t,"prevText"),i=V?this.formatDate(i,this._daylightSavingAdjust(new Date(te,Q-Y,1)),this._getFormatConfig(t)):i,s=this._canAdjustMonth(t,-1,te,Q)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+i+"</span></a>":q?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+i+"</span></a>",n=this._get(t,"nextText"),n=V?this.formatDate(n,this._daylightSavingAdjust(new Date(te,Q+Y,1)),this._getFormatConfig(t)):n,o=this._canAdjustMonth(t,1,te,Q)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+n+"</span></a>":q?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+n+"</span></a>",r=this._get(t,"currentText"),a=this._get(t,"gotoCurrent")&&t.currentDay?X:j,r=V?this.formatDate(r,a,this._getFormatConfig(t)):r,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",h=H?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?l:"")+(this._isInRange(t,a)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+r+"</button>":"")+(U?"":l)+"</div>":"",c=parseInt(this._get(t,"firstDay"),10),c=isNaN(c)?0:c,d=this._get(t,"showWeek"),u=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),g=this._get(t,"monthNamesShort"),m=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),y=this._get(t,"selectOtherMonths"),b=this._getDefaultDate(t),w="",x=0;x<W[0];x++){for(k="",this.maxRows=4,C=0;C<W[1];C++){if(S=this._daylightSavingAdjust(new Date(te,Q,t.selectedDay)),T=" ui-corner-all",$="",Z){if($+="<div class='ui-datepicker-group",W[1]>1)switch(C){case 0:$+=" ui-datepicker-group-first",T=" ui-corner-"+(U?"right":"left");break;case W[1]-1:$+=" ui-datepicker-group-last",T=" ui-corner-"+(U?"left":"right");break;default:$+=" ui-datepicker-group-middle",T=""}$+="'>"}for($+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+T+"'>"+(/all|left/.test(T)&&0===x?U?o:s:"")+(/all|right/.test(T)&&0===x?U?s:o:"")+this._generateMonthYearHeader(t,Q,te,K,J,x>0||C>0,f,g)+"</div><table class='ui-datepicker-calendar'><thead><tr>",A=d?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",_=0;7>_;_++)P=(_+c)%7,A+="<th scope='col'"+((_+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+u[P]+"'>"+p[P]+"</span></th>";for($+=A+"</tr></thead><tbody>",I=this._getDaysInMonth(te,Q),te===t.selectedYear&&Q===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,I)),D=(this._getFirstDayOfMonth(te,Q)-c+7)%7,M=Math.ceil((D+I)/7),E=Z?this.maxRows>M?this.maxRows:M:M,this.maxRows=E,L=this._daylightSavingAdjust(new Date(te,Q,1-D)),F=0;E>F;F++){for($+="<tr>",z=d?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(L)+"</td>":"",_=0;7>_;_++)O=m?m.apply(t.input?t.input[0]:null,[L]):[!0,""],R=L.getMonth()!==Q,N=R&&!y||!O[0]||K&&K>L||J&&L>J,z+="<td class='"+((_+c+6)%7>=5?" ui-datepicker-week-end":"")+(R?" ui-datepicker-other-month":"")+(L.getTime()===S.getTime()&&Q===t.selectedMonth&&t._keyEvent||b.getTime()===L.getTime()&&b.getTime()===S.getTime()?" "+this._dayOverClass:"")+(N?" "+this._unselectableClass+" ui-state-disabled":"")+(R&&!v?"":" "+O[1]+(L.getTime()===X.getTime()?" "+this._currentClass:"")+(L.getTime()===j.getTime()?" ui-datepicker-today":""))+"'"+(R&&!v||!O[2]?"":" title='"+O[2].replace(/'/g,"&#39;")+"'")+(N?"":" data-handler='selectDay' data-event='click' data-month='"+L.getMonth()+"' data-year='"+L.getFullYear()+"'")+">"+(R&&!v?"&#xa0;":N?"<span class='ui-state-default'>"+L.getDate()+"</span>":"<a class='ui-state-default"+(L.getTime()===j.getTime()?" ui-state-highlight":"")+(L.getTime()===X.getTime()?" ui-state-active":"")+(R?" ui-priority-secondary":"")+"' href='#'>"+L.getDate()+"</a>")+"</td>",L.setDate(L.getDate()+1),L=this._daylightSavingAdjust(L);$+=z+"</tr>"}Q++,Q>11&&(Q=0,te++),$+="</tbody></table>"+(Z?"</div>"+(W[0]>0&&C===W[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),k+=$}w+=k}return w+=h,t._keyEvent=!1,w},_generateMonthYearHeader:function(t,e,i,s,n,o,r,a){var l,h,c,d,u,p,f,g,m=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),y=this._get(t,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(o||!m)w+="<span class='ui-datepicker-month'>"+r[e]+"</span>";else{for(l=s&&s.getFullYear()===i,h=n&&n.getFullYear()===i,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;12>c;c++)(!l||c>=s.getMonth())&&(!h||c<=n.getMonth())&&(w+="<option value='"+c+"'"+(c===e?" selected='selected'":"")+">"+a[c]+"</option>");w+="</select>"}if(y||(b+=w+(!o&&m&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",o||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(d=this._get(t,"yearRange").split(":"),u=(new Date).getFullYear(),p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?u+parseInt(t,10):parseInt(t,10);return isNaN(e)?u:e},f=p(d[0]),g=Math.max(f,p(d[1]||"")),f=s?Math.max(f,s.getFullYear()):f,g=n?Math.min(g,n.getFullYear()):g,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";g>=f;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",b+=t.yearshtml,t.yearshtml=null}return b+=this._get(t,"yearSuffix"),y&&(b+=(!o&&m&&v?"":"&#xa0;")+w),b+="</div>"},_adjustInstDate:function(t,e,i){var s=t.drawYear+("Y"===i?e:0),n=t.drawMonth+("M"===i?e:0),o=Math.min(t.selectedDay,this._getDaysInMonth(s,n))+("D"===i?e:0),r=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(s,n,o)));t.selectedDay=r.getDate(),t.drawMonth=t.selectedMonth=r.getMonth(),t.drawYear=t.selectedYear=r.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),s=this._getMinMaxDate(t,"max"),n=i&&i>e?i:e;return s&&n>s?s:n},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,s){var n=this._getNumberOfMonths(t),o=this._daylightSavingAdjust(new Date(i,s+(0>e?e:n[0]*n[1]),1));return 0>e&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(t,o)},_isInRange:function(t,e){var i,s,n=this._getMinMaxDate(t,"min"),o=this._getMinMaxDate(t,"max"),r=null,a=null,l=this._get(t,"yearRange");return l&&(i=l.split(":"),s=(new Date).getFullYear(),r=parseInt(i[0],10),a=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(r+=s),i[1].match(/[+\-].*/)&&(a+=s)),(!n||e.getTime()>=n.getTime())&&(!o||e.getTime()<=o.getTime())&&(!r||e.getFullYear()>=r)&&(!a||e.getFullYear()<=a)},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,s){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var n=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(s,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),n,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).mousedown(t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new i,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.11.1",t.datepicker}),define("form/datepicker",["jquery","underscore","form/base-form-element","managers/routemanager","utils","libs/jqueryui/datepicker"],function(t,e,i,s,n){"use strict";var o=i.extend({el:".ui-date-picker",initialize:function(s){e.bindAll(this,"show","hide","onButtonClick","onCalendarDateSelect","setDate"),s.onSelect&&(s.customOnSelect=s.onSelect),s.onSelect=this.onCalendarDateSelect,this._setupDatePicker(this.$el,s),s=t.extend({calendarPanelClass:"ui-light",urlPath:this.$el.data("url-path")},s),s.buttonSelector&&(this.button=this._setupButton(s.buttonSelector)),this.body=n.get("body"),this.calendarPanel=this.body.find("#ui-datepicker-div"),this.calendarPanel.addClass(s.calendarPanelClass+" ui-date-picker-calendar-panel"),i.prototype.initialize.call(this,s)},onCalendarDateSelect:function(i,n){var o=this.options.urlPath,r=new Date(n.selectedYear,n.selectedMonth,n.selectedDay);if(o){if(-1!==o.indexOf("<%=")){var a=o.split("<%=");a.shift();for(var l={},h=0;h<a.length;h++){var c=a[h].match("[a-zA-Z]+")[0];l[c]=t.datepicker.formatDate(c,r)}o=e.template(o,l)}s.goTo(o)}this.options.customOnSelect&&this.options.customOnSelect(i,n)},setDate:function(e,i){e=i?t.datepicker.formatDate(i,e):t.datepicker.formatDate(this.options.dateFormat,e),this.$el.datepicker("setDate",e)},show:function(){this.$el.datepicker("show")},hide:function(){this.$el.datepicker("hide")},_setupDatePicker:function(t,e){t.datepicker(e)},_setupButton:function(i){var s=t(i);return s.on("click."+this.cid,e.bind(function(){this.onButtonClick()},this)),s},onButtonClick:function(){this.show(),this.options.onButtonClick&&this.options.onButtonClick(this.button,this.$el)},getType:function(){return"datepicker"},destroy:function(){this.button&&this.button.off("."+this.cid),this.$el.datepicker("destroy"),i.prototype.destroy.apply(this,arguments)}});return o}),define("form/base-form",["jquery","underscore","baseview","form/input-field","form/autocomplete","form/dropdown","form/checkbox","form/radio-button","form/datepicker"],function(t,e,i,s,n,o,r,a,l){"use strict";var h=i.extend({events:{submit:"onFormSubmit"},initialize:function(h){h=t.extend({formOptions:null},h),this.formNameMap={},i.prototype.initialize.call(this,h),this.$formItems=this.$(".ui-text-input, .ui-textarea, .ui-dropdown, .ui-radio, .ui-checkbox, .ui-date-picker"),this.$formItems.each(e.bind(function(e,i){var h,c=t(i);this.options.formOptions&&(h=this._getCustomOptions(c,this.options.formOptions)),!c.hasClass("ui-text-input")&&!c.hasClass("ui-textarea")||c.hasClass("ui-date-picker")?c.hasClass("ui-dropdown")?this._setupView(c,o,e,h):c.hasClass("ui-radio")?this._setupView(c,a,e,h):c.hasClass("ui-checkbox")?this._setupView(c,r,e,h):c.hasClass("ui-date-picker")&&this._setupView(c,l,e,h):c.data("autocomplete-url")||c.hasClass("ui-autocomplete")?this._setupView(c,n,e,h):this._setupView(c,s,e,h)},this)),this._setupRequiredFields()},_getCustomOptions:function(i,s){return t.isArray(s)||(s=[s]),e.filter(s,function(e){return i[0]===t(e.el)[0]?!0:!1})[0]},_setupRequiredFields:function(){e.each(this.subviews,function(t){t.isRequired()&&t.getUIElement().addClass("ui-form-field-required")})},getFormObjectsByName:function(t){return this.formNameMap[t]},_setupView:function(t,e,i,s){s||(s={el:t});var n="formItem"+i,o=t.attr("name");this.subviews[n]=new e(s),this.formNameMap[o]?this.formNameMap[o].push(this.subviews[n]):this.formNameMap[o]=[this.subviews[n]]},_handlePlaceholders:function(i){var s=[];t.each(i,function(e,i){var n=t(i),o=n.val();o===n.attr("placeholder")&&(s.push({field:n,value:o}),n.val(""))}),e.defer(function(){e.each(s,function(t){t.field.val(t.value)})})},onFormSubmit:function(){if(!Modernizr.input.placeholder){var t=this.$('[placeholder*=""]');t&&this._handlePlaceholders(t)}},resetForm:function(){this.reset()},reset:function(){this.triggerEvent("reset")}});return h}),define("modules/travel/tripology",["jquery","underscore","baseview","state","pubsub","form/base-form"],function(t,e,i,s,n,o){"use strict";var r=i.extend({el:".tripology-wrapper",events:{},initialize:function(t){e.bindAll(this,"departureSelect","arriveSelect"),i.prototype.initialize.call(this,t),this.$tripologyForm=this.$(".tripology-form"),this.departBoxName=this.$("#depart_loc"),this.departBoxID=this.$("#depart_loc_1"),this.destinationBoxName=this.$("#arrive_loc"),this.destinationBoxID=this.$("#arrive_loc_1"),this.pinfo=s.getActivePageInfo(),this.section=this.pinfo.section_name,this._setupForm(),this.$("form").submit(function(){n.trigger("uotrack","tripologysearch")})},_setupForm:function(){var i=[],s=this;i.push({el:t(".depart.tripology-auto"),resultDisplayTemplate:"<%= displayname %>",onSelect:s.departureSelect,maxResults:5,ajaxOptions:{dataType:"jsonp"},onParseResults:s.formatResults}),i.push({el:t(".arrive.tripology-auto"),resultDisplayTemplate:"<%= displayname %>",onSelect:s.arriveSelect,maxResults:5,ajaxOptions:{dataType:"jsonp"},onParseResults:s.formatResults}),this.$(".ui-date-picker").each(e.bind(function(e,s){var n=t(s),o=n.parent().find(".ui-date-picker-btn");i.push({el:n,buttonSelector:o,calendarPanelClass:"ui-light",changeMonth:!0,changeYear:!0,minDate:null,maxDate:null,showOtherMonths:!0,selectOtherMonths:!0,showMonthAfterYear:!0,dateFormat:"m/d/yy",dayNamesMin:["S","M","T","W","T","F","S"]})},this)),this.$tripologyForm.each(e.bind(function(e,s){this.subviews["form"+e]=new o({el:t(s),formOptions:i})},this)),this.$tripologyForm.submit(function(){return s.tripologyFormSubmit(),!1});var n=new Date,r=n.getMonth()+1+"/"+n.getDate()+"/"+n.getFullYear();this.$("#depart_date").val("Depart: "+r),this.$("#return_date").val("Return: "+r)},tripologyFormSubmit:function(){var e=(t(".tripology-form").serializeArray(),t(".tripology-form :input")),i={};e.each(function(){i[this.name]=t(this).val()});var s=i.departure_date.replace("Depart: ",""),n=i.return_date.replace("Return: ",""),o=new Date(s),r=new Date(n),a=Math.abs(r.getTime()-o.getTime()),l=Math.ceil(a/864e5),h="http://www.tripology.com/trip/step1/?",c=(i.departure_location_0,i.departure_location_1),d=(i.destination_0,i.destination_1),u=s,p=l||1,f=t("#flights_box").is(":checked"),g=t("#cruise_box").is(":checked"),m=t("#hotels_box").is(":checked"),v=t("#transportation_box").is(":checked"),y=t("#cars_box").is(":checked");c&&(h+="&departure_location_1="+c),d&&(h+="&destination_1="+d),u&&(h+="&departure_date="+u),p&&(h+="&duration="+p),f&&(h+="&flight=on"),g&&(h+="&cruise=on"),m&&(h+="&hotel=on"),(v||y)&&(h+="&transportation=on"),window.open(h)},formatResults:function(t){var i=[];return e.each(t,function(t){var e=t[0],s=t[1],n={displayname:e,id:s};i.push(n)}),i},departureSelect:function(t,e){this.departBoxName.val(e.displayname),this.departBoxID.val(e.id)},arriveSelect:function(t,e){this.destinationBoxName.val(e.displayname),this.destinationBoxID.val(e.id)}});return r}),define("modules/stories/utility-bar-flyout",["jquery","underscore","backbone","baseview","pubsub","utils","managers/routemanager","site-manager","modules/scroller/vertical-scroll"],function(t,e,i,s,n,o,r,a,l){var h=s.extend({events:{"click .util-bar-flyout-close-ribbon":"close",click:"onClickFlyout"},initialize:function(t){e.bindAll(this,"onBodyClick","onWindowResize"),this.$body=o.get("body"),this.$win=o.get("win"),this.$flyout=this.$(".util-bar-flyout"),this.pubSub=this.pubSub||{},this.pubSub["breakingbar:after:open"]=this.onWindowResize,s.prototype.initialize.call(this,t)},onWindowResize:function(){var t=this.getAvailableVerticalSpace();this.updateFlyoutHeight(t),this.options.noFlyoutScroll||this.updateFlyoutScroller()},getAvailableVerticalSpace:function(){var t=a.getHeader(),e=0;return t&&(e=t.getCollapsedHeight()),this.$win.height()-e},getContentHeight:function(){return this.$scrollableContent.outerHeight()},updateFlyoutHeight:function(t){this.$flyout.css("height",t)},updateFlyoutScroller:function(){this.subviews.vscroll?this.subviews.vscroll.refresh():this.subviews.vscroll=new l({el:this.$flyout})},open:function(t){this.$scrollableContent=this.$(".scrollable-content").eq(0),this.$(".util-bar-btn").removeClass("active"),this.$btn=this.$(t?".util-bar-btn-"+t:".util-bar-btn"),this.$btn.addClass("active"),this.$body.on("click."+this.cid,this.onBodyClick),this.$win.on("resize."+this.cid,e.throttle(this.onWindowResize,50)),this.$flyout.css({left:40,visibility:"visible"}).addClass("open"),t&&this.showSection("share"==t?"facebook":t),this.onWindowResize(),t&&n.trigger("uotrack","utilitybar"+t+"open")},close:function(){this.destroy()},onBodyClick:function(e){var i=t(e.target);i.hasClass("util-bar-noclose")||(!e.isDefaultPrevented()||r.isAjax(i.attr("href")))&&this.close()},onClickFlyout:function(e){var i=t(e.target);i.hasClass("util-bar-noclose")||i.closest("a").attr("href")||e.preventDefault()},destroy:function(t){this.$body.off("."+this.cid),this.$win.off("."+this.cid),this.$btn&&this.$btn.removeClass("active"),this.$flyout.css({left:"-1000px",visibility:"hidden"}).removeClass("open"),s.prototype.destroy.call(this,t),this.options.onDestroy&&this.options.onDestroy(this)}});return h}),define("modules/stories/utility-bar-module-firefly",["jquery","underscore","backbone","pubsub","third-party-apis/firefly/firefly","modules/stories/utility-bar-flyout","directAdPosition","state"],function(t,e,i,s,n,o,r,a){"use strict";var l=o.extend({messaging:{first:"Enjoy a limited number of articles over the next 30 days",last:"This is your last article!",tweener:" articles left",tweener_singular:" article left"},gps_tracking:{first:"CPPWFIRST",last:"CPPWSUBFIN",tweener:"CPPWSUB30",tweener_singular:"CPPWSUB1L"},initialize:function(i){i=t.extend({noFlyoutScroll:!0},i),e.bindAll(this,"fireflyFlyoutAdReady"),this.events=e.extend({},o.prototype.events,this.events),this.$title=this.$(".util-bar-flyout-firefly-title"),this.$subBtn=this.$(".util-bar-flyout-firefly-subscribe-btn"),this.$fireflyFlyoutAd=this.$(".util-bar-flyout-firefly-ad");var s=JSON.parse(this.$(".ubfmtitle").eq(0).html()||"{}")||{};this.messaging=t.extend(this.messaging,s),o.prototype.initialize.call(this,i),this._buildSpecialOffersFireflyFlyoutAd()},_buildSpecialOffersFireflyFlyoutAd:function(){this.subviews.fireflyFlyoutAd||(this.subviews.fireflyFlyoutAd=new r({el:this.$fireflyFlyoutAd,adSizes:[264,200],adPlacement:"consumer_sales-flyout",pageInfo:a.getActivePageInfo(),onAdReady:this.fireflyFlyoutAdReady}))},fireflyFlyoutAdReady:function(){this.$subBtn.addClass("hidden"),this.$fireflyFlyoutAd.removeClass("hidden"),this.subviews.fireflyFlyoutAd.showAd()},setTitle:function(t,e){this.$title.text(t),e?this.$title.addClass("util-bar-flyout-firefly-title-large"):this.$title.removeClass("util-bar-flyout-firefly-title-large")},setGPS:function(t){var e=this.$subBtn.attr("href");e=e.replace(/(gps-source)=.*/,"$1="+t),this.$subBtn.attr("href",e)},open:function(){s.trigger("uotrack","UtilityBarFireflyOpen");var t=n.getFireflyViewsCookie();if(t)if(1===t.viewCount)this.setTitle(this.messaging.first),this.setGPS(this.gps_tracking.first);else if(0===t.viewsRemaining)this.setTitle(this.messaging.last),this.setGPS(this.gps_tracking.last);else{var e=t.viewsRemaining>1?this.messaging.tweener:this.messaging.tweener_singular,i=t.viewsRemaining>1?this.gps_tracking.tweener:this.gps_tracking.tweener_singular;this.setTitle(t.viewsRemaining+e,!0),this.setGPS(i)}o.prototype.open.call(this)},close:function(){s.trigger("uotrack","UtilityBarFireflyClose"),this.destroy()}});return l}),define("modules/travel/shermans",["jquery","underscore","backbone","state","baseview"],function(t,e,i,s,n){"use strict";var o=n.extend({initialize:function(t){this.$dealsList=this.$(".shermans-deal-list"),this.$placeholder=this.$(".shermans-placeholder"),n.prototype.initialize.call(this,t),s.fetchData("http://api.deals.shermanstravel.com/v1/deals?consumer_key=8a3c1b45da1e6e8e919bd0d42d7a130e9bbaea645886122733bd7f23802f0b0c",{dataType:"jsonp"}).done(e.bind(function(t){this.displayDeals(t.deals)},this)).fail(e.bind(function(){this.$placeholder.html("No deals..")},this))},displayDeals:function(t){e.each(t,e.bind(function(t){t.title.length>45&&(t.title=t.title.slice(0,44)+"...");var e='<li><a href="'+t.url+'" target="_blank">'+t.title+"</a></li>";this.$dealsList.append(e)},this)),this.$placeholder.hide()}});return o}),define("modules/fronts/sidebar-poster-ad",["jquery","underscore","baseview","pubsub","state","sharedAdPosition","directAdPosition"],function(t,e,i,s,n,o,r){"use strict";var a=i.extend({initialize:function(s){e.bindAll(this,"onSidebarAdReady");var n=window.site_config.ADS.SIDEBAR_POSTER_AD||{},o=this.$el;this.layoutType=this._getLayoutType(),s=t.extend({adType:o.attr("data-ad-type")||n.TYPE||"sidebar",adPlacement:o.attr("data-ad-placement")||n.PLACEMENT||"poster_front",adSizes:o.attr("data-ad-sizes")||n.SIZES||"mediumrectangle,halfpage",isShared:n.IS_SHARED||!1},s),this.showOnlyWhenNoSidebar=!!o.closest(".show-only-when-no-sidebar").length,i.prototype.initialize.call(this,s)},_initAds:function(t){var e=this.options,i=e.adSizes;i&&(i=i.split(","));var s={el:this.$el,adPlacement:e.adPlacement,pageInfo:n.getActivePageInfo(),adSizes:i,onAdReady:this.onSidebarAdReady,adType:e.adType};this.subviews.sidebarAd?t&&(this.subviews.oldSidebarAd=this.subviews.sidebarAd,this.subviews.oldSidebarAd.$(".ad-slot").hide(),this.subviews.sidebarAd=new r(s)):e.isShared?(s.defaultPosition=!0,this.subviews.sidebarAd=new o(s)):this.subviews.sidebarAd=new r(s)},_getLayoutType:function(){var t=null;return this.options.layoutType&&(-1!==this.options.layoutType.indexOf("primary")?t="primary":"sidebar"===this.options.layoutType&&(t="sidebar")),t},onSidebarAdReady:function(){this.subviews.sidebarAd.showAd(),this.refreshSidebar()},refreshSidebar:function(){n.getActiveApp().triggerEvent("refreshSidebarScroll")},_onHideSidebarAd:function(){this.subviews.sidebarAd&&(this.options.isShared?(this.subviews.sidebarAd.destroy(!0),this.subviews.sidebarAd=!1):this.hide(),"sidebar"===this.layout&&(this.$(".sidebar-wrapper").css("top",0),this.refreshSidebar()))},onCardWidthChange:function(t){t.sidebarOpen?"primary"===this.layoutType?this.showOnlyWhenNoSidebar&&this._onHideSidebarAd():t.sidebarAds?this.options.isShared||(this.show(),this._initAds()):this._onHideSidebarAd():"sidebar"===this.layoutType?this._onHideSidebarAd():this.showOnlyWhenNoSidebar&&(this.show(),this._initAds())},renderCardInfo:function(t){this.renderFrontPosterAd(t)},renderFrontPosterAd:function(t,e){t.sidebarOpen?"primary"===this.layoutType?this.showOnlyWhenNoSidebar||this._initAds(e):t.sidebarAds&&this._initAds(e):"primary"===this.layoutType&&this._initAds(e)}});return a}),define("modules/travel/travel-guides",["jquery","underscore","baseview","state","utils","ui/generic-paginator","ui/dropdown"],function(t,e,i,s,n,o,r){var a=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){s=t.extend({transition:{interval:15e3}},s),e.bindAll(this,"automate","goTo"),this.subviews={},this.moveMe=t(this.$el).find(".travel-gdc-wrapper"),this.viewport=this.moveMe.parent(),this.slides=t(this.$el).find(".travel-gdc-slide"),this.moveMe.width(this.moveMe.width()*this.moveMe.children().length),this.subviews.dropdown=new r({el:this.$(".travel-gdc-list")}),this.slides.length>1&&(this.subviews.paginator=new o({el:t(this.$el).find(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer())),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(t){this.stoptimer(),i.prototype.destroy.call(this,t)},goTo:function(t){var e=this.viewport.outerWidth(),i=e*t;this.animate(this.moveMe,"left","-"+(i+1)+"px",450,"ease-in-out")},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return a}),define("modules/fronts/blog-promo",["jquery","underscore","baseview","state","utils","ui/generic-paginator","modules/fronts/featured-content"],function(t,e,i,s,n,o,r){"use strict";var a=i.extend({el:".blog-promo-module",events:{"click .blogs-show-all":"showAll","click .close-all-blogs":"showAll"},initialize:function(e){e=t.extend({transition:{interval:15e3},displayNum:4},e),i.prototype.initialize.call(this,e),this.$numberBlogs=this.$(".blog-promo-content-wrap").length,this.$numberBlogs>0?(this.$seeAllBtnWrap=this.$(".blogs-show-all-wrap"),this.$closeAllBtn=this.$(".promo-button-container"),this.$allBlogsContainer=this.$(".show-all-blogs"),this.$blogChangeContainerHeight=this.$(".inner-show-all-blogs").height()+80,this.subviews.featuredcontent=new r(e)):this.hide()
},showAll:function(){0===this.$allBlogsContainer.height()?(this.animate(this.$allBlogsContainer,"height",this.$blogChangeContainerHeight,350,"ease-in-out").done(e.bind(function(){this.$closeAllBtn.show()},this)),this.$seeAllBtnWrap.addClass("active")):(this.$closeAllBtn.hide(),this.animate(this.$allBlogsContainer,"height",0,350,"ease-in-out"),this.$seeAllBtnWrap.removeClass("active"))}});return a}),define("modules/sports/sports-countdown",["jquery","underscore","backbone","baseview"],function(t,e,i,s){var n=s.extend({initialize:function(){this.$countdown=this.$(".sports-countdown"),this.secondsInMinute=60,this.secondsInHour=60*this.secondsInMinute,this.secondsInDay=24*this.secondsInHour,this.startDate=this.$countdown.data("startdate")?new Date(this.$countdown.data("startdate")):new Date,this.endDate=this.$countdown.data("enddate")?new Date(this.$countdown.data("enddate")):this.startDate,this.endDate<this.startDate&&(this.endDate=this.startDate),this.dateDiffInSeconds=Math.ceil(.001*(this.endDate-this.startDate)),this.dateDiffInSeconds>0&&this.startCountdown()},startCountdown:function(){this.timer=setInterval(t.proxy(function(){this.dateDiffInSeconds=this.dateDiffInSeconds-1;var t=Math.floor(this.dateDiffInSeconds/this.secondsInDay),e=this.dateDiffInSeconds%this.secondsInDay,i=Math.floor(e/this.secondsInHour),s=e%this.secondsInHour,n=Math.floor(s/this.secondsInMinute),o=Math.ceil(s%this.secondsInMinute);return this.$countdown.find("#days").text(10>t?"0"+t:t),this.$countdown.find("#hours").text(10>i?"0"+i:i),this.$countdown.find("#minutes").text(10>n?"0"+n:n),this.$countdown.find("#seconds").text(10>o?"0"+o:o),this.dateDiffInSeconds<=0?void clearInterval(this.timer):void 0},this),1e3)}});return n}),define("modules/stories/expandable-photo",["jquery","underscore","baseview","modules/myCapture/myCapture"],function(t,e,i,s){var n=i.extend({events:{"click .expandable-collapsed":"expandPhoto","click .expandable-open":"collapsePhoto"},sized:!1,expandPhoto:function(){var t=this.$(".single-photo"),e=this.$(".image-credit-wrap");if(window.site_vars.THIRDPARTYAPI.MYCAPTURE.ENABLED&&!this.subviews.mycapture&&(this.subviews.mycapture=new s({el:this.$el})),this.subviews.mycapture&&t.find(".js-mycapture-btn-small").length&&this.subviews.mycapture.switchMyCaptureBtn(this),!this.sized){var i=this.$el.next();i.length?i.css("padding-top",this.$el.outerHeight()+20):this.$el.parent().height(this.$el.outerHeight()),this.$el.css("position","absolute"),this.sized=!0}e.hide(),t.animate({width:"540px"},350,function(){e.fadeIn(250)}),t.removeClass("expandable-collapsed").addClass("expandable-open")},collapsePhoto:function(i){if(!t(i.target).is(".js-mycapture-btn")){var s=this.$(".single-photo"),n=this.$(".image-credit-wrap");this.subviews.mycapture&&n.find(".js-mycapture-btn").length&&this.subviews.mycapture.switchMyCaptureBtn(this),n.hide(),s.removeClass("expandable-open"),s.animate({width:"180px"},350,e.bind(function(){n.fadeIn()},this)),s.removeClass("expandable-open").addClass("expandable-collapsed")}}});return n}),define("modules/partner/sponsor-logo-ad",["jquery","underscore","modules/partner/simple-ad"],function(t,e,i){"use strict";var s=i.extend({initialize:function(e){var s=this.$el;e=t.extend({adType:s.attr("data-ad-type")||"sponsor_logo_module",adPlacement:s.attr("data-ad-placement")||"sponsor_logo_module",adSizes:s.attr("data-ad-sizes")||"sponsor_logo_medium"},e),i.prototype.initialize.call(this,e),this._initAds()}});return s}),define("modules/travel/travel-dest-nav",["jquery","baseview","ui/dropdown"],function(t,e,i){"use strict";var s=e.extend({initialize:function(t){e.prototype.initialize.call(this,t),this.subviews.dropdown=new i({el:this.$(".tdn-list")})}});return s}),define("modules/ugc/ugc-base-view",["jquery","underscore","baseview","modules/ugc/ugc-user","pubsub"],function(t,e,i,s,n){"use strict";var o=i.extend({initialize:function(t){i.prototype.initialize.call(this,t),this.$views=this.$(".ugc-upload-form-view"),n.on("ugc:user:statuschange",function(){var t=this.getCurrentView();t&&(this.isViewProtected(t)&&this.revealView([]),this.revealView(t))},this)},revealView:function(e){var i=t(e);return e=i[0],i.hasClass("ugc-upload-form-view-login-required")?this._revealProtectedView(e):this._revealUnprotectedView(e)},_revealUnprotectedView:function(t){return this._transitionView(t)},_transitionView:function(e){var i=this.getCurrentView();return i===e?t.Deferred().resolve():(this.setCurrentView(e),this._handleRevealView(e,i))},setCurrentView:function(e){this._currentView=e,this.$views.removeClass("view-active"),t(e).addClass("view-active")},_revealProtectedView:function(i){var n=s.getUserInfo();return"rejected"===n.state()?t.Deferred().reject():n.then(e.bind(function(){return this._transitionView(i)},this))},_handleRevealView:function(e,i){var s=t(e),n=t(i);return n.hide(),s.show(),t.Deferred().resolve()},getCurrentView:function(){return this._currentView},isViewProtected:function(e){return t(e).hasClass("ugc-upload-form-view-login-required")},destroy:function(){this.revealView([]),n.off("ugc:user:statuschange"),i.prototype.destroy.call(this)}});return o}),define("form/input-file",["jquery","underscore","state","form/base-form-element"],function(t,e,i,s){"use strict";var n=s.extend({FILETYPE_MAP:{image:"bmp|jpg|jpeg|gif|png|tiff|tif",video:"quicktime|3g2|3gp|3gpp2|3gpp|asf|avi|dirac|dv|flav|flv|mkv|mov|mp4|m4a|mj2|mpg|mpeg|webm|ogg|ogv|x-ms-wmv"},el:".ui-input-file",events:{change:"_onFileSelection"},initialize:function(i){i=t.extend({onSelectFiles:null,uploadAjaxOptions:null,removeAjaxOptions:null,ajaxFileQueryKey:"file",iframeHiddenInputValueMap:null,iframeActionUploadUrl:null},i),s.prototype.initialize.call(this,i),e.bindAll(this,"getFiles"),this.setup(),this._fileMaps=[]},setup:function(){this.isAjaxUploadSupported()||this._setupIframe()},isAjaxUploadSupported:function(){return window.FormData&&window.File&&window.FileReader&&window.FileList&&!t("html").hasClass("lt-ie10")},getFiles:function(){return this._fileMaps},setFiles:function(t){return this._fileMaps=[],e.each(t,function(t){this._fileMaps.push(this._buildFileMap(t))},this),this._fileMaps},_buildFileMap:function(t){var i={file:t,fileId:this._getFileId(),upload:e.bind(function(){return this._uploadFile(i)},this),remove:e.bind(function(t){return this._removeFile(i,t)},this),abort:e.bind(function(){this._abortFileUpload(i)},this)};return i},_getFileId:function(){var t=1e3,e=9999;return Math.floor(Math.random()*(e-t+1))+t},_abortFileUpload:function(t){t.xhr&&t.xhr.abort()},_removeFile:function(t,e){return this._abortFileUpload(t),this._removeFileFromServer(t,e)},_removeFileFromServer:function(e,s){var n;return s=t.extend(!0,{},this.options.removeAjaxOptions,s),n=s&&this.isAjaxUploadSupported()?i.fetchData(null,s):t.Deferred().resolve(),n.promise()},_uploadFile:function(t){return this._abortFileUpload(t),this._uploadFileToServer(t)},_uploadFileToServer:function(i){var s=t.Deferred(),n=i.file;if(this.isAjaxUploadSupported()){if(!n)return console.log("unable to upload file: no file was specified."),s.reject();var o=e.bind(function(t){s.notify(t)},this);i.xhr=this.getUploadXhr(o);var r=this._getUploadRequestOptions(i);if(!r)return console.log("unable to upload file: no ajaxOptions were given."),s.reject();t.ajax(r).done(function(t){s.resolve(t)}).fail(function(){s.reject()})}else s=this._uploadUsingIframe();return s.promise()},_getUploadRequestOptions:function(e){var i=this.options.uploadAjaxOptions;if(i){var s=t.extend({type:"POST",xhr:function(){return e.xhr},processData:!1,contentType:!1,crossDomain:!0},i);return s.data=this.getFormData(e.file),s}return null},_onFileSelection:function(e){var i=t.makeArray(e.currentTarget.files),s=this.setFiles(i);this.options.onSelectFiles&&this.options.onSelectFiles(s)},_buildFileType:function(t){var i="",s=t.split("."),n=s[s.length-1],o=n.toLowerCase();return e.each(this.FILETYPE_MAP,function(t,e){-1!==t.indexOf(o)&&(i=e+"/"+o)}),i},getFormData:function(t){var i=new FormData,s=this.options.uploadAjaxOptions.data;return e.each(s,function(t,e){i.append(e,t)},this),i.append(this.options.ajaxFileQueryKey,t),i},getUploadXhr:function(t){var e=this.getXhr();return e.onprogress=t,e.upload&&(e.upload.onprogress=t),e.onloadend=t,e},getXhr:function(){return new XMLHttpRequest},resetPromises:function(){this._fileMaps.length&&(e.each(this._fileMaps,function(t){t.abort()},this),this._fileMaps=[])},reset:function(){return this.$el.val(""),this.isAjaxUploadSupported()?(this.resetPromises(),t.Deferred().resolve()):this._resetIframe()},getType:function(){return"input-file"},_setupIframe:function(){this._$iframe||(this._$iframe=this._buildIframeHtml(),this.$el.parent().append(this._$iframe)),this._resetIframeUrl()},getIframeSrcUrl:function(){return window.site_static_url+"/html/ui_input_file_upload_iframe.html"},_resetIframeUrl:function(){var i=t.Deferred(),s=this.getIframeSrcUrl(),n=this._$iframe,o=this._$iframe.get(0),r=!0;return n.load(e.bind(function(){r&&(r=!1,this._setupIframeInputClickEvent(),i.resolve())},this)),o.src=s,i.promise()},_buildIframeHtml:function(){return t('<iframe class="ui-input-file-hidden-iframe" scrolling="no" allowtransparency="true"></iframe>')},_setupIframeInputClickEvent:function(){var t=this._$iframe.contents().find(".ui-input-file-hidden-iframe-file-input");t.length&&t.on("change."+this.cid,e.bind(function(t){this._onIframeFileSelection(t)},this))},_onIframeFileSelection:function(e){var i={type:this._buildFileType(t(e.currentTarget).val())},s=this.setFiles([i]);this.options.onSelectFiles&&this.options.onSelectFiles(s)},_setupIframeForm:function(i){var s=this.options.uploadAjaxOptions,n=t.extend({},s.data,this.options.iframeHiddenInputValueMap),o=this.options.iframeActionUploadUrl||s.url;i.attr("action",o),e.each(n,function(t,e){i.prepend('<input type="hidden" name="'+e+'" value="'+t+'" />')})},_uploadUsingIframe:function(){var i=this._$iframe.contents().find("form");return this._iframeUploadPromise=t.Deferred(),this._setupIframeForm(i),i.length?(this._$iframe.load(e.bind(function(e){if(!this._iframeUploadPromise||"pending"===this._iframeUploadPromise.state()){var i=e.currentTarget;try{{i.contentWindow.location.href}}catch(s){return console.error("unable to determine upload status: response url from iframe was not local"),this._iframeUploadPromise.reject(),void this._resetIframe()}var n=t(i).contents().find("body"),o=n.text();n.html(""),this._iframeUploadPromise.resolve(o)}},this)),this._submitIframeForm()):(console.log("unable to upload file: can't find targeted iframe fallback form element"),this._iframeUploadPromise.reject()),this._iframeUploadPromise},_submitIframeForm:function(){this._$iframe.contents().find("form").submit()},_resetIframe:function(){return this._resetIframeUrl()},destroy:function(t){this.reset().done(e.bind(function(){s.prototype.destroy.call(this,t)},this))}});return n}),define("modules/ugc/ugc-file-upload",["jquery","underscore","baseview","form/input-file","easing"],function(t,e,i,s){"use strict";var n=i.extend({FILE_CONFIG:{image:{allowedFormats:"bmp|jpg|jpeg|gif|png",maxSize:1e4,previewMaxSize:2e4},video:{allowedFormats:"quicktime|3g2|3gp|3gpp2|3gpp|asf|avi|dirac|dv|flav|flv|mkv|mov|mp4|m4a|mj2|mpg|mpeg|webm|ogg|ogv|x-ms-wmv",maxSize:25600,previewMaxSize:2e4}},PROGRESS_CLASSES:{done:"ugc-upload-file-done",fail:"ugc-upload-file-fail",pending:"ugc-upload-file-pending",queued:"ugc-upload-file-queued"},initialize:function(s){s=t.extend({sessionToken:null,onSelectFiles:null,onFileUploadSuccess:null,onFileUploadFail:null},s),i.prototype.initialize.call(this,s),e.bindAll(this,"_onSelectFiles","uploadFile","setFile","trashFile","getFile"),this.$removeBtn=this.$(".ugc-upload-file-thumb-remove"),this.$emptyContainer=this.$(".ugc-upload-file-thumb-empty"),this.$filePreviewContainer=this.$(".ugc-upload-file-preview-wrap"),this.$fileMediaPreviewWrap=this.$(".ugc-upload-file-media-preview-wrap"),this.$progressText=this.$(".ugc-upload-file-progress-text"),this.$errorWrap=this.$(".ugc-upload-file-thumb-error-wrap"),this.$errorText=this.$(".ugc-upload-file-thumb-error-text"),window.site_config.THIRDPARTYAPI.FILEMOBILE&&(this.FM_SITE_CONFIG=window.site_config.THIRDPARTYAPI.FILEMOBILE,this.SERVICES_ENDPOINT=this.FM_SITE_CONFIG.SERVICES_ENDPOINT,this.VHOST=this.FM_SITE_CONFIG.VHOST),this.setup()},setup:function(){var t=this.getUploadAjaxOptions(),e=this.getRemoveUploadAjaxOptions(),i=this.getIframeHiddenValueMap();this.subviews.inputFileUpload||(this.subviews.inputFileUpload=new s({el:this.$(".ugc-upload-file-input"),onSelectFiles:this._onSelectFiles,maxUploads:6,uploadAjaxOptions:t,removeAjaxOptions:e,iframeHiddenInputValueMap:i}))},_onSelectFiles:function(t){this.isProgressiveUpload()?this.options.onSelectFiles&&this.options.onSelectFiles(t):this.onIframeFileSelection(t)},getIframeHiddenValueMap:function(){return{hidden:"HIDDEN",vhost:this.VHOST,sessiontoken:this.getSessionToken(),redirect:window.location.protocol+"//"+window.location.host+"/yourtake/upload/response/"}},getUploadAjaxOptions:function(){return{url:this.SERVICES_ENDPOINT+"upload2?json",type:"POST",crossDomain:!0,data:{sessiontoken:this.getSessionToken(),hidden:"HIDDEN",vhost:this.VHOST}}},getRemoveUploadAjaxOptions:function(){return{url:this.SERVICES_ENDPOINT+"json",type:"POST",crossDomain:!0,data:{vhost:this.VHOST,sessiontoken:this.getSessionToken(),method:"media.trashFile"}}},onIframeFileSelection:function(t){this.setFile(t[0]),this.uploadFile()},_getHtmlElementAttributes:function(i,s){var n=t.Deferred(),o=this.getFileSourceUrl(s);if(!o||!i)return n.reject();var r=i.tagName.toLowerCase();return"video"===r?this.isLoadedMetadataSupported(s.type)?(t(i).one("loadedmetadata",e.bind(function(t){n.resolve(t.target)},this)),t(i).on("error",function(){n.resolve(i)})):n.resolve(i):"img"===r&&(i.onload=e.bind(function(){n.resolve(i)},this),t(i).on("error",function(){n.reject()})),i.src=o,n.promise()},_getHtmlElementTag:function(t){var e,i=this.getFileTypeKey(t);return"video"===i?e=document.createElement("video"):"image"===i&&(e=document.createElement("img")),e},isLoadedMetadataSupported:function(t){var e="video/(3g2|3gp|x-ms-wmv)",i="video/(ogg|webm)",s=new RegExp(e,"gi"),n=new RegExp(i,"gi");return"Mozilla"===navigator.appCodeName?!t.match(s)&&!!t.match(n):!t.match(s)},_buildPreviewMediaElement:function(i){var s=t.Deferred();return this._elementAttrMapPromise.always(e.bind(function(){var e,n=t(i.getHtmlElement()),o=i.isPreviewable(),r=this.getFileTypeKey(i.file.type);n.length&&o?(e="ugc-upload-file-media-preview",n.addClass(e+"-"+this.getElementOrientation(n))):(n=t("<div>"),e="ugc-upload-file-media-no-preview"),"video"===n[0].tagName.toLowerCase()&&n.prop({autoplay:"true",muted:"true",loop:"true"}),n.addClass(e),n.addClass(e+"-"+r),s.resolve(n)},this)),s.promise()},getElementOrientation:function(e){e=t(e)[0];var i=e.videoWidth||e.width,s=e.videoHeight||e.height;return i>s?"landscape":"portrait"},getFile:function(){return this._fileMap?this._fileMap.file:""},getFileMap:function(){return this._fileMap},getInputFileMap:function(){return this._inputFileMap},updateFile:function(e){return t.extend(this._fileMap.file,e)},_buildFileMap:function(t){this._inputFileMap=t;var i=t.file,s=this._getHtmlElementTag(i.type),n=this.isPreviewable(i),o={file:i,fileId:t.fileId,isPreviewable:function(){return n},getHtmlElement:function(){return s}};return this._elementAttrMapPromise=this._getHtmlElementAttributes(s,i).done(e.bind(function(t){s=t},this)),o},setFile:function(t){this._fileMap=this._buildFileMap(t),this.$emptyContainer.hide(),this.$el.removeClass("ugc-upload-file-thumb-inactive"),this.$el.addClass(this._getProgressTypeClass()),this.$removeBtn.show(),this.setProgressClass(this.PROGRESS_CLASSES.queued),this.isFileTypeAllowed()||this.showError(this.getFileTypeNotAllowedMessage()),this.isFileSizeAllowed()||this.showError(this.getFileSizeNotAllowedMessage())},getFileTypeKey:function(t){return t?t.split("/")[0]:""},getFileFormatKey:function(t){return t?t.split("/")[1]:""},setupProgressHandling:function(){this.$filePreviewContainer.show(),this.setProgressClass(this.PROGRESS_CLASSES.pending),this.$fileMediaPreviewWrap.css("width",0),this.isProgressiveUpload()?this.$progressText.text("0%"):this.$fileMediaPreviewWrap.css("width","100%"),this.$fileMediaPreviewWrap.show(),this._setupProgressText(),this.isProgressiveUpload()||this.$progressText.text("Uploading your file")},uploadFile:function(){return this.isFileValid()?(this._fileUploadPromise&&"pending"===this._fileUploadPromise.state()||(this._fileUploadPromise=t.Deferred(),this._buildPreviewMediaElement(this._fileMap).done(e.bind(function(t){this.$fileMediaPreviewWrap.html(t),this.setupProgressHandling(),this.getInputFileMap().upload().progress(e.bind(function(t){var e=this.getProgressPercentage(t);this.onUploadFileProgress(e),this._fileUploadPromise.notify(e)},this)).done(e.bind(function(t){var e=this.updateFile(this.parseNewFileData(t)),i=this.getFileMap();this.setUploadSuccess(),this._fileUploadPromise.resolve(e,i),this.options.onFileUploadSuccess&&this.options.onFileUploadSuccess(e,i)},this)).fail(e.bind(function(){var t=this.getUploadFailureMessage(),e=this.getFileMap(),i=e.file;this.setUploadFail(t),this._fileUploadPromise.reject(t,i,e),this.options.onFileUploadFail&&this.options.onFileUploadFail(t,i,e)},this))},this))),this._fileUploadPromise.promise()):(this._fileUploadPromise=t.Deferred().reject(this.getFileTypeNotAllowedMessage(),this.getFile(),this.getFileMap()),this._fileUploadPromise)},getUploadFailureMessage:function(){return"something went wrong"},_setupProgressText:function(){this.isProgressiveUpload()&&this.$progressText.addClass("ugc-upload-file-progress-percentage-text")},isProgressiveUpload:function(){return this.isPreviewableBrowser()},_getProgressTypeClass:function(){return this._progressTypeClass||(this._progressTypeClass=this.isProgressiveUpload()?"ugc-progressive-upload":"ugc-nonprogressive-upload"),this._progressTypeClass},setProgressClass:function(t){this.removeProgressClasses(),this.$filePreviewContainer.addClass(t)},removeProgressClasses:function(){var t="";e.each(this.PROGRESS_CLASSES,function(e){t+=e+" "}),this.$filePreviewContainer.removeClass(t)},trashFile:function(){var t,e=this.getFile(),i=this.getInputFileMap();e&&e.id&&(t={data:{id:e.id}}),i&&i.remove(t)},isFileValid:function(){return!this._isInvalid},getFileSizeNotAllowedMessage:function(){return"That file is too big"},getFileTypeNotAllowedMessage:function(){var t="that file type",e=this.getFile();return e&&(t=this.getFileFormatKey(e.type)+" files"),"We don't allow "+t},getSessionToken:function(){return this.options.sessionToken},isFileTypeAllowed:function(){var t=this.getFile(),e=t.type,i=this.getFileConfig(this.getFileTypeKey(e));if(i){var s=new RegExp(this.getAllowedFileFormats(e),"gi");return t.type.match(s)}return!e},getAllowedFileFormats:function(t){var e,i=this.getFileConfig(this.getFileTypeKey(t));return i&&(e=i.allowedFormats),e},isFileSizeAllowed:function(){var t,e=this.getFile(),i=e.type,s=e.size,n=this.getFileTypeKey(i);return s?this.getFileConfig(n)?(t=this.getMaxFileSize(i),t>s/1024):!0:!0},getFileConfig:function(t){return this.FILE_CONFIG[t]},getMaxFileSize:function(t){var e,i=this.getFileConfig(this.getFileTypeKey(t));return i&&(e=i.maxSize),e},isPreviewable:function(t){var e,i=t.type,s=this.getFileTypeKey(i);return"video"===s?e=this.isPreviewableVideo(i)&&this.isPreviewableFileAcceptableSize(t):"image"===s&&(e=!0),e&&this.isPreviewableBrowser()},isPreviewableBrowser:function(){return this.subviews.inputFileUpload.isAjaxUploadSupported()?!0:!1},isPreviewableFileAcceptableSize:function(t){var e,i=this.getFileConfig(this.getFileTypeKey(t.type));return i?(e=i.previewMaxSize,t.size/1024<e):!0},isPreviewableVideo:function(t){var e=t.split("/")[1];return"probably"===Modernizr.video[e]},getFileSourceUrl:function(t){return window.URL=window.URL||window.webkitURL,window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(t):""},onUploadFileProgress:function(t){var e=t+"%";this.$fileMediaPreviewWrap.animate({width:e},{duration:400,easing:"linear",queue:!1}),this.$progressText.text(e)},getProgressPercentage:function(t){return Math.floor(t.loaded/t.total*100)},parseNewFileData:function(t){t=this.parseToJSON(t);var e;if(t.mf_status){var i=parseInt(t.mf_status,10),s=parseInt(t.mf_mid,10);if(1!==i)return this.onUploadFileFail("file upload failed"),"";e={id:s}}else e=t.files[0];return e},parseToJSON:function(e){return"string"===t.type(e)&&(e=e.substr(e.indexOf("{"))),JSON.parse(e)},setUploadSuccess:function(){this.setProgressClass(this.PROGRESS_CLASSES.done),this.$fileMediaPreviewWrap.css("width","100%"),this.$progressText.empty()},showError:function(t){this.$errorWrap.addClass("active"),this.$errorText.text(t),this.$filePreviewContainer.hide(),this._isInvalid=!0},setUploadFail:function(t){this.setProgressClass(this.PROGRESS_CLASSES.fail),this.$progressText.empty(),this.showError(t)},reset:function(){this.$filePreviewContainer.hide(),this.$el.removeClass(this._getProgressTypeClass()),this.$el.addClass("ugc-upload-file-thumb-inactive"),this.$fileMediaPreviewWrap.css("width",0),this.$fileMediaPreviewWrap.hide(),this.$fileMediaPreviewWrap.empty(),this.$progressText.removeClass("ugc-upload-file-progress-percentage-text"),this.$progressText.empty(),this.removeProgressClasses(),this.$emptyContainer.show(),this.$removeBtn.hide(),this.$errorWrap.removeClass("active"),this.$errorText.empty(),this._fileMap=null,this._inputFileMap=null,this._fileUploadPromise=null,this._elementAttrMapPromise=null,this._isInvalid=null,this.subviews.inputFileUpload.reset()},destroy:function(){this.reset(),i.prototype.destroy.call(this,!1)}});return n}),define("modules/ugc/ugc-base-upload-form",["jquery","underscore","baseview","state","modules/ugc/ugc-file-upload","form/base-form","managers/cachemanager"],function(t,e,i,s,n,o,r){"use strict";var a=i.extend({el:".ugc-upload-form",events:{submit:"onSubmit","blur .ugc-upload-location-input":"onLocationFieldBlur","click .ugc-upload-file-thumb-remove":"onClickThumbRemove","focus .ugc-upload-description-input, .ugc-upload-title-input":"onInputFieldFocus","blur .ugc-upload-description-input, .ugc-upload-title-input":"onInputFieldBlur"},initialize:function(n){n=t.extend({onSubmitSuccess:null,onSubmitFail:null,onSubmitInvalidForm:null,onUploadLocationChange:null,onFileUploadSuccess:null,onFileUploadFail:null,onFileRemove:null,userInfo:null},n),e.bindAll(this,"submit","parseVenuesForAutocomplete","_onSelectAutoCompleteLocationResult","onFileSelection","onDescInputFieldCharChange","onTitleInputFieldCharChange","onFileUploadSuccess","onFileUploadFail"),i.prototype.initialize.call(this,n),this.$postTitleInput=this.$(".ugc-upload-title-input"),this.$postTitleInputCharCounter=this.$(".ugc-upload-title-field-char-counter"),this.$postDescInput=this.$(".ugc-upload-description-input"),this.$postDescInputCharCounter=this.$(".ugc-upload-description-field-char-counter"),this.$locationInput=this.$(".ugc-upload-location-input"),this.$submitBtn=this.$(".ugc-upload-submit-btn"),this.$topicIdInput=this.$(".ugc-front-topic-id-input"),this.formItemErrorClass="ui-form-field-error",this.$successUploadedFileWrappers=this.$(".ugc-upload-success-file"),this.$thumbs=this.$(".ugc-upload-file-thumb"),this.pageInfo=s.getActivePageInfo(),this.setupForm()},setupForm:function(){this.subviews.form||(this.subviews.form=new o({el:this.$el,formOptions:[{el:this.$locationInput,maxResults:7,ajaxOptions:this.getFormAutoCompleteAjaxOptions(),resultDisplayTemplate:this.getFormValueTemplate(),resultValueTemplate:this.getFormValueTemplate(),onParseResults:this.parseVenuesForAutocomplete,onSelect:this._onSelectAutoCompleteLocationResult},{el:this.$postDescInput,onValueChange:this.onDescInputFieldCharChange},{el:this.$postTitleInput,onValueChange:this.onTitleInputFieldCharChange}]})),this.setupFileUploads(),this.setupRequiredFields(),this.$successUploadedFileWrappers.addClass("ugc-upload-success-file-empty")},onDescInputFieldCharChange:function(t){this.$postDescInputCharCounter.html(t.length)},onTitleInputFieldCharChange:function(t){this.$postTitleInputCharCounter.html(t.length)},onInputFieldFocus:function(e){t(e.currentTarget).hasClass("ugc-upload-description-input")?this.$postDescInputCharCounter.show():this.$postTitleInputCharCounter.show()},onInputFieldBlur:function(e){t(e.currentTarget).hasClass("ugc-upload-description-input")?this.$postDescInputCharCounter.hide():this.$postTitleInputCharCounter.hide()},setupFileUploads:function(){this._fileUploadSubviews=[],e.each(this.$thumbs,function(e,i){var s=new n({el:t(e),sessionToken:this.options.userInfo.sessiontoken,onSelectFiles:this.onFileSelection,onFileUploadSuccess:this.onFileUploadSuccess,onFileUploadFail:this.onFileUploadFail});this.subviews["fileUpload"+i]=s,this._fileUploadSubviews.push(s)},this)},onFileSelection:function(t){var i=this.$thumbs.length,s=this.getFiles().length,n=Math.min(i-s,t.length),o=t.slice(0,n);o.length&&e.each(o,function(t){this.addUpload(t)},this)},addUpload:function(t){var i=this.$thumbs.filter(".ugc-upload-file-thumb-inactive").first(),s=this.$thumbs.index(i),n=this._fileUploadSubviews[s];n.setFile(t),n.isFileValid()&&this._addToUploadQueue(e.bind(function(){return n.uploadFile()},this))},_addToUploadQueue:function(e){this._queuedUploadPromises=this._queuedUploadPromises||[];var i=t.Deferred();t.when.apply(this,this._queuedUploadPromises).always(function(){e().progress(function(t){t>95&&i.resolve()}).done(function(){i.resolve()})}),this._queuedUploadPromises.push(i.promise())},onClickThumbRemove:function(e){var i=t(e.currentTarget),s=i.closest(".ugc-upload-file-thumb"),n=this.$thumbs.index(s);this.removeUpload(n)},removeUpload:function(t){var e=this.subviews["fileUpload"+t],i=e.getFileMap();"submitSuccess"!==this.getSubmitStatus()&&e.trashFile(),e.reset(),this._showHideSubmitButton(),this.options.onFileRemove&&this.options.onFileRemove(i.file,i)},resetFileUploads:function(){e.each(this._fileUploadSubviews,function(t,e){t.getFile()&&this.removeUpload(e)},this)},getFormValueTemplate:function(){return"<%= name %><% if (location.address) { %> - <%= location.address %><% } %><% if (location.city) { %>, <%= location.city %><% } %><% if (location.state) { %>, <%= location.state %><% } %>"},getFormAutoCompleteAjaxOptions:function(){var t=this.getUploadLocation(),e="";return t&&(e=t.latitude+","+t.longitude),{url:"/api/foursquare/venues/search",dataType:"jsonp",data:{v:"20130319",intent:"global",limit:20,ll:e}}},setupRequiredFields:function(){var i=this.$(".ui-form-field-required");e.each(i,function(e){t(e).parent().addClass("required")},this)},onLocationFieldBlur:function(){this.setUploadLocation(this.getUploadLocation())},updateLocationFieldAutoCompleteParams:function(t){var e=this.$locationInput.attr("name");if(this.subviews.form&&e){var i=this.subviews.form.getFormObjectsByName(e)[0],s={ll:t.latitude+","+t.longitude};i.updateAjaxOptions({data:s})}},_onSelectAutoCompleteLocationResult:function(t,e){var i=e.location,s={latitude:i.lat,longitude:i.lng,city:i.city,state:i.state,country:i.cc,venue:t};this.setUploadLocation(s)},parseVenuesForAutocomplete:function(t){var e;return t.response&&t.response.venues&&t.response.venues.length>0&&(e=t.response.venues),e},getUploadLocation:function(){return r.getValue(this.getUploadLocationLookupKey())||this.getDefaultUploadLocation()},getDefaultUploadLocation:function(){return{latitude:37.9,longitude:-95}},getUploadLocationLookupKey:function(){return"ugcUploadLocation"},setUploadLocation:function(t){this.updateLocationFieldAutoCompleteParams(t),this.setUploadLocationField(t),r.setValue(this.getUploadLocationLookupKey(),t),this.options.onUploadLocationChange&&this.options.onUploadLocationChange(t)},resetUploadLocation:function(){r.clearValue(this.getUploadLocationLookupKey()),this.options.onUploadLocationChange&&this.options.onUploadLocationChange()},setUploadLocationField:function(t){var e="";t&&(t.venue?e=t.venue:t.city&&t.state&&(e=t.city+", "+t.state)),this.$locationInput.val(e)},_showHideSubmitButton:function(){var t=this.getUploadedFiles();t.length?this.$submitBtn.removeClass("ugc-upload-submit-btn-disabled"):this.$submitBtn.addClass("ugc-upload-submit-btn-disabled")},getUploadedFiles:function(){var t=[];return e.each(this._fileUploadSubviews,function(e){var i=e.getFile();i&&e.isFileValid()&&t.push(i)}),t},getFiles:function(){var t=[];return e.each(this._fileUploadSubviews,function(e){var i=e.getFile();i&&t.push(i)},this),t},onFileUploadSuccess:function(t,e){this._showHideSubmitButton(),this.options.onFileUploadSuccess&&this.options.onFileUploadSuccess(t,e)},onFileUploadFail:function(t,e,i){e&&(e.error=!0),this._showHideSubmitButton(),this.options.onFileUploadFail&&this.options.onFileUploadFail(t,e,i)},onSubmit:function(t){t.preventDefault(),this.submit()},isSubmitDisabled:function(){return this.$submitBtn.hasClass("ugc-upload-submit-btn-disabled")},submit:function(){if("submitPending"!==this.getSubmitStatus()&&!this.isSubmitDisabled()){if(!this.validateForm())return void(this.options.onSubmitInvalidForm&&this.options.onSubmitInvalidForm());this.$submitBtn.addClass("ugc-upload-submit-btn-sending");var t=this.getFormSubmitData();this._formSubmitPromise=this.sendFormDataToServer(t).done(e.bind(function(t){this._onSubmitSuccess(t)},this)).fail(e.bind(function(){this._onSubmitFail()},this)),this._formSubmitPromise.always(e.bind(function(){this.$submitBtn.removeClass("ugc-upload-submit-btn-sending")},this))}},getSubmitStatus:function(){return this._formSubmitPromise?"rejected"===this._formSubmitPromise.state()?"submitFailed":"pending"===this._formSubmitPromise.state()?"submitPending":"submitSuccess":"notSubmitted"},_onSubmitSuccess:function(t){this.options.onSubmitSuccess&&this.options.onSubmitSuccess(t)},_onSubmitFail:function(){this.options.onSubmitFail&&this.options.onSubmitFail()},sendFormDataToServer:function(t){return s.fetchData(null,{url:"/yourtake/updatemedia/",type:"POST",data:t})},getFormSubmitData:function(){var t=this.pageInfo.basePageType,e=this.pageInfo.assetid,i={user:JSON.stringify(this.options.userInfo),parentgroupid:this.$topicIdInput.val(),mediaitems:JSON.stringify(this.getSubmitFiles()),post:JSON.stringify(this.getSubmitPostData()),type:t,ssts:this.pageInfo.ssts};return e&&(i.story=JSON.stringify(this.getSubmitStoryData())),i.vhost=window.site_config.THIRDPARTYAPI.FILEMOBILE.VHOST,i},getSubmitFiles:function(){return this.getUploadedFiles()},validateForm:function(){var t=!1,i=0;return this.getUploadedFiles().length?(e.each(this.subviews.form.formNameMap,function(s){var n;e.each(s,function(t){n=this._validateFormItem(t)},this),0===i&&n&&(t=!0),!n&&t&&(t=!1),i++},this),t):!1},_validateFormItem:function(t){var e=t.getFormElement(),i=t.getUIElement(),s=e.val();return!e.hasClass("ui-form-field-required")||""!==s&&s!==t.placeholder?(i.removeClass(this.formItemErrorClass),!0):(i.addClass(this.formItemErrorClass),!1)},getSubmitPostData:function(){var e=this.getSubmitLocationData();return t.extend(e,{title:this.$postTitleInput.val(),description:this.$postDescInput.val(),tags:this.pageInfo.taxonomykeywords||""})},getSubmitStoryData:function(){var t=this.pageInfo;return{id:t.assetid,url:t.full_url||location.href,title:t.seotitle}},getSubmitLocationData:function(){var t=this.getUploadLocation();return t?{geo_latitude:t.latitude,geo_longitude:t.longitude,city:t.city,state:t.state,country:t.country,venue:t.venue}:{}},reset:function(){"submitPending"===this.getSubmitStatus()&&(this.$submitBtn.removeClass("ugc-upload-submit-btn-sending"),this._formSubmitPromise.abort()),this.subviews.form&&(e.each(this.subviews.form.formNameMap,function(t){e.each(t,function(t){t.getUIElement().removeClass(this.formItemErrorClass)},this)},this),this.subviews.form.reset()),this.resetFileUploads(),this.resetUploadLocation(),this._formSubmitPromise=null,this._queuedUploadPromises=null,this._showHideSubmitButton()}});return a}),define("third-party-apis/google/google-maps",["jquery","underscore","third-party-apis/google/google"],function(t,e,i){"use strict";
var s=i.extend({initialize:function(){i.prototype.initialize.call(this)},loadApi:function(){return this.loadGoogleApi("maps","3",{other_params:"sensor=false"})},getClientLocation:function(){var i=t.Deferred();return this.loadScript().done(e.bind(function(t){i.resolve(t.loader.ClientLocation)},this)),i.promise()},getGeolocation:function(i,s){var n=t.Deferred();return this.loadApi().done(e.bind(function(){var t={latLng:this._formatLatLng(i,s)};this.geocoder||(this.geocoder=new google.maps.Geocoder),this.geocoder.geocode(t,function(t){n.resolve(t)})},this)),n.promise()},_formatLatLng:function(t,e){return new google.maps.LatLng(t,e)},formatGeolocationResponse:function(t){t=t[0]||t;var e={};if(t){var i=t.formatted_address.split(", "),s=i[0],n=i[1],o=i[2].split(" "),r=o[0],a=o[1],l=i[3],h=t.geometry.location.lat()||"",c=t.geometry.location.lng()||"";e={latitude:h,longitude:c,city:n,state:r,country:l,address:s,postalCode:a}}return e}});return new s}),define("modules/ugc/ugc-base-upload-view",["jquery","underscore","modules/ugc/ugc-base-view","modules/ugc/ugc-base-upload-form","modules/ugc/ugc-user","third-party-apis/google/google-maps","state"],function(t,e,i,s,n,o,r){"use strict";var a=i.extend({initialize:function(s){s=t.extend({uploadFormOptions:{}},s),i.prototype.initialize.call(this,s),e.bindAll(this,"_onFileUploadSuccess","_onFileRemove"),this.$successUploadedFileWrappers=this.$(".ugc-upload-success-file"),this.$successUploadedFileWrappers.addClass("ugc-upload-success-file-empty"),r.stopRefreshTimer(),this.setupForm()},setupForm:function(){return n.getUserInfo().done(e.bind(function(e){var i=t.extend({},this._buildUploadFormOptions(),{userInfo:e});this.subviews.uploadForm||(this.subviews.uploadForm=new s(i))},this))},_buildUploadFormOptions:function(){return t.extend({},{el:this.$(".ugc-front-upload-form"),onFileUploadSuccess:this._onFileUploadSuccess,onFileRemove:this._onFileRemove},this.options.uploadFormOptions)},_onSubmitSuccess:function(){this.options.onSubmitSuccess&&this.options.onSubmitSuccess()},_onSubmitFail:function(){this.options.onSubmitFail&&this.options.onSubmitFail()},_onFileUploadSuccess:function(t,i){this._hasUploadLocationBeenSetByFile||this.getUploadLocationByFile(t).done(e.bind(function(t){this.getForm().setUploadLocation(t),this._hasUploadLocationBeenSetByFile=!0},this)),this.addFileToUploadSuccessMarkup(i)},getUploadLocationByFile:function(e){var i=e.geo_latitude,s=e.geo_longitude;return i&&s?this.getGeolocationByLatLon(i,s):t.Deferred().reject()},getGeolocationByLatLon:function(i,s){var n=t.Deferred();return o.getGeolocation(i,s).done(e.bind(function(t){var e=o.formatGeolocationResponse(t);n.resolve(e)},this)),n.promise()},_onFileRemove:function(t,e){this.removeFileFromUploadSuccessMarkup(e)},addFileToUploadSuccessMarkup:function(t){var e=t.fileId,i=this._buildUploadSuccessMediaElement(t),s=this.$successUploadedFileWrappers.filter(".ugc-upload-success-file-empty").eq(0);s.data("file-id",e),s.append(i),s.removeClass("ugc-upload-success-file-empty")},removeFileFromUploadSuccessMarkup:function(e){var i=this.$successUploadedFileWrappers.filter(function(){return t.data(this,"file-id")===e.fileId});this.removeFileDataFromUploadSuccessMarkup(i)},removeFileDataFromUploadSuccessMarkup:function(t){t.removeData("file-id"),t.empty(),t.addClass("ugc-upload-success-file-empty")},resetUploadSuccessMarkup:function(){e.each(this.$successUploadedFileWrappers,function(e){this.removeFileDataFromUploadSuccessMarkup(t(e))},this)},_buildUploadSuccessMediaElement:function(e){var i,s,n,o,r=e.getHtmlElement(),a=e.file,l=a.type.split("/")[0],h=e.isPreviewable(),c="ugc-upload-success-media";r&&(i=r.src,s=r.videoWidth||r.width,n=r.videoHeight||r.height);var d;d=t(h&&"video"===l?'<video src="'+i+'">':h&&"image"===l?'<img src="'+i+'">':"<div>"),s&&n&&h&&(o=s>n?"landscape":"portrait",d.addClass(c+"-"+o)),d.addClass(c),d.addClass(c+"-"+l);var u;return u=h?c+"-preview":c+"-no-preview",d.addClass(u),d},getForm:function(){return this.subviews.uploadForm},getFormSubmitStatus:function(){var t=this.getForm();return t?t.getSubmitStatus():"notSubmitted"},getDefaultUploadLocation:function(){return this.subviews.uploadForm?this.subviews.uploadForm.getDefaultUploadLocation():""},reset:function(){this.subviews.uploadForm&&this.subviews.uploadForm.reset(),this.resetUploadSuccessMarkup(),this._hasUploadLocationBeenSetByFile=!1},destroy:function(){r.startRefreshTimer(),i.prototype.destroy.call(this)}});return a}),define("modules/ugc/social-share-facebook",["jquery","underscore","utils","pubsub","baseview","third-party-apis/facebook/facebook"],function(t,e,i,s,n,o){"use strict";var r=n.extend({el:".social-share-modal-form-facebook",events:{"click .social-share-modal-btn-submit-facebook":"socialShareToFacebook","click .social-share-modal-form-submit-fail-try-again-link":"socialShareToFacebook","click .social-share-modal-view-post-link":"onClickPostLink"},initialize:function(i){i=t.extend({data:"",link:"",image:""},i),n.prototype.initialize.call(this,i),e.bindAll(this,"fbShareCallback"),this.setup()},setup:function(){var e=i.getNested(this.options.data,"post","description");this.title=i.getNested(this.options.data,"post","title")||"",this.$fbShareForm=t(".social-share-modal-form-facebook-container"),this.$successPane=t(".social-share-modal-form-submit-success"),this.$successPaneMessage=t(".social-share-modal-form-submit-success-text"),this.$failPane=t(".social-share-modal-form-submit-fail"),this.$loading=t(".social-share-modal-loading-facebook"),t(".social-share-modal-form-facebook-summary-title").html(this.title),t(".social-share-modal-form-facebook-summary-description").html(e),t(".social-share-modal-form-facebook-overview-image").attr("src",this.options.image)},hideConfirmationPane:function(){this.$successPane.hide(),this.$failPane.hide()},showFacebookShareForm:function(){this.$loading.hide(),this.$el.show(),this.$fbShareForm.show()},socialShareToFacebook:function(){this.$loading.show();var t={method:"feed",link:this.options.link,name:this.title};o.loadScript().done(e.bind(function(e){e.ui(t,this.fbShareCallback)},this))},fbShareCallback:function(t){t&&t.post_id?this._onShareSuccess(t.post_id):this._onShareFail()},onClickPostLink:function(e){e.preventDefault();var s=t(e.target).attr("href");i.openPopup(s,1e3,600)},_onShareSuccess:function(t){var e="https://www.facebook.com/"+t.replace("_","/posts/");this.$successPaneMessage.html('A link has been posted to your Facebook feed. <a class="social-share-modal-view-post-link" href="'+e+'">View the post.</a>'),this.$fbShareForm.hide(),this.$failPane.hide(),this.$successPane.show(),s.trigger("uotrack","yourtakefacebook")},_onShareFail:function(){this.$fbShareForm.hide(),this.$loading.hide(),this.$failPane.show()}});return r}),define("modules/stories/share-email",["jquery","underscore","backbone","pubsub","baseview","state","utils","form/input-field"],function(t,e,i,s,n,o,r,a){var l=n.extend({events:{"submit .js-share-email-form":"onSubmitEmailForm","click .recaptcha_option":"onRecaptcha","click .js-share-email-cancel-btn":"onClickCancelBtn","click .js-share-email-send-btn":"onClickSendBtn"},initialize:function(i){i=t.extend({uotrackName:"UtilityBarShareEmail",message:""},i),e.bindAll(this,"initInputs"),this.subviews={},this.initInputs(),this.$emailForm=this.$(".js-share-email-form"),this.$emailFormContainer=this.$(".js-share-email-form-container"),this.$successPane=this.$(".js-share-email-form-success-pane"),this.$shareTextarea=this.$(".js-share-email-form-textarea"),this.$shareTextareaOldVal=this.$shareTextarea.val(),this.setRecaptcha(),this.$emailForm.length&&r.requireSingleUseScript("http://www.google.com/recaptcha/api/challenge?k=6Lf7fuESAAAAAJ3_KMIDbkQySsEE0vMkLXUkq4eY").done(e.delay(this.initInputs,300)),n.prototype.initialize.call(this,i)},initInputs:function(){this.$inputs=this.$(".ui-text-input"),e.each(this.$inputs,function(t,e){this.subviews["input"+e]&&this.subviews["input"+e].destroy(),this.subviews["input"+e]=new a({el:t})},this)},setRecaptcha:function(){t(".recaptcha_widget").remove();var e=t("#recaptcha_widget").html();this.$(".js-email-form-recaptcha-widget").html(e),"modalEmailForm"===this.$el.attr("id")&&t("#recaptcha_response_field").addClass("ui-light")},onClickSendBtn:function(){this.$emailForm.trigger("submit")},onSubmitEmailForm:function(i){i.preventDefault();var s=this.$("#recaptcha_response_field");this.isValid(this.$emailForm)&&t.ajax({type:"POST",url:this.$emailForm.attr("action"),data:this.$emailForm.serialize()}).done(e.bind(function(){this.onSuccessfulSubmission()},this)).fail(e.bind(function(){s.addClass("error"),window.Recaptcha.reload()},this))},onSuccessfulSubmission:function(){this.showSuccessPane(),this.triggerEvent("clearInputValue"),this.reloadRecaptcha(),s.trigger("uotrack",this.options.uotrackName)},showSuccessPane:function(){this.hideEmailForm(),this.$successPane.show()},showEmailForm:function(){this.hideConfirmationPane(),this.setupShareText(),this.$el.show(),this.$emailFormContainer.show()},setupShareText:function(){this.$shareTextarea.val(this.options.message+"\n"+this.options.postLink+"\n\n"+this.$shareTextareaOldVal),this.$shareTextarea.height(40)},hideEmailForm:function(){this.$emailFormContainer.hide()},hideConfirmationPane:function(){this.$successPane.hide()},isValid:function(e){var i=!0;return e.children("input,textarea").removeClass("error").each(function(e,s){var n=t(s);n.hasClass("required")&&""===n.val()&&(n.addClass("error"),i=!1)}),i},onClickCancelBtn:function(){"modalEmailForm"===this.$el.attr("id")?o.getActiveApp().$(".social-share-modal-close-btn").trigger("click"):o.getActiveApp().$(".js-share-email-btn").trigger("click")},onRecaptcha:function(e){var i=t(e.currentTarget).data("option");"audio"===i||"image"===i?this.switchRecaptchaType(i):"help"===i?this.showRecaptchaHelp():this.reloadRecaptcha()},switchRecaptchaType:function(t){window.Recaptcha.switch_type(t)},showRecaptchaHelp:function(){window.Recaptcha.showhelp()},reloadRecaptcha:function(){window.Recaptcha.reload()}});return l}),define("modules/ugc/social-share-modal",["jquery","underscore","utils","baseview","modules/ugc/social-share-facebook","modules/stories/share-email"],function(t,e,i,s,n,o){"use strict";var r=s.extend({el:"#social-share-modal",events:{"click .social-share-modal-close-btn":"closeShareModal","click .social-share-modal-btn-facebook":"onClickFacebookBtn","click .social-share-modal-btn-email":"onClickEmailBtn"},initialize:function(e){e=t.extend({data:"",postLink:"",image:""},e),this.backdrop=t(".social-share-modal-background"),s.prototype.initialize.call(this,e),this._setupSocialShareModal()},_setupSocialShareModal:function(){this.setupTwitter(),this.setupGoogle(),this.setupLinkedIn(),this.subviews.socialShareFacebook||(this.subviews.socialShareFacebook=new n({data:this.options.data,link:this.options.postLink,image:this.options.image})),this.updateActiveButton("facebook")},setupTwitter:function(){var e=i.getNested(this.options.data,"post","title")||"",s="https://twitter.com/intent/tweet?url="+this.options.postLink+"&text="+e+"&via=yourtake";t(".social-share-modal-btn-twitter").attr("href",s)},setupGoogle:function(){var e="https://plus.google.com/share?url="+this.options.postLink;t(".social-share-modal-btn-google").attr("href",e)},setupLinkedIn:function(){var e="https://www.linkedin.com/shareArticle?mini=true&url="+this.options.postLink;t(".social-share-modal-btn-linkedin").attr("href",e)},openShareModal:function(){this.$el.fadeIn(300),this.subviews.socialShareFacebook&&(this.subviews.socialShareFacebook.hideConfirmationPane(),this.subviews.socialShareFacebook.showFacebookShareForm(),this.subviews.socialShareFacebook.show()),t(".js-share-email-form-container").hide(),this.updateActiveButton("facebook"),this.backdrop.addClass("show"),this.backdrop.css({"z-index":120,position:"fixed"})},closeShareModal:function(){this.$el.fadeOut(300),this.subviews.shareEmailView&&this.subviews.shareEmailView.hide()},onClickFacebookBtn:function(){this.subviews.socialShareFacebook?this.subviews.socialShareFacebook.hideConfirmationPane():this.subviews.socialShareFacebook=new n({data:this.options.data,link:this.options.postLink,image:this.options.image}),this.subviews.shareEmailView&&this.subviews.shareEmailView.hide(),this.updateActiveButton("facebook"),this.subviews.socialShareFacebook.showFacebookShareForm(),this.subviews.socialShareFacebook.show()},onClickEmailBtn:function(){this.subviews.shareEmailView||(this.subviews.shareEmailView=new o({uotrackName:"yourtakemail",el:"#modalEmailForm",postLink:this.options.postLink,message:i.getNested(this.options,"data","post","title")})),this.subviews.socialShareFacebook&&this.subviews.socialShareFacebook.hide(),this.updateActiveButton("email"),this.subviews.shareEmailView.showEmailForm(),this.subviews.shareEmailView.show()},updateActiveButton:function(e){t(".social-share-modal-icons").find(".active").removeClass("active"),t(".social-share-modal-btn-"+e).addClass("active")}});return r}),define("modules/ugc/ugc-utility-bar-upload-view",["jquery","underscore","modules/ugc/ugc-base-upload-view","user-manager","modules/ugc/ugc-user","modules/ugc/social-share-modal","easing"],function(t,e,i,s,n,o){"use strict";var r=i.extend({el:".ugc-util-bar-flyout-upload-form-view-container",events:{"click .ugc-util-bar-flyout-upload-form-contribute-more-btn":"onClickContributeMoreButton","click .ugc-util-bar-flyout-upload-form-view-upload-teaser":"onClickUploadTeaserButton","click .ugc-util-bar-flyout-submit-btn":"onClickSubmitButton","click .ugc-util-bar-flyout-cancel-btn":"onClickCancelButton","click .ugc-util-bar-flyout-be-first-to-contribute-graphic-signedin":"onBeFirstToContributeButtonClick","click .ugc-login-btn":"onClickLoginButton","click .ugc-util-bar-flyout-upload-form-login-fail-try-again":"onClickLoginFailTryAgain","click .ugc-util-upload-form-share-your-contribution-btn":"onClickSocialShareModalUtilBtn"},initialize:function(s){e.bindAll(this,"onFormSubmitSuccess","onFormSubmitFail"),s=t.extend({onRefresh:null,uploadFormOptions:{el:this.$(".ugc-util-bar-flyout-upload-form"),onSubmitSuccess:this.onFormSubmitSuccess,onSubmitFail:this.onFormSubmitFail}},s),this.pubSub={"ugc:user:statuschange":this.onUserStatusChange},i.prototype.initialize.call(this,s),this.$views=this.$(".ugc-upload-form-view"),this.$uploadView=this.$views.filter(".ugc-upload-form-view-upload"),this.$submitSuccessView=this.$views.filter(".ugc-upload-form-view-submit-success"),this.$submitFailView=this.$views.filter(".ugc-upload-form-view-submit-fail"),this.$loggingInView=this.$views.filter(".ugc-upload-form-view-logging-in"),this.$loginFailView=this.$views.filter(".ugc-upload-form-view-login-fail"),this.$notSignedInView=this.$views.filter(".ugc-upload-form-view-logged-out"),this.$uploadTeaserView=this.$views.filter(".ugc-util-bar-flyout-upload-form-view-upload-teaser"),this.show()},show:function(){var i,s=this.setupForm(),o=n.getLoginState();return"loggedOut"===o?this.revealView(this.$notSignedInView):"loginFailed"===o?this.revealView(this.$loginFailView):("pending"===s.state()&&(i=this.revealView(this.$loggingInView)),t.when(i).then(e.bind(function(){this.revealView(this.$uploadTeaserView).fail(e.bind(function(){this.revealView(this.$loginFailView)},this))},this)))},_handleRevealView:function(i,s){var n=t.Deferred(),o=t(i),r=o.height();return t(s).hide(),this.updateViewContainerHeight(r).done(e.bind(function(){o.fadeIn(400,e.bind(function(){n.resolve(),this.options.onRefresh&&this.options.onRefresh()},this))},this)),n.promise()},updateViewContainerHeight:function(e){var i,s,n=t.Deferred();return 0===e?(i="easeOutQuad",s=160):(i="easeOutBack",s=400),this.$el.stop().animate({height:e+"px"},{duration:s,easing:i,complete:function(){n.resolve()}}),n.promise()},onFormSubmitSuccess:function(t){var i=t.post;this.$submitSuccessView.find(".ugc-upload-form-submission-text-username").text(t.user.firstname);var s=this.$submitSuccessView.find(".ugc-utility-upload-form-view-your-contribution-text");s.attr("href",e.template(s.attr("href"),{post_id:i.groupid})),this.revealView(this.$submitSuccessView),this.setupSocialShareModal(t)},setupSocialShareModal:function(e){var i=window.location.origin+"/yourtake/asset/posts/"+e.post.groupid,s=t(".ugc-upload-success-media-preview").attr("src");this.subviews.shareModal=new o({data:e,postLink:i,image:s})},onClickSocialShareModalUtilBtn:function(){this.subviews.shareModal.openShareModal()},onFormSubmitFail:function(){this.revealView(this.$submitFailView)},onClickContributeMoreButton:function(){this.reset(),this.revealView(this.$uploadView)},onClickUploadTeaserButton:function(){this.revealView(this.$uploadView)},onClickSubmitButton:function(){this.getForm().submit()},onClickCancelButton:function(){this.reset()},onClickLoginButton:function(e){var i=t(e.target).data("user-account");s.loginUser(i),e.preventDefault()},onClickLoginFailTryAgain:function(t){t.preventDefault(),this.show()},onBeFirstToContributeButtonClick:function(){this.revealView(this.$uploadView)},onUserStatusChange:function(){this.show()},reset:function(){var t=this.getFormSubmitStatus();i.prototype.reset.call(this),this.revealView("submitSuccess"===t||"submitFailed"===t?this.$uploadView:this.$uploadTeaserView)}});return r}),define("modules/stories/utility-bar-module-ugc",["jquery","underscore","modules/stories/utility-bar-flyout","modules/ugc/ugc-utility-bar-upload-view","modules/ugc/report-abuse"],function(t,e,i,s,n){"use strict";var o=i.extend({initialize:function(t){this.$footer=this.$(".ugc-util-bar-flyout-footer"),this.$shortDisclaimer=this.$(".ugc-util-bar-flyout-disclaimer-short"),this.$longDisclaimer=this.$(".ugc-util-bar-flyout-disclaimer-long"),this.events=e.extend({},i.prototype.events,this.events),i.prototype.initialize.call(this,t),this.$recentPosts=this.$(".ugc-util-bar-flyout-recent-post-item"),this.setup()},setup:function(){this.$footer.hide(),this.subviews.uploadView||(this.subviews.uploadView=new s({onRefresh:this.onWindowResize})),this._handleDisclaimer(),this.setupReportAbuse(),this.$footer.fadeIn()},_handleDisclaimer:function(){this.$recentPosts.length?(this.$shortDisclaimer.hide(),this.$longDisclaimer.show()):(this.$longDisclaimer.hide(),this.$shortDisclaimer.show())},setupReportAbuse:function(){this.subviews.reportAbuse=new n({el:this.$el,tooltipOptions:{customPanelClass:"ugc-util-bar-flyout-recent-post-item-report-abuse-tooltip-panel",customTextClass:"ugc-util-bar-flyout-recent-post-item-report-abuse-tooltip-text"}})}});return o}),define("modules/partner/leaderboard-ad",["jquery","underscore","modules/partner/simple-ad"],function(t,e,i){"use strict";var s=i.extend({initialize:function(e){var s=this.$el;e=t.extend({adType:s.attr("data-ad-type")||"leaderboard",adPlacement:s.attr("data-ad-placement")||"leaderboard_btf",adSizes:s.attr("data-ad-sizes")||"leaderboard"},e),i.prototype.initialize.call(this,e),this._initAds()}});return s}),define("modules/ggm-jobs-search/ggm-jobs-search",["jquery","underscore","baseview","form/dropdown"],function(t,e,i,s){"use strict";var n=i.extend({events:{submit:"onFormSubmit"},initialize:function(t){i.prototype.initialize.call(this,t),this._setupForm()},_setupForm:function(){this.subviews.dropdownProduct=new s({el:this.$(".ggmmtjm-select")})}});return n}),define("apps/overlay/pages/olympics-widgets",["jquery","underscore","baseview"],function(t,e,i){var s=i.extend({events:{"click .schedule-norm":"reduceSchedule","click .schedule-wide":"expandSchedule","click .widget-switch-block":"switchWidget"},initialize:function(s){t.extend(s,{numberRetries:12,refreshInterval:5e3},s),i.prototype.initialize.call(this,s),e.bindAll(this,"checkWidgetResults"),this.$widget=this.$(".olympics-primary-widget"),this.$widget.length||(this.$widget=this.$(".olympics-sidebar-widget")),this.createWidget()},reduceSchedule:function(e){var i=t(e.currentTarget);i.hasClass("schedule-norm")&&(t(".card-primary-wrapper").css("width","840px"),t(".card-full-width .sidebar").show(),i.addClass("schedule-wide"),i.removeClass("schedule-norm"),i.html("Full Width Schedule"))},expandSchedule:function(e){var i=t(e.currentTarget);i.hasClass("schedule-wide")&&(t(".card-full-width .sidebar").hide(),t(".card-primary-wrapper").css("width","100%"),i.addClass("schedule-norm"),i.removeClass("schedule-wide"),i.html("Display Sidebar"))},createWidget:function(){var e=["athlete","country","day","discipline","event"],i=this.$widget;this.$widget.find(".widget-wrapper").each(function(){for(var s=t(this),n={el:"#"+s.attr("id"),highlight:"USA"},o=0;o<e.length;++o)s.data(e[o])?n[e[o]]=s.data(e[o]).toString():i.data(e[o])&&(n[e[o]]=i.data(e[o]).toString());switch(console.log(n),t(this).data("widget")){case"medals":n.sort="total",i.data("country")||i.data("discipline")?new Reuters.Olympics.View.MedalTable(n):new Reuters.Olympics.View.MedalCount(n);break;case"schedule":new Reuters.Olympics.View.Schedule(n);break;case"results":new Reuters.Olympics.View.Results(n)}}),this.numRetries=this.options.numberRetries},checkWidgetResults:function(){var e=this.$(".rightrail.widget");if(this.$(".olympics-primary-widget")){var i=!1,s=this.$(".olympics-primary-widget .widget-empty");this.$(".olympics-primary-widget .widget-wrapper").each(function(){var e=t(this);0===e.html().length||e.html().indexOf("error")>0||e.html().indexOf("no results")>0?e.hide():(e.show(),i=!0)}),i||this.numRetries>1?s.hide():s.show()}this.$(".olympics-sidebar-widget").each(function(){var i=t(this),s=!0,n=i.closest(".card-sidebar");i.find(".widget-wrapper").each(function(){var e=t(this);0===e.html().length||e.html().indexOf("error")>0||e.html().indexOf("no results")>0?e.hasClass("toggle")||e.hide():(e.hasClass("toggle")||e.show(),s=!1)}),s?(n.hide(),e.hide()):(n.show(),e.show());{var o=i.data("max-rows"),r=i.data("max-labels");i.data("max-phases")}o&&(t(this).find(".scheduleUnit").each(function(e){e>=o&&t(this).hide()}),t(this).find(".resultsTable").each(function(){t(this).find(".label").each(function(e){if(e>r){var i=t(this).closest("tr");i.hasClass("resultRow")||i.hide()}}),t(this).find(".resultRow").each(function(e){e>=o&&t(this).hide()})}))}),this.$(".reutersOlympicsWidget .widgetBody").removeClass("constrainHeight"),this.numRetries--,this.numRetries>0&&(this.widgetTimer=setTimeout(this.checkWidgetResults,this.options.refreshInterval))},switchWidget:function(e){var i=this.$(".widget-switch-results .widget-wrapper"),s=this.$(".widget-switch-block"),n=t(e.currentTarget),o=s.index(n);i.addClass("hide"),i.eq(o).removeClass("hide"),s.removeClass("selected"),n.addClass("selected")},destroy:function(){this.numRetries=0,this.widgetTimer&&clearTimeout(this.widgetTimer),i.prototype.destroy.call(this)}});return s}),define("modules/travel/flight-search",["jquery","underscore","pubsub","state","baseview","form/base-form","form/autocomplete"],function(t,e,i,s,n,o,r){"use strict";var a=n.extend({events:{"submit form":"flightSearchFormSubmit","click .flight-tracker-search-btn":"flightSearchButtonClick","click .expand-arrow":"expandDetailsClick","click .expand-view":"expandDetailsClick","blur .required":"requiredBlur"},initialize:function(i){i=t.extend(!0,{type:!1},i),this.statusi={A:"En Route",C:"Canceled",D:"Diverted",DN:"Data source needed",L:"Landed",NO:"Not Operational",R:"Redirected",S:"Scheduled",U:"Unknown"},this.searchResultsTemplate=t("#search-results-template");var s=new Date;s=s.getHours(),s%2!==0&&(s+=1),this.$("#flightTime").val(s),e.bindAll(this,"renderResults"),this.pubSub={"popup:click":this.flightStatsSearch},n.prototype.initialize.call(this,i);var a=!1;e.each(this.$("form"),function(i,s){var n=t(i);this.subviews["flightSearchForm"+s]=new o({el:n}),n.hasClass("flight-tracker-form-active")&&(a=n.data("search-type"));var l=s;e.each(n.find(".airport-code"),function(e,i){this.subviews["airportAutoComplete"+l+"-"+i]=new r({el:t(e),maxResults:6,resultDisplayTemplate:"<%= abbr %> - <%= name %>",resultValueTemplate:"<%= abbr %>",url:"/travel/flight-tracker/airports/search/<%=query%>/"})},this),e.each(n.find(".airline-code"),function(e,i){this.subviews["airlineAutoComplete"+l+"-"+i]=new r({el:t(e),maxResults:6,resultDisplayTemplate:"<%= abbr %> - <%= name %>",resultValueTemplate:"<%= abbr %>",url:"/travel/flight-tracker/airlines/search/<%=query%>/"})},this)},this),a&&(this.options.type=a),this.options.type||(this.options.type="flight"),this.currentSearchType=this.options.type,this.$(".flight-tracker-"+this.options.type+"-form-wrap").addClass("flight-tracker-form-active"),this.$(".flight-tracker-search-btn."+this.options.type).addClass("active")},flightSearchFormSubmit:function(s){var n=t(s.currentTarget),o=0;if(n.find(".required").each(function(){var e=t(this);""===e.val()&&(e.addClass("input-error"),o++)}),0!==o)return!1;if(!n.attr("action")){s.preventDefault();var r={};e.each(n.serializeArray(),function(t){r[t.name]=t.value},this),this.flightStatsSearch(this.currentSearchType,r)}i.trigger("uotrack","flighttrackermap")},getFlightSearchUrl:function(t,i){var s=this.$el.attr("data-fs-baseurl")+"flightstatus/rest/v2/jsonp/",n=this.$el.attr("data-fs-appid"),o=this.$el.attr("data-fs-appkey"),r=new Date,a=r.getFullYear(),l=r.getDate(),h=r.getMonth()+1,c=r.getHours(),d=a+"/"+h+"/"+l,u="?appId="+n+"&appKey="+o+"&extendedOptions=useInlinedReferences";return"flight"===t?s+="flight/status/"+i.airline_name+"/"+i.flight_number+"/dep/"+d+u:"route"===t?s+="route/status/"+i.origin_airport+"/"+i.dest_airport+"/dep/"+d+u+"&utc=false&maxFlights=100":"airport"===t?(e.isUndefined(i.flight_time)&&(i.flight_time=c),s+="airport/status/"+i.airport_code+"/"+i.flight_type+"/"+d+"/"+i.flight_time+u+"&numHours=2"):s="",s},flightStatsSearch:function(t,i){var n=this.getFlightSearchUrl(t,i);this.fetch&&this.fetch.abort(),this.fetch=s.fetchData(n,{dataType:"jsonp"}).done(e.bind(function(e){this.renderResults(e.flightStatuses,t,i)},this)).fail(e.bind(function(){this.$(".flight-tracker-results").html('<div class="error">There is no matching flight data.</div>')},this))},flightSearchButtonClick:function(e){var i=t(e.currentTarget),s=i.attr("data-search-type");this.currentSearchType!==s&&(this.$(".flight-tracker-search-btn").removeClass("active"),i.addClass("active"),this.$(".flight-tracker-"+this.currentSearchType+"-form-wrap").removeClass("flight-tracker-form-active"),this.$(".flight-tracker-"+s+"-form-wrap").addClass("flight-tracker-form-active"),this.currentSearchType=s)},requiredBlur:function(e){var i=t(e.currentTarget);""!==i.val()&&i.removeClass("input-error")},renderResults:function(t,i,s){var n=this.statusi;if(e.each(t,function(t){if(t.status=n[t.status],t.color="green",e.isUndefined(t.delays))t.delays="On-time";else{var i=0;e.each(t.delays,function(t){i+=t}),t.delays=i+" min",t.color="yellow"}"Canceled"===t.status&&(t.color="red"),e.isUndefined(t.departureAirport.stateCode)&&(t.departureAirport.stateCode=t.departureAirport.countryCode),e.isUndefined(t.arrivalAirport.stateCode)&&(t.arrivalAirport.stateCode=t.arrivalAirport.countryCode)}),t.length){t={results:t};var o=e.template(this.searchResultsTemplate.html(),t),r="Results for "+i+" search:";s.flight_type_full&&s.airport_name&&(r=s.flight_type_full+": "+s.airport_name),this.$(".flight-tracker-results").empty().append('<div class="search-title">'+r+"</div>").append(o)}else this.$(".flight-tracker-results").html('<div class="error">No matching flight data found.</div>')},expandDetailsClick:function(e){var i=t(e.target).attr("data-flightid"),s=this.$(".detail-view-"+i);s.hasClass("open")?(s.hide().removeClass("open"),t(e.target).removeClass("active")):(s.show().addClass("open"),t(e.target).addClass("active"))}});return a}),!function(t){var e={},s={mode:"horizontal",slideSelector:"",infiniteLoop:!0,hideControlOnEnd:!1,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:!1,captions:!1,ticker:!1,tickerHover:!1,adaptiveHeight:!1,adaptiveHeightSpeed:500,video:!1,useCSS:!0,preloadImages:"visible",responsive:!0,touchEnabled:!0,swipeThreshold:50,oneToOneTouch:!0,preventDefaultSwipeX:!0,preventDefaultSwipeY:!1,pager:!0,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:!0,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:!1,startText:"Start",stopText:"Stop",autoControlsCombine:!1,autoControlsSelector:null,auto:!1,pause:4e3,autoStart:!0,autoDirection:"next",autoHover:!1,autoDelay:0,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,onSliderLoad:function(){},onSlideBefore:function(){},onSlideAfter:function(){},onSlideNext:function(){},onSlidePrev:function(){}};t.fn.bxSlider=function(n){if(0==this.length)return this;if(this.length>1)return this.each(function(){t(this).bxSlider(n)}),this;var o={},r=this;e.el=this;var a=t(window).width(),l=t(window).height(),h=function(){o.settings=t.extend({},s,n),o.settings.slideWidth=parseInt(o.settings.slideWidth),o.children=r.children(o.settings.slideSelector),o.children.length<o.settings.minSlides&&(o.settings.minSlides=o.children.length),o.children.length<o.settings.maxSlides&&(o.settings.maxSlides=o.children.length),o.settings.randomStart&&(o.settings.startSlide=Math.floor(Math.random()*o.children.length)),o.active={index:o.settings.startSlide},o.carousel=o.settings.minSlides>1||o.settings.maxSlides>1,o.carousel&&(o.settings.preloadImages="all"),o.minThreshold=o.settings.minSlides*o.settings.slideWidth+(o.settings.minSlides-1)*o.settings.slideMargin,o.maxThreshold=o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin,o.working=!1,o.controls={},o.interval=null,o.animProp="vertical"==o.settings.mode?"top":"left",o.usingCSS=o.settings.useCSS&&"fade"!=o.settings.mode&&function(){var t=document.createElement("div"),e=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in e)if(void 0!==t.style[e[i]])return o.cssPrefix=e[i].replace("Perspective","").toLowerCase(),o.animProp="-"+o.cssPrefix+"-transform",!0;return!1}(),"vertical"==o.settings.mode&&(o.settings.maxSlides=o.settings.minSlides),r.data("origStyle",r.attr("style")),r.children(o.settings.slideSelector).each(function(){t(this).data("origStyle",t(this).attr("style"))}),c()},c=function(){r.wrap('<div class="bx-wrapper"><div class="bx-viewport"></div></div>'),o.viewport=r.parent(),o.loader=t('<div class="bx-loading" />'),o.viewport.prepend(o.loader),r.css({width:"horizontal"==o.settings.mode?100*o.children.length+215+"%":"auto",position:"relative"}),o.usingCSS&&o.settings.easing?r.css("-"+o.cssPrefix+"-transition-timing-function",o.settings.easing):o.settings.easing||(o.settings.easing="swing"),m(),o.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),o.viewport.parent().css({maxWidth:f()}),o.settings.pager||o.viewport.parent().css({margin:"0 auto 0px"}),o.children.css({"float":"horizontal"==o.settings.mode?"left":"none",listStyle:"none",position:"relative"}),o.children.css("width",g()),"horizontal"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginRight",o.settings.slideMargin),"vertical"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginBottom",o.settings.slideMargin),"fade"==o.settings.mode&&(o.children.css({position:"absolute",zIndex:0,display:"none"}),o.children.eq(o.settings.startSlide).css({zIndex:50,display:"block"})),o.controls.el=t('<div class="bx-controls" />'),o.settings.captions&&S(),o.active.last=o.settings.startSlide==v()-1,o.settings.video&&r.fitVids();var e=o.children.eq(o.settings.startSlide);"all"==o.settings.preloadImages&&(e=o.children),o.settings.ticker?o.settings.pager=!1:(o.settings.pager&&x(),o.settings.controls&&k(),o.settings.auto&&o.settings.autoControls&&C(),(o.settings.controls||o.settings.autoControls||o.settings.pager)&&o.viewport.after(o.controls.el)),d(e,u)},d=function(e,i){var s=e.find("img, iframe").length;if(0==s)return void i();var n=0;e.find("img, iframe").each(function(){t(this).is("img")&&t(this).attr("src",t(this).attr("src")+"?timestamp="+(new Date).getTime()),t(this).load(function(){setTimeout(function(){++n==s&&i()
},0)})})},u=function(){if(o.settings.infiniteLoop&&"fade"!=o.settings.mode&&!o.settings.ticker){var e="vertical"==o.settings.mode?o.settings.minSlides:o.settings.maxSlides,i=o.children.slice(0,e).clone().addClass("bx-clone"),s=o.children.slice(-e).clone().addClass("bx-clone");r.append(i).prepend(s)}o.loader.remove(),b(),"vertical"==o.settings.mode&&(o.settings.adaptiveHeight=!0),o.viewport.height(p()),r.redrawSlider(),o.settings.onSliderLoad(o.active.index),o.initialized=!0,o.settings.responsive&&t(window).bind("resize",U),o.settings.auto&&o.settings.autoStart&&F(),o.settings.ticker&&z(),o.settings.pager&&D(o.settings.startSlide),o.settings.controls&&L(),o.settings.touchEnabled&&!o.settings.ticker&&R()},p=function(){var e=0,s=t();if("vertical"==o.settings.mode||o.settings.adaptiveHeight)if(o.carousel){var n=1==o.settings.moveSlides?o.active.index:o.active.index*y();for(s=o.children.eq(n),i=1;i<=o.settings.maxSlides-1;i++)s=s.add(n+i>=o.children.length?o.children.eq(i-1):o.children.eq(n+i))}else s=o.children.eq(o.active.index);else s=o.children;return"vertical"==o.settings.mode?(s.each(function(){e+=t(this).outerHeight()}),o.settings.slideMargin>0&&(e+=o.settings.slideMargin*(o.settings.minSlides-1))):e=Math.max.apply(Math,s.map(function(){return t(this).outerHeight(!1)}).get()),e},f=function(){var t="100%";return o.settings.slideWidth>0&&(t="horizontal"==o.settings.mode?o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin:o.settings.slideWidth),t},g=function(){var t=o.settings.slideWidth,e=o.viewport.width();return 0==o.settings.slideWidth||o.settings.slideWidth>e&&!o.carousel||"vertical"==o.settings.mode?t=e:o.settings.maxSlides>1&&"horizontal"==o.settings.mode&&(e>o.maxThreshold||e<o.minThreshold&&(t=(e-o.settings.slideMargin*(o.settings.minSlides-1))/o.settings.minSlides)),t},m=function(){var t=1;if("horizontal"==o.settings.mode&&o.settings.slideWidth>0)if(o.viewport.width()<o.minThreshold)t=o.settings.minSlides;else if(o.viewport.width()>o.maxThreshold)t=o.settings.maxSlides;else{var e=o.children.first().width();t=Math.floor(o.viewport.width()/e)}else"vertical"==o.settings.mode&&(t=o.settings.minSlides);return t},v=function(){var t=0;if(o.settings.moveSlides>0)if(o.settings.infiniteLoop)t=o.children.length/y();else for(var e=0,i=0;e<o.children.length;)++t,e=i+m(),i+=o.settings.moveSlides<=m()?o.settings.moveSlides:m();else t=Math.ceil(o.children.length/m());return t},y=function(){return o.settings.moveSlides>0&&o.settings.moveSlides<=m()?o.settings.moveSlides:m()},b=function(){if(o.children.length>o.settings.maxSlides&&o.active.last&&!o.settings.infiniteLoop){if("horizontal"==o.settings.mode){var t=o.children.last(),e=t.position();w(-(e.left-(o.viewport.width()-t.width())),"reset",0)}else if("vertical"==o.settings.mode){var i=o.children.length-o.settings.minSlides,e=o.children.eq(i).position();w(-e.top,"reset",0)}}else{var e=o.children.eq(o.active.index*y()).position();o.active.index==v()-1&&(o.active.last=!0),void 0!=e&&("horizontal"==o.settings.mode?w(-e.left,"reset",0):"vertical"==o.settings.mode&&w(-e.top,"reset",0))}},w=function(t,e,i,s){if(o.usingCSS){var n="vertical"==o.settings.mode?"translate3d(0, "+t+"px, 0)":"translate3d("+t+"px, 0, 0)";r.css("-"+o.cssPrefix+"-transition-duration",i/1e3+"s"),"slide"==e?(r.css(o.animProp,n),r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),M()})):"reset"==e?r.css(o.animProp,n):"ticker"==e&&(r.css("-"+o.cssPrefix+"-transition-timing-function","linear"),r.css(o.animProp,n),r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),w(s.resetValue,"reset",0),O()}))}else{var a={};a[o.animProp]=t,"slide"==e?r.animate(a,i,o.settings.easing,function(){M()}):"reset"==e?r.css(o.animProp,t):"ticker"==e&&r.animate(a,speed,"linear",function(){w(s.resetValue,"reset",0),O()})}},_=function(){for(var e="",i=v(),s=0;i>s;s++){var n="";o.settings.buildPager&&t.isFunction(o.settings.buildPager)?(n=o.settings.buildPager(s),o.pagerEl.addClass("bx-custom-pager")):(n=s+1,o.pagerEl.addClass("bx-default-pager")),e+='<div class="bx-pager-item"><a href="" data-slide-index="'+s+'" class="bx-pager-link">'+n+"</a></div>"}o.pagerEl.html(e)},x=function(){o.settings.pagerCustom?o.pagerEl=t(o.settings.pagerCustom):(o.pagerEl=t('<div class="bx-pager" />'),o.settings.pagerSelector?t(o.settings.pagerSelector).html(o.pagerEl):o.controls.el.addClass("bx-has-pager").append(o.pagerEl),_()),o.pagerEl.delegate("a","click",I)},k=function(){o.controls.next=t('<a class="bx-next" href="">'+o.settings.nextText+"</a>"),o.controls.prev=t('<a class="bx-prev" href="">'+o.settings.prevText+"</a>"),o.controls.next.bind("click",T),o.controls.prev.bind("click",$),o.settings.nextSelector&&t(o.settings.nextSelector).append(o.controls.next),o.settings.prevSelector&&t(o.settings.prevSelector).append(o.controls.prev),o.settings.nextSelector||o.settings.prevSelector||(o.controls.directionEl=t('<div class="bx-controls-direction" />'),o.controls.directionEl.append(o.controls.prev).append(o.controls.next),o.controls.el.addClass("bx-has-controls-direction").append(o.controls.directionEl))},C=function(){o.controls.start=t('<div class="bx-controls-auto-item"><a class="bx-start" href="">'+o.settings.startText+"</a></div>"),o.controls.stop=t('<div class="bx-controls-auto-item"><a class="bx-stop" href="">'+o.settings.stopText+"</a></div>"),o.controls.autoEl=t('<div class="bx-controls-auto" />'),o.controls.autoEl.delegate(".bx-start","click",A),o.controls.autoEl.delegate(".bx-stop","click",P),o.settings.autoControlsCombine?o.controls.autoEl.append(o.controls.start):o.controls.autoEl.append(o.controls.start).append(o.controls.stop),o.settings.autoControlsSelector?t(o.settings.autoControlsSelector).html(o.controls.autoEl):o.controls.el.addClass("bx-has-controls-auto").append(o.controls.autoEl),E(o.settings.autoStart?"stop":"start")},S=function(){o.children.each(function(){var e=t(this).find("img:first").attr("title");void 0!=e&&(""+e).length&&t(this).append('<div class="bx-caption"><span>'+e+"</span></div>")})},T=function(t){o.settings.auto&&r.stopAuto(),r.goToNextSlide(),t.preventDefault()},$=function(t){o.settings.auto&&r.stopAuto(),r.goToPrevSlide(),t.preventDefault()},A=function(t){r.startAuto(),t.preventDefault()},P=function(t){r.stopAuto(),t.preventDefault()},I=function(e){o.settings.auto&&r.stopAuto();var i=t(e.currentTarget),s=parseInt(i.attr("data-slide-index"));s!=o.active.index&&r.goToSlide(s),e.preventDefault()},D=function(e){var i=o.children.length;return"short"==o.settings.pagerType?(o.settings.maxSlides>1&&(i=Math.ceil(o.children.length/o.settings.maxSlides)),void o.pagerEl.html(e+1+o.settings.pagerShortSeparator+i)):(o.pagerEl.find("a").removeClass("active"),void o.pagerEl.each(function(i,s){t(s).find("a").eq(e).addClass("active")}))},M=function(){if(o.settings.infiniteLoop){var t="";0==o.active.index?t=o.children.eq(0).position():o.active.index==v()-1&&o.carousel?t=o.children.eq((v()-1)*y()).position():o.active.index==o.children.length-1&&(t=o.children.eq(o.children.length-1).position()),"horizontal"==o.settings.mode?w(-t.left,"reset",0):"vertical"==o.settings.mode&&w(-t.top,"reset",0)}o.working=!1,o.settings.onSlideAfter(o.children.eq(o.active.index),o.oldIndex,o.active.index)},E=function(t){o.settings.autoControlsCombine?o.controls.autoEl.html(o.controls[t]):(o.controls.autoEl.find("a").removeClass("active"),o.controls.autoEl.find("a:not(.bx-"+t+")").addClass("active"))},L=function(){1==v()?(o.controls.prev.addClass("disabled"),o.controls.next.addClass("disabled")):!o.settings.infiniteLoop&&o.settings.hideControlOnEnd&&(0==o.active.index?(o.controls.prev.addClass("disabled"),o.controls.next.removeClass("disabled")):o.active.index==v()-1?(o.controls.next.addClass("disabled"),o.controls.prev.removeClass("disabled")):(o.controls.prev.removeClass("disabled"),o.controls.next.removeClass("disabled")))},F=function(){o.settings.autoDelay>0?setTimeout(r.startAuto,o.settings.autoDelay):r.startAuto(),o.settings.autoHover&&r.hover(function(){o.interval&&(r.stopAuto(!0),o.autoPaused=!0)},function(){o.autoPaused&&(r.startAuto(!0),o.autoPaused=null)})},z=function(){var e=0;if("next"==o.settings.autoDirection)r.append(o.children.clone().addClass("bx-clone"));else{r.prepend(o.children.clone().addClass("bx-clone"));var i=o.children.first().position();e="horizontal"==o.settings.mode?-i.left:-i.top}w(e,"reset",0),o.settings.pager=!1,o.settings.controls=!1,o.settings.autoControls=!1,o.settings.tickerHover&&!o.usingCSS&&o.viewport.hover(function(){r.stop()},function(){var e=0;o.children.each(function(){e+="horizontal"==o.settings.mode?t(this).outerWidth(!0):t(this).outerHeight(!0)});var i=o.settings.speed/e,s="horizontal"==o.settings.mode?"left":"top",n=i*(e-Math.abs(parseInt(r.css(s))));O(n)}),O()},O=function(t){speed=t?t:o.settings.speed;var e={left:0,top:0},i={left:0,top:0};"next"==o.settings.autoDirection?e=r.find(".bx-clone").first().position():i=o.children.first().position();var s="horizontal"==o.settings.mode?-e.left:-e.top,n="horizontal"==o.settings.mode?-i.left:-i.top,a={resetValue:n};w(s,"ticker",speed,a)},R=function(){o.touch={start:{x:0,y:0},end:{x:0,y:0}},o.viewport.bind("touchstart",N)},N=function(t){if(o.working)t.preventDefault();else{o.touch.originalPos=r.position();var e=t.originalEvent;o.touch.start.x=e.changedTouches[0].pageX,o.touch.start.y=e.changedTouches[0].pageY,o.viewport.bind("touchmove",B),o.viewport.bind("touchend",j)}},B=function(t){var e=t.originalEvent,i=Math.abs(e.changedTouches[0].pageX-o.touch.start.x),s=Math.abs(e.changedTouches[0].pageY-o.touch.start.y);if(3*i>s&&o.settings.preventDefaultSwipeX?t.preventDefault():3*s>i&&o.settings.preventDefaultSwipeY&&t.preventDefault(),"fade"!=o.settings.mode&&o.settings.oneToOneTouch){var n=0;if("horizontal"==o.settings.mode){var r=e.changedTouches[0].pageX-o.touch.start.x;n=o.touch.originalPos.left+r}else{var r=e.changedTouches[0].pageY-o.touch.start.y;n=o.touch.originalPos.top+r}w(n,"reset",0)}},j=function(t){o.viewport.unbind("touchmove",B);var e=t.originalEvent,i=0;if(o.touch.end.x=e.changedTouches[0].pageX,o.touch.end.y=e.changedTouches[0].pageY,"fade"==o.settings.mode){var s=Math.abs(o.touch.start.x-o.touch.end.x);s>=o.settings.swipeThreshold&&(o.touch.start.x>o.touch.end.x?r.goToNextSlide():r.goToPrevSlide(),r.stopAuto())}else{var s=0;"horizontal"==o.settings.mode?(s=o.touch.end.x-o.touch.start.x,i=o.touch.originalPos.left):(s=o.touch.end.y-o.touch.start.y,i=o.touch.originalPos.top),!o.settings.infiniteLoop&&(0==o.active.index&&s>0||o.active.last&&0>s)?w(i,"reset",200):Math.abs(s)>=o.settings.swipeThreshold?(0>s?r.goToNextSlide():r.goToPrevSlide(),r.stopAuto()):w(i,"reset",200)}o.viewport.unbind("touchend",j)},U=function(){var e=t(window).width(),i=t(window).height();(a!=e||l!=i)&&(a=e,l=i,r.redrawSlider())};return r.goToSlide=function(e,i){if(!o.working&&o.active.index!=e)if(o.working=!0,o.oldIndex=o.active.index,o.active.index=0>e?v()-1:e>=v()?0:e,o.settings.onSlideBefore(o.children.eq(o.active.index),o.oldIndex,o.active.index),"next"==i?o.settings.onSlideNext(o.children.eq(o.active.index),o.oldIndex,o.active.index):"prev"==i&&o.settings.onSlidePrev(o.children.eq(o.active.index),o.oldIndex,o.active.index),o.active.last=o.active.index>=v()-1,o.settings.pager&&D(o.active.index),o.settings.controls&&L(),"fade"==o.settings.mode)o.settings.adaptiveHeight&&o.viewport.height()!=p()&&o.viewport.animate({height:p()},o.settings.adaptiveHeightSpeed),o.children.filter(":visible").fadeOut(o.settings.speed).css({zIndex:0}),o.children.eq(o.active.index).css("zIndex",51).fadeIn(o.settings.speed,function(){t(this).css("zIndex",50),M()});else{o.settings.adaptiveHeight&&o.viewport.height()!=p()&&o.viewport.animate({height:p()},o.settings.adaptiveHeightSpeed);var s=0,n={left:0,top:0};if(!o.settings.infiniteLoop&&o.carousel&&o.active.last)if("horizontal"==o.settings.mode){var a=o.children.eq(o.children.length-1);n=a.position(),s=o.viewport.width()-a.outerWidth()}else{var l=o.children.length-o.settings.minSlides;n=o.children.eq(l).position()}else if(o.carousel&&o.active.last&&"prev"==i){var h=1==o.settings.moveSlides?o.settings.maxSlides-y():(v()-1)*y()-(o.children.length-o.settings.maxSlides),a=r.children(".bx-clone").eq(h);n=a.position()}else if("next"==i&&0==o.active.index)n=r.find("> .bx-clone").eq(o.settings.maxSlides).position(),o.active.last=!1;else if(e>=0){var c=e*y();n=o.children.eq(c).position()}if("undefined"!=typeof n){var d="horizontal"==o.settings.mode?-(n.left-s):-n.top;w(d,"slide",o.settings.speed)}}},r.goToNextSlide=function(){if(o.settings.infiniteLoop||!o.active.last){var t=parseInt(o.active.index)+1;r.goToSlide(t,"next")}},r.goToPrevSlide=function(){if(o.settings.infiniteLoop||0!=o.active.index){var t=parseInt(o.active.index)-1;r.goToSlide(t,"prev")}},r.startAuto=function(t){o.interval||(o.interval=setInterval(function(){"next"==o.settings.autoDirection?r.goToNextSlide():r.goToPrevSlide()},o.settings.pause),o.settings.autoControls&&1!=t&&E("stop"))},r.stopAuto=function(t){o.interval&&(clearInterval(o.interval),o.interval=null,o.settings.autoControls&&1!=t&&E("start"))},r.getCurrentSlide=function(){return o.active.index},r.getSlideCount=function(){return o.children.length},r.redrawSlider=function(){o.children.add(r.find(".bx-clone")).outerWidth(g()),o.viewport.css("height",p()),o.settings.ticker||b(),o.active.last&&(o.active.index=v()-1),o.active.index>=v()&&(o.active.last=!0),o.settings.pager&&!o.settings.pagerCustom&&(_(),D(o.active.index))},r.destroySlider=function(){o.initialized&&(o.initialized=!1,t(".bx-clone",this).remove(),o.children.each(function(){void 0!=t(this).data("origStyle")?t(this).attr("style",t(this).data("origStyle")):t(this).removeAttr("style")}),void 0!=t(this).data("origStyle")?this.attr("style",t(this).data("origStyle")):t(this).removeAttr("style"),t(this).unwrap().unwrap(),o.controls.el&&o.controls.el.remove(),o.controls.next&&o.controls.next.remove(),o.controls.prev&&o.controls.prev.remove(),o.pagerEl&&o.pagerEl.remove(),t(".bx-caption",this).remove(),o.controls.autoEl&&o.controls.autoEl.remove(),clearInterval(o.interval),o.settings.responsive&&t(window).unbind("resize",U))},r.reloadSlider=function(t){void 0!=t&&(n=t),r.destroySlider(),h()},h(),this}}(jQuery),define("bxslider",function(){}),define("modules/sports/sports-story-video",["jquery","underscore","state","pubsub","backbone","baseview","directAdPosition","modules/global/brightcove-video","modules/stories/share-facebook","bxslider"],function(t,e,i,s,n,o,r,a,l){"use strict";var h=a.extend({events:function(){var t=a.prototype.events;return e.isFunction(t)&&(t=t()),e.extend({},t,{"click .sports-video-promo-link":"createPlayer"})},initialize:function(i){a.prototype.initialize.call(this,i),this.$spVideoObj=t(".sp-video-player-modal"),this.isPlaying=!1,this.$globalHeaderEl=t("body header:first"),this.$overlayCloseEl=t(".close-wrap"),this.activeVideoId="",this.modalHtml='<div id="sp-videomodal-overlay" class="sp-videomodal-overlay"></div>',this.modalHtml+='<div id="sp-videomodal-container" class="sp-videomodal-container">',this.modalHtml+='<a id="sp-videomodal-close" class="sp-videomodal-close" title="Close"></a>',this.modalHtml+='<div id="sp-videomodal-wrapper" class="sp-videomodal-wrapper loading">',this.modalHtml+="</div></div>",this.$promoEl="",this.videoType="",this.cuedVideoId="",this.autoRotate=!0,this.subviews={},e.bindAll(this,"createPlayer","onBrightCoveLoad","onTemplateReady","onVideoComplete","onVideoStart","isPlayingHandler","determineCompletion"),this._initAd()},_buildBrightCoveLoadCallback:function(){t(".sp-video-player-modal").length>0&&(this.$brightcove=t(".sp-video-player-modal .BrightcoveExperience"),this.brightcoveId=t(".sp-video-player-modal .BrightcoveExperience").attr("id")),window.BCCallbacks||(window.BCCallbacks={}),window.BCCallbacks[this.brightcoveId]=this.onBrightCoveLoad,window.brightcove.createExperiences(),window.BCLoad?console.log("BCLoad is already here"):window.BCLoad=function(t){window.BCCallbacks[t]?window.BCCallbacks[t](t):console.log("received brightcove callback for video that does not exist: "+t)}},_initAd:function(){var t=this.$(".sp-player-sponsor");t.length&&(this.subviews.ad=new r({el:t,adSizes:["sponsor_logo"],adPlacement:"video_sponsor_logo",pageInfo:i.getActivePageInfo()}))},updateTrackingDataObj:function(t){this.$videoObj=t},createPlayer:function(i){""===this.$promoEl&&(i.preventDefault(),this.$promoEl=t(i.currentTarget)),"undefined"!=typeof window.brightcove?this.fetchPlaylist(this.$promoEl):this.loadScripts(e.bind(this.createPlayer,this))},loadVideoById:function(e,i){this.updateTrackingDataObj(i),this.closeShare(),this.updateActiveItem(i),this.modVP.loadVideoByID(e),this.populateUtilityShare(t(i).find("a"))},fetchPlaylist:function(s){this.showModal();var n=t(s).data("playlistid"),o=t(s).data("playerid"),r=t(s).data("playerkey"),a=t(s).data("awspath");this.modifyGlobalElements();var l="/sports/services/sports-video/playlist/"+o+"/"+n+"/"+r+"/?awspath="+a,h=this.launchVideoPromo;i.fetchHtml(l).done(e.bind(h,this))},launchVideoPromo:function(e){t("#sp-videomodal-wrapper").html(e),t("#sp-videomodal-wrapper").removeClass("loading"),this.$videoObj=t(".sp-video-player-modal .player"),this._buildBrightCoveLoadCallback(),this.initPlaylistCarousel(),this.initShareEvents()},initPlaylistCarousel:function(){this.$sliderEl=t(".sp-video-player-modal .bxslider"),this.$sliderEl.bxSlider({slideWidth:128,minSlides:1,maxSlides:6,pager:!1,slideMargin:10,onSliderLoad:e.bind(function(){this.initPlaylistItems()},this),onSlideAfter:e.bind(function(){this.$sliderEl.find("a[data-id='"+this.activeVideoId+"']").parent().addClass("active")},this)})},initPlaylistItems:function(){this.$spVideoObj=t(".sp-video-player-modal"),this.activeEl=t(".sp-video-player-modal .bxslider .active"),this.activeVideoId=this.activeEl.find("a").data("id"),this.$nextEl=t(".sp-video-player-modal .bxslider .active").next(),this.nextAsset=t(".sp-video-player-modal .bxslider .active").next().find("a").data("id"),t(".sp-video-player-modal .bxslider .item a").click(e.bind(function(e){e.preventDefault();var i=t(e.currentTarget).data("id"),s=t(e.currentTarget).data("title");t(e.currentTarget).parent().siblings().removeClass("active"),t(e.currentTarget).parent().addClass("active"),t(".sp-video-player-modal .asset-title").html(s),this.loadVideoById(i,t(e.currentTarget).parent())},this))},modifyGlobalElements:function(){this.$globalHeaderEl.css("position","relative").css("z-index","1000"),this.$overlayCloseEl.hide()},resetGlobalElements:function(){this.$globalHeaderEl.css("position","interit").css("z-index","auto"),this.$overlayCloseEl.show()},initShareEvents:function(){this.subviews.shareTools=new l({el:".sp-video-player-modal"}),t(".util-bar-btn-facebook").click(e.bind(function(){this.pausePlayer()},this)),t(".util-bar-flyout-close-ribbon").click(e.bind(function(){this.unpausePlayer()},this))},populateUtilityShare:function(e){var i=t(e).data("title"),s=t(e).data("desc"),n=t(e).data("shorturl"),o=t(e).data("pageurl"),r="https://twitter.com/intent/tweet?url="+n+"&via=USATODAY&text="+i,a="//plus.google.com/share?url="+n,l="http://www.linkedin.com/shareArticle?url="+n+"&mini=true",h="";h=t(e).find("figure").length>0?t(e).find("figure").find("img").attr("src"):t(e).data("imageurl"),this.$spVideoObj.find(".util-bar-flyout-nav-btn-twitter").attr("href",r),this.$spVideoObj.find(".util-bar-flyout-nav-btn-googleplus").attr("href",a),this.$spVideoObj.find(".util-bar-flyout-nav-btn-linkedin").attr("href",l),this.$spVideoObj.find(".util-bar-share-message-facebook").data("link",o),this.$spVideoObj.find(".util-bar-share-message-facebook").data("title",i),this.$spVideoObj.find(".util-bar-share-message-facebook").data("image",h),this.$spVideoObj.find(".util-bar-share-form-email textarea").html(i+"on USAToday.com: "+n),this.$spVideoObj.find(".util-bar-share-summary-title").html(i),this.$spVideoObj.find(".util-bar-share-summary-description").html(s),this.$spVideoObj.find(".util-bar-share-summary-image").data("src",h),this.$spVideoObj.find(".util-bar-share-summary-image").attr("src",h),this.$spVideoObj.find(".util-bar-share-loading-facebook").data("image",h)},pausePlayer:function(){i.startRefreshTimer();this.modVP.getIsPlaying(e.bind(function(t){this.isPlaying=t===!1?!1:!0},this));this.modVP.pause(!0)},unpausePlayer:function(){i.stopRefreshTimer(),this.isPlaying===!0&&this.modVP.pause(!1)},showModal:function(){var i=t(document).scrollTop()+30;t("body").append(this.modalHtml),t("#sp-videomodal-container").css("top",i+"px"),t("#sp-videomodal-overlay").fadeIn("slow",function(){t("#sp-videomodal-container").fadeIn("slow")}),t("#sp-videomodal-overlay").click(e.bind(function(t){this.closeModal(t)},this)),t("#sp-videomodal-close").click(e.bind(function(t){this.closeModal(t)},this))},setNextAsset:function(e){t(e).next(".item").length>0?(this.nextAsset=t(e).next().find("a").data("id"),this.$nextEl=t(e).next()):(this.nextAsset=t(e).siblings().filter(":first").find("a").data("id"),this.$nextEl=t(e).siblings().filter(":first"))},updateActiveItem:function(e){this.activeEl=e,this.activeVideoId=t(e).find("a").data("id"),t(e).siblings().removeClass("active"),t(e).addClass("active"),this.setNextAsset(t(e))},closeShare:function(){t(".util-bar-flyout-share-video").hasClass("open")&&t(".util-bar-flyout-close-ribbon").trigger("click")},closeModal:function(){this.modExp.removeEventListener(window.brightcove.api.events.ExperienceEvent.TEMPLATE_READY,this.onTemplateReady),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.BEGIN,this.onVideoStart),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.COMPLETE,this.onVideoComplete),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PLAY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.STOP,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.SEEK_NOTIFY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PROGRESS,this.throttledDetermine),this.resetGlobalElements(),t("#sp-videomodal-overlay").fadeOut("fast",function(){t(this).remove()}),t("#sp-videomodal-container").fadeOut("fast",function(){t(this).remove()})},onVideoComplete:function(){if(this.$activeEl=this.$nextEl,this.autoRotate!==!1&&(this.loadVideoById(this.nextAsset,this.$nextEl),t(".sp-video-player-modal").length>0)){var e=t(".sp-video-player-modal .bx-viewport").innerWidth(),i=t(".sp-video-player-modal .bx-viewport").offset().left,s=i+e,n=t(this.$activeEl).offset().left;n>s&&t(".sp-video-player-modal .bx-next").trigger("click"),t(".sp-video-player-modal .asset-title").text(t(this.$nextEl).find("a").data("title"))}},onBrightCoveLoad:function(){a.prototype.onBrightCoveLoad.apply(this,arguments),this.videoType=this.player.type},onTemplateReady:function(){a.prototype.onTemplateReady.apply(this,arguments),"html"===this.videoType&&this.modVP.canPlayWithoutInteraction()?this.modVP.cueVideoByID(this.cuedVideoId):this.modVP.loadVideoByID(this.cuedVideoId)},destroy:function(){o.prototype.destroy.apply(this,arguments)}});return h}),define("modules/sports/sports-front-video",["jquery","underscore","state","backbone","baseview","directAdPosition","modules/sports/sports-story-video","modules/stories/share-facebook"],function(t,e,i,s,n,o,r,a){var l=r.extend({events:function(){var t=r.prototype.events;return e.isFunction(t)&&(t=t()),e.extend({},t,{"click .sp-video-player .playlist .item a":"initVideoAsset","click .video-still-play":"loadScripts","click .sp-video-player .util-bar-btn-facebook-video":"pausePlayer","click .sp-video-player .util-bar-flyout-close-ribbon":"unpausePlayer"})},initialize:function(i){r.prototype.initialize.call(this,i),this.$spVideoObj=t(".sp-video-player"),this.$brightcove=t(".sp-video-player .BrightcoveExperience"),this.$embed=t(".sp-video-player .embed"),this.brightcoveId=this.$embed.data("brightcoveid"),this.playerId=this.$embed.data("playerid"),this.playerKey=this.$embed.data("playerkey"),this.defaultVideoId=this.$embed.data("videoid"),this.activeEl=t(".sp-video-player .active"),this.$nextEl=t(".sp-video-player .active").next(),this.nextAsset=t(".sp-video-player .active").next().find("a").data("id"),this.playlistLength=t(".sp-video-player .item").length,this.$playerEl=t(".sp-video-player .player"),this.$videoStillEl=t(".sp-video-player .video-still"),this.videoStillVisible=!0,this.$videoObj=this.$playerEl,this.cuedVideoId=this.$spVideoObj.first().data("id"),this.videoType="",this.autoRotate=this.$playerEl.data("autorotate"),this.adServerUrl=this.$embed.data("adserverurl"),this.subviews={},this.$sponsorlogo=t(".sp-player-sponsor"),e.bindAll(this,"_buildBrightCoveLoadCallback","swapStillToVideo","onTemplateReady","onBrightCoveLoad","onVideoComplete","onVideoStart","pausePlayer","unpausePlayer","isPlayingHandler","determineCompletion"),this.$embed.empty(),this.$videoStillEl.show(),this.updateActiveItem(t(".sp-video-player .item").first()),window.swfobject.hasFlashPlayerVersion("1")&&t(".sp-video-player .player .embed").hide(),this.embedHtml='<object id="'+this.brightcoveId+'" class="BrightcoveExperience">',this.embedHtml+='<param name="bgcolor" value="#FFFFFF" />',this.embedHtml+='<param name="width" value="464" />',this.embedHtml+='<param name="height" value="262" />',this.embedHtml+='<param name="playerID" value="'+this.playerId+'" />',this.embedHtml+='<param name="playerKey" value="'+this.playerKey+'" />',this.embedHtml+='<param name="autoStart" value="true" />',this.embedHtml+='<param name="isVid" value="true" />',this.embedHtml+='<param name="isUI" value="true" />',this.embedHtml+='<param name="wmode" value="transparent" />',this.embedHtml+='<param name="htmlFallback" value="true" />',this.embedHtml+='<param name="usat_hasEmbed" value="true" />',this.embedHtml+='<param name="usat_shareFunction" value="function(){setTimeout(&quot;$(\'.util-bar-btn-facebook-video\').click();&quot;, 1)}" />',this.embedHtml+='<param name="dynamicStreaming" value="true" />',this.embedHtml+='<param name="@videoPlayer" value="'+this.defaultVideoId+'" />',this.embedHtml+='<param name="includeAPI" value="true" />',this.embedHtml+='<param name="templateLoadHandler" value="BCLoad" />',""!==this.adServerUrl&&(this.embedHtml+='<param name="adServerURL" value="'+this.adServerUrl+'" />'),this.embedHtml+="</object>",t(".sp-video-player .player .embed").html(this.embedHtml)},initVideoAsset:function(e){e.preventDefault();var i=t(e.currentTarget).data("id"),s=t(e.currentTarget).parent();this.videoStillVisible===!0?(t(e.currentTarget).parent().hasClass("item")&&t("#"+this.brightcoveId).find('param[name="@videoPlayer"]').val(i),this.loadScripts(e)):this.loadVideoById(i,s)},loadVideoById:function(e,i){this.updateTrackingDataObj(t(i)),this.cuedVideoId=e,this.closeShare(),this.updateActiveItem(i),this.modVP.loadVideoByID(e),this.populateUtilityShare(t(i).find("a"))},loadScripts:function(t){require(["http://admin.brightcove.com/js/BrightcoveExperiences.js"],e.bind(function(){"undefined"!=typeof window.brightcove?(console.log("Brightcove loaded"),this._buildBrightCoveLoadCallback(),this.swapStillToVideo(t)):console.log("Error loading Brightcove")},this))},swapStillToVideo:function(s){i.stopRefreshTimer(),this.initShareEvents(),this.videoStillVisible=!1,this.$videoStillEl.fadeOut("fast",e.bind(function(){if(t(s.currentTarget).parent().hasClass("item")){{var e=t(s.currentTarget).data("id");t(s.currentTarget).parent()}this.cuedVideoId=e,this.updateTrackingDataObj(t(s.currentTarget).parent()),this.updateActiveItem(t(s.currentTarget).parent()),this.populateUtilityShare(t(s.currentTarget))}this.$embed.css("display","block"),this.populateUtilityShare(t(this.activeEl).find("a"))},this))},initShareEvents:function(){this.subviews.shareTools=new a({el:".sp-video-player"})},destroy:function(){if(this.$sponsorlogo.empty(),i.startRefreshTimer(),this.brightcoveId&&window.brightcove&&(this.player||window.brightcove.api&&(this.player=window.brightcove.api.getExperience(this.brightcoveId)),this.player&&(this.modVP||(this.modVP=this.player.getModule(window.brightcove.api.modules.APIModules.VIDEO_PLAYER)),this.modVP&&window.site_config.SMARTPLAYER&&(this.modVP.getIsPlaying(this.isPlayingHandler),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.BEGIN,this.onVideoStart),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.COMPLETE,this.onVideoComplete),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PLAY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.STOP,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.SEEK_NOTIFY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PROGRESS,this.throttledDetermine))),window.brightcove&&(window.brightcove.experiences&&delete window.brightcove.experiences[this.brightcoveId],window.brightcove.instances&&delete window.brightcove.instances[this.brightcoveId])),window.BCCallbacks){if(window.BCCallbacks[this.brightcoveId]&&delete window.BCCallbacks[this.brightcoveId],0===e.size(window.BCCallbacks)){window.BCCallbacks=void 0,window.BCLoad=void 0;try{delete window.BCCallbacks,delete window.BCLoad}catch(t){}}}else console.warn("BCCallbacks no longer available on video destroy");n.prototype.destroy.apply(this,arguments)}});return l}),define("modules/stories/sponsored-series-topbar",["jquery","underscore","baseview"],function(t,e,i){"use strict";var s=i.extend({animationTime:200,events:{"click .close-drawer":"closeDrawer","click nav ul li a":"toggleDrawer"},closeDrawer:function(){return this.$navAnchors.removeClass("open"),this.$drawer.slideUp(this.animationTime,e.bind(function(){this.$drawer.removeClass("open").removeAttr("style"),this.$openSection.removeClass("open").removeAttr("style"),this.$openSection=null},this)),!1},initialize:function(e){this.options=t.extend({},e),this.$navAnchors=this.$("nav ul li a"),this.$drawer=this.$(".drawer"),this.$sectionAbout=t(".sponsor-about",this.$drawer),this.$sectionResources=t(".sponsor-resources",this.$drawer),this.$sectionVideos=t(".sponsor-videos",this.$drawer)},toggleDrawer:function(i){var s=t(i.target);if(s.hasClass("open"))this.closeDrawer();else{this.$navAnchors.removeClass("open"),s.addClass("open");var n=null;switch(s.attr("href")){case"#sponsor-about":n=this.$sectionAbout;break;case"#sponsor-resources":n=this.$sectionResources;break;case"#sponsor-videos":n=this.$sectionVideos}this.$openSection?this.$openSection.slideUp(this.animationTime,e.bind(function(){this.$openSection.removeClass("open").removeAttr("style"),n.slideDown(this.animationTime,e.bind(function(){n.addClass("open").removeAttr("style")},this))},this)):(n.addClass("open").removeAttr("style"),this.$drawer.slideDown(this.animationTime,e.bind(function(){this.$drawer.addClass("open").removeAttr("style")},this))),this.$openSection=n}return!1}});return s}),define("modules/book-reviews/books-three-up",["jquery","underscore","baseview","state","managers/routemanager","form/base-form"],function(t,e,i,s,n,o){"use strict";var r=i.extend({events:{"submit #ListFilter":"submitBooklistSearchForm"},initialize:function(t){i.prototype.initialize.call(this,t),this.$searchForm=this.$("#ListFilter"),this.$searchTypes=this.$('input[name="search_type"]'),this.$searchField=this.$("#books-list-search"),this.searchBase=this.$searchForm.attr("action"),this.booklistBaseUrl="/life/books/best-selling/",this.subviews.baseform=new o({el:this.$("#ListFilter")})},submitBooklistSearchForm:function(t){t.preventDefault();var e=this.$(":checked",this.$searchTypes).val(),i=this.$searchField.val(),s=""!==i?this.searchBase+e+"/"+encodeURIComponent(i)+"/":this.booklistBaseUrl;
n.goTo(s)}});return r}),define("modules/twitter",["jquery","underscore","state","baseview","modules/scroller/sidebar-scroll"],function(t,e,i,s,n){"use strict";var o=s.extend({initialize:function(e){e=t.extend({layoutType:null},e),this.$twitterEl=this.$(".twm-wrapper"),this.isFixed=this.$el.closest(".sidebar-fixed-content").length,s.prototype.initialize.call(this,e)},renderCardInfo:function(t){"sidebar"===this.options.layoutType&&t.sidebarOpen&&this.addScrollbar()},openSideBar:function(){this.renderCardInfo({sidebarOpen:!0})},destroy:function(t){t&&this.$twitterEl.empty(),s.prototype.destroy.call(this,!1)},onSidebarScrollableHeightChange:function(i,s){if("sidebar"===this.options.layoutType){var n=e.reduce(this.$el.siblings(".card-sidebar"),function(e,i){return e+t(i).outerHeight()},0);this.$el.css("height",(this.isFixed?i:s)-n),this.refreshScrollbar()}},refreshScrollbar:function(){this.subviews&&this.subviews.scrollbar&&this.subviews.scrollbar.refresh(),"sidebar"!==this.options.layoutType||this.isFixed||i.getActiveApp().triggerEvent("refreshSidebarScroll")},addScrollbar:function(){this.subviews.scrollbar=new n({el:this.$(".twitter-sidebar-content"),color:"light",lockPageScroll:!0,fadeout:!0})}});return o}),define("modules/car-search",["jquery","underscore","baseview","state","form/base-form","ui/button-toggle"],function(t,e,i,s,n){"use strict";var o=i.extend({events:{"submit .cars-form-wrap":"onFormSubmit","click .cars-form-radio":"onNewUsedToggleSelect"},initialize:function(t){i.prototype.initialize.call(this,t),e.bindAll(this,"onNewUsedToggleSelect","onMakeDropdownSelect","onModelDropdownSelect"),this.form=this.$(".cars-form-wrap"),this.baseFormUrl=this.form.attr("action"),this.form.attr("action",this._buildFormUrl(this.baseFormUrl)),this.subviews.carSearchForm=new n({el:this.form,formOptions:[{el:this.$(".cars-make-dropdown"),onSelect:this.onMakeDropdownSelect},{el:this.$(".cars-model-dropdown"),onSelect:this.onModelDropdownSelect}]})},onNewUsedToggleSelect:function(i){var n=t(i.currentTarget).data("value"),o="/services/cars/dropdown/"+n+"/all";s.fetchData(o).done(e.bind(function(e){this.parseDropdown("formItem2",t.parseHTML(e));var i=this.getDropdownResetHtml("Model");this.parseDropdown("formItem3",i)},this)),this.setNewUsedHiddenValues(n),this.form.attr("action",this._buildFormUrl(this.baseFormUrl))},_buildFormUrl:function(t){var e=this.$(".ui-radio-selected").data("value"),i=t;return i+="used"===e?"for-sale/searchresults.action":"go/search/newBuyIndex.jsp"},setNewUsedHiddenValues:function(t){"used"===t?(this.$("input:hidden[name='stkTyp']").val("U"),this.$("input:hidden[name='tracktype']").val("usedcc")):(this.$("input:hidden[name='stkTyp']").val("N"),this.$("input:hidden[name='tracktype']").val("newcc"))},getDropdownResetHtml:function(t){return'<option class="uotrack" value="All" selected="selected">'+t+"</option>"},onMakeDropdownSelect:function(t,i){var n,o,r=this.$(".ui-radio-selected").data("value");n="All"===t?"All":i,this.currentMakeSelectValue=n,o="/services/cars/dropdown/"+r+"/"+e.escape(n.toLowerCase()),s.fetchData(o).done(e.bind(function(e){if("All"===t){var i=this.getDropdownResetHtml("Model");this.parseDropdown("formItem3",i)}else this.parseDropdown("formItem3",e)},this)),this.setMakeHiddenValues(t,i)},onModelDropdownSelect:function(t,e){this.setModelHiddenValues(t,e)},setMakeHiddenValues:function(t,e){this.$("input:hidden[name='AmbMkId']").val(t),this.$("input:hidden[name='AmbMkNm']").val(e),this.$("input:hidden[name='mkId']").val(t)},setModelHiddenValues:function(t,e){this.$("input:hidden[name='AmbMdId']").val(t),this.$("input:hidden[name='AmbMdNm']").val(e),this.$("input:hidden[name='mdId']").val(t)},parseDropdown:function(t,e){this.subviews.carSearchForm.subviews[t].refresh(e)},onFormSubmit:function(t){var e=this.$(".cars-form-input-zip"),i=/^\d{5}(?:[-\s]\d{4})?$/,s=this.$("#cars-form-make-select option:selected").val(),n=this.$("#cars-form-model-select option:selected").val();i.test(e.val())?e.removeClass("ui-form-field-error"):(t.preventDefault(),e.addClass("ui-form-field-error")),"All"===s&&(this.$("#cars-form-make-select option:selected").removeAttr("value"),this.setMakeHiddenValues("","")),"All"===n&&(this.$("#cars-form-model-select option:selected").removeAttr("value"),this.setModelHiddenValues("",""))},destroy:function(t){this.form.attr("action",this.baseFormUrl),i.prototype.destroy.call(this,t)}});return o}),define("modules/money/market-symbol-search",["jquery","underscore","baseview","state","utils","pubsub","form/autocomplete","directAdPosition"],function(t,e,i,s,n,o,r,a){"use strict";var l=i.extend({events:{submit:"onFormSubmit"},initialize:function(t){i.prototype.initialize.call(this,t),e.bindAll(this,"onStockSelect"),this._initAd(),this.$lookupInput=this.$(".money-markets-stock-lookup-input"),this.subviews.autocomplete=new r({el:this.$lookupInput,resultDisplayTemplate:"<%= Symbol %> - <%= Name %>",resultValueTemplate:"<%= Symbol %>",onSelect:this.onStockSelect})},_initAd:function(){var t=this.$(".mss-quote-ad");t.length&&(this.subviews.ad=new a({el:t,adSizes:[88,31],adPlacement:"sponsor_logo",adType:"sponsor_logo",pageInfo:s.getActivePageInfo()}))},onStockSelect:function(t,e){var i=this.parseStockPath(e.SymbolType);this.setStockPath(i),this.$el.is("form")?this.$el.submit():this.$("form").submit()},setStockPath:function(t){this.$$(".money-markets-stock-lookup-path-input").val(t),this.triggerABTestingEvent()},getStockPath:function(){return this.$$(".money-markets-stock-lookup-path-input").val()},parseStockPath:function(t){var e="stocks";if(t)switch(t){case"C":e="stocks";break;case"F":e="mutual-funds";break;case"G":e="etfs"}return e},onFormSubmit:function(t){if(!this.getStockPath()&&(t.preventDefault(),this.$lookupInput.val())){var i=this.$lookupInput.val().toUpperCase();s.fetchData(this.$lookupInput.data("autocomplete-url")+i).done(e.bind(function(t){t&&t.length&&(e.each(t,function(t){t.Symbol===i&&(this.setStockPath(this.parseStockPath(t.SymbolType)),this.$lookupInput.val(i))},this),this.$el.submit())},this))}},triggerABTestingEvent:function(){var t=s.getActivePageInfo();if(t.ab_test_id){var e=t.ab_test_id+"|"+t.ab_test_variant||"control";o.trigger("abtesttrack",e)}},destroy:function(t){this.$$(".money-markets-stock-lookup-path-input").val(""),this.$lookupInput.blur(),i.prototype.destroy.call(this,t)}});return l}),define("modules/fronts/elections-module",["jquery","underscore","backbone","baseview","pubsub","state"],function(t,e,i,s,n,o){"use strict";var r=s.extend({el:".elections-module-container",events:{"click .epm-selector":"displayChanger","click .epm-counter-div":"changeSlide","click .epm-module-link":"trackFull"},initialize:function(t){s.prototype.initialize.call(this,t),this.loadData("senate")},loadData:function(t){var i=this,s="/services/webproxy/?url=http://www.gannett-cdn.com/GDContent/2014/elections/api-scrapers/data/key-race-index.json";o.fetchData(s).done(e.bind(function(e){"key"==t?i.keyRaces(t,e):i.fillBars(t,e)},this))},fillBars:function(t,e){n.trigger("uotrack","elections2014"+t+".m");var i=0,s=0,o=100,r=[];"governor"==t?(s=25,i=50,r=e.govdata[0]):"house"==t?(s=100,i=435,r=e.housedata[0]):(s=100,i=100,r=e.senatedata[0]);var a=r.dem*o/i,l=r.leandem*o/i,h=r.repub*o/i,c=r.leanrepub*o/i,d=r.other*o/i;"house"!=t&&(s+=50),setTimeout(function(){this.$(".epm-democrat ").animate({width:a+"%"},50),this.$(".epm-lean-democrat ").animate({width:l+"%"},50),this.$(".epm-republican").animate({width:h+"%"},50),this.$(".epm-lean-republican").animate({width:c+"%"},50),this.$(".epm-tossup").animate({width:d+"%"},50)},100),this.$("#democrat ").html(r.dem),this.$("#lean-democrat ").html(r.leandem),this.$("#republican").html(r.repub),this.$("#lean-republican").html(r.leanrepub),this.$("#tossup").html(r.other)},keyRaces:function(t,e){n.trigger("uotrack","elections2014"+t+".m");var i=0;if(0===this.$(".epm-carousel-li").length){for(var s=e.races,o="",r="",a="",l="",h="",c=1;c<s.length;c++){{var d=s[c],u=d.stp,p=u.toLowerCase(),f=0;s.length-1}"RL"==d.lean?(r="r-lean",a="Lean Republican"):"DL"==d.lean?(r="d-lean",a="Lean Democrat"):"T"==d.lean?(r="t-lean",a="Tossup"):(r="t-lean",a="No Lean"),l="";for(var g=0;g<d.cand.length;g++){var m=d.cand[g];2>f&&(l+="<p class='epm-candidate "+m.pty+" "+m.inc+"'>"+m.lname+"</p>"),f++}var v="/pages/interactives/elections-forecast-2014/#/race/",y="<a class='epm-candidate-box' target='_blank' href='"+v+d.id+"'>";y+="<div class='epm-candidate-state "+r+"'>"+d.st+"<span class='epm-state-holder state-icon state-lg-"+p+"'></span></div>",y+="<div class='epm-candidate-candidates'>",y+="<div class='epm-lean-container "+r+"'>"+a+"</div>",y+="<span class='epm-candidate-container'>"+l+"</span></div>",y+="</a>",c%3===0?(h+=y,o+="<li class='epm-carousel-li'>"+h+"</li>",h="",i++):h+=y}""!==h&&(o+="<li class='epm-carousel-li'>"+h+"</li>",i++),this.$(".epm-key-races-container").append(o),this.slideCalc(i)}},displayChanger:function(e){var i=t(e.target).attr("id");this.$(".epm-races-holder, .epm-key-races, .epm-governor-numbers, .epm-house-numbers, .epm-senate-numbers").hide(),"key"==i?(this.loadData("key"),this.$(".epm-map").hide(),this.$(".epm-key-races").show()):(this.loadData(i),this.$(".epm-map").show(),this.$(".epm-races-holder").show(),this.$(".epm-"+i+"-numbers").show()),this.$(".epm-selector").removeClass("selected"),this.$("#"+i).addClass("selected")},slideCalc:function(t){var e=522*t+"px";if(this.$(".epm-key-races-container").width(e),0===this.$(".epm-counter-div").length){for(var i="<div class='selected epm-counter-div' id='slide-0'></div>",s=t-1,n=0;s>n;n++){var o=n+1;i+="<div class='epm-counter-div' id='slide-"+o+"'></div>"}this.$(".epm-module-navigation").append(i)}var r=this.$(".elections-module-navigation").width(),a=510-r,l=a/2+"px";this.$(".epm-module-navigation").css("margin-left",l)},changeSlide:function(e){this.$(".epm-counter-div").removeClass("selected"),t(e.target).addClass("selected");var i=t(e.target).attr("id"),s=i.split("-"),n=s[1],o=522*n+"px";this.$(".epm-key-races-container").animate({marginLeft:"-"+o},500)},trackFull:function(){n.trigger("uotrack","elections2014full")}});return r}),define("modules/interactives/interactive-ads",["jquery","underscore","backbone","pubsub","utils","baseview","directAdPosition"],function(t,e,i,s,n,o,r){var a=o.extend({initialize:function(t){o.prototype.initialize.call(this,t),this.$el.length>0&&this.setupAds()},setupAds:function(){var t=this.$el.data(),e={title:t.seoTitle,series:t.series,sitePage:"usat/"+(t.ssts||"").replace(/\/\/*$/,""),topic:t.topic};this.subviews.sponsorshipAd=new r({el:this.$el,adPlacement:"sponsor_logo/interactive",adSizes:["sponsor_logo"],targeting:e})}});return a}),document.createElement("canvas").getContext||!function(){function t(){return this.context_||(this.context_=new w(this))}function e(t,e){var i=B.call(arguments,2);return function(){return t.apply(e,i.concat(B.call(arguments)))}}function i(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function s(t,e,i){t.namespaces[e]||t.namespaces.add(e,i,"#default#VML")}function n(t){if(s(t,"g_vml_","urn:schemas-microsoft-com:vml"),s(t,"g_o_","urn:schemas-microsoft-com:office:office"),!t.styleSheets.ex_canvas_){var e=t.createStyleSheet();e.owningElement.id="ex_canvas_",e.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}"}}function o(t){var e=t.srcElement;switch(t.propertyName){case"width":e.getContext().clearRect(),e.style.width=e.attributes.width.nodeValue+"px",e.firstChild.style.width=e.clientWidth+"px";break;case"height":e.getContext().clearRect(),e.style.height=e.attributes.height.nodeValue+"px",e.firstChild.style.height=e.clientHeight+"px"}}function r(t){var e=t.srcElement;e.firstChild&&(e.firstChild.style.width=e.clientWidth+"px",e.firstChild.style.height=e.clientHeight+"px")}function a(){return[[1,0,0],[0,1,0],[0,0,1]]}function l(t,e){for(var i=a(),s=0;3>s;s++)for(var n=0;3>n;n++){for(var o=0,r=0;3>r;r++)o+=t[s][r]*e[r][n];i[s][n]=o}return i}function h(t,e){e.fillStyle=t.fillStyle,e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.shadowBlur=t.shadowBlur,e.shadowColor=t.shadowColor,e.shadowOffsetX=t.shadowOffsetX,e.shadowOffsetY=t.shadowOffsetY,e.strokeStyle=t.strokeStyle,e.globalAlpha=t.globalAlpha,e.font=t.font,e.textAlign=t.textAlign,e.textBaseline=t.textBaseline,e.arcScaleX_=t.arcScaleX_,e.arcScaleY_=t.arcScaleY_,e.lineScale_=t.lineScale_}function c(t){var e=t.indexOf("(",3),i=t.indexOf(")",e+1),s=t.substring(e+1,i).split(",");return(4!=s.length||"a"!=t.charAt(3))&&(s[3]=1),s}function d(t){return parseFloat(t)/100}function u(t,e,i){return Math.min(i,Math.max(e,t))}function p(t){var e,i,s,n,o,r;if(n=parseFloat(t[0])/360%360,0>n&&n++,o=u(d(t[1]),0,1),r=u(d(t[2]),0,1),0==o)e=i=s=r;else{var a=.5>r?r*(1+o):r+o-r*o,l=2*r-a;e=f(l,a,n+1/3),i=f(l,a,n),s=f(l,a,n-1/3)}return"#"+U[Math.floor(255*e)]+U[Math.floor(255*i)]+U[Math.floor(255*s)]}function f(t,e,i){return 0>i&&i++,i>1&&i--,1>6*i?t+6*(e-t)*i:1>2*i?e:2>3*i?t+(e-t)*(2/3-i)*6:t}function g(t){if(t in W)return W[t];var e,i=1;if(t=String(t),"#"==t.charAt(0))e=t;else if(/^rgb/.test(t)){for(var s,n=c(t),e="#",o=0;3>o;o++)s=-1!=n[o].indexOf("%")?Math.floor(255*d(n[o])):+n[o],e+=U[u(s,0,255)];i=+n[3]}else if(/^hsl/.test(t)){var n=c(t);e=p(n),i=n[3]}else e=V[t]||t;return W[t]={color:e,alpha:i}}function m(t){if(Y[t])return Y[t];var e=document.createElement("div"),i=e.style;try{i.font=t}catch(s){}return Y[t]={style:i.fontStyle||G.style,variant:i.fontVariant||G.variant,weight:i.fontWeight||G.weight,size:i.fontSize||G.size,family:i.fontFamily||G.family}}function v(t,e){var i={};for(var s in t)i[s]=t[s];var n=parseFloat(e.currentStyle.fontSize),o=parseFloat(t.size);return i.size="number"==typeof t.size?t.size:-1!=t.size.indexOf("px")?o:-1!=t.size.indexOf("em")?n*o:-1!=t.size.indexOf("%")?n/100*o:-1!=t.size.indexOf("pt")?o/.75:n,i.size*=.981,i}function y(t){return t.style+" "+t.variant+" "+t.weight+" "+t.size+"px "+t.family}function b(t){return Z[t]||"square"}function w(t){this.m_=a(),this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.strokeStyle="#000",this.fillStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*R,this.globalAlpha=1,this.font="10px sans-serif",this.textAlign="left",this.textBaseline="alphabetic",this.canvas=t;var e="width:"+t.clientWidth+"px;height:"+t.clientHeight+"px;overflow:hidden;position:absolute",i=t.ownerDocument.createElement("div");i.style.cssText=e,t.appendChild(i);var s=i.cloneNode(!1);s.style.backgroundColor="red",s.style.filter="alpha(opacity=0)",t.appendChild(s),this.element_=i,this.arcScaleX_=1,this.arcScaleY_=1,this.lineScale_=1}function _(t,e,i,s){t.currentPath_.push({type:"bezierCurveTo",cp1x:e.x,cp1y:e.y,cp2x:i.x,cp2y:i.y,x:s.x,y:s.y}),t.currentX_=s.x,t.currentY_=s.y}function x(t,e){var i=g(t.strokeStyle),s=i.color,n=i.alpha*t.globalAlpha,o=t.lineScale_*t.lineWidth;1>o&&(n*=o),e.push("<g_vml_:stroke",' opacity="',n,'"',' joinstyle="',t.lineJoin,'"',' miterlimit="',t.miterLimit,'"',' endcap="',b(t.lineCap),'"',' weight="',o,'px"',' color="',s,'" />')}function k(t,e,i,s){var n=t.fillStyle,o=t.arcScaleX_,r=t.arcScaleY_,a=s.x-i.x,l=s.y-i.y;if(n instanceof $){var h=0,c={x:0,y:0},d=0,u=1;if("gradient"==n.type_){var p=n.x0_/o,f=n.y0_/r,m=n.x1_/o,v=n.y1_/r,y=C(t,p,f),b=C(t,m,v),w=b.x-y.x,_=b.y-y.y;h=180*Math.atan2(w,_)/Math.PI,0>h&&(h+=360),1e-6>h&&(h=0)}else{var y=C(t,n.x0_,n.y0_);c={x:(y.x-i.x)/a,y:(y.y-i.y)/l},a/=o*R,l/=r*R;var x=M.max(a,l);d=2*n.r0_/x,u=2*n.r1_/x-d}var k=n.colors_;k.sort(function(t,e){return t.offset-e.offset});for(var S=k.length,T=k[0].color,P=k[S-1].color,I=k[0].alpha*t.globalAlpha,D=k[S-1].alpha*t.globalAlpha,E=[],L=0;S>L;L++){var F=k[L];E.push(F.offset*u+d+" "+F.color)}e.push('<g_vml_:fill type="',n.type_,'"',' method="none" focus="100%"',' color="',T,'"',' color2="',P,'"',' colors="',E.join(","),'"',' opacity="',D,'"',' g_o_:opacity2="',I,'"',' angle="',h,'"',' focusposition="',c.x,",",c.y,'" />')}else if(n instanceof A){if(a&&l){var z=-i.x,O=-i.y;e.push("<g_vml_:fill",' position="',z/a*o*o,",",O/l*r*r,'"',' type="tile"',' src="',n.src_,'" />')}}else{var N=g(t.fillStyle),B=N.color,j=N.alpha*t.globalAlpha;e.push('<g_vml_:fill color="',B,'" opacity="',j,'" />')}}function C(t,e,i){var s=t.m_;return{x:R*(e*s[0][0]+i*s[1][0]+s[2][0])-N,y:R*(e*s[0][1]+i*s[1][1]+s[2][1])-N}}function S(t){return isFinite(t[0][0])&&isFinite(t[0][1])&&isFinite(t[1][0])&&isFinite(t[1][1])&&isFinite(t[2][0])&&isFinite(t[2][1])}function T(t,e,i){if(S(e)&&(t.m_=e,i)){var s=e[0][0]*e[1][1]-e[0][1]*e[1][0];t.lineScale_=O(z(s))}}function $(t){this.type_=t,this.x0_=0,this.y0_=0,this.r0_=0,this.x1_=0,this.y1_=0,this.r1_=0,this.colors_=[]}function A(t,e){switch(I(t),e){case"repeat":case null:case"":this.repetition_="repeat";break;case"repeat-x":case"repeat-y":case"no-repeat":this.repetition_=e;break;default:P("SYNTAX_ERR")}this.src_=t.src,this.width_=t.width,this.height_=t.height}function P(t){throw new D(t)}function I(t){t&&1==t.nodeType&&"IMG"==t.tagName||P("TYPE_MISMATCH_ERR"),"complete"!=t.readyState&&P("INVALID_STATE_ERR")}function D(t){this.code=this[t],this.message=t+": DOM Exception "+this.code}var M=Math,E=M.round,L=M.sin,F=M.cos,z=M.abs,O=M.sqrt,R=10,N=R/2,B=(+navigator.userAgent.match(/MSIE ([\d.]+)?/)[1],Array.prototype.slice);n(document);var j={init:function(t){var i=t||document;i.createElement("canvas"),i.attachEvent("onreadystatechange",e(this.init_,this,i))},init_:function(t){for(var e=t.getElementsByTagName("canvas"),i=0;i<e.length;i++)this.initElement(e[i])},initElement:function(e){if(!e.getContext){e.getContext=t,n(e.ownerDocument),e.innerHTML="",e.attachEvent("onpropertychange",o),e.attachEvent("onresize",r);var i=e.attributes;i.width&&i.width.specified?e.style.width=i.width.nodeValue+"px":e.width=e.clientWidth,i.height&&i.height.specified?e.style.height=i.height.nodeValue+"px":e.height=e.clientHeight}return e}};j.init();for(var U=[],H=0;16>H;H++)for(var q=0;16>q;q++)U[16*H+q]=H.toString(16)+q.toString(16);var V={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",grey:"#808080",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",oldlace:"#FDF5E6",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",whitesmoke:"#F5F5F5",yellowgreen:"#9ACD32"},W={},G={style:"normal",variant:"normal",weight:"normal",size:10,family:"sans-serif"},Y={},Z={butt:"flat",round:"round"},X=w.prototype;X.clearRect=function(){this.textMeasureEl_&&(this.textMeasureEl_.removeNode(!0),this.textMeasureEl_=null),this.element_.innerHTML=""},X.beginPath=function(){this.currentPath_=[]},X.moveTo=function(t,e){var i=C(this,t,e);this.currentPath_.push({type:"moveTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},X.lineTo=function(t,e){var i=C(this,t,e);this.currentPath_.push({type:"lineTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},X.bezierCurveTo=function(t,e,i,s,n,o){var r=C(this,n,o),a=C(this,t,e),l=C(this,i,s);_(this,a,l,r)},X.quadraticCurveTo=function(t,e,i,s){var n=C(this,t,e),o=C(this,i,s),r={x:this.currentX_+2/3*(n.x-this.currentX_),y:this.currentY_+2/3*(n.y-this.currentY_)},a={x:r.x+(o.x-this.currentX_)/3,y:r.y+(o.y-this.currentY_)/3};_(this,r,a,o)},X.arc=function(t,e,i,s,n,o){i*=R;var r=o?"at":"wa",a=t+F(s)*i-N,l=e+L(s)*i-N,h=t+F(n)*i-N,c=e+L(n)*i-N;a!=h||o||(a+=.125);var d=C(this,t,e),u=C(this,a,l),p=C(this,h,c);this.currentPath_.push({type:r,x:d.x,y:d.y,radius:i,xStart:u.x,yStart:u.y,xEnd:p.x,yEnd:p.y})},X.rect=function(t,e,i,s){this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+s),this.lineTo(t,e+s),this.closePath()},X.strokeRect=function(t,e,i,s){var n=this.currentPath_;this.beginPath(),this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+s),this.lineTo(t,e+s),this.closePath(),this.stroke(),this.currentPath_=n},X.fillRect=function(t,e,i,s){var n=this.currentPath_;this.beginPath(),this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+s),this.lineTo(t,e+s),this.closePath(),this.fill(),this.currentPath_=n},X.createLinearGradient=function(t,e,i,s){var n=new $("gradient");return n.x0_=t,n.y0_=e,n.x1_=i,n.y1_=s,n},X.createRadialGradient=function(t,e,i,s,n,o){var r=new $("gradientradial");return r.x0_=t,r.y0_=e,r.r0_=i,r.x1_=s,r.y1_=n,r.r1_=o,r},X.drawImage=function(t){var e,i,s,n,o,r,a,l,h=t.runtimeStyle.width,c=t.runtimeStyle.height;t.runtimeStyle.width="auto",t.runtimeStyle.height="auto";var d=t.width,u=t.height;if(t.runtimeStyle.width=h,t.runtimeStyle.height=c,3==arguments.length)e=arguments[1],i=arguments[2],o=r=0,a=s=d,l=n=u;else if(5==arguments.length)e=arguments[1],i=arguments[2],s=arguments[3],n=arguments[4],o=r=0,a=d,l=u;else{if(9!=arguments.length)throw Error("Invalid number of arguments");o=arguments[1],r=arguments[2],a=arguments[3],l=arguments[4],e=arguments[5],i=arguments[6],s=arguments[7],n=arguments[8]}var p=C(this,e,i),f=[],g=10,m=10;if(f.push(" <g_vml_:group",' coordsize="',R*g,",",R*m,'"',' coordorigin="0,0"',' style="width:',g,"px;height:",m,"px;position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]||1!=this.m_[1][1]||this.m_[1][0]){var v=[];v.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",E(p.x/R),",","Dy=",E(p.y/R),"");var y=p,b=C(this,e+s,i),w=C(this,e,i+n),_=C(this,e+s,i+n);y.x=M.max(y.x,b.x,w.x,_.x),y.y=M.max(y.y,b.y,w.y,_.y),f.push("padding:0 ",E(y.x/R),"px ",E(y.y/R),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",v.join(""),", sizingmethod='clip');")}else f.push("top:",E(p.y/R),"px;left:",E(p.x/R),"px;");f.push(' ">','<g_vml_:image src="',t.src,'"',' style="width:',R*s,"px;"," height:",R*n,'px"',' cropleft="',o/d,'"',' croptop="',r/u,'"',' cropright="',(d-o-a)/d,'"',' cropbottom="',(u-r-l)/u,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",f.join(""))},X.stroke=function(t){for(var e=10,i=10,s=5e3,n={x:null,y:null},o={x:null,y:null},r=0;r<this.currentPath_.length;r+=s){var a=[];a.push("<g_vml_:shape",' filled="',!!t,'"',' style="position:absolute;width:',e,"px;height:",i,'px;"',' coordorigin="0,0"',' coordsize="',R*e,",",R*i,'"',' stroked="',!t,'"',' path="');for(var l=r;l<Math.min(r+s,this.currentPath_.length);l++){l%s==0&&l>0&&a.push(" m ",E(this.currentPath_[l-1].x),",",E(this.currentPath_[l-1].y));var h,c=this.currentPath_[l];switch(c.type){case"moveTo":h=c,a.push(" m ",E(c.x),",",E(c.y));break;case"lineTo":a.push(" l ",E(c.x),",",E(c.y));break;case"close":a.push(" x "),c=null;break;case"bezierCurveTo":a.push(" c ",E(c.cp1x),",",E(c.cp1y),",",E(c.cp2x),",",E(c.cp2y),",",E(c.x),",",E(c.y));break;case"at":case"wa":a.push(" ",c.type," ",E(c.x-this.arcScaleX_*c.radius),",",E(c.y-this.arcScaleY_*c.radius)," ",E(c.x+this.arcScaleX_*c.radius),",",E(c.y+this.arcScaleY_*c.radius)," ",E(c.xStart),",",E(c.yStart)," ",E(c.xEnd),",",E(c.yEnd))}c&&((null==n.x||c.x<n.x)&&(n.x=c.x),(null==o.x||c.x>o.x)&&(o.x=c.x),(null==n.y||c.y<n.y)&&(n.y=c.y),(null==o.y||c.y>o.y)&&(o.y=c.y))}a.push(' ">'),t?k(this,a,n,o):x(this,a),a.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",a.join(""))}},X.fill=function(){this.stroke(!0)},X.closePath=function(){this.currentPath_.push({type:"close"})},X.save=function(){var t={};h(this,t),this.aStack_.push(t),this.mStack_.push(this.m_),this.m_=l(a(),this.m_)},X.restore=function(){this.aStack_.length&&(h(this.aStack_.pop(),this),this.m_=this.mStack_.pop())},X.translate=function(t,e){var i=[[1,0,0],[0,1,0],[t,e,1]];T(this,l(i,this.m_),!1)},X.rotate=function(t){var e=F(t),i=L(t),s=[[e,i,0],[-i,e,0],[0,0,1]];T(this,l(s,this.m_),!1)},X.scale=function(t,e){this.arcScaleX_*=t,this.arcScaleY_*=e;var i=[[t,0,0],[0,e,0],[0,0,1]];T(this,l(i,this.m_),!0)},X.transform=function(t,e,i,s,n,o){var r=[[t,e,0],[i,s,0],[n,o,1]];T(this,l(r,this.m_),!0)},X.setTransform=function(t,e,i,s,n,o){var r=[[t,e,0],[i,s,0],[n,o,1]];T(this,r,!0)},X.drawText_=function(t,e,s,n,o){var r=this.m_,a=1e3,l=0,h=a,c={x:0,y:0},d=[],u=v(m(this.font),this.element_),p=y(u),f=this.element_.currentStyle,g=this.textAlign.toLowerCase();switch(g){case"left":case"center":case"right":break;case"end":g="ltr"==f.direction?"right":"left";break;case"start":g="rtl"==f.direction?"right":"left";break;default:g="left"}switch(this.textBaseline){case"hanging":case"top":c.y=u.size/1.75;break;case"middle":break;default:case null:case"alphabetic":case"ideographic":case"bottom":c.y=-u.size/2.25}switch(g){case"right":l=a,h=.05;break;case"center":l=h=a/2}var b=C(this,e+c.x,s+c.y);d.push('<g_vml_:line from="',-l,' 0" to="',h,' 0.05" ',' coordsize="100 100" coordorigin="0 0"',' filled="',!o,'" stroked="',!!o,'" style="position:absolute;width:1px;height:1px;">'),o?x(this,d):k(this,d,{x:-l,y:0},{x:h,y:u.size});var w=r[0][0].toFixed(3)+","+r[1][0].toFixed(3)+","+r[0][1].toFixed(3)+","+r[1][1].toFixed(3)+",0,0",_=E(b.x/R)+","+E(b.y/R);d.push('<g_vml_:skew on="t" matrix="',w,'" ',' offset="',_,'" origin="',l,' 0" />','<g_vml_:path textpathok="true" />','<g_vml_:textpath on="true" string="',i(t),'" style="v-text-align:',g,";font:",i(p),'" /></g_vml_:line>'),this.element_.insertAdjacentHTML("beforeEnd",d.join(""))},X.fillText=function(t,e,i,s){this.drawText_(t,e,i,s,!1)},X.strokeText=function(t,e,i,s){this.drawText_(t,e,i,s,!0)},X.measureText=function(t){if(!this.textMeasureEl_){var e='<span style="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;"></span>';this.element_.insertAdjacentHTML("beforeEnd",e),this.textMeasureEl_=this.element_.lastChild}var i=this.element_.ownerDocument;return this.textMeasureEl_.innerHTML="",this.textMeasureEl_.style.font=this.font,this.textMeasureEl_.appendChild(i.createTextNode(t)),{width:this.textMeasureEl_.offsetWidth}},X.clip=function(){},X.arcTo=function(){},X.createPattern=function(t,e){return new A(t,e)},$.prototype.addColorStop=function(t,e){e=g(e),this.colors_.push({offset:t,color:e.color,alpha:e.alpha})};var K=D.prototype=new Error;K.INDEX_SIZE_ERR=1,K.DOMSTRING_SIZE_ERR=2,K.HIERARCHY_REQUEST_ERR=3,K.WRONG_DOCUMENT_ERR=4,K.INVALID_CHARACTER_ERR=5,K.NO_DATA_ALLOWED_ERR=6,K.NO_MODIFICATION_ALLOWED_ERR=7,K.NOT_FOUND_ERR=8,K.NOT_SUPPORTED_ERR=9,K.INUSE_ATTRIBUTE_ERR=10,K.INVALID_STATE_ERR=11,K.SYNTAX_ERR=12,K.INVALID_MODIFICATION_ERR=13,K.NAMESPACE_ERR=14,K.INVALID_ACCESS_ERR=15,K.VALIDATION_ERR=16,K.TYPE_MISMATCH_ERR=17,G_vmlCanvasManager=j,CanvasRenderingContext2D=w,CanvasGradient=$,CanvasPattern=A,DOMException=D}(),define("libs/flot/excanvas",function(){}),function(t){t.color={},t.color.make=function(e,i,s,n){var o={};return o.r=e||0,o.g=i||0,o.b=s||0,o.a=null!=n?n:1,o.add=function(t,e){for(var i=0;i<t.length;++i)o[t.charAt(i)]+=e;return o.normalize()},o.scale=function(t,e){for(var i=0;i<t.length;++i)o[t.charAt(i)]*=e;return o.normalize()},o.toString=function(){return o.a>=1?"rgb("+[o.r,o.g,o.b].join(",")+")":"rgba("+[o.r,o.g,o.b,o.a].join(",")+")"},o.normalize=function(){function t(t,e,i){return t>e?t:e>i?i:e}return o.r=t(0,parseInt(o.r),255),o.g=t(0,parseInt(o.g),255),o.b=t(0,parseInt(o.b),255),o.a=t(0,o.a,1),o},o.clone=function(){return t.color.make(o.r,o.b,o.g,o.a)},o.normalize()},t.color.extract=function(e,i){var s;do{if(s=e.css(i).toLowerCase(),""!=s&&"transparent"!=s)break;e=e.parent()}while(!t.nodeName(e.get(0),"body"));return"rgba(0, 0, 0, 0)"==s&&(s="transparent"),t.color.parse(s)},t.color.parse=function(i){var s,n=t.color.make;if(s=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(i))return n(parseInt(s[1],10),parseInt(s[2],10),parseInt(s[3],10));if(s=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(i))return n(parseInt(s[1],10),parseInt(s[2],10),parseInt(s[3],10),parseFloat(s[4]));if(s=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(i))return n(2.55*parseFloat(s[1]),2.55*parseFloat(s[2]),2.55*parseFloat(s[3]));if(s=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(i))return n(2.55*parseFloat(s[1]),2.55*parseFloat(s[2]),2.55*parseFloat(s[3]),parseFloat(s[4]));if(s=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(i))return n(parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16));if(s=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(i))return n(parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16),parseInt(s[3]+s[3],16));var o=t.trim(i).toLowerCase();return"transparent"==o?n(255,255,255,0):(s=e[o]||[0,0,0],n(s[0],s[1],s[2]))};var e={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(t){function e(e,i){var s=i.children("."+e)[0];if(null==s&&(s=document.createElement("canvas"),s.className=e,t(s).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(i),!s.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");
s=window.G_vmlCanvasManager.initElement(s)}this.element=s;var n=this.context=s.getContext("2d"),o=window.devicePixelRatio||1,r=n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1;this.pixelRatio=o/r,this.resize(i.width(),i.height()),this.textContainer=null,this.text={},this._textCache={}}function i(i,n,o,r){function a(t,e){e=[me].concat(e);for(var i=0;i<t.length;++i)t[i].apply(this,e)}function l(){for(var i={Canvas:e},s=0;s<r.length;++s){var n=r[s];n.init(me,i),n.options&&t.extend(!0,ne,n.options)}}function h(e){t.extend(!0,ne,e),e&&e.colors&&(ne.colors=e.colors),null==ne.xaxis.color&&(ne.xaxis.color=t.color.parse(ne.grid.color).scale("a",.22).toString()),null==ne.yaxis.color&&(ne.yaxis.color=t.color.parse(ne.grid.color).scale("a",.22).toString()),null==ne.xaxis.tickColor&&(ne.xaxis.tickColor=ne.grid.tickColor||ne.xaxis.color),null==ne.yaxis.tickColor&&(ne.yaxis.tickColor=ne.grid.tickColor||ne.yaxis.color),null==ne.grid.borderColor&&(ne.grid.borderColor=ne.grid.color),null==ne.grid.tickColor&&(ne.grid.tickColor=t.color.parse(ne.grid.color).scale("a",.22).toString());var s,n,o,r={style:i.css("font-style"),size:Math.round(.8*(+i.css("font-size").replace("px","")||13)),variant:i.css("font-variant"),weight:i.css("font-weight"),family:i.css("font-family")};for(r.lineHeight=1.15*r.size,o=ne.xaxes.length||1,s=0;o>s;++s)n=ne.xaxes[s],n&&!n.tickColor&&(n.tickColor=n.color),n=t.extend(!0,{},ne.xaxis,n),ne.xaxes[s]=n,n.font&&(n.font=t.extend({},r,n.font),n.font.color||(n.font.color=n.color));for(o=ne.yaxes.length||1,s=0;o>s;++s)n=ne.yaxes[s],n&&!n.tickColor&&(n.tickColor=n.color),n=t.extend(!0,{},ne.yaxis,n),ne.yaxes[s]=n,n.font&&(n.font=t.extend({},r,n.font),n.font.color||(n.font.color=n.color));for(ne.xaxis.noTicks&&null==ne.xaxis.ticks&&(ne.xaxis.ticks=ne.xaxis.noTicks),ne.yaxis.noTicks&&null==ne.yaxis.ticks&&(ne.yaxis.ticks=ne.yaxis.noTicks),ne.x2axis&&(ne.xaxes[1]=t.extend(!0,{},ne.xaxis,ne.x2axis),ne.xaxes[1].position="top"),ne.y2axis&&(ne.yaxes[1]=t.extend(!0,{},ne.yaxis,ne.y2axis),ne.yaxes[1].position="right"),ne.grid.coloredAreas&&(ne.grid.markings=ne.grid.coloredAreas),ne.grid.coloredAreasColor&&(ne.grid.markingsColor=ne.grid.coloredAreasColor),ne.lines&&t.extend(!0,ne.series.lines,ne.lines),ne.points&&t.extend(!0,ne.series.points,ne.points),ne.bars&&t.extend(!0,ne.series.bars,ne.bars),null!=ne.shadowSize&&(ne.series.shadowSize=ne.shadowSize),null!=ne.highlightColor&&(ne.series.highlightColor=ne.highlightColor),s=0;s<ne.xaxes.length;++s)m(ce,s+1).options=ne.xaxes[s];for(s=0;s<ne.yaxes.length;++s)m(de,s+1).options=ne.yaxes[s];for(var l in ge)ne.hooks[l]&&ne.hooks[l].length&&(ge[l]=ge[l].concat(ne.hooks[l]));a(ge.processOptions,[ne])}function c(t){se=d(t),v(),y()}function d(e){for(var i=[],s=0;s<e.length;++s){var n=t.extend(!0,{},ne.series);null!=e[s].data?(n.data=e[s].data,delete e[s].data,t.extend(!0,n,e[s]),e[s].data=n.data):n.data=e[s],i.push(n)}return i}function u(t,e){var i=t[e+"axis"];return"object"==typeof i&&(i=i.n),"number"!=typeof i&&(i=1),i}function p(){return t.grep(ce.concat(de),function(t){return t})}function f(t){var e,i,s={};for(e=0;e<ce.length;++e)i=ce[e],i&&i.used&&(s["x"+i.n]=i.c2p(t.left));for(e=0;e<de.length;++e)i=de[e],i&&i.used&&(s["y"+i.n]=i.c2p(t.top));return void 0!==s.x1&&(s.x=s.x1),void 0!==s.y1&&(s.y=s.y1),s}function g(t){var e,i,s,n={};for(e=0;e<ce.length;++e)if(i=ce[e],i&&i.used&&(s="x"+i.n,null==t[s]&&1==i.n&&(s="x"),null!=t[s])){n.left=i.p2c(t[s]);break}for(e=0;e<de.length;++e)if(i=de[e],i&&i.used&&(s="y"+i.n,null==t[s]&&1==i.n&&(s="y"),null!=t[s])){n.top=i.p2c(t[s]);break}return n}function m(e,i){return e[i-1]||(e[i-1]={n:i,direction:e==ce?"x":"y",options:t.extend(!0,{},e==ce?ne.xaxis:ne.yaxis)}),e[i-1]}function v(){var e,i=se.length,s=-1;for(e=0;e<se.length;++e){var n=se[e].color;null!=n&&(i--,"number"==typeof n&&n>s&&(s=n))}s>=i&&(i=s+1);var o,r=[],a=ne.colors,l=a.length,h=0;for(e=0;i>e;e++)o=t.color.parse(a[e%l]||"#666"),e%l==0&&e&&(h=h>=0?.5>h?-h-.2:0:-h),r[e]=o.scale("rgb",1+h);var c,d=0;for(e=0;e<se.length;++e){if(c=se[e],null==c.color?(c.color=r[d].toString(),++d):"number"==typeof c.color&&(c.color=r[c.color].toString()),null==c.lines.show){var p,f=!0;for(p in c)if(c[p]&&c[p].show){f=!1;break}f&&(c.lines.show=!0)}null==c.lines.zero&&(c.lines.zero=!!c.lines.fill),c.xaxis=m(ce,u(c,"x")),c.yaxis=m(de,u(c,"y"))}}function y(){function e(t,e,i){e<t.datamin&&e!=-y&&(t.datamin=e),i>t.datamax&&i!=y&&(t.datamax=i)}var i,s,n,o,r,l,h,c,d,u,f,g,m=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,y=Number.MAX_VALUE;for(t.each(p(),function(t,e){e.datamin=m,e.datamax=v,e.used=!1}),i=0;i<se.length;++i)r=se[i],r.datapoints={points:[]},a(ge.processRawData,[r,r.data,r.datapoints]);for(i=0;i<se.length;++i){if(r=se[i],f=r.data,g=r.datapoints.format,!g){if(g=[],g.push({x:!0,number:!0,required:!0}),g.push({y:!0,number:!0,required:!0}),r.bars.show||r.lines.show&&r.lines.fill){var b=!!(r.bars.show&&r.bars.zero||r.lines.show&&r.lines.zero);g.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:b}),r.bars.horizontal&&(delete g[g.length-1].y,g[g.length-1].x=!0)}r.datapoints.format=g}if(null==r.datapoints.pointsize){r.datapoints.pointsize=g.length,h=r.datapoints.pointsize,l=r.datapoints.points;var w=r.lines.show&&r.lines.steps;for(r.xaxis.used=r.yaxis.used=!0,s=n=0;s<f.length;++s,n+=h){u=f[s];var _=null==u;if(!_)for(o=0;h>o;++o)c=u[o],d=g[o],d&&(d.number&&null!=c&&(c=+c,isNaN(c)?c=null:1/0==c?c=y:c==-1/0&&(c=-y)),null==c&&(d.required&&(_=!0),null!=d.defaultValue&&(c=d.defaultValue))),l[n+o]=c;if(_)for(o=0;h>o;++o)c=l[n+o],null!=c&&(d=g[o],d.autoscale&&(d.x&&e(r.xaxis,c,c),d.y&&e(r.yaxis,c,c))),l[n+o]=null;else if(w&&n>0&&null!=l[n-h]&&l[n-h]!=l[n]&&l[n-h+1]!=l[n+1]){for(o=0;h>o;++o)l[n+h+o]=l[n+o];l[n+1]=l[n-h+1],n+=h}}}}for(i=0;i<se.length;++i)r=se[i],a(ge.processDatapoints,[r,r.datapoints]);for(i=0;i<se.length;++i){r=se[i],l=r.datapoints.points,h=r.datapoints.pointsize,g=r.datapoints.format;var x=m,k=m,C=v,S=v;for(s=0;s<l.length;s+=h)if(null!=l[s])for(o=0;h>o;++o)c=l[s+o],d=g[o],d&&d.autoscale!==!1&&c!=y&&c!=-y&&(d.x&&(x>c&&(x=c),c>C&&(C=c)),d.y&&(k>c&&(k=c),c>S&&(S=c)));if(r.bars.show){var T;switch(r.bars.align){case"left":T=0;break;case"right":T=-r.bars.barWidth;break;case"center":T=-r.bars.barWidth/2;break;default:throw new Error("Invalid bar alignment: "+r.bars.align)}r.bars.horizontal?(k+=T,S+=T+r.bars.barWidth):(x+=T,C+=T+r.bars.barWidth)}e(r.xaxis,x,C),e(r.yaxis,k,S)}t.each(p(),function(t,e){e.datamin==m&&(e.datamin=null),e.datamax==v&&(e.datamax=null)})}function b(){i.css("padding",0).children(":not(.flot-base,.flot-overlay)").remove(),"static"==i.css("position")&&i.css("position","relative"),oe=new e("flot-base",i),re=new e("flot-overlay",i),le=oe.context,he=re.context,ae=t(re.element).unbind();var s=i.data("plot");s&&(s.shutdown(),re.clear()),i.data("plot",me)}function w(){ne.grid.hoverable&&(ae.mousemove(V),ae.bind("mouseleave",W)),ne.grid.clickable&&ae.click(G),a(ge.bindEvents,[ae])}function _(){ye&&clearTimeout(ye),ae.unbind("mousemove",V),ae.unbind("mouseleave",W),ae.unbind("click",G),a(ge.shutdown,[ae])}function x(t){function e(t){return t}var i,s,n=t.options.transform||e,o=t.options.inverseTransform;"x"==t.direction?(i=t.scale=pe/Math.abs(n(t.max)-n(t.min)),s=Math.min(n(t.max),n(t.min))):(i=t.scale=fe/Math.abs(n(t.max)-n(t.min)),i=-i,s=Math.max(n(t.max),n(t.min))),t.p2c=n==e?function(t){return(t-s)*i}:function(t){return(n(t)-s)*i},t.c2p=o?function(t){return o(s+t/i)}:function(t){return s+t/i}}function k(t){var e=t.options,i=t.ticks||[],s=e.labelWidth||0,n=e.labelHeight||0,o=s||"x"==t.direction?Math.floor(oe.width/(i.length||1)):null;legacyStyles=t.direction+"Axis "+t.direction+t.n+"Axis",layer="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+legacyStyles,font=e.font||"flot-tick-label tickLabel";for(var r=0;r<i.length;++r){var a=i[r];if(a.label){var l=oe.getTextInfo(layer,a.label,font,null,o);s=Math.max(s,l.width),n=Math.max(n,l.height)}}t.labelWidth=e.labelWidth||s,t.labelHeight=e.labelHeight||n}function C(e){var i,s=e.labelWidth,n=e.labelHeight,o=e.options.position,r=e.options.tickLength,a=ne.grid.axisMargin,l=ne.grid.labelMargin,h="x"==e.direction?ce:de,c=t.grep(h,function(t){return t&&t.options.position==o&&t.reserveSpace});if(t.inArray(e,c)==c.length-1&&(a=0),null==r){var d=t.grep(h,function(t){return t&&t.reserveSpace});i=0==t.inArray(e,d),r=i?"full":5}isNaN(+r)||(l+=+r),"x"==e.direction?(n+=l,"bottom"==o?(ue.bottom+=n+a,e.box={top:oe.height-ue.bottom,height:n}):(e.box={top:ue.top+a,height:n},ue.top+=n+a)):(s+=l,"left"==o?(e.box={left:ue.left+a,width:s},ue.left+=s+a):(ue.right+=s+a,e.box={left:oe.width-ue.right,width:s})),e.position=o,e.tickLength=r,e.box.padding=l,e.innermost=i}function S(t){"x"==t.direction?(t.box.left=ue.left-t.labelWidth/2,t.box.width=oe.width-ue.left-ue.right+t.labelWidth):(t.box.top=ue.top-t.labelHeight/2,t.box.height=oe.height-ue.bottom-ue.top+t.labelHeight)}function T(){var e,i=ne.grid.minBorderMargin,s={x:0,y:0};if(null==i)for(i=0,e=0;e<se.length;++e)i=Math.max(i,2*(se[e].points.radius+se[e].points.lineWidth/2));s.x=s.y=Math.ceil(i),t.each(p(),function(t,e){var i=e.direction;e.reserveSpace&&(s[i]=Math.ceil(Math.max(s[i],("x"==i?e.labelWidth:e.labelHeight)/2)))}),ue.left=Math.max(s.x,ue.left),ue.right=Math.max(s.x,ue.right),ue.top=Math.max(s.y,ue.top),ue.bottom=Math.max(s.y,ue.bottom)}function $(){var e,i=p(),s=ne.grid.show;for(var n in ue){var o=ne.grid.margin||0;ue[n]="number"==typeof o?o:o[n]||0}a(ge.processOffset,[ue]);for(var n in ue)ue[n]+="object"==typeof ne.grid.borderWidth?s?ne.grid.borderWidth[n]:0:s?ne.grid.borderWidth:0;if(t.each(i,function(t,e){e.show=e.options.show,null==e.show&&(e.show=e.used),e.reserveSpace=e.show||e.options.reserveSpace,A(e)}),s){var r=t.grep(i,function(t){return t.reserveSpace});for(t.each(r,function(t,e){P(e),I(e),D(e,e.ticks),k(e)}),e=r.length-1;e>=0;--e)C(r[e]);T(),t.each(r,function(t,e){S(e)})}pe=oe.width-ue.left-ue.right,fe=oe.height-ue.bottom-ue.top,t.each(i,function(t,e){x(e)}),s&&z(),H()}function A(t){var e=t.options,i=+(null!=e.min?e.min:t.datamin),s=+(null!=e.max?e.max:t.datamax),n=s-i;if(0==n){var o=0==s?1:.01;null==e.min&&(i-=o),(null==e.max||null!=e.min)&&(s+=o)}else{var r=e.autoscaleMargin;null!=r&&(null==e.min&&(i-=n*r,0>i&&null!=t.datamin&&t.datamin>=0&&(i=0)),null==e.max&&(s+=n*r,s>0&&null!=t.datamax&&t.datamax<=0&&(s=0)))}t.min=i,t.max=s}function P(e){var i,n=e.options;i="number"==typeof n.ticks&&n.ticks>0?n.ticks:.3*Math.sqrt("x"==e.direction?oe.width:oe.height);var o=(e.max-e.min)/i,r=-Math.floor(Math.log(o)/Math.LN10),a=n.tickDecimals;null!=a&&r>a&&(r=a);var l,h=Math.pow(10,-r),c=o/h;if(1.5>c?l=1:3>c?(l=2,c>2.25&&(null==a||a>=r+1)&&(l=2.5,++r)):l=7.5>c?5:10,l*=h,null!=n.minTickSize&&l<n.minTickSize&&(l=n.minTickSize),e.delta=o,e.tickDecimals=Math.max(0,null!=a?a:r),e.tickSize=n.tickSize||l,"time"==n.mode&&!e.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(e.tickGenerator||(e.tickGenerator=function(t){var e,i=[],n=s(t.min,t.tickSize),o=0,r=Number.NaN;do e=r,r=n+o*t.tickSize,i.push(r),++o;while(r<t.max&&r!=e);return i},e.tickFormatter=function(t,e){var i=e.tickDecimals?Math.pow(10,e.tickDecimals):1,s=""+Math.round(t*i)/i;if(null!=e.tickDecimals){var n=s.indexOf("."),o=-1==n?0:s.length-n-1;if(o<e.tickDecimals)return(o?s:s+".")+(""+i).substr(1,e.tickDecimals-o)}return s}),t.isFunction(n.tickFormatter)&&(e.tickFormatter=function(t,e){return""+n.tickFormatter(t,e)}),null!=n.alignTicksWithAxis){var d=("x"==e.direction?ce:de)[n.alignTicksWithAxis-1];if(d&&d.used&&d!=e){var u=e.tickGenerator(e);if(u.length>0&&(null==n.min&&(e.min=Math.min(e.min,u[0])),null==n.max&&u.length>1&&(e.max=Math.max(e.max,u[u.length-1]))),e.tickGenerator=function(t){var e,i,s=[];for(i=0;i<d.ticks.length;++i)e=(d.ticks[i].v-d.min)/(d.max-d.min),e=t.min+e*(t.max-t.min),s.push(e);return s},!e.mode&&null==n.tickDecimals){var p=Math.max(0,-Math.floor(Math.log(e.delta)/Math.LN10)+1),f=e.tickGenerator(e);f.length>1&&/\..*0$/.test((f[1]-f[0]).toFixed(p))||(e.tickDecimals=p)}}}}function I(e){var i=e.options.ticks,s=[];null==i||"number"==typeof i&&i>0?s=e.tickGenerator(e):i&&(s=t.isFunction(i)?i(e):i);var n,o;for(e.ticks=[],n=0;n<s.length;++n){var r=null,a=s[n];"object"==typeof a?(o=+a[0],a.length>1&&(r=a[1])):o=+a,null==r&&(r=e.tickFormatter(o,e)),isNaN(o)||e.ticks.push({v:o,label:r})}}function D(t,e){t.options.autoscaleMargin&&e.length>0&&(null==t.options.min&&(t.min=Math.min(t.min,e[0].v)),null==t.options.max&&e.length>1&&(t.max=Math.max(t.max,e[e.length-1].v)))}function M(){oe.clear(),a(ge.drawBackground,[le]);var t=ne.grid;t.show&&t.backgroundColor&&L(),t.show&&!t.aboveData&&F();for(var e=0;e<se.length;++e)a(ge.drawSeries,[le,se[e]]),O(se[e]);a(ge.draw,[le]),t.show&&t.aboveData&&F(),oe.render(),Z()}function E(t,e){for(var i,s,n,o,r=p(),a=0;a<r.length;++a)if(i=r[a],i.direction==e&&(o=e+i.n+"axis",t[o]||1!=i.n||(o=e+"axis"),t[o])){s=t[o].from,n=t[o].to;break}if(t[o]||(i="x"==e?ce[0]:de[0],s=t[e+"1"],n=t[e+"2"]),null!=s&&null!=n&&s>n){var l=s;s=n,n=l}return{from:s,to:n,axis:i}}function L(){le.save(),le.translate(ue.left,ue.top),le.fillStyle=ie(ne.grid.backgroundColor,fe,0,"rgba(255, 255, 255, 0)"),le.fillRect(0,0,pe,fe),le.restore()}function F(){var e,i,s,n;le.save(),le.translate(ue.left,ue.top);var o=ne.grid.markings;if(o)for(t.isFunction(o)&&(i=me.getAxes(),i.xmin=i.xaxis.min,i.xmax=i.xaxis.max,i.ymin=i.yaxis.min,i.ymax=i.yaxis.max,o=o(i)),e=0;e<o.length;++e){var r=o[e],a=E(r,"x"),l=E(r,"y");null==a.from&&(a.from=a.axis.min),null==a.to&&(a.to=a.axis.max),null==l.from&&(l.from=l.axis.min),null==l.to&&(l.to=l.axis.max),a.to<a.axis.min||a.from>a.axis.max||l.to<l.axis.min||l.from>l.axis.max||(a.from=Math.max(a.from,a.axis.min),a.to=Math.min(a.to,a.axis.max),l.from=Math.max(l.from,l.axis.min),l.to=Math.min(l.to,l.axis.max),(a.from!=a.to||l.from!=l.to)&&(a.from=a.axis.p2c(a.from),a.to=a.axis.p2c(a.to),l.from=l.axis.p2c(l.from),l.to=l.axis.p2c(l.to),a.from==a.to||l.from==l.to?(le.beginPath(),le.strokeStyle=r.color||ne.grid.markingsColor,le.lineWidth=r.lineWidth||ne.grid.markingsLineWidth,le.moveTo(a.from,l.from),le.lineTo(a.to,l.to),le.stroke()):(le.fillStyle=r.color||ne.grid.markingsColor,le.fillRect(a.from,l.to,a.to-a.from,l.from-l.to))))}i=p(),s=ne.grid.borderWidth;for(var h=0;h<i.length;++h){var c,d,u,f,g=i[h],m=g.box,v=g.tickLength;if(g.show&&0!=g.ticks.length){for(le.lineWidth=1,"x"==g.direction?(c=0,d="full"==v?"top"==g.position?0:fe:m.top-ue.top+("top"==g.position?m.height:0)):(d=0,c="full"==v?"left"==g.position?0:pe:m.left-ue.left+("left"==g.position?m.width:0)),g.innermost||(le.strokeStyle=g.options.color,le.beginPath(),u=f=0,"x"==g.direction?u=pe+1:f=fe+1,1==le.lineWidth&&("x"==g.direction?d=Math.floor(d)+.5:c=Math.floor(c)+.5),le.moveTo(c,d),le.lineTo(c+u,d+f),le.stroke()),le.strokeStyle=g.options.tickColor,le.beginPath(),e=0;e<g.ticks.length;++e){var y=g.ticks[e].v;u=f=0,isNaN(y)||y<g.min||y>g.max||"full"==v&&("object"==typeof s&&s[g.position]>0||s>0)&&(y==g.min||y==g.max)||("x"==g.direction?(c=g.p2c(y),f="full"==v?-fe:v,"top"==g.position&&(f=-f)):(d=g.p2c(y),u="full"==v?-pe:v,"left"==g.position&&(u=-u)),1==le.lineWidth&&("x"==g.direction?c=Math.floor(c)+.5:d=Math.floor(d)+.5),le.moveTo(c,d),le.lineTo(c+u,d+f))}le.stroke()}}s&&(n=ne.grid.borderColor,"object"==typeof s||"object"==typeof n?("object"!=typeof s&&(s={top:s,right:s,bottom:s,left:s}),"object"!=typeof n&&(n={top:n,right:n,bottom:n,left:n}),s.top>0&&(le.strokeStyle=n.top,le.lineWidth=s.top,le.beginPath(),le.moveTo(0-s.left,0-s.top/2),le.lineTo(pe,0-s.top/2),le.stroke()),s.right>0&&(le.strokeStyle=n.right,le.lineWidth=s.right,le.beginPath(),le.moveTo(pe+s.right/2,0-s.top),le.lineTo(pe+s.right/2,fe),le.stroke()),s.bottom>0&&(le.strokeStyle=n.bottom,le.lineWidth=s.bottom,le.beginPath(),le.moveTo(pe+s.right,fe+s.bottom/2),le.lineTo(0,fe+s.bottom/2),le.stroke()),s.left>0&&(le.strokeStyle=n.left,le.lineWidth=s.left,le.beginPath(),le.moveTo(0-s.left/2,fe+s.bottom),le.lineTo(0-s.left/2,0),le.stroke())):(le.lineWidth=s,le.strokeStyle=ne.grid.borderColor,le.strokeRect(-s/2,-s/2,pe+s,fe+s))),le.restore()}function z(){t.each(p(),function(t,e){if(e.show&&0!=e.ticks.length){var i,s,n,o,r,a=e.box,l=e.direction+"Axis "+e.direction+e.n+"Axis",h="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+l,c=e.options.font||"flot-tick-label tickLabel";oe.removeText(h);for(var d=0;d<e.ticks.length;++d)i=e.ticks[d],!i.label||i.v<e.min||i.v>e.max||("x"==e.direction?(o="center",s=ue.left+e.p2c(i.v),"bottom"==e.position?n=a.top+a.padding:(n=a.top+a.height-a.padding,r="bottom")):(r="middle",n=ue.top+e.p2c(i.v),"left"==e.position?(s=a.left+a.width-a.padding,o="right"):s=a.left+a.padding),oe.addText(h,s,n,i.label,c,null,null,o,r))}})}function O(t){t.lines.show&&R(t),t.bars.show&&j(t),t.points.show&&N(t)}function R(t){function e(t,e,i,s,n){var o=t.points,r=t.pointsize,a=null,l=null;le.beginPath();for(var h=r;h<o.length;h+=r){var c=o[h-r],d=o[h-r+1],u=o[h],p=o[h+1];if(null!=c&&null!=u){if(p>=d&&d<n.min){if(p<n.min)continue;c=(n.min-d)/(p-d)*(u-c)+c,d=n.min}else if(d>=p&&p<n.min){if(d<n.min)continue;u=(n.min-d)/(p-d)*(u-c)+c,p=n.min}if(d>=p&&d>n.max){if(p>n.max)continue;c=(n.max-d)/(p-d)*(u-c)+c,d=n.max}else if(p>=d&&p>n.max){if(d>n.max)continue;u=(n.max-d)/(p-d)*(u-c)+c,p=n.max}if(u>=c&&c<s.min){if(u<s.min)continue;d=(s.min-c)/(u-c)*(p-d)+d,c=s.min}else if(c>=u&&u<s.min){if(c<s.min)continue;p=(s.min-c)/(u-c)*(p-d)+d,u=s.min}if(c>=u&&c>s.max){if(u>s.max)continue;d=(s.max-c)/(u-c)*(p-d)+d,c=s.max}else if(u>=c&&u>s.max){if(c>s.max)continue;p=(s.max-c)/(u-c)*(p-d)+d,u=s.max}(c!=a||d!=l)&&le.moveTo(s.p2c(c)+e,n.p2c(d)+i),a=u,l=p,le.lineTo(s.p2c(u)+e,n.p2c(p)+i)}}le.stroke()}function i(t,e,i){for(var s=t.points,n=t.pointsize,o=Math.min(Math.max(0,i.min),i.max),r=0,a=!1,l=1,h=0,c=0;;){if(n>0&&r>s.length+n)break;r+=n;var d=s[r-n],u=s[r-n+l],p=s[r],f=s[r+l];if(a){if(n>0&&null!=d&&null==p){c=r,n=-n,l=2;continue}if(0>n&&r==h+n){le.fill(),a=!1,n=-n,l=1,r=h=c+n;continue}}if(null!=d&&null!=p){if(p>=d&&d<e.min){if(p<e.min)continue;u=(e.min-d)/(p-d)*(f-u)+u,d=e.min}else if(d>=p&&p<e.min){if(d<e.min)continue;f=(e.min-d)/(p-d)*(f-u)+u,p=e.min}if(d>=p&&d>e.max){if(p>e.max)continue;u=(e.max-d)/(p-d)*(f-u)+u,d=e.max}else if(p>=d&&p>e.max){if(d>e.max)continue;f=(e.max-d)/(p-d)*(f-u)+u,p=e.max}if(a||(le.beginPath(),le.moveTo(e.p2c(d),i.p2c(o)),a=!0),u>=i.max&&f>=i.max)le.lineTo(e.p2c(d),i.p2c(i.max)),le.lineTo(e.p2c(p),i.p2c(i.max));else if(u<=i.min&&f<=i.min)le.lineTo(e.p2c(d),i.p2c(i.min)),le.lineTo(e.p2c(p),i.p2c(i.min));else{var g=d,m=p;f>=u&&u<i.min&&f>=i.min?(d=(i.min-u)/(f-u)*(p-d)+d,u=i.min):u>=f&&f<i.min&&u>=i.min&&(p=(i.min-u)/(f-u)*(p-d)+d,f=i.min),u>=f&&u>i.max&&f<=i.max?(d=(i.max-u)/(f-u)*(p-d)+d,u=i.max):f>=u&&f>i.max&&u<=i.max&&(p=(i.max-u)/(f-u)*(p-d)+d,f=i.max),d!=g&&le.lineTo(e.p2c(g),i.p2c(u)),le.lineTo(e.p2c(d),i.p2c(u)),le.lineTo(e.p2c(p),i.p2c(f)),p!=m&&(le.lineTo(e.p2c(p),i.p2c(f)),le.lineTo(e.p2c(m),i.p2c(f)))}}}}le.save(),le.translate(ue.left,ue.top),le.lineJoin="round";var s=t.lines.lineWidth,n=t.shadowSize;if(s>0&&n>0){le.lineWidth=n,le.strokeStyle="rgba(0,0,0,0.1)";var o=Math.PI/18;e(t.datapoints,Math.sin(o)*(s/2+n/2),Math.cos(o)*(s/2+n/2),t.xaxis,t.yaxis),le.lineWidth=n/2,e(t.datapoints,Math.sin(o)*(s/2+n/4),Math.cos(o)*(s/2+n/4),t.xaxis,t.yaxis)}le.lineWidth=s,le.strokeStyle=t.color;var r=U(t.lines,t.color,0,fe);r&&(le.fillStyle=r,i(t.datapoints,t.xaxis,t.yaxis)),s>0&&e(t.datapoints,0,0,t.xaxis,t.yaxis),le.restore()}function N(t){function e(t,e,i,s,n,o,r,a){for(var l=t.points,h=t.pointsize,c=0;c<l.length;c+=h){var d=l[c],u=l[c+1];null==d||d<o.min||d>o.max||u<r.min||u>r.max||(le.beginPath(),d=o.p2c(d),u=r.p2c(u)+s,"circle"==a?le.arc(d,u,e,0,n?Math.PI:2*Math.PI,!1):a(le,d,u,e,n),le.closePath(),i&&(le.fillStyle=i,le.fill()),le.stroke())}}le.save(),le.translate(ue.left,ue.top);var i=t.points.lineWidth,s=t.shadowSize,n=t.points.radius,o=t.points.symbol;if(0==i&&(i=1e-4),i>0&&s>0){var r=s/2;le.lineWidth=r,le.strokeStyle="rgba(0,0,0,0.1)",e(t.datapoints,n,null,r+r/2,!0,t.xaxis,t.yaxis,o),le.strokeStyle="rgba(0,0,0,0.2)",e(t.datapoints,n,null,r/2,!0,t.xaxis,t.yaxis,o)}le.lineWidth=i,le.strokeStyle=t.color,e(t.datapoints,n,U(t.points,t.color),0,!1,t.xaxis,t.yaxis,o),le.restore()}function B(t,e,i,s,n,o,r,a,l,h,c,d){var u,p,f,g,m,v,y,b,w;c?(b=v=y=!0,m=!1,u=i,p=t,g=e+s,f=e+n,u>p&&(w=p,p=u,u=w,m=!0,v=!1)):(m=v=y=!0,b=!1,u=t+s,p=t+n,f=i,g=e,f>g&&(w=g,g=f,f=w,b=!0,y=!1)),p<a.min||u>a.max||g<l.min||f>l.max||(u<a.min&&(u=a.min,m=!1),p>a.max&&(p=a.max,v=!1),f<l.min&&(f=l.min,b=!1),g>l.max&&(g=l.max,y=!1),u=a.p2c(u),f=l.p2c(f),p=a.p2c(p),g=l.p2c(g),r&&(h.beginPath(),h.moveTo(u,f),h.lineTo(u,g),h.lineTo(p,g),h.lineTo(p,f),h.fillStyle=r(f,g),h.fill()),d>0&&(m||v||y||b)&&(h.beginPath(),h.moveTo(u,f+o),m?h.lineTo(u,g+o):h.moveTo(u,g+o),y?h.lineTo(p,g+o):h.moveTo(p,g+o),v?h.lineTo(p,f+o):h.moveTo(p,f+o),b?h.lineTo(u,f+o):h.moveTo(u,f+o),h.stroke()))}function j(t){function e(e,i,s,n,o,r,a){for(var l=e.points,h=e.pointsize,c=0;c<l.length;c+=h)null!=l[c]&&B(l[c],l[c+1],l[c+2],i,s,n,o,r,a,le,t.bars.horizontal,t.bars.lineWidth)}le.save(),le.translate(ue.left,ue.top),le.lineWidth=t.bars.lineWidth,le.strokeStyle=t.color;var i;switch(t.bars.align){case"left":i=0;break;case"right":i=-t.bars.barWidth;break;case"center":i=-t.bars.barWidth/2;break;default:throw new Error("Invalid bar alignment: "+t.bars.align)}var s=t.bars.fill?function(e,i){return U(t.bars,t.color,e,i)}:null;e(t.datapoints,i,i+t.bars.barWidth,0,s,t.xaxis,t.yaxis),le.restore()}function U(e,i,s,n){var o=e.fill;if(!o)return null;if(e.fillColor)return ie(e.fillColor,s,n,i);var r=t.color.parse(i);return r.a="number"==typeof o?o:.4,r.normalize(),r.toString()}function H(){if(i.find(".legend").remove(),ne.legend.show){for(var e,s,n=[],o=[],r=!1,a=ne.legend.labelFormatter,l=0;l<se.length;++l)e=se[l],e.label&&(s=a?a(e.label,e):e.label,s&&o.push({label:s,color:e.color}));if(ne.legend.sorted)if(t.isFunction(ne.legend.sorted))o.sort(ne.legend.sorted);else if("reverse"==ne.legend.sorted)o.reverse();else{var h="descending"!=ne.legend.sorted;o.sort(function(t,e){return t.label==e.label?0:t.label<e.label!=h?1:-1})}for(var l=0;l<o.length;++l){var c=o[l];l%ne.legend.noColumns==0&&(r&&n.push("</tr>"),n.push("<tr>"),r=!0),n.push('<td class="legendColorBox"><div style="border:1px solid '+ne.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+c.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+c.label+"</td>")}if(r&&n.push("</tr>"),0!=n.length){var d='<table style="font-size:smaller;color:'+ne.grid.color+'">'+n.join("")+"</table>";if(null!=ne.legend.container)t(ne.legend.container).html(d);else{var u="",p=ne.legend.position,f=ne.legend.margin;null==f[0]&&(f=[f,f]),"n"==p.charAt(0)?u+="top:"+(f[1]+ue.top)+"px;":"s"==p.charAt(0)&&(u+="bottom:"+(f[1]+ue.bottom)+"px;"),"e"==p.charAt(1)?u+="right:"+(f[0]+ue.right)+"px;":"w"==p.charAt(1)&&(u+="left:"+(f[0]+ue.left)+"px;");var g=t('<div class="legend">'+d.replace('style="','style="position:absolute;'+u+";")+"</div>").appendTo(i);if(0!=ne.legend.backgroundOpacity){var m=ne.legend.backgroundColor;null==m&&(m=ne.grid.backgroundColor,m=m&&"string"==typeof m?t.color.parse(m):t.color.extract(g,"background-color"),m.a=1,m=m.toString());var v=g.children();t('<div style="position:absolute;width:'+v.width()+"px;height:"+v.height()+"px;"+u+"background-color:"+m+';"> </div>').prependTo(g).css("opacity",ne.legend.backgroundOpacity)}}}}}function q(t,e,i){var s,n,o,r=ne.grid.mouseActiveRadius,a=r*r+1,l=null;for(s=se.length-1;s>=0;--s)if(i(se[s])){var h=se[s],c=h.xaxis,d=h.yaxis,u=h.datapoints.points,p=c.c2p(t),f=d.c2p(e),g=r/c.scale,m=r/d.scale;if(o=h.datapoints.pointsize,c.options.inverseTransform&&(g=Number.MAX_VALUE),d.options.inverseTransform&&(m=Number.MAX_VALUE),h.lines.show||h.points.show)for(n=0;n<u.length;n+=o){var v=u[n],y=u[n+1];if(null!=v&&!(v-p>g||-g>v-p||y-f>m||-m>y-f)){var b=Math.abs(c.p2c(v)-t),w=Math.abs(d.p2c(y)-e),_=b*b+w*w;a>_&&(a=_,l=[s,n/o])}}if(h.bars.show&&!l){var x="left"==h.bars.align?0:-h.bars.barWidth/2,k=x+h.bars.barWidth;for(n=0;n<u.length;n+=o){var v=u[n],y=u[n+1],C=u[n+2];null!=v&&(se[s].bars.horizontal?p<=Math.max(C,v)&&p>=Math.min(C,v)&&f>=y+x&&y+k>=f:p>=v+x&&v+k>=p&&f>=Math.min(C,y)&&f<=Math.max(C,y))&&(l=[s,n/o])}}}return l?(s=l[0],n=l[1],o=se[s].datapoints.pointsize,{datapoint:se[s].datapoints.points.slice(n*o,(n+1)*o),dataIndex:n,series:se[s],seriesIndex:s}):null}function V(t){ne.grid.hoverable&&Y("plothover",t,function(t){return 0!=t.hoverable})}function W(t){ne.grid.hoverable&&Y("plothover",t,function(){return!1})}function G(t){Y("plotclick",t,function(t){return 0!=t.clickable})}function Y(t,e,s){var n=ae.offset(),o=e.pageX-n.left-ue.left,r=e.pageY-n.top-ue.top,a=f({left:o,top:r});a.pageX=e.pageX,a.pageY=e.pageY;var l=q(o,r,s);if(l&&(l.pageX=parseInt(l.series.xaxis.p2c(l.datapoint[0])+n.left+ue.left,10),l.pageY=parseInt(l.series.yaxis.p2c(l.datapoint[1])+n.top+ue.top,10)),ne.grid.autoHighlight){for(var h=0;h<ve.length;++h){var c=ve[h];c.auto!=t||l&&c.series==l.series&&c.point[0]==l.datapoint[0]&&c.point[1]==l.datapoint[1]||J(c.series,c.point)}l&&K(l.series,l.datapoint,t)}i.trigger(t,[a,l])}function Z(){var t=ne.interaction.redrawOverlayInterval;return-1==t?void X():void(ye||(ye=setTimeout(X,t)))}function X(){ye=null,he.save(),re.clear(),he.translate(ue.left,ue.top);var t,e;for(t=0;t<ve.length;++t)e=ve[t],e.series.bars.show?ee(e.series,e.point):te(e.series,e.point);he.restore(),a(ge.drawOverlay,[he])}function K(t,e,i){if("number"==typeof t&&(t=se[t]),"number"==typeof e){var s=t.datapoints.pointsize;e=t.datapoints.points.slice(s*e,s*(e+1))}var n=Q(t,e);-1==n?(ve.push({series:t,point:e,auto:i}),Z()):i||(ve[n].auto=!1)}function J(t,e){if(null==t&&null==e)return ve=[],void Z();if("number"==typeof t&&(t=se[t]),"number"==typeof e){var i=t.datapoints.pointsize;e=t.datapoints.points.slice(i*e,i*(e+1))}var s=Q(t,e);-1!=s&&(ve.splice(s,1),Z())}function Q(t,e){for(var i=0;i<ve.length;++i){var s=ve[i];if(s.series==t&&s.point[0]==e[0]&&s.point[1]==e[1])return i}return-1}function te(e,i){var s=i[0],n=i[1],o=e.xaxis,r=e.yaxis,a="string"==typeof e.highlightColor?e.highlightColor:t.color.parse(e.color).scale("a",.5).toString();if(!(s<o.min||s>o.max||n<r.min||n>r.max)){var l=e.points.radius+e.points.lineWidth/2;he.lineWidth=l,he.strokeStyle=a;var h=1.5*l;s=o.p2c(s),n=r.p2c(n),he.beginPath(),"circle"==e.points.symbol?he.arc(s,n,h,0,2*Math.PI,!1):e.points.symbol(he,s,n,h,!1),he.closePath(),he.stroke()}}function ee(e,i){var s="string"==typeof e.highlightColor?e.highlightColor:t.color.parse(e.color).scale("a",.5).toString(),n=s,o="left"==e.bars.align?0:-e.bars.barWidth/2;he.lineWidth=e.bars.lineWidth,he.strokeStyle=s,B(i[0],i[1],i[2]||0,o,o+e.bars.barWidth,0,function(){return n},e.xaxis,e.yaxis,he,e.bars.horizontal,e.bars.lineWidth)}function ie(e,i,s,n){if("string"==typeof e)return e;for(var o=le.createLinearGradient(0,s,0,i),r=0,a=e.colors.length;a>r;++r){var l=e.colors[r];if("string"!=typeof l){var h=t.color.parse(n);null!=l.brightness&&(h=h.scale("rgb",l.brightness)),null!=l.opacity&&(h.a*=l.opacity),l=h.toString()}o.addColorStop(r/(a-1),l)}return o}var se=[],ne={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},oe=null,re=null,ae=null,le=null,he=null,ce=[],de=[],ue={left:0,right:0,top:0,bottom:0},pe=0,fe=0,ge={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},me=this;me.setData=c,me.setupGrid=$,me.draw=M,me.getPlaceholder=function(){return i},me.getCanvas=function(){return oe.element},me.getPlotOffset=function(){return ue},me.width=function(){return pe},me.height=function(){return fe},me.offset=function(){var t=ae.offset();return t.left+=ue.left,t.top+=ue.top,t},me.getData=function(){return se},me.getAxes=function(){var e={};return t.each(ce.concat(de),function(t,i){i&&(e[i.direction+(1!=i.n?i.n:"")+"axis"]=i)}),e},me.getXAxes=function(){return ce},me.getYAxes=function(){return de},me.c2p=f,me.p2c=g,me.getOptions=function(){return ne},me.highlight=K,me.unhighlight=J,me.triggerRedrawOverlay=Z,me.pointOffset=function(t){return{left:parseInt(ce[u(t,"x")-1].p2c(+t.x)+ue.left,10),top:parseInt(de[u(t,"y")-1].p2c(+t.y)+ue.top,10)}},me.shutdown=_,me.resize=function(){var t=i.width(),e=i.height();oe.resize(t,e),re.resize(t,e)},me.hooks=ge,l(me),h(o),b(),c(n),$(),M(),w();var ve=[],ye=null}function s(t,e){return e*Math.floor(t/e)}var n=Object.prototype.hasOwnProperty;e.prototype.resize=function(t,e){if(0>=t||0>=e)throw new Error("Invalid dimensions for plot, width = "+t+", height = "+e);var i=this.element,s=this.context,n=this.pixelRatio;this.width!=t&&(i.width=t*n,i.style.width=t+"px",this.width=t),this.height!=e&&(i.height=e*n,i.style.height=e+"px",this.height=e),s.restore(),s.save(),s.scale(n,n)},e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.render=function(){var t=this._textCache;for(var e in t)if(n.call(t,e)){var i=this.getTextLayer(e),s=t[e];i.hide();for(var o in s)if(n.call(s,o)){var r=s[o];for(var a in r)if(n.call(r,a)){for(var l,h=r[a].positions,c=0;l=h[c];c++)l.active?l.rendered||(i.append(l.element),l.rendered=!0):(h.splice(c--,1),l.rendered&&l.element.detach());0==h.length&&delete r[a]}}i.show()}},e.prototype.getTextLayer=function(e){var i=this.text[e];return null==i&&(null==this.textContainer&&(this.textContainer=t("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),i=this.text[e]=t("<div></div>").addClass(e).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),i},e.prototype.getTextInfo=function(e,i,s,n,o){var r,a,l,h;if(i=""+i,r="object"==typeof s?s.style+" "+s.variant+" "+s.weight+" "+s.size+"px/"+s.lineHeight+"px "+s.family:s,a=this._textCache[e],null==a&&(a=this._textCache[e]={}),l=a[r],null==l&&(l=a[r]={}),h=l[i],null==h){var c=t("<div></div>").html(i).css({position:"absolute","max-width":o,top:-9999}).appendTo(this.getTextLayer(e));"object"==typeof s?c.css({font:r,color:s.color}):"string"==typeof s&&c.addClass(s),h=l[i]={width:c.outerWidth(!0),height:c.outerHeight(!0),element:c,positions:[]},c.detach()}return h},e.prototype.addText=function(t,e,i,s,n,o,r,a,l){var h=this.getTextInfo(t,s,n,o,r),c=h.positions;"center"==a?e-=h.width/2:"right"==a&&(e-=h.width),"middle"==l?i-=h.height/2:"bottom"==l&&(i-=h.height);for(var d,u=0;d=c[u];u++)if(d.x==e&&d.y==i)return void(d.active=!0);d={active:!0,rendered:!1,element:c.length?h.element.clone():h.element,x:e,y:i},c.push(d),d.element.css({top:Math.round(i),left:Math.round(e),"text-align":a})},e.prototype.removeText=function(t,e,i,s,o,r){if(null==s){var a=this._textCache[t];
if(null!=a)for(var l in a)if(n.call(a,l)){var h=a[l];for(var c in h)if(n.call(h,c))for(var d,u=h[c].positions,p=0;d=u[p];p++)d.active=!1}}else for(var d,u=this.getTextInfo(t,s,o,r).positions,p=0;d=u[p];p++)d.x==e&&d.y==i&&(d.active=!1)},t.plot=function(e,s,n){var o=new i(t(e),s,n,t.plot.plugins);return o},t.plot.version="0.8.1",t.plot.plugins=[],t.fn.plot=function(e,i){return this.each(function(){t.plot(this,e,i)})}}(jQuery),define("libs/flot/jquery.flot",function(){}),define("modules/interactives/interactive-base",["jquery","underscore","baseview","utils","modules/interactives/interactive-ads","libs/flot/jquery.flot"],function(t,e,i,s,n){"use strict";var o=i.extend({events:{"plothover .chart-area":"lazyHover"},initialize:function(t){var e=!0;(t.isFramed||this.$el.data("suppressad")===!0)&&(e=!1),i.prototype.initialize.call(this,t),this.initializeDom(),this.flotData=this.getFlotData(this.datasetItems),this.graph.length&&null!==this.flotData&&void 0!==this.flotData&&(e&&(this.subviews.interactiveAds=new n({el:this.$(".interactive-sponsor")})),this.redraw(),this.$chartHover.css("color",this.mainColor))},redraw:function(){t.plot(this.graph,this.flotData,this.getFlotOptions()),this.calculateBoundVal()},initializeDom:function(){this.chartData=JSON.parse(this.$(".chartData").html()||"{}"),this.datasetItems=s.getNested(this.chartData,"datasets","item")||[],this.chartColors=this.getChartColors(),this.$chartHover=this.$(".chart-hover"),this.$chartArea=this.$(".chart-area"),this.graph=this.$(".graph"),this.colorsArray=(this.$el.data("colors")||"").split("|"),this.colorsArray.length>=6?this.mainColor=this.colorsArray[2]:1==this.colorsArray.length&&(this.mainColor=this.colorsArray[0])},getChartColors:function(){return(this.$el.data("colors")||"rgb(100,100,100)").split("|")},numberWithCommas:function(t){return t.toString().replace(/\B(?=(?:\d{3})+(?!\d))/g,",")},_createTicks:function(t){return e.map(t.split("|"),function(t,e){return[e,t]})},calculateBoundVal:function(){this.hoverLeftBoundVal=this.hoverLeftBound(),this.hoverRightBoundVal=this.hoverRightBound(),this.hoverTopBoundVal=this.hoverTopBound(),this.hoverBottomBoundVal=this.hoverBottomBound()},hoverLeftBound:function(){return this.$el.width()/2},hoverRightBound:function(){return this.$el.width()/2},hoverTopBound:function(){return this.$el.height()/5},hoverBottomBound:function(){return this.$el.height()/5},getHoverPrefix:function(){return this.chartData.beforelabel||""},getHoverSuffix:function(){return this.chartData.afterlabel||""},_getHoverClass:function(t){return t.pageX>this.hoverRightBoundVal/2&&t.pageX<this.hoverLeftBoundVal/2?t.pageY<this.hoverTopBoundVal?"top":t.pageY>this.hoverBottomBoundVal?"bottom":void 0:t.pageX<this.hoverLeftBoundVal?"middleleft":t.pageX>this.hoverRightBoundVal?"middleright":""},_getHoverPosition:function(t,e){return e.pageX>this.hoverRightBoundVal/2&&e.pageX<this.hoverLeftBoundVal/2?e.pageY<this.hoverTopBoundVal?{top:t.pageY,left:t.pageX-this.$chartHover.outerWidth(!0)/2}:e.pageY>this.hoverBottomBoundVal?{top:t.pageY-this.$chartHover.outerHeight(!0),left:t.pageX-this.$chartHover.outerWidth(!0)/2}:void 0:e.pageX<this.hoverLeftBoundVal?{top:t.pageY-this.$chartHover.outerHeight(!0)/2,left:t.pageX}:e.pageX>this.hoverRightBoundVal?{top:t.pageY-this.$chartHover.outerHeight(!0)/2,left:t.pageX-this.$chartHover.outerWidth(!0)}:null},lazyHover:function(){this.lazyDebounce||(this.lazyDebounce=e.throttle(this._hover,20)),this.lazyDebounce.apply(this,arguments)},_hover:function(t,e,i){if(i&&e&&t&&i.series){var s={pageY:e.pageY-this.$el.offset().top,pageX:e.pageX-this.$el.offset().left},n={pageY:e.pageY-this.$chartArea.offset().top,pageX:e.pageX-this.$chartArea.offset().left},o=this._getHoverClass(s),r="pointer-"+o.replace("middle",""),a=""!==this._getHoverLabel(i)?"<h3>"+this._getHoverLabel(i)+"</h3>":"",l='<div class="'+r+'"></div>'+a+"<h4>"+this._getHoverBody(i)+"</h4>",h=this._getHoverPosition(n,s);this.$chartHover.show(),this.$chartHover.html(l),h&&o?this.$chartHover.css(h).attr("class",o+"-hover chart-hover"):this.$chartHover.hide()}else this.$chartHover.hide()},_getHoverBody:function(t){var e=s.addCommas(""+parseFloat(s.getNested(t,"series","percent")||0).toFixed(0));return e+"%"},_getHoverLabel:function(t){return t.series.label},getFlotOptions:function(){return{series:{},grid:{hoverable:!0,clickable:!0},legend:{show:!1}}},getFlotData:function(t){return e.map(t,function(t,e,i){var n=this.mainColor;return i.length>1&&(n=this.chartColors[e%this.chartColors.length]),{label:s.getNested(t,"label")||"",data:parseFloat(t.value),color:n}},this)},destroy:function(t,e){var s=(this.graph.data()||{}).plot;s&&s.shutdown&&s.shutdown(),i.prototype.destroy.call(this,t,e)}});return o}),function(t){function e(e){function n(t,e){e.series.pie.show&&(e.grid.show=!1,"auto"==e.series.pie.label.show&&(e.series.pie.label.show=e.legend.show?!1:!0),"auto"==e.series.pie.radius&&(e.series.pie.radius=e.series.pie.label.show?.75:1),e.series.pie.tilt>1&&(e.series.pie.tilt=1),e.series.pie.tilt<0&&(e.series.pie.tilt=0),t.hooks.processDatapoints.push(a),t.hooks.drawOverlay.push(k),t.hooks.draw.push(d))}function o(t,e){var i=t.getOptions();i.series.pie.show&&i.grid.hoverable&&e.unbind("mousemove").mousemove(g),i.series.pie.show&&i.grid.clickable&&e.unbind("click").click(m)}function r(t){for(var e=0;e<t.length;++e){var i=parseFloat(t[e].data[0][1]);i&&(P+=i)}}function a(e){L||(L=!0,C=e.getCanvas(),S=t(C).parent(),s=e.getOptions(),e.setData(c(e.getData())))}function l(){E=S.children().filter(".legend").children().width(),T=Math.min(C.width,C.height/s.series.pie.tilt)/2,A=C.height/2+s.series.pie.offset.top,$=C.width/2,"auto"==s.series.pie.offset.left?s.legend.position.match("w")?$+=E/2:$-=E/2:$+=s.series.pie.offset.left,T>$?$=T:$>C.width-T&&($=C.width-T)}function h(t){for(var e=0;e<t.length;++e)"number"==typeof t[e].data?t[e].data=[[1,t[e].data]]:("undefined"==typeof t[e].data||"undefined"==typeof t[e].data[0])&&("undefined"!=typeof t[e].data&&"undefined"!=typeof t[e].data.label&&(t[e].label=t[e].data.label),t[e].data=[[1,0]]);return t}function c(t){t=h(t),r(t);for(var e=0,i=0,n=s.series.pie.combine.color,o=[],a=0;a<t.length;++a)t[a].data[0][1]=parseFloat(t[a].data[0][1]),t[a].data[0][1]||(t[a].data[0][1]=0),t[a].data[0][1]/P<=s.series.pie.combine.threshold?(e+=t[a].data[0][1],i++,n||(n=t[a].color)):o.push({data:[[1,t[a].data[0][1]]],color:t[a].color,label:t[a].label,angle:2*t[a].data[0][1]*Math.PI/P,percent:t[a].data[0][1]/P*100});return i>0&&o.push({data:[[1,e]],color:n,label:s.series.pie.combine.label,angle:2*e*Math.PI/P,percent:e/P*100}),o}function d(e,i){function n(t){ctx.save(),ctx.translate($,A),ctx.beginPath(),ctx.arc(0,0,t+4,90,2*Math.PI,!0),ctx.lineWidth=1,ctx.strokeStyle=F,ctx.stroke(),ctx.restore()}function o(){ctx.clearRect(0,0,C.width,C.height),S.children().filter(".pieLabel, .pieLabelBackground").remove()}function r(){var t=5,e=15,i=10,n=.02;if(s.series.pie.radius>1)var o=s.series.pie.radius;else var o=T*s.series.pie.radius;if(!(o>=C.width/2-t||o*s.series.pie.tilt>=C.height/2-e||i>=o)){ctx.save(),ctx.translate(t,e),ctx.globalAlpha=n,ctx.fillStyle="#000",ctx.translate($,A),ctx.scale(1,s.series.pie.tilt);for(var r=1;i>=r;r++)ctx.beginPath(),ctx.arc(0,0,o,0,2*Math.PI,!1),ctx.fill(),o-=r;ctx.restore()}}function a(){function e(t,e,i){0>=t||(i?ctx.fillStyle=e:(ctx.strokeStyle=e,ctx.lineJoin="miter"),ctx.beginPath(),Math.abs(t-2*Math.PI)>1e-9&&ctx.moveTo(0,0),ctx.arc(0,0,o,r,r+t,!1),ctx.closePath(),r+=t,i?ctx.fill():ctx.stroke())}function i(){function e(e,i,o){if(0!=e.data[0][1]){var r,a=s.legend.labelFormatter,l=s.series.pie.label.formatter;r=a?a(e.label,e):e.label,l&&(r=l(r,e));var h=(i+e.angle+i)/2,c=$+Math.round(Math.cos(h)*n),d=A+Math.round(Math.sin(h)*n)*s.series.pie.tilt,u='<span class="pieLabel" id="pieLabel'+o+'" style="position:absolute;top:'+d+"px;left:"+c+'px;">'+r+"</span>";S.append(u);var p=S.children("#pieLabel"+o),f=d-p.height()/2,g=c-p.width()/2;if(p.css("top",f),p.css("left",g),(0-f>0||0-g>0||C.height-(f+p.height())<0||C.width-(g+p.width())<0)&&(I=!0),0!=s.series.pie.label.background.opacity){var m=s.series.pie.label.background.color;null==m&&(m=e.color);var v="top:"+f+"px;left:"+g+"px;";t('<div class="pieLabelBackground" style="position:absolute;width:'+p.width()+"px;height:"+p.height()+"px;"+v+"background-color:"+m+';"> </div>').insertBefore(p).css("opacity",s.series.pie.label.background.opacity)}}}var i=startAngle;if(s.series.pie.label.radius>1)var n=s.series.pie.label.radius;else var n=T*s.series.pie.label.radius;for(var o=0;o<h.length;++o)h[o].percent>=100*s.series.pie.label.threshold&&e(h[o],i,o),i+=h[o].angle}if(startAngle=Math.PI*s.series.pie.startAngle,s.series.pie.radius>1)var o=s.series.pie.radius;else var o=T*s.series.pie.radius;ctx.save(),ctx.translate($,A),ctx.scale(1,s.series.pie.tilt),ctx.save();for(var r=startAngle,a=0;a<h.length;++a)h[a].startAngle=r,e(h[a].angle,h[a].color,!0);ctx.restore(),ctx.save(),ctx.lineWidth=s.series.pie.stroke.width,r=startAngle;for(var a=0;a<h.length;++a)e(h[a].angle,s.series.pie.stroke.color,!1);ctx.restore(),u(ctx),s.series.pie.label.show&&i(),ctx.restore(),n(o)}if(S){ctx=i,l();for(var h=e.getData(),c=0;I&&D>c;)I=!1,c>0&&(T*=M),c+=1,o(),s.series.pie.tilt<=.8&&r(),a();c>=D&&(o(),S.prepend('<div class="error">Could not draw pie with labels contained inside canvas</div>')),e.setSeries&&e.insertLegend&&(e.setSeries(h),e.insertLegend())}}function u(t){s.series.pie.innerRadius>0&&(t.save(),innerRadius=s.series.pie.innerRadius>1?s.series.pie.innerRadius:T*s.series.pie.innerRadius,t.globalCompositeOperation="destination-out",t.beginPath(),t.fillStyle=s.series.pie.stroke.color,t.arc(0,0,innerRadius,0,2*Math.PI,!1),t.fill(),t.closePath(),t.restore(),t.save(),t.beginPath(),t.strokeStyle=s.series.pie.stroke.color,t.arc(0,0,innerRadius,0,2*Math.PI,!1),t.stroke(),t.closePath(),t.restore(),t.save(),t.beginPath(),t.arc(0,0,innerRadius/1.2,90,2*Math.PI,!1),t.lineWidth=1,t.strokeStyle=F,t.stroke(),t.restore())}function p(t,e){for(var i=!1,s=-1,n=t.length,o=n-1;++s<n;o=s)(t[s][1]<=e[1]&&e[1]<t[o][1]||t[o][1]<=e[1]&&e[1]<t[s][1])&&e[0]<(t[o][0]-t[s][0])*(e[1]-t[s][1])/(t[o][1]-t[s][1])+t[s][0]&&(i=!i);return i}function f(t,i){for(var s=e.getData(),n=e.getOptions(),o=n.series.pie.radius>1?n.series.pie.radius:T*n.series.pie.radius,r=0;r<s.length;++r){var a=s[r];if(a.pie.show){if(ctx.save(),ctx.beginPath(),ctx.moveTo(0,0),ctx.arc(0,0,o,a.startAngle,a.startAngle+a.angle,!1),ctx.closePath(),x=t-$,y=i-A,ctx.isPointInPath){if(ctx.isPointInPath(t-$,i-A))return ctx.restore(),{datapoint:[a.percent,a.data],dataIndex:0,series:a,seriesIndex:r}}else if(p1X=o*Math.cos(a.startAngle),p1Y=o*Math.sin(a.startAngle),p2X=o*Math.cos(a.startAngle+a.angle/4),p2Y=o*Math.sin(a.startAngle+a.angle/4),p3X=o*Math.cos(a.startAngle+a.angle/2),p3Y=o*Math.sin(a.startAngle+a.angle/2),p4X=o*Math.cos(a.startAngle+a.angle/1.5),p4Y=o*Math.sin(a.startAngle+a.angle/1.5),p5X=o*Math.cos(a.startAngle+a.angle),p5Y=o*Math.sin(a.startAngle+a.angle),arrPoly=[[0,0],[p1X,p1Y],[p2X,p2Y],[p3X,p3Y],[p4X,p4Y],[p5X,p5Y]],arrPoint=[x,y],p(arrPoly,arrPoint))return ctx.restore(),{datapoint:[a.percent,a.data],dataIndex:0,series:a,seriesIndex:r};ctx.restore()}}return null}function g(t){v("plothover",t)}function m(t){v("plotclick",t)}function v(t,i){var n=e.offset(),o=parseInt(i.pageX-n.left),r=parseInt(i.pageY-n.top),a=f(o,r);if(s.grid.autoHighlight)for(var l=0;l<z.length;++l){var h=z[l];h.auto!=t||a&&h.series==a.series||w(h.series)}a&&b(a.series,t);var c={pageX:i.pageX,pageY:i.pageY};S.trigger(t,[c,a])}function b(t,i){"number"==typeof t&&(t=series[t]);var s=_(t);-1==s?(z.push({series:t,auto:i}),e.triggerRedrawOverlay()):i||(z[s].auto=!1)}function w(t){null==t&&(z=[],e.triggerRedrawOverlay()),"number"==typeof t&&(t=series[t]);var i=_(t);-1!=i&&(z.splice(i,1),e.triggerRedrawOverlay())}function _(t){for(var e=0;e<z.length;++e){var i=z[e];if(i.series==t)return e}return-1}function k(t,e){function s(t){t.angle<0||(e.fillStyle="rgba(255, 255, 255, "+n.series.pie.highlight.opacity+")",e.beginPath(),Math.abs(t.angle-2*Math.PI)>1e-9&&e.moveTo(0,0),e.arc(0,0,o,t.startAngle,t.startAngle+t.angle,!1),e.closePath(),e.fill())}var n=t.getOptions(),o=n.series.pie.radius>1?n.series.pie.radius:T*n.series.pie.radius;for(e.save(),e.translate($,A),e.scale(1,n.series.pie.tilt),i=0;i<z.length;++i)s(z[i].series);u(e),e.restore()}var C=null,S=null,T=null,$=null,A=null,P=0,I=!0,D=10,M=.95,E=0,L=!1,F="#ebebeb",z=[];e.hooks.processOptions.push(n),e.hooks.bindEvents.push(o)}var s={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,offset:{top:0,left:"auto"},stroke:{color:"#FFF",width:1},label:{show:"auto",formatter:function(t,e){return'<div style="font-size:x-small;text-align:center;padding:2px;color:'+e.color+';">'+t+"<br/>"+Math.round(e.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}},pattern:null}};t.plot.plugins.push({init:e,options:s,name:"pie",version:"1.0"})}(jQuery),define("libs/flot/jquery.flot.usat.pie",function(){}),define("modules/interactives/pie-chart",["jquery","underscore","utils","modules/interactives/interactive-base","libs/flot/jquery.flot.usat.pie"],function(t,e,i,s){"use strict";var n=s.extend({isDonut:function(){return"true"===this.chartData.donutPresent},_getHoverBody:function(t){return this.isDonut()?[this.getHoverPrefix(),i.addCommas(i.getNested(t,"datapoint",1,0,1)),this.getHoverSuffix()].join(" "):s.prototype._getHoverBody.apply(this,arguments)},getFlotOptions:function(){var t=s.prototype.getFlotOptions.apply(this,arguments);return t.series.pie={show:!0,stroke:{color:"#fff",width:2},innerRadius:0,radius:1},this.isDonut()&&(t.series.pie.innerRadius=.48),t},hoverLeftBound:function(){return this.isDonut()?this.graph.width()/3:this.graph.width()/2},hoverRightBound:function(){return this.isDonut()?this.graph.width()/3*2:this.graph.width()/2}});return n}),define("modules/sports/sports-news",["jquery","underscore","utils","state","pubsub","baseview"],function(t,e,i,s,n,o){var r=o.extend({initialize:function(t){o.prototype.initialize.call(this,t),this.$newsBlock=this.$(".sp-news-wrap"),this.loadTaxonomyNews(this.$newsBlock.data("url"))},loadTaxonomyNews:function(t){var i=this;s.fetchHtml(t,{timeout:1e5}).done(e.bind(function(t){t&&t.length&&(i.$(".card-suspender-title").removeClass("hide"),i.$newsBlock.html(t))},this))},destroy:function(t){o.prototype.destroy.call(this,t)}});return r}),define("modules/stories/utility-bar-module-share",["jquery","underscore","backbone","utils","state","pubsub","managers/resourcemanager","modules/stories/utility-bar-flyout"],function(t,e,i,s,n,o,r,a){"use strict";var l=a.extend({events:{"click .util-bar-flyout-nav-btn":"onClickFlyoutNavBtn"},initialize:function(t){e.bindAll(this,"onClickFlyoutNavBtn");var i=this.$(".util-bar-share-summary-image");s.lazyLoadImage(i,"data-src",!0),this.events=e.extend({},a.prototype.events,this.events),a.prototype.initialize.call(this,t),this._loadUtilityBarModules()},_loadUtilityBarModules:function(){var t=window.site_config.UTILITY_BAR_MODULES;if(t){var i=e.find(t,function(t){return"utility-bar-module-share"===t.name});i&&i.options&&i.options.submodules&&r.fetchPageModules(i.options.submodules).done(e.bind(function(t){this.destroyed||e.each(t,function(t){this.subviews[t.name]=new t.ModuleClass(e.extend({el:t.selector},t.options))},this)},this))}},onClickFlyoutNavBtn:function(e){var i=t(e.currentTarget),s=t(e.currentTarget).data("share-method"),r="utilitybarshare"+s;o.trigger("uotrack",r),"A"!==i.prop("tagName")&&(e.preventDefault(),s&&n.getActiveApp().$(".util-bar-btn-"+s).trigger("click"))},showSection:function(e){this.activeSection=e,this.$(".util-bar-flyout-section, .util-bar-flyout-pane").hide(),this.$(".util-bar-flyout-pane-share, .util-bar-flyout-section-"+e).show(),this.$(".util-bar-flyout-nav-btn").removeClass("active"),this.$(".util-bar-flyout-nav-btn-"+e).addClass("active"),t(".js-share-email-form-success-pane").hide(),"email"===this.activeSection?t(".js-share-email-form-container").show():t(".js-share-email-form-container").hide()}});return l}),define("modules/travel/hotelme",["jquery","underscore","backbone","state","pubsub","baseview"],function(t,e,i,s,n,o){var r=o.extend({initialize:function(t){s.fetchHtml("/travel/hotelme/").done(e.bind(function(t){this.$el.html(t)},this)),o.prototype.initialize.call(this,t)}});return r}),define("modules/header/site-nav-social-module",["jquery","underscore","modules/header/site-nav-dropdown","utils"],function(t,e,i,s){"use strict";var n=i.extend({initialize:function(){this.initSocialShareButtons(),i.prototype.initialize.apply(this)},initSocialShareButtons:function(){this._loadGooglePlus()},_loadGooglePlus:function(){s.loadScript("https://apis.google.com/js/plusone.js","gapi")}});return n}),define("modules/sports/sports-team-leaders",["jquery","underscore","backbone","baseview","easing"],function(t,e,i,s){var n=s.extend({events:{"click .front-gallery-link":"onSuspenderItemClick"},initialize:function(){s.prototype.initialize.call(this,this.options),this.links=this.$(".front-gallery-link"),this.viewport=this.$(".sp-team-leaders-viewport"),this.slider=this.$(".sp-team-leaders-slider"),this.views=this.$(".sp-team-leaders-wrap"),this.charts=this.$(".sports-team-statistics-charts"),this.animateGraphs(this.charts.eq(0))},onSuspenderItemClick:function(e){var i=t(e.currentTarget),s=i.data("id"),n=i.data("module-name"),o="selected";e.preventDefault(),this.links.parent().removeClass(o),this.links.filter(i).parent().addClass(o),"team-leaders"===n?(this.views.removeClass("selected"),this.views.filter(".sp-team-leaders-wrap-"+s).addClass(o)):"team-statistics"===n&&(this.$target_stats=this.$(".sports-team-statistics-charts-"+s),this.animateGraphs(this.$target_stats),this.charts.hide(),this.$target_stats.show())},animateGraphs:function(e){var i=100,s=e.find(".sports-team-statistics-chart-group .category"),n=e.find(".sports-team-statistics-chart-group .bar"),o=e.find(".sports-team-statistics-chart-group .value");n.css("height","0%"),s.hide(),o.hide(),s.fadeIn(1e3),n.each(function(e,s){t(s).delay(i).animate({height:t(s).data("percentage")},500,"easeOutElastic"),i+=100}),o.delay(i).fadeIn(1e3)}});return n}),define("modules/fronts/primary-poster-ad",["jquery","underscore","modules/partner/simple-ad"],function(t,e,i){"use strict";var s=i.extend({initialize:function(e){var s=this.$el;e=t.extend({adType:s.attr("data-ad-type")||"poster",adPlacement:s.attr("data-ad-placement")||"poster_front",adSizes:s.attr("data-ad-sizes")||"mediumrectangle"},e),i.prototype.initialize.call(this,e),this._initAds()}});return s}),define("uiFlip",["jquery","transformSupport"],function(t){"use strict";var e="uiPageFlip",i={useTransforms:!!t.support.css.transform,transitionTiming:"linear",flipDuration:300,flipFrontSelector:".ui-flip-panel",flipBackSelector:".ui-flip-panel",activePanelClass:"active",perspective:"900px",fadeDuration:200,onFlip:function(){}},s={init:function(s){return this.each(function(){var n=t(this),o=t.extend({},i,s);n.data(e,{busy:!1,settings:o})})},option:function(t,i){var s=this.data(e);if(s&&t){if(!i)return s[t];("function"==typeof i||"onFlip"!==t)&&(s[t]=i)}},flipForward:function(t){var i=this.data(e),s=i.settings,o=this.find(s.flipFrontSelector);return n.transition(this,o.filter(".active"),o.filter(":not(.active)"),!0,s,i,t)},flipBackward:function(t){var i=this.data(e),s=i.settings,o=this.find(s.flipFrontSelector);return n.transition(this,o.filter(".active"),o.filter(":not(.active)"),!1,s,i,t)}},n={transition:function(e,i,s,o,r,a,l){var h;return a.busy?t.Deferred().reject():l?(r.onFlip(s),s.addClass("active"),i.removeClass("active"),t.Deferred().resolve()):(a.busy=!0,s.addClass("active"),h=r.useTransforms?n.flipTransform(e[0],i[0],s[0],o,r):n.fadeTransition(i,s,r),h.done(function(){r.onFlip(s),a.busy=!1,i.removeClass("active")}),h)},flipTransform:function(e,i,s,o,r){n.setupTransition(e,i,s,o,r);var a=t.Deferred();return t.support.css.transition.registerTransitionEndListener(i,a).done(function(){i.style[t.support.css.transform.backfaceVisibilityCssName]="",i.style[t.support.css.transform.styleCssName]="",i.style[t.support.css.transition.cssName]="",i.style[t.support.css.transform.cssName]="",s.style[t.support.css.transform.backfaceVisibilityCssName]="",s.style[t.support.css.transform.styleCssName]="",s.style[t.support.css.transition.cssName]="",s.style[t.support.css.transform.cssName]="",e.style[t.support.css.transform.perspectiveCssName]="",e.style[t.support.css.transform.styleCssName]=""}),setTimeout(function(){var e="rotateX("+(o?"":"-")+"180deg)";i.style[t.support.css.transform.cssName]=e,s.style[t.support.css.transition.cssName]=n.getTransitionStyle(t.support.css.transform.cssHyphenName,r.flipDuration,r.transitionTiming),s.style[t.support.css.transform.cssName]="rotateX(0deg)"},20),a.promise()},fadeTransition:function(t,e,i){t.css({opacity:1,"z-index":11}).show(),e.css({opacity:1,"z-index":10}).show();var s=t.fadeOut(i.fadeDuration).promise();return s.done(function(){t.css({"z-index":""}),e.css({"z-index":""})}),s},getTransitionStyle:function(t,e,i,s){var n=t+" "+e+"ms "+i;return s&&(n+=" "+s+"ms"),n},setupTransition:function(e,i,s,o,r){var a="rotateX("+(o?"-":"")+"180deg)";e.style[t.support.css.transform.perspectiveCssName]=r.perspective,e.style[t.support.css.transform.styleCssName]="preserve-3d",i.style[t.support.css.transform.backfaceVisibilityCssName]="hidden",i.style[t.support.css.transform.styleCssName]="preserve-3d",i.style[t.support.css.transition.cssName]=n.getTransitionStyle(t.support.css.transform.cssHyphenName,r.flipDuration,r.transitionTiming),i.style[t.support.css.transform.cssName]="rotateX(0deg)",s.style[t.support.css.transform.backfaceVisibilityCssName]="hidden",s.style[t.support.css.transform.styleCssName]="preserve-3d",s.style[t.support.css.transform.cssName]=a}};t.fn.uiFlip=function(e){return s[e]?s[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.uiPageTurn"):s.init.apply(this,arguments)}}),define("modules/fronts/hero",["jquery","underscore","backbone","baseview","pubsub","utils","state","managers/routemanager","modules/videos/brightcove-video","modules/carousel/carousel","sharedAdPosition","directAdPosition","partner/leavebehind","modules/fronts/primary-poster-ad","uiPageTurn","uiFlip"],function(t,e,i,s,n,o,r,a,l,h,c,d,u,p){var f=s.extend({events:{"click .slide, .hero-asset-open":"open","click .carousel-thumbs > li":"openTile","click .hero-turn-trigger, .hero-popular .hero-page-trigger":"toggleFrontBack","click .partner-close":"closeAdClick","click .hero-headline-video-close":"toggleFrontVideo"},destroy:function(t){this.adShowing&&this.closeAd(!0),s.prototype.destroy.call(this,t)},initialize:function(i){i=t.extend(!0,{animate:{duration:200},popularCount:this.$el.data("popular-count")||6,shadow:{opacity:".4",duration:200,delay:0}},i),s.prototype.initialize.call(this,i),e.bindAll(this,"onVideoShow","onVideoHide","onAdReady","showHeroAd","beforeAdRender","belowHeroAdReady"),this.visibleFace="front",this.$openSidebar=t(".open-sidebar"),this.mostPopularLoaded=!1,this.isPageTurn=this.$el.hasClass("hero-page-turn"),this.isPageTurn?(this.pageTurn={frontIndex:this.$(".hero-page-front").index(),backIndex:this.$(".hero-page-back").index(),adIndex:this.$(".hero-page-ad").index(),videoIndex:this.$(".hero-page-video").index()},this.$el.uiPageTurn({perspective:"1400px"})):this.$el.uiFlip({perspective:"1400px"}),this.adShowing=!1,this.$el.hasClass("carousel")&&(this.subviews.heroCarousel=new h({el:this.$el,ads:!1,hoverTransition:200,thumbsSelector:".carousel-thumbs",rotate:!0,autostart:!0})),this.subviews.video=[],this.$(".ui-video").each(e.bind(function(e,i){var s=t(i),n=new l({el:s.parent(),onVideoShow:this.onVideoShow,onVideoHide:this.onVideoHide});s.closest(".hero-page-video").length?this.subviews.heroVideo=n:this.subviews.video.push(n)},this));var n=this.$(".poster-ad-primary");if(n.length>0&&(this.subviews.posterAdPrimary=new p({el:n})),this.$(".partner-heroflip-ad").each(e.bind(function(t,e){return t>0?void console.error("why are there multiple ad placements for this hero?"):void(this.subviews.ad=new c({el:e,adSizes:["heroflip"],adPlacement:"high_impact",adType:"heroflip",beforeAdRender:this.beforeAdRender,onAdReady:this.onAdReady}))},this)),this.$(".popular").length){var a="/services/most-popular/hero/"+o.getSectionPath(window.location.pathname)+"/"+this.options.popularCount+"/";r.fetchHtml(a).done(e.bind(function(t){this.$(".popular .ui-placer").html(t),this.$(".hero-turn-trigger").fadeIn(500),this.mostPopularLoaded=!0},this))}},renderCardInfo:function(t){this.updateTrackingLabels(t),this.renderFrontPosterAd(t)},renderFrontPosterAd:function(t,e){if(this.belowHeroModule=this.$el.next(".below-hero-ad-module"),this.belowHeroModule.length)if(t.belowHeroAd){var i={el:this.belowHeroModule.find(".below-hero-ad"),adSizes:["mediumrectangle"],adPlacement:"high_impact",adType:"below_hero",defaultPosition:!0,onAdReady:this.belowHeroAdReady};e?e&&(this.subviews.oldBelowHeroAd=this.subviews.belowHeroAd,this.subviews.oldBelowHeroAd.$(".ad-slot").hide(),this.subviews.belowHeroAd=new d(i)):this.subviews.belowHeroAd=new c(i)}else this.belowHeroModule.hide()},belowHeroAdReady:function(){var t="/services/most-popular/headline-ad/"+o.getSectionPath(window.location.pathname)+"/2/";r.fetchHtml(t).done(e.bind(function(t){this.belowHeroModule.find(".below-hero-popular").html(t),this.belowHeroModule.show(),this.subviews.belowHeroAd.playAd()},this))},beforeAdRender:function(){var t=this.subviews.ad.$el,e=t.height(),i=t.width();this.subviews.ad.setInitialDimensions(i,e)},onAdReady:function(t){t.leaveBehindImage&&t.leaveBehindText?this.createAdLeaveBehind(this.subviews.ad,t.leaveBehindImage,t.leaveBehindText):this.showHeroAd()},createAdLeaveBehind:function(t,e,i){var s=r.getActiveApp();this.subviews.adLeaveBehind=new u({el:r.getActiveApp().$(".partner-leavebehind"),onShowAd:this.showHeroAd,imageUrl:e,altText:i,isCompact:s.isCurrentCardBumped&&s.isCurrentCardBumped()}),this.subviews.adLeaveBehind.render(t)},showHeroAd:function(){return this.adShowing=!0,r.getActiveApp().triggerEvent("onHeroAdOpen"),this.subviews.ad.show(),this.triggerAnimation(e.bind(function(){var t;return t=this.isPageTurn?this.$el.uiPageTurn("goToPage",this.pageTurn.adIndex,!1,this.$(".partner-placement iframe").length):this.$el.uiFlip("flipForward"),t.done(e.bind(function(){this.subviews.ad.playAd()},this)),t},this))},closeAdClick:function(t){t.preventDefault(),this.closeAd()},closeAd:function(t){return this.adShowing=!1,this.subviews.ad.stopAd(),this.triggerAnimation(e.bind(function(){var e;return e=this.isPageTurn?"back"===this.visibleFace?this.$el.uiPageTurn("goToPage",this.pageTurn.backIndex,t,this.$(".partner-placement iframe").length):this.$el.uiPageTurn("goToPage",this.pageTurn.frontIndex,t,this.$(".partner-placement iframe").length):this.$el.uiFlip("flipBackward",t)},this)).done(e.bind(function(){r.getActiveApp().triggerEvent("onHeroAdClose"),this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.show()},this)),!1},triggerAnimation:function(t){return r.registerAnimation(t())},onVideoShow:function(){this.$openSidebar.addClass("hidden"),this.$(".hero-turn-trigger").hide()},onVideoHide:function(){this.$openSidebar.removeClass("hidden"),this.mostPopularLoaded&&this.$(".hero-turn-trigger").show()},open:function(e){var i=t(e.target),s=t(e.currentTarget),n=s.data("content-type")||"";this.subviews.heroVideo&&(i.hasClass("videoStillPlay")||"video"===n)?(this.toggleFrontVideo(e),e.preventDefault()):i.closest("a").length||(s.find(".hero-story > h1 > a").click(),e.preventDefault())},openTile:function(e){var i=t(e.currentTarget).index();this.$(".slide:eq("+i+") .hero-story > h1 > a").click()},toggleFrontBack:function(){return this.mostPopularLoaded?(this.triggerAnimation(e.bind(function(){return"back"!==this.visibleFace?(n.trigger("uotrack","mostpopularopen"),this.goToBack()):(n.trigger("uotrack","mostpopularclose"),this.goToFront())},this)),!1):!1},goToFront:function(){return this.visibleFace="front",this.$el.uiPageTurn("goToPage",this.pageTurn.frontIndex)},goToBack:function(){return this.visibleFace="back",this.$el.uiPageTurn("goToPage",this.pageTurn.backIndex)},goToVideo:function(){return this.visibleFace="video",this.$el.uiPageTurn("goToPage",this.pageTurn.videoIndex).done(e.bind(function(){this.subviews.heroVideo.playVideo()},this))},onCardWidthChange:function(t){this.updateTrackingLabels(t)},updateTrackingLabels:function(i){this.$moduleWrap||(this.$moduleWrap=this.$el.closest(".hero-module")),!this.variant&&this.$moduleWrap.data("variant")&&(this.variant=this.$moduleWrap.data("variant")),"4uphp"===this.variant&&(this.trackPrefix||(this.trackPrefix=this.$moduleWrap.find(".hfwmm-list").data("track-prefix")),this.$flexListItems||(this.$flexListItems=this.$moduleWrap.find(".hfwmm-secondary-link,.hfwmm-tertiary-link")),1320===i.cardWidth?e.each(this.$flexListItems,function(e,i){var s=t(e),n=i>2?i-3+1:i+1;s.data("ht",this.trackPrefix+s.data("track-display-type")+n)},this):e.each(this.$flexListItems,function(e,i){var s=t(e);s.data("ht",this.trackPrefix+"stack"+(i+1))},this))},toggleFrontVideo:function(t){return this.subviews.heroVideo?(this.triggerAnimation(e.bind(function(){return"video"!==this.visibleFace?(n.trigger("uotrack","headlinevideoopen"),this.$(".hero-headline-video-close").show(),this.subviews.heroVideo.show(),this.goToVideo()):(this.subviews.heroVideo.onVideoStatusChange(t),this.subviews.heroVideo.hide(),n.trigger("uotrack","headlinevideoclose"),this.$(".hero-headline-video-close").hide(),this.goToFront())},this)),!1):!1}});return f}),define("modules/sports/sports-twitter",["jquery","underscore","state","baseview","modules/scroller/sidebar-scroll"],function(t,e,i,s,n){"use strict";var o=s.extend({events:{"click .sports-twittertab-option":"twitterTabClicked"},initialize:function(i){return i=t.extend({num_tweets:null,twitter_id:null,layoutType:null,refreshInterval:3e4,failureRefreshInterval:6e4,twitter_cache:12e3},i),"sidebar"===this.options.layoutType&&this.onHideSidebarAd(),this.$twitterTabs=t(".sports-twitter-module .front-gallery-item, .sports-twitter-data"),e.bindAll(this,"createTweetsHTML","loadTweets","twitterTabClicked"),this.twitter_el=this.$(".tweet-list"),this.update=!1,this.continueRefresh=!0,this.handles=t(this.$twitterTabs[0]).attr("tab-target-handles"),this.hashtags=t(this.$twitterTabs[0]).attr("tab-target-hashtags"),this.refreshInterval=t(this.$twitterTabs[0]).attr("tab-target-refresh-rate")||i.refreshInterval,this.failureRefreshInterval=this.twitter_el.attr("data-twitter-failure-refresh-rate")||i.failureRefreshInterval,this.twitter_cache=this.twitter_el.attr("data-twitter-cache-ttl")||i.twitter_cache,this.selectedTab=1,this.$primary=t(".sports-twitter-module .sports-twitter-primary"),this.$suspender=t(".sports-twitter-module .sports-twitter-suspender"),this.$viewport=t(".sports-twitter-module .twitter-scroll-content"),this.row_size=this.options.row_size||this.twitter_el.attr("data-row-size"),this.num_tweets=this.options.num_tweets||this.twitter_el.attr("data-num-tweets"),this.twitterID=i.twitter_id||this.twitter_el.attr("data-twitter-id"),this.twitterID?(this.addscrollBar(),this.loadTweets(),void s.prototype.initialize.call(this,i)):void this.$el.hide()},twitterTabClicked:function(e){this.refreshID&&clearTimeout(this.refreshID);var i=t(e.currentTarget);e.preventDefault(),this.$twitterTabs.removeClass("selected"),i.addClass("selected"),this.refreshInterval=i.attr("tab-target-refresh-rate"),this.handles=i.attr("tab-target-handles"),this.hashtags=i.attr("tab-target-hashtags"),this.twitter_el.html(""),t(".sports-twitter-module .scrollable-content").outerHeight(t(".tweet-list")[0].scrollHeight),this.update=!1,this.refreshScrollbar(),this.$viewport.addClass("loading"),this.loadTweets()},refreshScrollbar:function(){this.scrollbar&&(this.scrollbar.refresh(),this.update===!1&&this.scrollbar.moveDraggerToPosition(0,0))
},loadTweets:function(){this.tweetsLoaded=!0;var t=this.twitterID,s=this.num_tweets,n=this.row_size,o=this.createTweetsHTML,r=this.handles,a=this.hashtags,l=(this.refreshInterval,this.update,this.twitter_cache),h=r+"~~"+a,c="/sports/services/sportstwitter/json/"+t+"/"+s+"/"+n+"/"+l+"/"+h+"/";i.fetchHtml(c).done(o).fail(e.bind(function(){this.twitter_el.html("<div id='sports-no-tweets'>No tweets available.</div>"),o("TWITTER SERVER FAILURE")},this)).always(e.bind(function(){this.$viewport.removeClass("loading")},this))},stopRefresh:function(){this.continueRefresh=!1,this.refreshID&&clearTimeout(this.refreshID)},createTweetsHTML:function(e){if("TWITTER SERVER FAILURE"===e)this.continueRefresh&&"0"!=this.failureRefreshInterval&&(this.update=!0,this.refreshID=setTimeout(this.loadTweets,this.failureRefreshInterval));else{if(e&&String(e.html()).length>10){for(var i=t(this.twitter_el.html()),s=!1,n=t(e).find(".tweet"),o=t(i).find(".tweet"),r=0;r<t(n).length;r++)if(t(n[r]).html()!=t(o[r]).html()){s=!0;break}s&&(t(".sports-twitter-module .scrollable-content").outerHeight(0),this.refreshScrollbar(),this.twitter_el.html(e),t(".sports-twitter-module .scrollable-content").outerHeight(t(".tweet-list")[0].scrollHeight-150),this.refreshScrollbar());var a=this.timeAgo;e.find(".tweet_time_ago").each(function(e,i){t(i).html(a(t(i).html()))})}else t(".sports-twitter-module .scrollable-content").outerHeight(0),this.refreshScrollbar(),this.twitter_el.html("<div id='sports-no-tweets'>No tweets available.</div>");this.continueRefresh&&"0"!=this.refreshInterval&&(this.update=!0,this.refreshID=setTimeout(this.loadTweets,this.refreshInterval))}},addscrollBar:function(){this.scrollbar=new n({el:t(".sports-twitter-module .twitter-scroll-content"),color:"dark",padding:2,lockPageScroll:!0,delayScroll:!1,fadeout:!0})},timeAgo:function(t){var e=new Date,i=new Date(t);i.getTime()||(i=Date.parse(t.replace(/( \+)/," UTC$1")));var s=e-i,n=1e3,o=60*n,r=60*o,a=24*r;return isNaN(s)||0>s?"":2*n>s?"right now":o>s?Math.floor(s/n)+" seconds ago":2*o>s?"about 1 minute ago":r>s?Math.floor(s/o)+" minutes ago":2*r>s?"about 1 hour ago":a>s?Math.floor(s/r)+" hours ago":s>a&&2*a>s?"yesterday":365*a>s?Math.floor(s/a)+" days ago":"over a year ago"},destroy:function(t){t&&this.twitter_el.empty(),this.stopRefresh(),s.prototype.destroy.call(this)}});return o}),define("blog/blog-list",["jquery","underscore","backbone","state","apps/stag-front","modules/global/brightcove-video"],function(t,e,i,s,n,o){"use strict";var r=n.extend({el:".blt-content-container",events:{"click .button-add-content":"showMore"},initialize:function(){var e=this;this.subviews=this.subviews||{},this.subviews.video=[],this.readMoreBlogsNumber=this.$(".button-add-content").data("next"),t(".stag.hero .video, .blpm-video-container .video").each(function(){var i=new o({el:t(this).parent().get(0)});e.subviews.video.push(i)})},getMoreBlogs:function(i){var n=this;s.fetchHtml(window.location.pathname+i+"/new").done(e.bind(function(e){e.find(".blpm-post").removeClass("active").addClass("inactive"),e.find(".button-add-content");this.$(".blpm-all-articles").append(e),e.find(".video").each(function(){var e=new o({el:t(this).parent().get(0)});n.subviews.video.push(e)}),this.readMoreBlogsNumber++,this.$button.removeClass("loading").text(this.$button.attr("data-default"))},this)).fail(e.bind(function(){this.$button.removeClass("loading").addClass("inactive").text("No more posts")},this))},showMore:function(e){return t(e.target).hasClass("inactive")?!1:(this.$button=this.$(".button-add-content"),this.$button.addClass("loading").text(this.$button.attr("data-loading")),this.getMoreBlogs(this.readMoreBlogsNumber),void e.preventDefault())}});return r}),define("modules/fronts/countdown-clock",["jquery","underscore","baseview","state","directAdPosition"],function(t,e,i,s,n){"use strict";var o=i.extend({timer:0,seconds:0,classes:{sponsor:"countdown-clock-ad"},initialize:function(e){e=t.extend({adPlacement:"sponsor_logo_countdown",adSizes:[100,50],countdownContainer:".countdown-clock-container",digitBoxes:".countdown-timer-digit-container .digit",digitContainer:".countdown-timer-digit-container"},e),this.options=e,this.$sponsorshipAd=this.$("."+this.classes.sponsor),this.layoutType=this._getLayoutType();var s=t(e.countdownContainer).attr("data-type-event_date");i.prototype.initialize.call(this,e),this.seconds=Math.round(new Date(s).getTime()/1e3)-Math.round((new Date).getTime()/1e3),this.$digitBoxes=this.$(e.digitBoxes),this.$digitContainer=this.$(e.digitContainer),this.$primaryTimer=t(".card-primary-suspender.countdown-clock-module"),this.$sidebarTimer=t(".card-sidebar.countdown-clock-module"),this.counterStart(),this.positionTimer()},_getLayoutType:function(){var t=null;return this.options.layoutType&&(-1!==this.options.layoutType.indexOf("primary")?t="primary":"sidebar"===this.options.layoutType&&(t="sidebar")),t},positionTimer:function(){this.$sidebarTimer.length||this.$primaryTimer.css("display","block")},renderCardInfo:function(t){t.sidebarOpen||"primary"!==this.layoutType?t.sidebarOpen&&"sidebar"===this.layoutType&&this._buildSponsorshipAd():(this.$primaryTimer.show(),this._buildSponsorshipAd()),this.currentCardInfo=t},_buildSponsorshipAd:function(){this.$sponsorshipAd.length&&!this.subviews.sponsorshipAd&&(this.subviews.sponsorshipAd=new n({el:this.$sponsorshipAd,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,adType:"sponsor_logo",pageInfo:s.getActivePageInfo()}))},openSideBar:function(){this.currentCardInfo&&this._buildSponsorshipAd()},onCardWidthChange:function(t){t.sidebarOpen!==this.currentCardInfo.sidebarOpen&&(this.currentCardInfo=t,t.sidebarOpen&&this.$sidebarTimer.length?"primary"===this.layoutType?this.$primaryTimer.hide():"sidebar"===this.layoutType&&this._buildSponsorshipAd():"primary"===this.layoutType&&(this.$primaryTimer.show(),this._buildSponsorshipAd()))},pad:function(t){for(var e=[],i=t.length;i>0;i--){var s=t[t.length-i]>9?t[t.length-i]:"0"+t[t.length-i];e.push(s.toString())}return e},updateTime:function(e){var i=Math.floor(e/86400),s=Math.floor(e/3600),n=Math.floor(e/60),o=Math.floor(e),r=i,a=s-24*i,l=n-60*s,h=o-60*n,c=0,d="",u=this.$digitContainer,p=this.pad([r,a,l,h]);this.$digitBoxes.each(function(e,i){if(void 0!==p[c]){var s=p[c].split("");t(i).text(e%2===0?s[0]:s[1]),e++,e%2===0&&c++}}),d=u.clone().first(),e--,u.slice(1).html(d.html())},decrementCounter:function(){this.updateTime(this.seconds),(0===this.seconds||isNaN(this.seconds))&&this.counterStop(),this.seconds--},counterStart:function(){clearInterval(this.timer),this.timer=setInterval(this.decrementCounter.bind(this),1e3)},counterStop:function(){clearInterval(this.timer)},destroy:function(t){this.counterStop(),i.prototype.destroy.call(this,t)}});return o}),define("modules/sports/sports-follow-usat",["jquery","underscore","baseview"],function(t,e,i){var s=i.extend({events:{},initialize:function(){i.prototype.initialize.apply(this,arguments),t(document).ready(this.followUSATOverlay)},followUSATOverlay:function(){var e=t(".sp-follow-usat-overlay-wrap");if(e.length>0){for(var i="",s="usatfollowus=",n=document.cookie.split(";"),o=0;o<n.length;o++){var r=n[o].trim();if(0===r.indexOf(s)){i=r.substring(s.length,r.length);break}}var a=new Date;a.setTime(a.getTime()+24*e.data("exp")*60*60*1e3);var l="expires="+a.toGMTString();switch(i){case"":document.cookie="usatfollowus=ready; "+l+"; path=/";break;case"ready":if(t(".follow-button-wrap.fb-wrap").length>0&&t(".follow-button-wrap.fb-wrap").append('<iframe src="//www.facebook.com/plugins/like.php?href=https%3A%2F%2Fwww.facebook.com%2Fusatodaysports&amp;width&amp;layout=button_count&amp;action=like&amp;show_faces=false&amp;share=false&amp;height=21&amp;appId=2530096808" scrolling="no" frameborder="0" style="border:none; overflow:hidden; height:21px; width:84px;" allowTransparency="true"></iframe>'),t(".follow-button-wrap.tw-wrap").length>0){if(t("#twitter-wjs").length>0)return;var h=/^http:/.test(document.location)?"http":"https",c=t("<script src='"+h+"://platform.twitter.com/widgets.js' id='twitter-wjs'>");t("head").append(c)}t("#follow-usat-box-details").css("top",t("#follow-usat-box-details").offset().top-100+"px"),t("#follow-usat-box-details").css("position","absolute"),t("#follow-usat-film").fadeIn(1e3,function(){t("#follow-usat-box-details").fadeIn(1e3)}),document.cookie="usatfollowus=shown; "+l+"; path=/",t(".sp-details-close").click(function(){t(".sp-follow-usat-overlay-wrap").parent().remove()});break;case"shown":t(".sp-follow-usat-overlay-wrap").parent().remove();break;default:t(".sp-follow-usat-overlay-wrap").parent().remove()}}}});return s}),define("modules/weather/weather-dropdown",["jquery","underscore","backbone","baseview","pubsub","utils","state","form/autocomplete","easing","animatecolors","cookie"],function(t,e,i,s,n,o,r,a){"use strict";var l=s.extend({events:{mouseenter:"onMouseEnter",mouseleave:"onMouseLeave","click .weather-nav-dropdown-settings-open-btn":"showSettingsPanel","click .weather-nav-dropdown-settings-close-btn":"hideSettingsPanel","click .weather-nav-location-cancel-btn":"hideSettingsPanel","click .weather-nav-location-set-btn":"onSetButtonClick","submit .weather-nav-location-form":"onSubmitLocationForm","keydown .weather-nav-location-input":"onKeyDown","focus .weather-nav-location-input":"onFocusLocationField","blur .weather-nav-location-input":"onBlurLocationField","click .weather-nav-full-forecast-btn":"onClickFullForecast"},initialize:function(i){e.bindAll(this,"refreshData","onAutoCompleteResultClick"),this.panels=this.$(".weather-nav-dropdown-panel-wrap"),this.frontPanel=this.panels.find(".weather-nav-conditions-panel"),this.frontWeatherLocation=this.frontPanel.find(".weather-nav-location-name"),this.frontWeatherIcon=this.frontPanel.find(".weather-nav-dropdown-wicon"),this.settingsPanel=this.panels.find(".weather-nav-settings-panel"),this.locationField=this.settingsPanel.find(".weather-nav-location-input"),this.dropdownWiconClassName=this.frontWeatherIcon.attr("class"),this.transitionDelay=80,this.body=o.get("body"),this.navBtn=this.$el.parent(".weather"),this.$navLink=this.$el.siblings("a").eq(0),this.$navTempSpan=this.$navLink.find(".site-nav-alt-span"),this.navBtnTemp=this.navBtn.find(".btn-temp"),this.navBtnClassName=this.navBtnTemp.attr("class"),this.pubSub={"weather:newLocation":this._parseData},s.prototype.initialize.call(this,i),this.locationErrorEl=this.$(".weather-nav-location-error"),t.cookie("weatherLocation")?this.refreshData():this.updateWeatherLocation(window.defaultWeatherLocation),this.weatherDataRefresh=setInterval(this.refreshData,3e5)},onSetButtonClick:function(t){t.preventDefault(),this.updateWeatherLocation(this.locationField.val())},onAutoCompleteResultClick:function(){this.updateWeatherLocation(this.locationField.val())},onKeyDown:function(t){var e=t.keyCode?t.keyCode:t.which;13===e&&this.updateWeatherLocation(this.locationField.val()),this.clearLocationInputError()},onSubmitLocationForm:function(t){t.preventDefault()},onClickFullForecast:function(){this.isMouseOnDropdown=!1,this.closeDropdown()},onMouseEnter:function(){this.isMouseOnDropdown=!0},onMouseLeave:function(){this.locationField.is(":focus")||(this.isMouseOnDropdown=!1,this.closeDropdown())},closeDropdown:function(){this.isMouseOnDropdown||(this.isSettingsPanelActive&&this.hideSettingsPanel(),r.registerAnimation(this.$el.stop().fadeOut(this.transitionDelay,"swing").promise().done(e.bind(function(){this.$el.removeClass("dropdown-active"),this.navBtn.find(".nav-span").removeClass("dropdown-active")},this))),this.body.off("."+this.cid))},openDropdown:function(){r.registerAnimation(this.$el.stop().fadeIn(this.transitionDelay,"swing").promise().done(e.bind(function(){this.$el.addClass("dropdown-active"),this.navBtn.find(".nav-span").addClass("dropdown-active")},this)))},showSettingsPanel:function(){this.$el.hasClass("settings-active")||(this.$el.addClass("settings-active"),this.isSettingsPanelActive=!0),this.subviews.autocomplete||(this.subviews.autocomplete=new a({el:this.locationField,resultDisplayTemplate:"<%= City %>, <%= State %>",resultValueTemplate:"<%= City %>, <%= State %>",onSelect:this.onAutoCompleteResultClick}))},hideSettingsPanel:function(){this.subviews.autocomplete&&this.subviews.autocomplete.resetInput(),this.clearLocationInputError(),this.locationField.blur(),this.$el.hasClass("settings-active")&&(this.$el.removeClass("settings-active"),this.isSettingsPanelActive=!1)},onFocusLocationField:function(){this.locationField.val(""),this.body.on("click."+this.cid,e.bind(function(e){0===t(e.target).closest(this.el).length&&(this.isMouseOnDropdown=!1,this.closeDropdown())},this))},onBlurLocationField:function(){""===this.locationField.val()&&this.locationField.val(this.locationField.data("value"))},setWeatherCookie:function(e){t.cookie("weatherLocation",e,{path:"/",expires:1825})},updateWeatherLocation:function(i){return i&&i!==t.cookie("weatherLocation")?this._fetchData(i).done(e.bind(function(t){this.hideSettingsPanel(),n.trigger("weather:newLocation",t)},this)).fail(e.bind(function(t){this.showLocationInputError(t)},this)):void 0},refreshData:function(){return this._fetchData(t.cookie("weatherLocation"))},_fetchData:function(i){return this.isBusyGettingData||!i?t.Deferred().reject():(i=i.replace(",",""),this.isBusyGettingData=!0,t.Deferred(e.bind(function(t){r.fetchData("/weather/forecast/json/"+i+"/").done(e.bind(function(e){e.length&&e[0]?(this._parseData(e),t.resolveWith(this,[e])):t.rejectWith(this,["No data is available for this location."]),this.isBusyGettingData=!1},this)).fail(e.bind(function(){t.rejectWith(this,["There was an error finding this location. Please try again later."]),this.isBusyGettingData=!1},this))},this)))},showLocationInputError:function(t){this.locationErrorEl.html()!==t&&(this.locationErrorEl.addClass("ui-input-field-error-active"),this.locationErrorEl.text(t),this.locationErrorEl.stop().slideDown(50,"easeInOutQuad"))},clearLocationInputError:function(){this.locationErrorEl.hasClass("ui-input-field-error-active")&&this.locationErrorEl.stop().slideUp(50,"easeInOutQuad").promise().done(e.bind(function(){this.locationErrorEl.removeClass("ui-input-field-error-active"),this.locationErrorEl.empty()},this))},_parseData:function(i){if(i[0].currentConditions){var s=i[0],n=s.currentConditions,o=s.local.city+", "+s.local.adminArea.Text,r="wicon-"+n.weatherIcon,a=parseInt(n.temperature,10),l=this.$navTempSpan.add(this.$("[data-weather]"));l.each(e.bind(function(e,i){var s=t(i);s.html((n[s.data("weather")]||"")+(s.data("weather-suffix")||""))},this)),o.length>20&&this.frontWeatherLocation.addClass("longname"),this.frontWeatherLocation.html(o),a>99&&this.frontWeatherTemp.addClass("three-digit"),this.frontWeatherIcon.attr("class",this.dropdownWiconClassName+" "+r),this.navBtnTemp.attr("class",this.navBtnClassName+" "+r),this.$navTempSpan.addClass("site-nav-visible-alt-span "+r),t.cookie("weatherLocation")!==o&&this.setWeatherCookie(o),this.locationField.data("value",o).val(o)}},destroy:function(t){this.body.off("."+this.cid),clearInterval(this.weatherDataRefresh),s.prototype.destroy.call(this,t)}});return l}),define("modules/weather/site-nav-weather-module",["jquery","underscore","baseview","pubsub","utils","state","modules/weather/weather-dropdown"],function(t,e,i,s,n,o,r){"use strict";var a=i.extend({events:{mouseenter:"onHoverWeatherNav",mouseleave:"onHoverWeatherNav","click .site-nav-weather-link":"onClickWeatherNav"},initialize:function(){i.prototype.initialize.apply(this);var t=this.$(".weather-nav-dropdown");this.subviews.weatherDropdown=new r({el:t})},onHoverWeatherNav:function(t){var i=this.$(".site-nav-alt-span");clearTimeout(this.navBtnHoverDelay),i.hasClass("site-nav-visible-alt-span")&&("mouseenter"===t.type?(i.addClass("site-nav-active-alt-span"),this.navBtnHoverDelay=e.delay(e.bind(this.subviews.weatherDropdown.openDropdown,this.subviews.weatherDropdown),this.hoverDropdownDelay)):(i.removeClass("site-nav-active-alt-span"),this.navBtnHoverDelay=e.delay(e.bind(this.subviews.weatherDropdown.closeDropdown,this.subviews.weatherDropdown),this.hoverDropdownDelay)))},onClickWeatherNav:function(){this.subviews.weatherDropdown.closeDropdown()}});return a}),define("modules/sports/sports-video-ooyala",["jquery","underscore","state","backbone","baseview"],function(t,e,i,s,n){var o=n.extend({events:{"click #ooyalaplaylist li.item":"selectVideo"},initialize:function(){n.prototype.initialize.call(this,this.options),this.settings={disableAds:t("#ooyalaplayer").data("disableads"),wmode:"transparent",enableChannels:!0,autoplay:!1,debug:!0,nextIndex:2,containerId:"ooyalaplayer",playlistContainer:"ooyalaplaylist",videoTitleId:"ooyala-title",playlistId:"ooyalaplaylist",videoPlayer:{},hasPlayed:!1,width:t("#ooyalaplayer").data("width"),height:t("#ooyalaplayer").data("height"),adsetcode:t("#ooyalaplayer").data("adsetcode"),adtagurl:t("#ooyalaplayer").data("adtagurl"),cuedvideoid:"",viewdestroyed:!1},this.firstVideoId=t("#"+this.settings.containerId).data("videoid"),this.playerApiUrl=t("#"+this.settings.containerId).data("playerapiurl"),e.bindAll(this,"createPlayer","loadScripts","selectVideo","playerReceiver","loadVideoById","setNextplaylistItem","clearActiveElement","setActiveElement","getAdOptions"),window.googletag&&this.settings.disableAds!==!0&&window.googletag.cmd.push(function(){window.googletag.pubads().enableSingleRequest(),window.googletag.companionAds().setRefreshUnfilledSlots(!0),window.googletag.enableServices()}),this.loadScripts()},loadScripts:function(){require([this.playerApiUrl],e.bind(function(){"undefined"!=typeof window.OO?this.createPlayer(this.firstVideoId):console.log("Error loading ooyala")},this))},createPlayer:function(t){var i={wmode:this.settings.wmode,enableChannels:!0,autoplay:this.settings.autoplay,width:this.settings.width+"px",height:this.settings.height+"px",debug:this.settings.debug,adSetCode:this.settings.adsetcode,onCreate:e.bind(function(t){window.mb=t.mb,window.mb.subscribe("*","PGATourOoyala",e.bind(function(t){this.playerReceiver(t)},this))},this)};this.settings.disableAds!==!0&&(i["google-ima-ads-manager"]=this.getAdOptions(t)),this.settings.videoPlayer=window.OO.Player.create(this.settings.containerId,t,i)},destroyVideo:function(){this.settings.videoPlayer.destroy()},selectVideo:function(e){this.loadVideoById(t(e.currentTarget).data("videoid")),this.clearActiveElement(),this.setActiveElement(t(e.currentTarget)),this.setNextplaylistItem(t(e.currentTarget))},playerReceiver:function(e){switch(e){case"played":{var s=t("#"+this.settings.playlistId+" li:nth-child("+this.settings.nextIndex+")");s.data("videoid")}t(s).trigger("click");break;case"playbackReady":this.settings.autoplay=!0;break;case"playing":i.stopRefreshTimer();break;case"destroy":this.settings.viewdestroyed===!1&&this.loadVideoById()}},getAdOptions:function(t){var e=this.settings.adtagurl.replace("%s",t),i=(new Date).getTime(),s={adTagUrl:e,additionalAdTagParameters:{correlator:i},showInAdControlBar:!0};return s},loadVideoById:function(t){t?(this.settings.cuedvideoid=t,this.destroyVideo()):this.createPlayer(this.settings.cuedvideoid)},setNextplaylistItem:function(t){this.settings.nextIndex=t.next().attr("data-index")?t.next().data("index"):1},setVideoTitle:function(){var e=this.settings.videoPlayer.getTitle();t("#"+this.settings.videoTitleId).html(e)},clearActiveElement:function(){t("#"+this.settings.playlistId+" li").siblings().removeClass("active")},setActiveElement:function(t){t.addClass("active")},destroy:function(){this.settings.viewdestroyed=!0,this.clearActiveElement(),this.setActiveElement(t("#"+this.settings.playlistId+" li").first()),"function"==typeof this.settings.videoPlayer.destroy&&this.settings.videoPlayer.destroy(),n.prototype.destroy.apply(this,arguments)}});return o}),define("modules/live-newscasts/live-newscasts",["jquery","underscore","baseview","modules/global/livevideo"],function(t,e,i,s){var n=i.extend({events:{"click .newscast-item a":"onLiveNewscastsClick"},onLiveNewscastsClick:function(e){var i=t(e.currentTarget).attr("data-livevideoassetid");if(i){var n=new s({service:"/services/livenewscasts/"});return n.loadLiveVideo(i),!1}}});return n}),define("touchswipe",["jquery"],function(t){function e(e){return!e||void 0!==e.allowPageScroll||void 0===e.swipe&&void 0===e.swipeStatus||(e.allowPageScroll=h),e||(e={}),e=t.extend({},t.fn.swipe.defaults,e),this.each(function(){var s=t(this),n=s.data(b);n||(n=new i(this,e),s.data(b,n))})}function i(e,i){function w(e){if(!(N()||t(e.target).closest(i.excludedElements,te).length>0)){e=e.originalEvent;var s,n=y?e.touches[0]:e;return ee=f,y?ie=e.touches.length:e.preventDefault(),G=0,Y=null,Q=null,Z=0,X=0,K=0,J=1,se=j(),!y||ie===i.fingers||i.fingers===p||O()?(se[0].start.x=se[0].end.x=n.pageX,se[0].start.y=se[0].end.y=n.pageY,ne=F(),2==ie&&(se[1].start.x=se[1].end.x=e.touches[1].pageX,se[1].start.y=se[1].end.y=e.touches[1].pageY,X=K=P(se[0].start,se[1].start)),(i.swipeStatus||i.pinchStatus)&&(s=C(e,ee))):(k(e),s=!1),s===!1?(ee=v,C(e,ee),s):(B(!0),te.bind(q,_),te.bind(V,x),void 0)}}function _(t){if(t=t.originalEvent,ee!==m&&ee!==v){var e,s=y?t.touches[0]:t;if(se[0].end.x=y?t.touches[0].pageX:s.pageX,se[0].end.y=y?t.touches[0].pageY:s.pageY,oe=F(),Y=L(se[0].start,se[0].end),y&&(ie=t.touches.length),ee=g,2==ie&&(0==X?(se[1].start.x=t.touches[1].pageX,se[1].start.y=t.touches[1].pageY,X=K=P(se[0].start,se[1].start)):(se[1].end.x=t.touches[1].pageX,se[1].end.y=t.touches[1].pageY,K=P(se[0].end,se[1].end),Q=D(se[0].end,se[1].end)),J=I(X,K)),ie!==i.fingers&&i.fingers!==p&&y)ee=v,C(t,ee);else if($(t,Y),G=M(se[0].start,se[0].end),Z=A(se[0].start,se[0].end),(i.swipeStatus||i.pinchStatus)&&(e=C(t,ee)),!i.triggerOnTouchEnd){var n=!T();S()===!0?(ee=m,e=C(t,ee)):n&&(ee=v,C(t,ee))}e===!1&&(ee=v,C(t,ee))}}function x(t){if(t=t.originalEvent,t.touches&&t.touches.length>0)return!0;if(t.preventDefault(),oe=F(),0!=X&&(K=P(se[0].end,se[1].end),J=I(X,K),Q=D(se[0].end,se[1].end)),G=M(se[0].start,se[0].end),Y=L(se[0].start,se[0].end),Z=A(),i.triggerOnTouchEnd||i.triggerOnTouchEnd===!1&&ee===g){ee=m;var e=R()||!O(),s=ie===i.fingers||i.fingers===p||!y,n=0!==se[0].end.x,o=s&&n&&e;if(o){var r=T(),a=S();a!==!0&&null!==a||!r?r&&a!==!1||(ee=v,C(t,ee)):C(t,ee)}else ee=v,C(t,ee)}else ee===g&&(ee=v,C(t,ee));te.unbind(q,_,!1),te.unbind(V,x,!1),B(!1)}function k(){ie=0,oe=0,ne=0,X=0,K=0,J=1,B(!1)}function C(t,e){var h=void 0;if(i.swipeStatus&&(h=i.swipeStatus.call(te,t,e,Y||null,G||0,Z||0,ie)),i.pinchStatus&&R()&&(h=i.pinchStatus.call(te,t,e,Q||null,K||0,Z||0,ie,J)),e===v&&(!i.click||1!==ie&&y||!isNaN(G)&&0!==G||(h=i.click.call(te,t,t.target))),e==m){switch(i.swipe&&(h=i.swipe.call(te,t,Y,G,Z,ie,i)),Y){case s:i.swipeLeft&&(h=i.swipeLeft.call(te,t,Y,G,Z,ie,i));break;case n:i.swipeRight&&(h=i.swipeRight.call(te,t,Y,G,Z,ie,i));break;case o:i.swipeUp&&(h=i.swipeUp.call(te,t,Y,G,Z,ie,i));break;case r:i.swipeDown&&(h=i.swipeDown.call(te,t,Y,G,Z,ie,i))}switch(Q){case a:i.pinchIn&&(h=i.pinchIn.call(te,t,Q||null,K||0,Z||0,ie,J));break;case l:i.pinchOut&&(h=i.pinchOut.call(te,t,Q||null,K||0,Z||0,ie,J))}}return(e===v||e===m)&&k(t),h}function S(){return null!==i.threshold?G>=i.threshold:null}function T(){var t;return t=i.maxTimeThreshold?Z>=i.maxTimeThreshold?!1:!0:!0}function $(t,e){if(i.allowPageScroll===h||O())t.preventDefault();else{var a=i.allowPageScroll===c;switch(e){case s:(i.swipeLeft&&a||!a&&i.allowPageScroll!=d)&&t.preventDefault();break;case n:(i.swipeRight&&a||!a&&i.allowPageScroll!=d)&&t.preventDefault();break;case o:(i.swipeUp&&a||!a&&i.allowPageScroll!=u)&&t.preventDefault();break;case r:(i.swipeDown&&a||!a&&i.allowPageScroll!=u)&&t.preventDefault()}}}function A(){return oe-ne}function P(t,e){var i=Math.abs(t.x-e.x),s=Math.abs(t.y-e.y);return Math.round(Math.sqrt(i*i+s*s))}function I(t,e){var i=e/t*1;return i.toFixed(2)}function D(){return 1>J?l:a}function M(t,e){return Math.round(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)))}function E(t,e){var i=t.x-e.x,s=e.y-t.y,n=Math.atan2(s,i),o=Math.round(180*n/Math.PI);return 0>o&&(o=360-Math.abs(o)),o}function L(t,e){var i=E(t,e);return 45>=i&&i>=0?s:360>=i&&i>=315?s:i>=135&&225>=i?n:i>45&&135>i?r:o}function F(){var t=new Date;return t.getTime()}function z(){te.unbind(H,w),te.unbind(W,k),te.unbind(q,_),te.unbind(V,x),B(!1)}function O(){return i.pinchStatus||i.pinchIn||i.pinchOut}function R(){return Q&&O()}function N(){return te.data(b+"_intouch")===!0?!0:!1}function B(t){t=t===!0?!0:!1,te.data(b+"_intouch",t)}function j(){for(var t=[],e=0;5>=e;e++)t.push({start:{x:0,y:0},end:{x:0,y:0},delta:{x:0,y:0}});return t}var U=y||!i.fallbackToMouseEvents,H=U?"touchstart":"mousedown",q=U?"touchmove":"mousemove",V=U?"touchend":"mouseup",W="touchcancel",G=0,Y=null,Z=0,X=0,K=0,J=1,Q=0,te=t(e),ee="start",ie=0,se=null,ne=0,oe=0;try{te.bind(H,w),te.bind(W,k)}catch(re){t.error("events not supported "+H+","+W+" on jQuery.swipe")}this.enable=function(){return te.bind(H,w),te.bind(W,k),te},this.disable=function(){return z(),te},this.destroy=function(){return z(),te.data(b,null),te}}var s="left",n="right",o="up",r="down",a="in",l="out",h="none",c="auto",d="horizontal",u="vertical",p="all",f="start",g="move",m="end",v="cancel",y="ontouchstart"in window,b="TouchSwipe",w={fingers:1,threshold:75,maxTimeThreshold:null,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,triggerOnTouchEnd:!0,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"button, input, select, textarea, a, .noSwipe"};t.fn.swipe=function(i){var s=t(this),n=s.data(b);if(n&&"string"==typeof i){if(n[i])return n[i].apply(this,Array.prototype.slice.call(arguments,1));t.error("Method "+i+" does not exist on jQuery.swipe")}else if(!(n||"object"!=typeof i&&i))return e.apply(this,arguments);return s},t.fn.swipe.defaults=w,t.fn.swipe.phases={PHASE_START:f,PHASE_MOVE:g,PHASE_END:m,PHASE_CANCEL:v},t.fn.swipe.directions={LEFT:s,RIGHT:n,UP:o,DOWN:r,IN:a,OUT:l},t.fn.swipe.pageScroll={NONE:h,HORIZONTAL:d,VERTICAL:u,AUTO:c},t.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:p}}),define("modules/interactives/interactive-templates",["jquery","underscore","state","pubsub","utils","baseview","ui/loader","modules/global/brightcove-video","ui/generic-paginator","touchswipe","meteredAdPosition","adLogger","modules/interactives/interactive-ads"],function(t,e,i,s,n,o,r,a,l,h,c,d,u){var p=o.extend({el:".interactive",events:{"click .slide-nav.prev, .slide-nav.next":"onArrowClick","click .navigation li":"onNavClick"},initialize:function(i){e.bindAll(this,"beforePaginatorClick","goTo"),i=t.extend({ads:!1,adSponsor:!1,adTransition:!1,ignoreFirstNav:!1,interactiveType:"",isFramed:!1,standAlone:!1},i),this.$leftArrow=this.$(".slide-nav.prev"),this.$rightArrow=this.$(".slide-nav.next"),this.$viewport=this.$(".viewport"),this.$slideContainer=this.$viewport.find(".slides"),this.$slides=this.$slideContainer.find(".slide"),this.$navigation=this.$(".navigation"),this.$navigationItems=this.$navigation.find("li"),this.slideNum=this.$slides.length,t(this.$slides[this.$slides.length-1]).hasClass("partner-slide-ad")&&(this.slideNum-=1),this.slideWidth=this.$slides.outerWidth(),this.slideHeight=this.$slides.outerHeight(),this.slideWidthPad="sequencer"===this.options.interactiveType?this.$(".stage").outerWidth()-this.slideWidth:0,this.maxSlides=this.slideNum,this.$slideContainer.width(this.maxSlides*this.slideWidth),this.currentSlideIndex=0,this.subviews={},this.setupSwipes(),this.$viewport.hasClass("slide")&&this.$slides.css({display:"inline-block"}),o.prototype.initialize.call(this,i),this.subviews.video=[],this.subviews.paginator=new l({onBeforePaginator:this.beforePaginatorClick,el:this.$(".paginator"),onGoTo:this.goTo}),this.setupAds()},beforePaginatorClick:function(t){var e=t<this.currentSlideIndex?"left":"right";return!this.showingAd&&this.shouldShowAd()?(this.showAd(e),!1):(this.options.isFramed!==!0&&this.trackPageView(),!0)},goTo:function(t){this._switchSlides(this._getSlideIn(t),this._getSlideOut())},onArrowClick:function(e){var i=t(e.currentTarget).is(this.$leftArrow)?"left":"right";return"chronology"!==this.options.interactiveType&&"beforeandafter"!==this.options.interactiveType||this.options.isFramed===!0||this.trackPageView(),!this.showingAd&&this.shouldShowAd()?(this.showAd(i),!1):this.showingAd&&this.showingAd.index()===this.currentSlideIndex?(this.subviews.paginator.goToPage("left"===i?this.currentSlideIndex-1:this.currentSlideIndex),!1):("left"===i?this.previousSlide():this.nextSlide(),!1)},onNavClick:function(e){var i=t(e.currentTarget),s=i.parent().find("li"),n=s.index(i);return 0===n&&this.options.ignoreFirstNav?!1:(this.options.ignoreFirstNav&&n--,this.goTo(n),!1)},onSwipeSlide:function(t,e,i,s,n,o){"right"===e||"down"===e?o.self.previousSlide():o.self.nextSlide()},previousSlide:function(){if(this.subviews.paginator.$el.length<1){var t=this.currentSlideIndex>0?this.currentSlideIndex-1:this.slideNum-1;this.goTo(t)}else this.subviews.paginator.goToPrevPage(this.currentSlideIndex)},nextSlide:function(){if(this.subviews.paginator.$el.length<1){var t=this.currentSlideIndex<this.slideNum-1?this.currentSlideIndex+1:0;this.goTo(t)}else this.subviews.paginator.goToNextPage(this.currentSlideIndex)},setupAds:function(){if(this.options.ads){this.subviews.interactiveAds=new u({el:this.$(".interactive-sponsor")});var t=this.$el.data(),e={title:t.seoTitle,series:t.series,sitePage:"usat/"+(t.ssts||"").replace(/\/\/*$/,""),topic:t.topic},i=this.$viewport.width(),s=this.$viewport.height();450>s||600>i?d.logWarn("Advertisement viewport is too small: "+i+"x"+s):(this.$adSlide=this.$(".partner-slide-ad"),this.$adSlide.length>0&&(this.options.adTransition=!0,this.$adContents=this.$adSlide.find(".interactive-ad"),this.subviews.ad=new c({el:this.$adContents,adPlacement:"transition_interactive/"+t.cst,adSizes:["elastic"],meterThreshold:"transition_interactive",rateMeterId:"asset_"+t.interactiveId,targeting:e})))}},setupSwipes:function(){if(Modernizr.touch&&"beforeandafter"!==this.options.interactiveType&&"timeline"!==this.options.interactiveType){var t=this;this.$slideContainer.swipe({self:t,swipe:t.onSwipeSlide})}},shouldShowAd:function(){return!this.showingAd&&this.options.ads&&this.subviews.ad&&this.subviews.ad.shouldShowAd()?!0:!1},showAd:function(t){var i=this._getSlideOut();if(this.showingAd=this.$adSlide,this.$adContents.show(),i[0]!==this.showingAd[0]){var s=this.showingAd.detach();"left"===t?s.insertBefore(i):"right"===t&&s.insertAfter(i),this.$slides=this.$slideContainer.find(".slide"),this._switchSlides(this.showingAd,i,t).done(e.bind(function(){this.$slides.removeClass("active"),this.subviews.ad.playAd()},this))}},trackClick:function(t){this.trackFirstClick(),s.trigger("uotrack",t)},trackFirstClick:function(){this.firstClick||(s.trigger("uotrack",this.options.interactiveType+"firstclick"),this.firstClick=!0)},trackPageView:function(){this.trackFirstClick();var e={contenttype:this.$el.data("contenttype"),pathName:this.trackPathName("")},n=i.getActivePageInfo();e=t.extend(n,e),s.trigger("analytics:pageload",e)},trackPathName:function(t){var e;return e=this.options.standAlone===!0?document.location.pathname:"/interactive/"+this.$el.data("interactive-id")+"/",e=this.options.interactiveType+e+this.$el.data("seoTitle")+"/"+t},_getSlideOut:function(){var t;return t=this.showingAd&&this.showingAd.length>0?this.showingAd:this.$slides.eq(this.currentSlideIndex)},_getSlideIn:function(t){this.options.adTransition&&this.$adSlide.index()<=t&&(t+=1);var e=this.$slides.eq(t);return e},_switchSlides:function(i,s){var n,o=s.index(),r=i.index(),l=this.slideWidth*r,h=this.slideHeight*r,c=this.options.adTransition&&this.$adSlide.index()<this.maxSlides?!0:!1;s===this.showingAd&&this.subviews.ad.stopAd(),0===r?(this.$leftArrow.addClass("invisible"),this.$rightArrow.removeClass("invisible")):r===this.maxSlides-1&&!c||r===this.maxSlides&&c?(this.$leftArrow.removeClass("invisible"),this.$rightArrow.addClass("invisible")):(this.$leftArrow.removeClass("invisible"),this.$rightArrow.removeClass("invisible")),e.each(this.subviews.video,function(t){t.destroy(!1,!0)
}),this.subviews.video=[];var d=r;if(this.options.ignoreFirstNav&&d++,this.$navigationItems.removeClass("active").eq(d).addClass("active"),this.$viewport.hasClass("slide")||this.$viewport.hasClass("slide-transition"))n=this.animate(this.$slideContainer,"left",-1*l+this.slideWidthPad+"px",400,"ease-in-out",0).done(e.bind(function(){this.showingAd&&s[0]===this.showingAd[0]&&(this.subviews.ad.refreshPosition(),"none"!==this.$adContents.css("display")&&this.$adContents.hide(),this.showingAd=null)},this));else if(this.$viewport.hasClass("vslide-transition"))n=this.animate(this.$slideContainer,"top",-1*h+"px",400,"ease-in-out",0).done(e.bind(function(){this.showingAd&&s[0]===this.showingAd[0]&&(this.subviews.ad.refreshPosition(),"none"!==this.$adContents.css("display")&&this.$adContents.hide(),this.showingAd=null)},this));else if(this.$viewport.hasClass("fade")||this.$viewport.hasClass("fade-transition")){var u=this.$slides.eq(r),p=this.$slides.eq(o);r!==o?(p.css({"z-index":1}),u.css({"z-index":2,opacity:0,display:"block"}),n=this.animate(u,"opacity",1,400,"linear").done(function(){p.css({opacity:0,display:"none"})})):(u.css({opacity:0,display:"block"}),n=this.animate(u,"opacity",1,400,"linear"))}this.$slides.removeClass("active").eq(r).addClass("active");var f=this;return t.each(this.$slides.eq(r).find(".video"),function(){var e=new a({el:t(this).get(0),autostart:!0});f.subviews.video.push(e)}),this.currentSlideIndex=r,n}});return p}),define("modules/interactives/overview",["jquery","underscore","backbone","utils","baseview","modules/interactives/interactive-templates","modules/global/brightcove-video"],function(t,e,i,s,n,o){var r=n.extend({initialize:function(t){n.prototype.initialize.call(this,t);var e=!0;(t.isFramed||this.$el.data("suppressad")===!0)&&(e=!1),this.$el.length&&(this.subviews.template=new o({ads:e,el:this.$el,interactiveType:"chronology",isFramed:t.isFramed,standAlone:t.standAlone}),this.subviews.template.goTo(this.subviews.template.currentSlideIndex))}});return r}),define("modules/interactives/sequencer",["jquery","underscore","pubsub","utils","baseview","modules/interactives/interactive-templates","modules/global/brightcove-video"],function(t,e,i,s,n,o){var r=n.extend({events:function(){var t=Modernizr.touch?"touchstart":"click",e={"click .navigation li":"navInteraction"};return e[t+" .nav-hide"]="showHidePanel",e},initialize:function(t){n.prototype.initialize.call(this,t);var e=!0;(t.isFramed||this.$el.data("suppressad")===!0)&&(e=!1),this.subviews.template=new o({ads:e,el:this.$el,ignoreFirstNav:!0,interactiveType:"sequencer",isFramed:t.isFramed,standAlone:t.standAlone}),this.subviews.template.goTo(this.subviews.template.currentSlideIndex),this.subviews.video=[],this.$slideContainer=this.subviews.template.$slideContainer,this.$slides=this.subviews.template.$slides,this.$nav=this.subviews.template.$navigation,this.$navButton=this.$nav.find(".nav-hide-button"),this.$viewport=this.subviews.template.$viewport,this.setupSlides()},setupSlides:function(){if(this.$viewport.hasClass("slide-transition")){var t=this.$slides.eq(0).width()*this.$slides.length;this.$slideContainer.width(t)}else if(this.$viewport.hasClass("vslide-transition")){var e=this.$slides.eq(0).height()*this.$slides.length;this.$slideContainer.height(e)}},showHidePanel:function(){if(this.$navButton.length<1)return!1;var t=this.$nav.hasClass("show"),e=t?"showpanel":"hidepanel";this.animatePanel(t),this.options.isFramed!==!0&&this.subviews.template.trackClick("sequencer"+document.location.pathname+e)},navInteraction:function(){this.$(arguments[0].currentTarget).hasClass("nav-hide")||this.options.isFramed!==!0&&this.subviews.template.trackPageView()},animatePanel:function(t){t?(this.$nav.animate({width:"180px"},350),this.$nav.find(".sq-navigation-text-wrap").fadeIn()):(this.$nav.find(".sq-navigation-text-wrap").fadeOut(),this.$nav.animate({width:"48px"},350)),this.$nav.toggleClass("show")}});return r}),define("modules/travel/travel-poll",["jquery","underscore","baseview","pubsub","utils","state","cookie"],function(t,e,i,s,n,o){var r=i.extend({events:{"submit .travel-poll-form":"registerVote","click .poll-vote-results .story-poll-vote-btn":"revealChoices"},initialize:function(){this.user_id="unauthenticated",this.template=this.$(".travel-poll-wrapper"),this.form=this.$(".travel-poll-form"),this.choices=this.$(".travel-poll-choices"),this.results=this.$(".travel-poll-results"),this.poll_id=this.template.attr("data-pollid"),t.cookie(this.poll_id)&&this.revealResults(),i.prototype.initialize.apply(this,arguments)},revealResults:function(i){var s="/polls/get/"+this.poll_id+"/";o.fetchData(s).done(e.bind(function(s){var n=e.pluck(s[0].answer,"count"),o=e.reduce(n,function(t,e){return t+parseFloat(e)},0),r=0===o?!0:!1,a=0;isNaN(i)||t.cookie(this.poll_id,!0),e.each(s[0].answer,function(t,e){var s,n=parseFloat(t.count);r?s=i==e?100:0:(i==e-1&&(t.count+=1),s=Math.round(n/o*100)),t.count_output=n,a+=s,t.percent=s,t.percent_width=.8*s,n>999&&(t.count_output=(Math.round(n/100*10)/10).toString()+"k")});var l=e.template(t(".quickpoll-results").html(),{data:s[0],total:o});this.form.hide(),this.results.html(l),t.cookie(this.poll_id)&&this.$(".poll-vote-results .story-poll-vote-wrapper").hide(),this.results.css("height","auto")},this))},registerVote:function(i){var n=t("input[name=travel-poll-choice]:checked").val(),r="/polls/save/"+this.poll_id+"/"+this.user_id+"/"+n+"/";return i.preventDefault(),o.fetchData(r,{method:"post"}).done(e.bind(function(t){t&&(s.trigger("uotrack","pollvote"),this.revealResults(n))},this)),!1},revealChoices:function(){this.choices=this.$(".story-poll-choices"),this.results=this.$(".story-poll-chart"),this.results.hide(),this.choices.fadeIn()}});return r}),define("modules/fronts/live-feed",["jquery","underscore","baseview","state","utils"],function(t,e,i,s,n){"use strict";var o=i.extend({initialize:function(s){e.bindAll(this,"initMarkup","updateMarkup","fetchUpdate","hideImage");var o=this.$el.attr("data-livefeed")||n.getSectionPath(window.location.pathname),r=this.$el.attr("data-livefeed-site-id"),a=this.$el.attr("data-livefeed-site-prefix");s=t.extend({maxItems:60,itemFetchLimit:40,removeNewHighlight:20,updateDelay:30,dataSrcAttr:"data-src",autoUpdate:!0,site_id:r,site_prefix:a,section:o,afterFetchResults:null,ajaxOptions:null},s);var l={count:s.itemFetchLimit};"undefined"!=typeof r&&""!==r&&(l.site_id=s.site_id),"undefined"!=typeof a&&""!==a&&(l.site_prefix=s.site_prefix);var h={url:"/feeds/live/"+o+"/",data:l};this.requestOptions=t.extend(!0,h,s.ajaxOptions),i.prototype.initialize.call(this,s)},onCardWidthChange:function(t){var e=t.sidebarWidth!==this.currentCardInfo.sidebarWidth;this.currentCardInfo=t,e&&this.setLiveFeedWidth(t)},setLiveFeedWidth:function(t){t.sidebarWidth<340?this.$el.removeClass("live-feed-wide"):this.$el.addClass("live-feed-wide"),this.options.dataSrcAttr="data-src-"+t.sidebarWidth,this.loadLazyImages()},openSideBar:function(){this.setupLiveFeed()},closeSideBar:function(){this.stopUpdateCheck()},renderCardInfo:function(t){this.currentCardInfo=t,t.sidebarOpen&&this.setupLiveFeed()},setupLiveFeed:function(){this.stopUpdateCheck(),this.setLiveFeedWidth(this.currentCardInfo),this.$el.children("li").length?(this.$el.children(".newcontent").removeClass("newcontent"),this.fetchUpdate()):s.fetchHtml(null,this.requestOptions).done(e.bind(function(t){this.initMarkup(t),this.afterFetchResultsSuccess(t)},this))},afterFetchResultsSuccess:function(t){this.options.afterFetchResults&&this.options.afterFetchResults(t)},initMarkup:function(t){this.$el.removeClass("livefeed-loading"),this.$el.append(t),this.loadLazyImages(t.find("img")),this.refreshSidebar(),this.options.autoUpdate&&this.startUpdateCheck()},loadLazyImages:function(t){t=t||this.$("img"),n.lazyLoadImage(t,this.options.dataSrcAttr,!0,this.hideImage,this.refreshSidebar)},refreshSidebar:function(){s.getActiveApp().triggerEvent("refreshSidebarScroll")},hideImage:function(t){t.closest(".has-image").removeClass("has-image"),this.refreshSidebar()},fetchUpdate:function(){this.requestOptions.data.date=this.$("li:first").attr("data-timestamp"),s.fetchHtml(null,this.requestOptions).done(e.bind(function(t){this.updateMarkup(t),this.afterFetchResultsSuccess(t)},this))},updateMarkup:function(i){if(i&&0!==i.length){var s,n=this.$("li"),o={};n.removeClass("top"),i.each(function(){o[t(this).attr("data-content-id")]=!0}),n.each(function(){s=t(this),o[s.attr("data-content-id")]&&s.remove()}),i.eq(0).addClass("top").append('<div class="shadow"></div>'),this.$el.prepend(i),i.addClass("newcontent"),this.loadLazyImages(i.find("img")),n=this.$el.children("li"),n.length>60&&n.slice(60).remove(),this.afterNewContent=setTimeout(e.bind(function(){i.removeClass("newcontent")},this),1e3*this.options.removeNewHighlight),this.refreshSidebar()}},startUpdateCheck:function(){clearInterval(this.interval),this.interval=setInterval(this.fetchUpdate,1e3*this.options.updateDelay)},stopUpdateCheck:function(){clearInterval(this.interval)},destroy:function(t){t&&this.$el.empty(),this.stopUpdateCheck(),clearTimeout(this.afterNewContent),i.prototype.destroy.apply(this,arguments)}});return o}),function(t){function e(t){function e(t,e,n){var r=null;if(i(e)&&(h(e),s(t),o(t),l(e),m>=2)){var a=c(e),v=0;v=u(a)?-1*p(g,a-1,Math.floor(m/2)-1):p(g,Math.floor(m/2),a-2),m%2===0&&(v+=d()),r=f(n,e,v),n.points=r}return r}function i(t){return null!=t.bars&&t.bars.show&&null!=t.bars.order}function s(t){var e=w?t.getPlaceholder().innerHeight():t.getPlaceholder().innerWidth(),i=w?n(t.getData(),1):n(t.getData(),0),s=i[1]-i[0];b=s/e}function n(t,e){for(var i=new Array,s=0;s<t.length;s++)i[0]=t[s].data[0][e],i[1]=t[s].data[t[s].data.length-1][e];return i}function o(t){g=r(t.getData()),m=g.length}function r(t){for(var e=new Array,i=0;i<t.length;i++)null!=t[i].bars.order&&t[i].bars.show&&e.push(t[i]);return e.sort(a)}function a(t,e){var i=t.bars.order,s=e.bars.order;return s>i?-1:i>s?1:0}function l(){v=3,y=v*b}function h(t){t.bars.horizontal&&(w=!0)}function c(t){for(var e=0,i=0;i<g.length;++i)if(t==g[i]){e=i;break}return e+1}function d(){return g[Math.ceil(m/2)].bars.barWidth/2}function u(t){return t<=Math.ceil(m/2)}function p(t,e,i){for(var s=0,n=e;i>=n;n++)s+=t[n].bars.barWidth+2*y;return s}function f(t,e,i){for(var s=t.pointsize,n=t.points,o=0,r=w?1:0;r<n.length;r+=s)n[r]+=i,e.data[o][3]=n[r],o++;return n}var g,m,v,y,b=1,w=!1;t.hooks.processDatapoints.push(e)}var i={series:{bars:{order:null}}};t.plot.plugins.push({init:e,options:i,name:"orderBars",version:"0.2"})}(jQuery),define("libs/flot/jquery.flot.orderBars",function(){}),function(t){function e(t){function e(t){var e=document.createElement("canvas");if(e.getContext&&e.getContext("2d")){t.getCanvas().getContext("2d"),t.width()+100,t.height()+50}}t.hooks.draw.push(e)}var i={};t.plot.plugins.push({init:e,options:i,name:"style ",version:"0.05"})}(jQuery),define("libs/flot/jquery.flot.usat.style",function(){}),define("modules/interactives/bar-chart",["jquery","underscore","baseview","utils","modules/interactives/interactive-base","libs/flot/jquery.flot.orderBars","libs/flot/jquery.flot.usat.style"],function(t,e,i,s,n){"use strict";var o=n.extend({initialize:function(t){this.orientation=this.$el.data("orientation"),n.prototype.initialize.call(this,t)},_isMultiBar:function(){return this.datasetItems.length>1},getChartColors:function(){return"horizontal"===this.orientation&&this._isMultiBar()?(this.$el.data("colors")||"").split("|").slice(0,this.datasetItems.length).reverse():(this.$el.data("colors")||"").split("|")},getFlotData:function(t){return e.map(t,function(t,i,s){var n=this.mainColor;return s.length>1&&(n=this.chartColors[i%this.chartColors.length]),{label:t.label||"",color:n,bars:{borderWidth:30,fillColor:n},data:e.map(t.value,function(t){return t.split(",")})}},this)},_getHoverBody:function(t){return[this.getHoverPrefix(),s.addCommas(s.addCommas(t.datapoint["horizontal"===this.orientation?0:1])),this.getHoverSuffix()].join(" ")},getFlotOptions:function(){var t=this.datasetItems.length+(this.datasetItems.length>1&&s.getNested(this.datasetItems,"0","value","length")>6?4:this.datasetItems.length>1?2:1),e=n.prototype.getFlotOptions.apply(this,arguments),i=1/t;return e.colors=this.chartColors,e.series={bars:{show:!0,barWidth:i,order:"integer"},stack:!1},e.series.bars.align="center",e.grid.borderWidth=1,e.grid.labelMargin=5,e.grid.axisMargin=0,e.grid.autoHighlight=!0,e.grid.borderColor="rgb(237,236,236)","horizontal"===this.orientation?(e.xaxis={position:"bottom",autoscaleMargin:.02,tickFormatter:this.numberWithCommas},e.yaxis={ticks:this._createTicks(this.chartData.datasetLabels||""),position:"left",tickLength:0,autoscaleMargin:.02},e.bars={horizontal:!0}):(e.xaxis={autoscaleMargin:.02,ticks:this._createTicks(this.chartData.datasetLabels||""),position:"bottom",tickLength:0},e.yaxis={position:"left",labelWidth:40,tickFormatter:this.numberWithCommas}),e},_getHoverLabel:function(t){return this._isMultiBar()?t.series.label:""}});return o}),define("modules/global/video-carousel",["jquery","underscore","baseview","pubsub","state","modules/global/brightcove-video"],function(t,e,i,s,n,o){"use strict";var r=i.extend({events:{"click .carousel-nav":"onCarouselNavClick","mouseleave .video-carousel-viewport":"carouselMouseOut","mouseenter .video-carousel-viewport":"carouselMouseIn"},initialize:function(s){this.$carouselContainer=this.$(".video-carousel-series"),this.moveMe=this.$carouselContainer,this.viewport=this.moveMe.parent(),this.$slides=this.$carouselContainer.find(".video-carousel-item"),this.totalSlides=this.$slides.length,this.index=this.$(".video-carousel-item-wrap.active").index(),this.subviews={},this.subviews.video=[],this.autoplay=!1,e.bindAll(this,"goToNextVideo"),this.totalSlides>1?this.slideChangeInterval=setInterval(this.goToNextVideo,5e3):this.$(".carousel-nav").hide();var n=this;e.bindAll(this,"bcPlayerLoaded"),t.each(this.$slides.find(".video"),function(){var t=new o({el:this,onVideoComplete:n.goToNextVideo,onVideoLoaded:n.bcPlayerLoaded,autostart:!1});n.subviews.video.push(t)}),this.$el.hasClass("autoplay")&&(this.subviews.video[0].$(".videoStillPlay").click(),clearInterval(this.slideChangeInterval)),i.prototype.initialize.call(this,s)},bcPlayerLoaded:function(){this.autoplay=!0},onCarouselNavClick:function(e){if(e.preventDefault(),this.totalSlides>1){var i=t(e.currentTarget),s=i.hasClass("prev"),n=this.$(".video-carousel-item-wrap.active").index();this.index=n,this.autoplay=!1,s?n--:n++,this.goTo(n)}},goTo:function(t){t>=this.totalSlides?t=0:0>t&&(t=this.totalSlides-1);var e=this.viewport.outerWidth(),i=e*t*-1;this.subviews.video[this.index].player&&this.subviews.video[this.index].resetVideoState(),this.animate(this.moveMe,"left",i+"px",450,"ease-in-out"),this.autoplay&&(s.trigger("uotrack","videocarousel|nextauto"),this.subviews.video[t].player||this.subviews.video[t].$(".videoStillPlay").click()),this.updateDom(t)},updateDom:function(t){this.updateNextPrevArrows(t),this.$(".video-carousel-item-wrap").eq(this.index).removeClass("active"),this.$(".video-carousel-item-wrap").eq(t).addClass("active"),this.index=t},goToNextVideo:function(){var t=this.$(".video-carousel-item-wrap.active").index()+1;this.subviews.video[this.index].modVP?this.subviews.video[this.index].modVP.getIsPlaying(e.bind(function(e){e||this.goTo(t)},this)):this.goTo(t)},carouselMouseIn:function(){this.slideChangeInterval&&(clearInterval(this.slideChangeInterval),this.slideChangeInterval=!1)},carouselMouseOut:function(){this.totalSlides>1&&(this.autoplay||this.slideChangeInterval||(this.slideChangeInterval=setInterval(this.goToNextVideo,5e3)))},updateNextPrevArrows:function(t){{var e=this.$(".carousel-prev");this.$(".carousel-next")}0===t?e.hide():e.show()},destroy:function(t){clearInterval(this.slideChangeInterval),i.prototype.destroy.call(this,t)}});return r}),define("modules/fronts/suspender-ad",["jquery","underscore","modules/partner/simple-ad"],function(t,e,i){"use strict";var s=i.extend({initialize:function(e){e=t.extend({adPlacement:"sponsor_logo_front",adSizes:"sponsor_logo_medium"},e),this.visibleWithSidebarOpen="false"!==this.$el.attr("data-visible-with-sidebar-open"),i.prototype.initialize.call(this,e)},openSideBar:function(){this.visibleWithSidebarOpen||this._onHideSidebarAd()},closeSideBar:function(){this.visibleWithSidebarOpen||this._initAds()},_onHideSidebarAd:function(){this.subviews.simpleAd&&(this.subviews.simpleAd.destroy(),this.hide(),this.subviews.simpleAd=!1)},renderCardInfo:function(t){this.visibleWithSidebarOpen?this._initAds():t.sidebarOpen||this._initAds()}});return s}),define("modules/fronts/lottery",["jquery","underscore","baseview","state","utils","ui/dropdown"],function(t,e,i,s,n,o){"use strict";var r=i.extend({initialize:function(n){n=t.extend({refreshDelay:6e3,refresh:!1},n),e.bindAll(this,"updateLottery"),i.prototype.initialize.call(this,n),this.options.refresh?this.subviews.refreshInterval=s.recurringFetchHtml("/lottery/front-module/",null,this.options.refreshDelay,this.updateLottery):s.fetchHtml("/lottery/front-module/").done(this.updateLottery)},updateLottery:function(t){this.$el.html(t),this.setupDropdown()},setupDropdown:function(){this.subviews.selectDropdown&&this.subviews.selectDropdown.destroy(),this.subviews.selectDropdown=new o({el:this.$(".lottery-state-picker-dropdown")})}});return r}),define("modules/ggm-va-loan/ggm-va-loan",["jquery","underscore","baseview","form/dropdown"],function(t,e,i,s){"use strict";var n=i.extend({events:{submit:"onFormSubmit"},initialize:function(t){i.prototype.initialize.call(this,t),this._setupForm()},_setupForm:function(){this.subviews.dropdownProduct=new s({el:this.$(".ggmval-select")})}});return n}),define("modules/travel/travel-tools",["jquery","baseview","state"],function(t,e){var i=e.extend({events:{"click  .ttp-tab":"switchTabs","click .ttp-close":"closeTabs"},switchTabs:function(t){var e=this.$(t.currentTarget),i=e.attr("data-tabtarget"),s=this.$(i),n=this.$(".ttp-tab-content");this.$el.addClass("tt-dashboard-open"),this.$(".ttp-tab").removeClass("ttp-tab-active"),e.addClass("ttp-tab-active"),n.removeClass("ttp-submodule-active").addClass("ttp-submodule"),s.addClass("ttp-submodule-active").removeClass("ttp-submodule")},closeTabs:function(){this.$el.removeClass("tt-dashboard-open"),this.$(".ttp-tab-active").removeClass("ttp-tab-active"),this.$(".ttp-submodule-active").removeClass("ttp-submodule-active").addClass("ttp-submodule")}});return i}),define("modules/sports/sports-headline-grid",["jquery","underscore","backbone","state","pubsub","utils","baseview","ui/button-toggle","modules/fronts/headline-grid","modules/scroller/vertical-scroll"],function(t,e,i,s,n,o,r,a,l,h){"use strict";var c=l.extend({el:".sp-filter-bar-wrap",events:function(){return t.extend(l.prototype.events,{"click .sp-filter-link":"getFilteredContent","mouseenter .sp-filter-dropdown":"onHoverFilterDropdown","mouseleave .sp-filter-dropdown":"onHoverFilterDropdown"})},initialize:function(t){l.prototype.initialize.call(this,t)},getFilteredContent:function(i){this.$contentFilterId=t(i.currentTarget);var o=this.$contentFilterId.text(),r=this.$contentFilterId.data("url");this.$(".headline-collection-container").addClass("sp-loading-details"),this.$(".headline-collection-container").html(""),this.$(".sp-filter-btn").html(o),s.fetchHtml(r).done(e.bind(function(t){this.$(".headline-collection-container").html(t),this.$(".headline-collection-container").removeClass("sp-loading-details")},this));var a=this.$contentFilterId.data("ht")+o;a&&n.trigger("uotrack",a)},showMore:function(e){if(e.preventDefault(),t(e.target).hasClass("inactive"))return!1;this.$button=t(".button-add-content",this.el),this.$button.addClass("loading").text(this.$button.attr("data-loading"));var i,s=this.$(".headline-page.active:last").next(),r=s.attr("data-itemnum"),a=s.attr("data-items-per-page"),l=Math.round(r/a),h=t(".headline-collection");return i=h.hasClass("listview")?"data-list-src":"data-grid-src",o.lazyLoadImage(s.find("img"),i,!0),n.trigger("uotrack",o.getSectionPath(window.location.pathname)+"morestories"+l),this.transitionMore(s),!0},onHoverFilterDropdown:function(e){if("mouseenter"===e.type){var i=t(e.currentTarget),s=i.find(".sp-filter-scroll-wrap");this.subviews.vscroll=new h({el:s,padding:6})}else this.subviews.vscroll&&this.subviews.vscroll.destroy()}});return c}),define("modules/stories/utility-bar-module-comments",["jquery","underscore","backbone","pubsub","utils","modules/stories/utility-bar-flyout","modules/scroller/vertical-scroll","third-party-apis/facebook/facebook"],function(t,e,i,s,n,o,r,a){var l=o.extend({initialize:function(i){this.pubSub={"breakingbar:after:open":this.scalePanel},i=t.extend({noFlyoutScroll:!0},i),this.events=e.extend({},o.prototype.events,this.events),o.prototype.initialize.call(this,i)},attachCommentListener:function(){a.loadScript().done(function(){FB.getLoginStatus(function(t){"connected"===t.status&&(FB.Event.subscribe("comment.create",function(){s.trigger("comment:created")}),FB.Event.subscribe("comment.remove",function(){s.trigger("comment:removed")}))})})},unattachCommentListener:function(){a.loadScript().done(function(){FB.getLoginStatus(function(t){"connected"===t.status&&(FB.Event.unsubscribe("comment.create"),FB.Event.unsubscribe("comment.remove"))})})},loadComments:function(){return a.loadScript().done(e.bind(function(){FB.XFBML.parse(this.$scrollable[0]),this.scrollableHeight=this.$scrollable.height(),this.heightPoll=setInterval(e.bind(function(){this.scrollableHeight!==this.$scrollable.height()&&(this.scrollableHeight=this.$scrollable.height(),this.scalePanel())},this),200);var t=!1;-1===navigator.userAgent.indexOf("Chrome")?t=!0:Modernizr.touch&&(this.$scrollWrap.css({"-webkit-overflow-scrolling":"touch"}),"touch"===this.$scrollWrap.css("-webkit-overflow-scrolling")&&(t=!0)),t?this.$scrollWrap.css("overflow","auto"):this.subviews.vscroll=new r({el:this.$scrollWrap,draggerPaddingTop:0,color:"lighter"})},this))},onWindowResize:function(){this.scalePanel(),o.prototype.onWindowResize.call(this)},scalePanel:function(){this.$scrollWrap.css("height",this.$win.height()-n.get("headerHeight")-115),this.subviews.vscroll&&this.subviews.vscroll.refresh()},open:function(){this.$scrollWrap=this.$(".util-bar-scroll-wrap"),this.$scrollable=this.$(".scrollable-content"),this.$fbPluginWrap=this.$(".facebook-comments-plugin-wrap"),this.$win=n.get("win"),this.loadComments().done(e.bind(function(){this.attachCommentListener(),s.trigger("uotrack","UtilityBarCommentsOpen"),o.prototype.open.call(this)},this))},close:function(){s.trigger("uotrack","UtilityBarCommentsClose"),this.destroy()},destroy:function(t){clearInterval(this.heightPoll),this.unattachCommentListener(),o.prototype.destroy.call(this,t)}});return l}),define("modules/fronts/election-results-module",["jquery","underscore","backbone","baseview","pubsub","state"],function(t,e,i,s,n,o){"use strict";var r=s.extend({el:".elres-module-container",events:{"click .elres-race-container":"redirectModule"},initialize:function(t){s.prototype.initialize.call(this,t),this.drawSenate(),this.drawHouse(),this.drawGov()},drawSenate:function(){var i=100,s="/services/webproxy/?url=http://www.gannett-cdn.com/GDContent/2014/elections/api-scrapers/data/senate-bar-data.json";o.fetchData(s,{dataType:"json"}).done(e.bind(function(e){if(e){var s=e.senatedata[0],n=s.dem*i/100,o=s.repub*i/100,r=s.other*i/100,a=s.undecided*i/100;t(".elres-sen-democrat").width(n+"%"),t(".elres-sen-republican").width(o+"%"),t(".elres-sen-other").width(r+"%"),t(".elres-sen-undecided").width(a+"%"),t("#elres-sen-dem-num").html(s.dem),t("#elres-sen-rep-num").html(s.repub)}},this))},drawGov:function(){var i=100,s="/services/webproxy/?url=http://www.gannett-cdn.com/GDContent/2014/elections/api-scrapers/data/gov-bar-data.json";o.fetchData(s,{dataType:"json"}).done(e.bind(function(e){if(e){var s=e.govdata[0],n=s.dem*i/50,o=s.repub*i/50,r=s.other*i/50,a=s.undecided*i/50;t(".elres-gov-democrat").width(n+"%"),t(".elres-gov-republican").width(o+"%"),t(".elres-gov-tossup").width(r+"%"),t(".elres-gov-undecided").width(a+"%"),t("#elres-gov-dem-num").html(s.dem),t("#elres-gov-rep-num").html(s.repub)}},this))},drawHouse:function(){var i=100,s="/services/webproxy/?url=http://www.gannett-cdn.com/GDContent/2014/elections/api-scrapers/data/house-bar-data.json";o.fetchData(s,{dataType:"json"}).done(e.bind(function(e){if(e){var s=e.housedata[0],n=s.dem*i/435,o=s.repub*i/435,r=s.other*i/435,a=s.undecided*i/435;t(".elres-house-democrat").width(n+"%"),t(".elres-house-republican").width(o+"%"),t(".elres-house-tossup").width(r+"%"),t(".elres-house-undecided").width(a+"%"),t("#elres-house-dem-num").html(s.dem),t("#elres-house-rep-num").html(s.repub)}},this))},redirectModule:function(){n.trigger("uotrack","electionsliveresults2014"+this.attr("id"))},trackFull:function(){n.trigger("uotrack","electionsliveresults2014full")}});return r}),define("modules/sports/sports-team-matchup",["jquery","underscore","backbone","baseview","easing"],function(t,e,i,s){var n=s.extend({initialize:function(){s.prototype.initialize.call(this,this.options);var i=0,n=this.$(".sp-matchup-away-stat-chart-fill"),o=this.$(".sp-matchup-home-stat-chart-fill");n.each(e.bind(function(e,s){this.animBar(t(s),i),this.animBar(o.eq(e),i),i+=100},this))},animBar:function(t,e){t.delay(e).animate({width:t.data("percentage")},175,"easeInQuad")}});return n}),define("modules/travel/travel-email",["jquery","underscore","baseview","state","utils","pubsub"],function(t,e,i,s,n,o){var r=i.extend({updateMessage:function(i){var s;try{i=t.parseJSON(i)}catch(n){i={}}if(i.travelEmailMessage&&(s=i.travelEmailMessage,s.errorControl&&this.travelEmailForm.find('input[name="'+s.errorControl+'"]').addClass("travel-email-form-input-error").attr("placeholder","Required: "+s.errorControl),"travel-email-success"==s.status)){o.trigger("uotrack","travelfrontemail");var r=e.template('<div class="travel-email-confirmation"><div class="travel-email-thank-you"><%= message %></div><div>We\'ll be in touch with you soon.</div></div>'),a=r({message:s.message});this.travelEmailForm.find(".travel-email-wrapper").html(a).addClass("travel-email-submitted"),this.travelEmailForm.find("input").removeClass("travel-email-form-input-error")}},initialize:function(s){this.travelEmailForm=t(this.$el),this.win=n.get("win"),this.win.on("message",e.bind(function(t){var e=window.location.protocol+"//"+window.location.host;t.originalEvent.origin.replace(/\/$/,"")==e&&"undefined"!=t.originalEvent.data.travelEmailMessage&&this.updateMessage(t.originalEvent.data)},this)),e.bindAll(this,"updateMessage"),i.prototype.initialize.call(this,s)},destroy:function(t){this.win.off("message"),i.prototype.destroy.call(this,t)}});return r}),define("modules/users/site-nav-user-module",["jquery","underscore","pubsub","utils","modules/header/site-nav-dropdown","user-manager"],function(t,e,i,s,n,o){"use strict";var r=n.extend({ALT_ACTIVE_CLASS:"site-nav-visible-alt-span",WRAP_ACTIVE_CLASS:"site-nav-user-dropdown-wrap-active",events:{"click .site-nav-user-login-btn":"onClickLogin","click .site-nav-user-logout-btn":"onClickLogout"},initialize:function(t){this.pubSub={"user:login":this.showLoggedInUser,"user:logout":this.showLoggedOutUser},e.bindAll(this,"_handleDropdownPanels","showLoggedInUser","showLoggedOutUser"),this.events=e.extend({},n.prototype.events,this.events),this.$loginWrap=this.$(".site-nav-user-logged-in-wrap"),this.$logoutWrap=this.$(".site-nav-user-logged-out-wrap"),this.$siteNavAltSpan=this.$(".site-nav-alt-span"),this.$avatarContainer=this.$(".site-nav-user-avatar-span"),this.$userDisplayName=this.$(".site-nav-user-display-name"),this.$avatar=this.$(".site-nav-user-avatar-image"),n.prototype.initialize.call(this,t),this._handleDropdownPanels()},_handleDropdownPanels:function(){this.isUserLoggedIn?(this.$loginWrap.addClass(this.WRAP_ACTIVE_CLASS),this.$logoutWrap.removeClass(this.WRAP_ACTIVE_CLASS)):(this.$loginWrap.removeClass(this.WRAP_ACTIVE_CLASS),this.$logoutWrap.addClass(this.WRAP_ACTIVE_CLASS))},showLoggedOutUser:function(){this.isUserLoggedIn=!1,this._teardownLoggedInMarkup(),this._handleDropdownPanels()},showLoggedInUser:function(){this._setupLoggedInMarkup(o.getAccount()),this.isUserLoggedIn=!0,this._handleDropdownPanels()},_setupLoggedInMarkup:function(t){var e=t.getUserFirstName()+" "+t.getUserLastName();this.$avatar.attr("src",t.getUserAvatar()),this.$avatar.attr("alt",e),this.$siteNavAltSpan.addClass(this.ALT_ACTIVE_CLASS),this.$userDisplayName.html(e)},_teardownLoggedInMarkup:function(){this.$avatar.attr("src",""),this.$avatar.attr("alt",""),this.$siteNavAltSpan.removeClass(this.ALT_ACTIVE_CLASS),this.$userDisplayName.html("")},onClickLogout:function(){this.showLoggedOutUser(),o.logoutUser().done(function(){i.trigger("uotrack","headerprofilelogout")})},onClickLogin:function(e){var s=t(e.target).data("user-account");o.loginUser(s).done(function(){i.trigger("uotrack","headerprofilelogin")})},destroy:function(t){this._teardownLoggedInMarkup(),n.prototype.destroy.call(this,t)}});return r}),define("modules/money/job-search",["jquery","underscore","baseview","state","form/base-form"],function(t,e,i,s,n){"use strict";var o=i.extend({initialize:function(t){i.prototype.initialize.call(this,t),s.fetchData("/money/jobs/categories/",{timeout:1e4}).done(e.bind(function(t){this.$(".jobs-form-dropdown").html(t)},this)).always(e.bind(function(){this.subviews.jobSearchForm=new n({el:this.$(".jobs-form-wrap")})},this))}});return o}),define("modules/sports/sports-multipurpose-promo",["jquery","underscore","baseview","pubsub"],function(t,e,i){var s=i.extend({initialize:function(){this.$promo=t("#sports-multipurpose-promo"),this.active_mod=this.$promo.attr("activemod"),"countdown"==this.active_mod&&(this.$countdown=t(".sports-countdown"),this.countdown_transition_target=this.$countdown.data("transitionlink"),this.countdown_preview_target=this.$countdown.data("previewink"),this.secondsInMinute=60,this.secondsInHour=60*this.secondsInMinute,this.secondsInDay=24*this.secondsInHour,this.startDate=this.$countdown.data("startdate")?new Date(this.$countdown.data("startdate")):new Date,this.endDate=this.$countdown.data("enddate")?new Date(this.$countdown.data("enddate")):this.startDate,this.endDate<this.startDate&&(this.endDate=this.startDate),this.dateDiffInSeconds=Math.ceil(.001*(this.endDate-new Date)),this.dateDiffInSeconds>0?this.startCountdown():this.countdownTransition(this.countdown_transition_target))},startCountdown:function(){this.timer=setInterval(t.proxy(function(){this.dateDiffInSeconds=this.dateDiffInSeconds-1;var t=Math.floor(this.dateDiffInSeconds/this.secondsInDay),e=this.dateDiffInSeconds%this.secondsInDay,i=Math.floor(e/this.secondsInHour),s=e%this.secondsInHour,n=Math.floor(s/this.secondsInMinute),o=Math.ceil(s%this.secondsInMinute);this.$countdown.find("#days").text(10>t?"0"+t:t),this.$countdown.find("#hours").text(10>i?"0"+i:i),this.$countdown.find("#minutes").text(10>n?"0"+n:n),this.$countdown.find("#seconds").text(10>o?"0"+o:o),this.dateDiffInSeconds<=0&&this.countdownTransition(this.countdown_transition_target)},this),1e3)},countdownTransition:function(e){clearInterval(this.timer),t("#sports-multipurpose-promo .sports-countdown-img img").attr("src",e),t("#sports-multipurpose-promo #clock_display").hide()},destroy:function(t){clearInterval(this.timer),i.prototype.destroy.call(this,t)}});return s}),function(){var t;t=function(){function t(){this.options_index=0,this.parsed=[]}return t.prototype.add_node=function(t){return"OPTGROUP"===t.nodeName.toUpperCase()?this.add_group(t):this.add_option(t)},t.prototype.add_group=function(t){var e,i,s,n,o,r;for(e=this.parsed.length,this.parsed.push({array_index:e,group:!0,label:t.label,children:0,disabled:t.disabled}),o=t.childNodes,r=[],s=0,n=o.length;n>s;s++)i=o[s],r.push(this.add_option(i,e,t.disabled));return r},t.prototype.add_option=function(t,e,i){return"OPTION"===t.nodeName.toUpperCase()?(""!==t.text?(null!=e&&(this.parsed[e].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:t.value,text:t.text,html:t.innerHTML,selected:t.selected,disabled:i===!0?i:t.disabled,group_array_index:e,classes:t.className,style:t.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0
},t}(),t.select_to_array=function(e){var i,s,n,o,r;for(s=new t,r=e.childNodes,n=0,o=r.length;o>n;n++)i=r[n],s.add_node(i);return s.parsed},this.SelectParser=t}.call(this),function(){var t,e;e=this,t=function(){function t(t,e){this.form_field=t,this.options=null!=e?e:{},this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup()}return t.prototype.set_default_values=function(){var t=this;return this.click_test_action=function(e){return t.test_active_click(e)},this.activate_action=function(e){return t.activate_field(e)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.search_contains=this.options.search_contains||!1,this.choices=0,this.single_backstroke_delete=this.options.single_backstroke_delete||!1,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1},t.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||"Select Some Options":this.options.placeholder_text_single||this.options.placeholder_text||"Select an Option",this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||"No results match"},t.prototype.mouse_enter=function(){return this.mouse_on_container=!0},t.prototype.mouse_leave=function(){return this.mouse_on_container=!1},t.prototype.input_focus=function(){var t=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return t.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},t.prototype.input_blur=function(){var t=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return t.blur_test()},100))},t.prototype.result_add_option=function(t){var e,i;return t.disabled?"":(t.dom_id=this.container_id+"_o_"+t.array_index,e=t.selected&&this.is_multiple?[]:["active-result"],t.selected&&e.push("result-selected"),null!=t.group_array_index&&e.push("group-option"),""!==t.classes&&e.push(t.classes),i=""!==t.style.cssText?' style="'+t.style+'"':"",'<li id="'+t.dom_id+'" class="'+e.join(" ")+'"'+i+">"+t.html+"</li>")},t.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},t.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},t.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},t.prototype.keyup_checker=function(t){var e,i;switch(e=null!=(i=t.which)?i:t.keyCode,this.search_field_scale(),e){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(t.preventDefault(),this.results_showing)return this.result_select(t);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},t.prototype.generate_field_id=function(){var t;return t=this.generate_random_id(),this.form_field.id=t,t},t.prototype.generate_random_char=function(){var t,e,i;return t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=Math.floor(Math.random()*t.length),e=t.substring(i,i+1)},t}(),e.AbstractChosen=t}.call(this),function(){var t,e,i,s,n,o={}.hasOwnProperty,r=function(t,e){function i(){this.constructor=t}for(var s in e)o.call(e,s)&&(t[s]=e[s]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};s=this,t=jQuery,t.fn.extend({chosen:function(i){var s,n,o;return o=navigator.userAgent.toLowerCase(),n=/(msie) ([\w.]+)/.exec(o)||[],s={name:n[1]||"",version:n[2]||"0"},"msie"===s.name&&("6.0"===s.version||"7.0"===s.version&&7===document.documentMode)?this:this.each(function(){var s;return s=t(this),s.hasClass("chzn-done")?void 0:s.data("chosen",new e(this,i))})}}),e=function(e){function o(){return n=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.setup=function(){return this.form_field_jq=t(this.form_field),this.current_value=this.form_field_jq.val(),this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},o.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")},o.prototype.set_up_html=function(){var e,s,n,o,r,a;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id(),this.container_id+="_chzn",e=["chzn-container"],e.push("chzn-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&e.push(this.form_field.className),this.is_rtl&&e.push("chzn-rtl"),this.f_width=this.form_field_jq.outerWidth(),n={id:this.container_id,"class":e.join(" "),style:"width: "+this.f_width+"px;",title:this.form_field.title},s=t("<div />",n),s.html(this.is_multiple?'<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>':'<a href="javascript:void(0)" class="chzn-single chzn-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(s),this.container=t("#"+this.container_id),this.dropdown=this.container.find("div.chzn-drop").first(),o=this.container.height(),r=this.f_width-i(this.dropdown),this.dropdown.css({width:r+"px",top:o+"px"}),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first(),a=r-i(this.search_container)-i(this.search_field),this.search_field.css({width:a+"px"})),this.results_build(),this.set_tab_index(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},o.prototype.register_observers=function(){var t=this;return this.container.mousedown(function(e){t.container_mousedown(e)}),this.container.mouseup(function(e){t.container_mouseup(e)}),this.container.mouseenter(function(e){t.mouse_enter(e)}),this.container.mouseleave(function(e){t.mouse_leave(e)}),this.search_results.mouseup(function(e){t.search_results_mouseup(e)}),this.search_results.mouseover(function(e){t.search_results_mouseover(e)}),this.search_results.mouseout(function(e){t.search_results_mouseout(e)}),this.form_field_jq.bind("liszt:updated",function(e){t.results_update_field(e)}),this.form_field_jq.bind("liszt:activate",function(e){t.activate_field(e)}),this.form_field_jq.bind("liszt:open",function(e){t.container_mousedown(e)}),this.search_field.blur(function(e){t.input_blur(e)}),this.search_field.keyup(function(e){t.keyup_checker(e)}),this.search_field.keydown(function(e){t.keydown_checker(e)}),this.search_field.focus(function(e){t.input_focus(e)}),this.is_multiple?this.search_choices.click(function(e){t.choices_click(e)}):this.container.click(function(t){t.preventDefault()})},o.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},o.prototype.container_mousedown=function(e){var i;return this.is_disabled?void 0:(i=null!=e?t(e.target).hasClass("search-choice-close"):!1,e&&"mousedown"===e.type&&!this.results_showing&&e.preventDefault(),this.pending_destroy_click||i?this.pending_destroy_click=!1:(this.active_field?!this.is_multiple&&e&&(t(e.target)[0]===this.selected_item[0]||t(e.target).parents("a.chzn-single").length)&&(e.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),t(document).click(this.click_test_action),this.results_show()),this.activate_field()))},o.prototype.container_mouseup=function(t){return"ABBR"!==t.target.nodeName||this.is_disabled?void 0:this.results_reset(t)},o.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chzn-container-active")?this.close_field():void 0},o.prototype.close_field=function(){return t(document).unbind("click",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},o.prototype.activate_field=function(){return this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},o.prototype.test_active_click=function(e){return t(e.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},o.prototype.results_build=function(){var t,e,i,n,o;for(this.parsing=!0,this.results_data=s.SelectParser.select_to_array(this.form_field),this.is_multiple&&this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.addClass("chzn-default").find("span").text(this.default_text),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch")),t="",o=this.results_data,i=0,n=o.length;n>i;i++)e=o[i],e.group?t+=this.result_add_group(e):e.empty||(t+=this.result_add_option(e),e.selected&&this.is_multiple?this.choice_build(e):e.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(e.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(t),this.parsing=!1},o.prototype.result_add_group=function(e){return e.disabled?"":(e.dom_id=this.container_id+"_g_"+e.array_index,'<li id="'+e.dom_id+'" class="group-result">'+t("<div />").text(e.label).html()+"</li>")},o.prototype.result_do_highlight=function(t){var e,i,s,n,o;if(t.length){if(this.result_clear_highlight(),this.result_highlight=t,this.result_highlight.addClass("highlighted"),s=parseInt(this.search_results.css("maxHeight"),10),o=this.search_results.scrollTop(),n=s+o,i=this.result_highlight.position().top+this.search_results.scrollTop(),e=i+this.result_highlight.outerHeight(),e>=n)return this.search_results.scrollTop(e-s>0?e-s:0);if(o>i)return this.search_results.scrollTop(i)}},o.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},o.prototype.results_show=function(){var t;if(this.is_multiple){if(this.max_selected_options<=this.choices)return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1}else this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&this.result_do_highlight(this.result_single_selected);return t=this.is_multiple?this.container.height():this.container.height()-1,this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this}),this.dropdown.css({top:t+"px",left:0}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results()},o.prototype.results_hide=function(){return this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop"),this.result_clear_highlight(),this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this}),this.dropdown.css({left:"-9000px"}),this.results_showing=!1},o.prototype.set_tab_index=function(){var t;return this.form_field_jq.attr("tabindex")?(t=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.search_field.attr("tabindex",t)):void 0},o.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},o.prototype.search_results_mouseup=function(e){var i;return i=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first(),i.length?(this.result_highlight=i,this.result_select(e),this.search_field.focus()):void 0},o.prototype.search_results_mouseover=function(e){var i;return i=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first(),i?this.result_do_highlight(i):void 0},o.prototype.search_results_mouseout=function(e){return t(e.target).hasClass("active-result")?this.result_clear_highlight():void 0},o.prototype.choices_click=function(e){return e.preventDefault(),!this.active_field||t(e.target).hasClass("search-choice")||this.results_showing?void 0:this.results_show()},o.prototype.choice_build=function(e){var i,s,n,o=this;return this.is_multiple&&this.max_selected_options<=this.choices?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(i=this.container_id+"_c_"+e.array_index,this.choices+=1,s=e.disabled?'<li class="search-choice search-choice-disabled" id="'+i+'"><span>'+e.html+"</span></li>":'<li class="search-choice" id="'+i+'"><span>'+e.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+e.array_index+'"></a></li>',this.search_container.before(s),n=t("#"+i).find("a").first(),n.click(function(t){return o.choice_destroy_link_click(t)}))},o.prototype.choice_destroy_link_click=function(e){return e.preventDefault(),this.is_disabled?e.stopPropagation:(this.pending_destroy_click=!0,this.choice_destroy(t(e.target)))},o.prototype.choice_destroy=function(t){return this.result_deselect(t.attr("rel"))?(this.choices-=1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&this.search_field.val().length<1&&this.results_hide(),t.parents("li").first().remove(),this.search_field_scale()):void 0},o.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.is_multiple||this.selected_item.addClass("chzn-default"),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},o.prototype.results_reset_cleanup=function(){return this.current_value=this.form_field_jq.val(),this.selected_item.find("abbr").remove()},o.prototype.result_select=function(t){var e,i,s,n;return this.result_highlight?(e=this.result_highlight,i=e.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(e):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=e,this.selected_item.removeClass("chzn-default")),e.addClass("result-selected"),n=i.substr(i.lastIndexOf("_")+1),s=this.results_data[n],s.selected=!0,this.form_field.options[s.options_index].selected=!0,this.is_multiple?this.choice_build(s):(this.selected_item.find("span").first().text(s.text),this.allow_single_deselect&&this.single_deselect_control_build()),(!t.metaKey&&!t.ctrlKey||!this.is_multiple)&&this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field_jq.val()!==this.current_value)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[s.options_index].value}),this.current_value=this.form_field_jq.val(),this.search_field_scale()):void 0},o.prototype.result_activate=function(t){return t.addClass("active-result")},o.prototype.result_deactivate=function(t){return t.removeClass("active-result")},o.prototype.result_deselect=function(e){var i,s;return s=this.results_data[e],this.form_field.options[s.options_index].disabled?!1:(s.selected=!1,this.form_field.options[s.options_index].selected=!1,i=t("#"+this.container_id+"_o_"+e),i.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[s.options_index].value}),this.search_field_scale(),!0)},o.prototype.single_deselect_control_build=function(){return this.allow_single_deselect&&this.selected_item.find("abbr").length<1?this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'):void 0},o.prototype.winnow_results=function(){var e,i,s,n,o,r,a,l,h,c,d,u,p,f,g,m,v,y;for(this.no_results_clear(),h=0,c=this.search_field.val()===this.default_text?"":t("<div/>").text(t.trim(this.search_field.val())).html(),r=this.search_contains?"":"^",o=new RegExp(r+c.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),p=new RegExp(c.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),y=this.results_data,f=0,m=y.length;m>f;f++)if(i=y[f],!i.disabled&&!i.empty)if(i.group)t("#"+i.dom_id).css("display","none");else if(!this.is_multiple||!i.selected){if(e=!1,l=i.dom_id,a=t("#"+l),o.test(i.html))e=!0,h+=1;else if(this.enable_split_word_search&&(i.html.indexOf(" ")>=0||0===i.html.indexOf("["))&&(n=i.html.replace(/\[|\]/g,"").split(" "),n.length))for(g=0,v=n.length;v>g;g++)s=n[g],o.test(s)&&(e=!0,h+=1);e?(c.length?(d=i.html.search(p),u=i.html.substr(0,d+c.length)+"</em>"+i.html.substr(d+c.length),u=u.substr(0,d)+"<em>"+u.substr(d)):u=i.html,a.html(u),this.result_activate(a),null!=i.group_array_index&&t("#"+this.results_data[i.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&l===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(a))}return 1>h&&c.length?this.no_results(c):this.winnow_results_set_highlight()},o.prototype.winnow_results_clear=function(){var e,i,s,n,o;for(this.search_field.val(""),i=this.search_results.find("li"),o=[],s=0,n=i.length;n>s;s++)e=i[s],e=t(e),o.push(e.hasClass("group-result")?e.css("display","auto"):this.is_multiple&&e.hasClass("result-selected")?void 0:this.result_activate(e));return o},o.prototype.winnow_results_set_highlight=function(){var t,e;return this.result_highlight||(e=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),t=e.length?e.first():this.search_results.find(".active-result").first(),null==t)?void 0:this.result_do_highlight(t)},o.prototype.no_results=function(e){var i;return i=t('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),i.find("span").first().html(e),this.search_results.append(i)},o.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},o.prototype.keydown_arrow=function(){var e,i;return this.result_highlight?this.results_showing&&(i=this.result_highlight.nextAll("li.active-result").first(),i&&this.result_do_highlight(i)):(e=this.search_results.find("li.active-result").first(),e&&this.result_do_highlight(t(e))),this.results_showing?void 0:this.results_show()},o.prototype.keyup_arrow=function(){var t;return this.results_showing||this.is_multiple?this.result_highlight?(t=this.result_highlight.prevAll("li.active-result"),t.length?this.result_do_highlight(t.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},o.prototype.keydown_backstroke=function(){var t;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(t=this.search_container.siblings("li.search-choice").last(),t.length&&!t.hasClass("search-choice-disabled")?(this.pending_backstroke=t,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},o.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},o.prototype.keydown_checker=function(t){var e,i;switch(e=null!=(i=t.which)?i:t.keyCode,this.search_field_scale(),8!==e&&this.pending_backstroke&&this.clear_backstroke(),e){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(t),this.mouse_on_container=!1;break;case 13:t.preventDefault();break;case 38:t.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},o.prototype.search_field_scale=function(){var e,i,s,n,o,r,a,l,h;if(this.is_multiple){for(s=0,a=0,o="position:absolute; left: -1000px; top: -1000px; display:none;",r=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],l=0,h=r.length;h>l;l++)n=r[l],o+=n+":"+this.search_field.css(n)+";";return i=t("<div />",{style:o}),i.text(this.search_field.val()),t("body").append(i),a=i.width()+25,i.remove(),a>this.f_width-10&&(a=this.f_width-10),this.search_field.css({width:a+"px"}),e=this.container.height(),this.dropdown.css({top:e+"px"})}},o.prototype.generate_random_id=function(){var e;for(e="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();t("#"+e).length>0;)e+=this.generate_random_char();return e},o}(AbstractChosen),s.Chosen=e,i=function(t){var e;return e=t.outerWidth()-t.width()},s.get_side_border_padding=i}.call(this),define("chosen",function(){}),define("modules/sports/sports-scores-suspender",["jquery","underscore","backbone","pubsub","state","baseview","modules/scroller/sidebar-scroll","chosen","animatecolors"],function(t,e,i,s,n,o,r){var a=o.extend({events:{"mouseover .top-wrapper, .bottom-wrapper, .magicscroll, .game":"stopRotation","touchstart .top-wrapper, .bottom-wrapper, .magicscroll, .game":"stopRotation",change:"onChangeLeague","click .game":"gameClicked"},initialize:function(i){t.extend(i,{rotateInterval:5e3,refreshInterval:3e4,leagueFailLimit:3}),o.prototype.initialize.call(this,i),e.bindAll(this,"onScoresLoaded","rotateToNextScore","onUpdateLoaded","scoresSuspenderRefresher"),this.$scroller=this.$(".suspender-scroll-content"),this.$pairings=this.$("#pairings"),this.$noScores=this.$pairings.find(".league.none"),this.padding=parseInt(this.$pairings.css("paddingTop"),10),this.canSlideUp=!0,this.yp=0,this.leagues={},this.scoreType="schedule",this.continueRotate=!0,this.continueRefresh=!0,this.refreshStarted=!1,this.failLeague=null,this.leagueFailCount=1;var s=this.$(".magicscroll").outerHeight(),n=this.$(".bottom-wrapper").outerHeight()+23,r=this.$(".top-wrapper").outerHeight();this.viewport=s-(n+r),this.chosenSelector=this.$(".filter"),this.chosenSelector.chosen({disable_search_threshold:30}),this.startIndex=this.$(".chzn-results .result-selected").index(),this.oldHbox=this.$(".hoverGameFunction"),this.onChangeLeague(),this.addscrollBar()},gameClicked:function(e){this.oldHbox.css("display","none");for(var i=e.target||e.srcElement;i&&!i.id;)i=i.parentNode;var s=t(i).next();s.css("display","block"),this.oldHbox=s},scoresSuspenderRefresher:function(){this.refreshStarted=!0;var t;t="/sports/services/scores-suspender/"+this.league+"/",void 0!==this.$scroller.data("max-count")&&(t+="?count="+this.$scroller.data("max-count")),this.fetchData(t,this.onUpdateLoaded,!0)},stopRefresh:function(){this.continueRefresh=!1,this.refreshID&&clearTimeout(this.refreshID)},stopRotation:function(){this.continueRotate=!1,this.rotateID&&(this.rotateID=clearInterval(this.rotateID)),this.continueRefresh&&!this.refreshStarted&&(this.refreshStarted=!0,this.refreshID=setTimeout(this.scoresSuspenderRefresher,this.options.refreshInterval))},rotateToNextScore:function(){var t=this.$(".chzn-results .result-selected").next();0===t.length&&(t=this.$(".chzn-results").children(":first")),t.index()===this.startIndex&&this.stopRotation(),t.mouseup()},fetchData:function(t,i,s){s?n.fetchHtml(t).done(i).fail(e.bind(function(){console.log("ERROR: Scores Suspender AJAX load failed!"),this.failLeague==this.league&&(this.leagueFailCount+=1),this.failLeague=this.league,i()},this)):(this.$el.addClass("loading"),n.fetchHtml(t).done(i).fail(e.bind(function(){this.$noScores.show(),i()},this)).always(e.bind(function(){this.$el.removeClass("loading")},this)))},onChangeLeague:function(){if(this.refreshScrollBar(),this.$(".league").hide(),this.league=this.$(".filter").val(),void 0===this.league&&(this.league=this.$el.closest(".card").data("league-id")),void 0===this.league&&(this.league=this.$el.closest(".card").data("subsection-id")),void 0===this.league)return void this.$noScores.show();if(this.leagues[this.league])this.updateDisplay(this.leagues[this.league]);else{var t;t="SMG"===this.$scroller.data("sub-section-name")?"/sports/services/scores-suspender/desktop/"+this.league+"/":"/sports/services/scores-suspender/"+this.league+"/",void 0!==this.$scroller.data("max-count")&&(t+="?count="+this.$scroller.data("max-count")),this.fetchData(t,this.onScoresLoaded)}},onUpdateLoaded:function(i){if(i){var s=this.$("#pairings ."+this.league),n=t(i);s.find(".game").each(e.bind(function(e,i){var s=t(i),o=s.attr("id"),r=n.find("#"+o),a=r.find(".suspender_score"),l=s.find(".suspender_score");this.markChangedScores(a,l)},this)),s.html(i),this.addScoreHighlight(s.find(".scoreChangeFont"),"rgb(164, 23, 18)",1500),this.continueRefresh&&this.leagueFailCount<this.options.leagueFailLimit&&(this.refreshID=setTimeout(this.scoresSuspenderRefresher,this.options.refreshInterval))}},markChangedScores:function(i,s){i.each(e.bind(function(e,i){var n=t(i);n.html()!==s.eq(e).html()&&n.addClass("scoreChangeFont")},this))},onScoresLoaded:function(e){var i=this.leagues[this.league]=t(e);i.find(".gameBox").length?(this.$pairings.append(i),this.scoreType="scores",this.updateDisplay(i),this.continueRotate&&location.href.search("sports/$")>0?this.rotateID=setTimeout(this.rotateToNextScore,this.options.rotateInterval):this.refreshID=setTimeout(this.scoresSuspenderRefresher,this.options.refreshInterval)):(console.log("FAILED: Scores Suspender AJAX retrieved BAD data!"),this.$noScores.show())},updateDisplay:function(t){this.$games=t.find(".game"),this.index=0,this.total=this.$games.length,this.total?t.show():this.$noScores.show();var e=this.$(".all-scores-link");e[0].innerHTML=t.data("text"),e.attr("href",t.data("link")),e.attr("target",t.data("target")),this.refreshScrollBar()},showLeague:function(){this.$(".league").hide();var t=this.$(".filter").val(),e=this.$("."+t);e.show(),this.$games=e.find(".game"),this.index=0,this.total=this.$games.length},addScoreHighlight:function(t,e,i){var s=e||"#FFFF9C",n=i||1e3,o=t.css("color");t.stop().css("color",s).animate({color:o},n).animate({color:s},n).animate({color:o},n)},addscrollBar:function(){this.scrollbar=new r({el:this.$(".suspender-scroll-content"),color:"dark",padding:2,lockPageScroll:!1,delayScroll:!1,fadeout:!0})},refreshScrollBar:function(){this.scrollbar&&(this.scrollbar.refresh(),this.scrollbar.moveDraggerToPosition(0,0))},destroy:function(){this.scrollbar.destroy(),this.stopRefresh(),this.stopRotation(),o.prototype.destroy.call(this)}});return a}),define("modules/travel/kayak-module",["jquery","underscore","baseview","state","pubsub","form/base-form"],function(t,e,i,s,n,o){"use strict";var r=i.extend({el:".kayak-wrapper",events:{"click .kayak-btn":"kayakWidgetBtnClick","click .flight-select-radio-btn":"onFlightRadioButtonClick","clock .kayak-submit":"onKayakSubmitClick"},initialize:function(t){e.bindAll(this,"kayakWidgetBtnClick","tabTransition","onHotelAutoCompleteSelect","datePickerBeforeShow","datePickerBeforeShowDay"),i.prototype.initialize.call(this,t),this.$kayakHotelId=this.$("#kayak-hotel-id"),this._setupDropdownDates(),this._setupForms(),this.tabAnimHeights=this._getTabHeights(this.$(".kayak-tab")),this.$activeTab=this.$(".kayak-btn.active"),this.tabTransition(this.$(".kayak-btn.active").data("type"),!0),this.$("form").submit(function(){n.trigger("uotrack","kayaksearch")})},onHotelAutoCompleteSelect:function(t,e){this.$kayakHotelId.val(e.hid?e.hid:"")},getTabHeight:function(t){return this.tabAnimHeights[t]},setTabHeight:function(t,e){this.tabAnimHeights[t]=e},kayakWidgetBtnClick:function(e){var i=t(e.currentTarget),s=i.data("type"),o="kayak"+s;n.trigger("heattrack",o),this.tabTransition(s,!1)},tabTransition:function(t){var i=this.$(".kayak-tab-"+t),s=this.$activeTab,n="kayak-tab-active",o=this.getTabHeight(t);s&&i[0]===s[0]||(s&&s.removeClass(n),this.animTabWrapperHeight(o).done(e.bind(function(){this.makeButtonActive(t),i.fadeIn(250,e.bind(function(){i.addClass(n),this.$activeTab=i},this))},this)))},animTabWrapperHeight:function(t){return this.animate(this.$(".kayak-search-widget").stop(),"height",t+"px",150,"linear",0)},makeButtonActive:function(t){var e="active",i=this.$(".kayak-"+t+"-btn");i&&(this.$activeBtn&&this.$activeBtn.removeClass(e),i.addClass(e),this.$activeBtn=i)},onFlightRadioButtonClick:function(e){this.switchView(t(e.currentTarget).val())},switchView:function(t){var i=this.$(".flights-"+t+"-container"),s="kayak-flight-view-active",n=i[0].scrollHeight;this.$(".kayak-flight-view").removeClass(s),this.animTabWrapperHeight(n).done(e.bind(function(){i.fadeIn(250).addClass(s),this.setTabHeight("flights",n)},this))},_setupForms:function(){var i=[];this.$(".kayak-tab-hotels .kayak-auto, .kayak-tab-deals .kayak-auto").each(e.bind(function(e,s){i.push({el:t(s),resultDisplayTemplate:"<%= displayname %>",resultValueTemplate:"<%= displayname %>",maxResults:5,onSelect:this.onHotelAutoCompleteSelect,ajaxOptions:{dataType:"jsonp"}})},this)),this.$(".kayak-tab-flights .kayak-auto").each(function(){i.push({el:t(this),resultDisplayTemplate:"<%= displayname %>",resultValueTemplate:"<%= ap %>",maxResults:5,ajaxOptions:{dataType:"jsonp"}})}),this.$(".kayak-tab-vacations .kayak-auto").each(function(){i.push({el:t(this),resultDisplayTemplate:"<%= displayname %>",resultValueTemplate:"<%= displayname %>",maxResults:5,ajaxOptions:{dataType:"jsonp"}})}),this.$(".ui-date-picker").each(e.bind(function(e,s){var n=t(s),o=n.parent().find(".ui-date-picker-btn");i.push({el:n,buttonSelector:o,calendarPanelClass:"ui-light",changeMonth:!0,changeYear:!0,minDate:null,maxDate:null,showOtherMonths:!0,selectOtherMonths:!0,showMonthAfterYear:!0,dateFormat:"m/d/yy",dayNamesMin:["S","M","T","W","T","F","S"],beforeShow:this.datePickerBeforeShow(t(s)),beforeShowDay:null})},this)),this.$(".kayak-form").each(e.bind(function(e,s){this.subviews["form"+e]=new o({el:t(s),formOptions:i})},this));var s=new Date,n=s.getMonth()+1+"/"+s.getDate()+"/"+s.getFullYear();this.$(".kayak-date-picker-field").val(n)},datePickerBeforeShow:function(e){e.find(t(".ui-date-picker-btn")).addClass("kayak-date-picker-flyout"),e.find(t(".ui-date-picker-btn")).addClass("ui-light")},datePickerBeforeShowDay:function(t){var e=t.getDay();return[0!==e,""]},_setupDropdownDates:function(){var t=10,e=["January","February","March","April","May","June","July","August","September","October","November","December"],i=(new Date).getMonth(),s=(new Date).getFullYear(),n=e.length,o=i,r=t+o,a=r-n,l=function(t,e){for(var i=0,s=t.length;s--;)t[i]+=" "+e,i++
},h=function(t){var e=t.substr(t.indexOf(" ")+1);return e},c=[].concat(e.slice(o,r));if(l(c,s),a>0){var d=e.slice(0,a);l(d,s+1),c.push.apply(c,d)}for(var u=0;t>u;u++){var p=h(c[u]),f=i+u+1;f>12&&(f-=12),this.$("#kayakCruiseDateDropdown").append('<option value="'+f+"/1/"+p+'">'+c[u]+"</option>"),f=i+u+1}},_getTabHeights:function(i){var s={};return e.each(i,function(e){var i=t(e),n=i.data("tab-id");if(s[n]=i[0].scrollHeight,"flights"===n){var o=this.$(".flight-select-radio-btn:checked").val(),r=this.$(".flights-"+o+"-container");s.flights=r[0].scrollHeight}},this),s}});return r}),define("modules/travel/travel-experience",["jquery","underscore","baseview","state","utils","ui/generic-paginator"],function(t,e,i,s,n,o){var r=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){e.bindAll(this,"automate","goTo"),s=t.extend({transition:{interval:15e3}},s),this.subviews={},this.moveMe=this.$(".exp-travel-wrapper"),this.viewport=this.moveMe.parent(),this.subviews.paginator=new o({el:this.$(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(t){this.stoptimer(),i.prototype.destroy.call(this,t)},goTo:function(t){var e=this.viewport.outerWidth(),i=e*t;this.animate(this.moveMe,"left","-"+i+"px",450,"ease-in-out")},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return r}),define("modules/fronts/most-popular-primary",["jquery","underscore","baseview","utils","ui/generic-paginator"],function(t,e,i,s,n){"use strict";var o=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){e.bindAll(this,"automate","goTo"),s=t.extend({transition:{interval:15e3}},s),this.subviews={},this.moveMe=this.$(".mppm-items-wrap"),this.viewport=this.moveMe.parent(),this.subviews.paginator=new n({el:this.$(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(t){this.stoptimer(),i.prototype.destroy.call(this,t)},goTo:function(t){var e=this.viewport.outerWidth(),i=e*t*-1,n=i;this.animate(this.moveMe,"left",n+"px",450,"ease-in-out"),s.lazyLoadImage(this.moveMe.find("img"))},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return o}),define("modules/fronts/most-popular-sidebar",["jquery","underscore","baseview","utils","state"],function(t,e,i,s,n){"use strict";var o=i.extend({renderCardInfo:function(t){this.currentCardInfo=t,t.sidebarOpen&&this.loadLazyImages()},onCardWidthChange:function(t){var e=t.sidebarWidth!==this.currentCardInfo.sidebarWidth;this.currentCardInfo=t,e&&this.loadLazyImages()},onOpenSidebar:function(){this.loadLazyImages()},loadLazyImages:function(){s.lazyLoadImage(this.$("img"),"data-src-"+this.currentCardInfo.sidebarWidth,!0,this.hideImage,this.showImage)},hideImage:function(t){t.parent().css("height",t.next().outerHeight()),n.getActiveApp().triggerEvent("refreshSidebarScroll")},showImage:function(t){t.css("visibility","visible"),n.getActiveApp().triggerEvent("refreshSidebarScroll")}});return o}),define("modules/fronts/most-popular",["jquery","underscore","baseview","modules/fronts/most-popular-primary","modules/fronts/most-popular-sidebar"],function(t,e,i,s,n){"use strict";var o=i.extend({initialize:function(t){this.subviews={},"sidebar"===t.layoutType?this.subviews.sidebar=new n(t):this.subviews.primary=new s(t),i.prototype.initialize.call(this,t)},renderCardInfo:function(t){this.triggerEvent("renderCardInfo",t)}});return o}),define("modules/fronts/blogs",["jquery","underscore","backbone","baseview","pubsub"],function(t,e,i,s){var n=s.extend({events:{"click .scroller":"scroll"},initialize:function(e){this.$moveMe=this.$(".stage ul"),this.totalItems=t("li",this.$moveMe).length,this.$scrollerLeft=this.$(".scroller.left"),this.$scrollerRight=this.$(".scroller.right"),s.prototype.initialize.call(this,e)},scroll:function(e){e&&e.preventDefault();var i=t(e.target);if(i.hasClass("disabled"))return!1;var s=i.hasClass("right"),n=this.$moveMe.data("item-offset"),o=4;Modernizr.mq("screen and (min-width: 1250px)")?o=6:Modernizr.mq("screen and (min-width: 1150px)")&&(o=5),s&&(o=-1*o);var r=o+n;r>0&&(r=0);var a=183*n-1,l=183*o,h=l+a;h=183*r-1,0===r?this.$scrollerLeft.addClass("disabled"):this.$scrollerLeft.removeClass("disabled");var c=Math.abs(r)+Math.abs(o);c>=this.totalItems?(this.$scrollerRight.addClass("disabled"),o+=c-this.totalItems,r=o+n,l=183*o,h=l+a,h=183*r-1):this.$scrollerRight.removeClass("disabled"),this.$moveMe.data("item-offset",r),this.animate(this.$moveMe,"left",h+"px",200,"ease-in")}});return n}),define("modules/sports/sports-module-update",["jquery","underscore","baseview","state","utils","pubsub"],function(t,e,i,s,n,o){"use strict";var r=i.extend({initialize:function(s){e.bindAll(this,"initMarkup","updateMarkup","fetchUpdate"),s=t.extend({getItems:25,maxItems:50,removeNewHighlight:20,updateDelay:30,dataSrcAttr:"data-src",dataSection:"data-livefeed",dataLoading:"livefeed-loading",dataTimeStamp:"data-timestamp",dataContentId:"data-content-id",moreLink:null,moreLinkText:null,newContentClass:"newcontent"},s),s.section=this.$el.attr(this.options.dataSection)||n.getSectionPath(window.location.pathname),i.prototype.initialize.call(this,s),this.setupLiveFeed()},setupLiveFeed:function(){var t="/feeds/live/"+this.options.section+"/?count="+this.options.getItems;this.$el.children("li").length?(this.$el.children("."+this.options.newContentClass).removeClass(this.options.newContentClass),this.fetchUpdate()):s.fetchHtml(t).done(this.initMarkup)},initMarkup:function(t){this.$el.removeClass(this.options.dataLoading),this.$el.append(t),this.loadLazyImages(t.find("img")),this.renderMoreLink(),o.trigger("sports:module:update"),this.startUpdateCheck()},loadLazyImages:function(t){t=t||this.$("img"),n.lazyLoadImage(t,this.options.dataSrcAttr,!0,this.hideBrokenHasImage)},renderMoreLink:function(){this.options.moreLink&&this.$el.append('<li class="live-feed-news-item"><a href="'+this.options.moreLink+'" class="livefeed-news-item-link has-more">'+this.options.moreLinkText+"</a></li>")},hideBrokenHasImage:function(){t(this).closest(".has-image").removeClass("has-image"),o.trigger("sports:module:update")},fetchUpdate:function(){var t=this.$("li:first").attr(this.options.dataTimeStamp),e="/feeds/live/"+this.options.section+"/?date="+t;s.fetchHtml(e).done(this.updateMarkup)},updateMarkup:function(i){if(i&&0!==i.length){var s,n=this.$("li"),r={};n.removeClass("top"),i.each(function(){r[t(this).attr(this.options.dataContentId)]=!0}),n.each(function(){s=t(this),r[s.attr(this.options.dataContentId)]&&s.remove()}),i.eq(0).addClass("top").append('<div class="shadow"></div>'),this.$el.prepend(i),i.addClass(this.options.newContentClass),this.loadLazyImages(i.find("img")),n=this.$el.children("li"),n.length>this.options.maxItems&&n.slice(this.options.maxItems).remove(),this.renderMoreLink(),this.afterNewContent=setTimeout(e.bind(function(){i.removeClass(this.options.newContentClass)},this),1e3*this.options.removeNewHighlight),o.trigger("sports:module:update")}},startUpdateCheck:function(){clearInterval(this.interval),this.interval=setInterval(this.fetchUpdate,1e3*this.options.updateDelay)},stopUpdateCheck:function(){clearInterval(this.interval)},destroy:function(t){t&&this.$el.empty(),this.stopUpdateCheck(),clearTimeout(this.afterNewContent),i.prototype.destroy.apply(this,arguments)}});return r}),define("modules/sports/sports-latest-player-news",["jquery","underscore","backbone","base-app","modules/sports/sports-module-update"],function(t,e,i,s,n){var o=s.extend({initialize:function(e){s.prototype.initialize.call(this,e);var i=t(this.el).find(".sports-latest-player-news"),o=i.data("livefeed-more-link")||null,r=i.data("livefeed-more-link-text")||"More...";this.subviews.updatemodule=new n({el:".livefeed-news-list",maxItems:5,getItems:5,removeNewHighlight:20,updateDelay:30,dataSrcAttr:"data-src",dataSection:"data-livefeed",dataLoading:"livefeed-loading",dataTimeStamp:"data-timestamp",dataContentId:"data-content-id",moreLink:o,moreLinkText:r,newContentClass:"newcontent"})}});return o}),define("modules/newsletter-signup/newsletter-signup",["jquery","underscore","baseview","state","user-manager","pubsub"],function(t,e,i,s,n,o){"use strict";var r=i.extend({validEmail:function(t){var e=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(t)},el:".newsletter-signup-container",events:{submit:"onFormSubmit"},initialize:function(){this.$newsletterForm=this.$(".newsletter-signup-form"),this.$newsletterFormAction=this.$newsletterForm.attr("action"),this.$emailField=this.$(".newsletter-signup-email"),this.$emailConfirmField=this.$(".newsletter-signup-email-confirm"),this.$emailFormMsg=this.$(".newsletter-signup-msg"),this.$emailFormMsgTxt=this.$(".newsletter-signup-msg .message-text"),this.$newsletterCheckboxes=this.$(".newsletter-signup-form .newsletters input"),this.$businessUnitCode=this.$newsletterForm.data("business-unit"),this.$newsletterSubmit=this.$(".newsletter-signup-submit"),this.$newsletterTagline=this.$(".newsletter-signup-tagline"),this.userAccount=n.getAccount("firefly"),this.userAccount&&this.userAccount.getUserInfo().done(e.bind(function(e){e.email&&(this.$currentUserEmail=e.email,this.$emailField.val(this.$currentUserEmail),this.$emailConfirmField.val(this.$currentUserEmail),this.$emailField.prop("type","hidden"),this.$emailConfirmField.prop("type","hidden"),this.$newsletterSubmit.prop("value","Update"),this.$newsletterTagline.html("Hello, <strong>"+e.welcomeName+"</strong>. Please select any new newsletters you would like to receive."),s.fetchData(null,{url:"/services/gemsapi/getuser/"+e.email+"/"+this.$businessUnitCode}).done(function(e){e.success===!0&&e.subscriptions&&t.each(e.subscriptions,function(e,i){t("#newsletter-"+i)&&t("#newsletter-"+i).prop("checked",!0)})}))},this))},onFormSubmit:function(i){if(i.preventDefault(),this.$emailField.val()==this.$emailConfirmField.val()&&this.$emailField.val()&&this.validEmail(this.$emailField.val())){this.$emailFormMsg.hide();var n=[];this.$newsletterCheckboxes.each(function(e,i){n.push({id:t(i).data("newsletter-id"),signup:t(i).is(":checked")})});var r=JSON.stringify(n);this.$emailFormMsg.removeClass("fail").removeClass("success").addClass("updating"),this.$emailFormMsgTxt.html("Updating subscriptions."),this.$emailFormMsg.show();var a=0;this.userAccount&&this.userAccount.getUserInfo().always(e.bind(function(t){t.email&&(a=1)},this)),s.fetchData(null,{type:"POST",url:this.$newsletterFormAction+this.$emailField.val()+"/"+this.$businessUnitCode+"/",data:{logged_in:a,newsletter_choices:r}}).done(e.bind(function(e){if(this.$emailFormMsg.removeClass("updating"),e.success===!0){this.$emailFormMsg.removeClass("fail").addClass("success");var i="newsletter-signup|front|"+this.$newsletterSubmit.data("frontname")+"|choices|",s=[];this.$newsletterCheckboxes.each(function(e,i){t(i).is(":checked")&&s.push(t(i).data("newsletter-id"))});var n=s.join("|");i+=n,o.trigger("uotrack",i)}else this.$emailFormMsg.removeClass("success").addClass("fail");this.$emailFormMsgTxt.html(e.message)},this))}else this.$emailFormMsg.removeClass("updating").removeClass("success").addClass("fail"),this.$emailField.val()!=this.$emailConfirmField.val()&&this.$emailFormMsgTxt.html("Email addresses do not match."),this.$emailField.val()&&this.validEmail(this.$emailField.val())||this.$emailFormMsgTxt.html("Please enter a valid email address."),this.$emailFormMsg.show()}});return r}),function(t){"function"==typeof define&&define.amd?define("libs/jqueryui/widget",["jquery"],t):t(jQuery)}(function(t){var e=0,i=Array.prototype.slice;return t.cleanData=function(e){return function(i){var s,n,o;for(o=0;null!=(n=i[o]);o++)try{s=t._data(n,"events"),s&&s.remove&&t(n).triggerHandler("remove")}catch(r){}e(i)}}(t.cleanData),t.widget=function(e,i,s){var n,o,r,a,l={},h=e.split(".")[0];return e=e.split(".")[1],n=h+"-"+e,s||(s=i,i=t.Widget),t.expr[":"][n.toLowerCase()]=function(e){return!!t.data(e,n)},t[h]=t[h]||{},o=t[h][e],r=t[h][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new r(t,e)},t.extend(r,o,{version:s.version,_proto:t.extend({},s),_childConstructors:[]}),a=new i,a.options=t.widget.extend({},a.options),t.each(s,function(e,s){return t.isFunction(s)?void(l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},n=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,o=this._superApply;return this._super=t,this._superApply=n,e=s.apply(this,arguments),this._super=i,this._superApply=o,e}}()):void(l[e]=s)}),r.prototype=t.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix||e:e},l,{constructor:r,namespace:h,widgetName:e,widgetFullName:n}),o?(t.each(o._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,r,i._proto)}),delete o._childConstructors):i._childConstructors.push(r),t.widget.bridge(e,r),r},t.widget.extend=function(e){for(var s,n,o=i.call(arguments,1),r=0,a=o.length;a>r;r++)for(s in o[r])n=o[r][s],o[r].hasOwnProperty(s)&&void 0!==n&&(e[s]=t.isPlainObject(n)?t.isPlainObject(e[s])?t.widget.extend({},e[s],n):t.widget.extend({},n):n);return e},t.widget.bridge=function(e,s){var n=s.prototype.widgetFullName||e;t.fn[e]=function(o){var r="string"==typeof o,a=i.call(arguments,1),l=this;return o=!r&&a.length?t.widget.extend.apply(null,[o].concat(a)):o,this.each(r?function(){var i,s=t.data(this,n);return"instance"===o?(l=s,!1):s?t.isFunction(s[o])&&"_"!==o.charAt(0)?(i=s[o].apply(s,a),i!==s&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):t.error("no such method '"+o+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+o+"'")}:function(){var e=t.data(this,n);e?(e.option(o||{}),e._init&&e._init()):t.data(this,n,new s(o,this))}),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(i,s){s=t(s||this.defaultElement||this)[0],this.element=t(s),this.uuid=e++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),i),this.bindings=t(),this.hoverable=t(),this.focusable=t(),s!==this&&(t.data(s,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===s&&this.destroy()}}),this.document=t(s.style?s.ownerDocument:s.document||s),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var s,n,o,r=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(r={},s=e.split("."),e=s.shift(),s.length){for(n=r[e]=t.widget.extend({},this.options[e]),o=0;o<s.length-1;o++)n[s[o]]=n[s[o]]||{},n=n[s[o]];if(e=s.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];r[e]=i}return this._setOptions(r),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,i,s){var n,o=this;"boolean"!=typeof e&&(s=i,i=e,e=!1),s?(i=n=t(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),t.each(s,function(s,r){function a(){return e||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof r?o[r]:r).apply(o,arguments):void 0}"string"!=typeof r&&(a.guid=r.guid=r.guid||a.guid||t.guid++);var l=s.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+o.eventNamespace,c=l[2];c?n.delegate(c,h,a):i.bind(h,a)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function i(){return("string"==typeof t?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,s){var n,o,r=this.options[e];if(s=s||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(n in o)n in i||(i[n]=o[n]);return this.element.trigger(i,s),!(t.isFunction(r)&&r.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(s,n,o){"string"==typeof n&&(n={effect:n});var r,a=n?n===!0||"number"==typeof n?i:n.effect||i:e;n=n||{},"number"==typeof n&&(n={duration:n}),r=!t.isEmptyObject(n),n.complete=o,n.delay&&s.delay(n.delay),r&&t.effects&&t.effects.effect[a]?s[e](n):a!==e&&s[a]?s[a](n.duration,n.easing,o):s.queue(function(i){t(this)[e](),o&&o.call(s[0]),i()})}}),t.widget}),function(t){"function"==typeof define&&define.amd?define("libs/jqueryui/mouse",["jquery","./widget"],t):t(jQuery)}(function(t){var e=!1;return t(document).mouseup(function(){e=!1}),t.widget("ui.mouse",{version:"1.11.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!e){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var s=this,n=1===i.which,o="string"==typeof this.options.cancel&&i.target.nodeName?t(i.target).closest(this.options.cancel).length:!1;return n&&!o&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){s.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===t.data(i.target,this.widgetName+".preventClickEvent")&&t.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return s._mouseMove(t)},this._mouseUpDelegate=function(t){return s._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),e=!0,!0)):!0}},_mouseMove:function(e){return t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button?this._mouseUp(e):e.which?this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted):this._mouseUp(e)},_mouseUp:function(i){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,i.target===this._mouseDownEvent.target&&t.data(i.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(i)),e=!1,!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}),function(t){"function"==typeof define&&define.amd?define("libs/jqueryui/draggable",["jquery","./core","./mouse","./widget"],t):t(jQuery)}(function(t){return t.widget("ui.draggable",t.ui.mouse,{version:"1.11.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var i=this.document[0],s=this.options;try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&t(i.activeElement).blur()}catch(n){}return this.helper||s.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(t(s.iframeFix===!0?"iframe":s.iframeFix).each(function(){t("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(t(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",e,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,s=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(s=t.ui.ddmanager.drop(this,e)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",e)!==!1&&i._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1},_mouseUp:function(e){return t("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.element.focus(),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return s.parents("body").length||s.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s[0]===this.element[0]||/(fixed|absolute)/.test(s.css("position"))||s.css("position","absolute"),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options,o=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===n.containment?void(this.containment=[0,0,t(o).width()-this.helperProportions.width-this.margins.left,(t(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):n.containment.constructor===Array?void(this.containment=n.containment):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=t(n.containment),s=i[0],void(s&&(e="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,s,n,o,r=this.options,a=this._isRootNode(this.scrollParent[0]),l=t.pageX,h=t.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(h=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(h=i[3]+this.offset.click.top)),r.grid&&(n=r.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/r.grid[1])*r.grid[1]:this.originalPageY,h=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-r.grid[1]:n+r.grid[1]:n,o=r.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/r.grid[0])*r.grid[0]:this.originalPageX,l=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-r.grid[0]:o+r.grid[0]:o),"y"===r.axis&&(l=this.originalPageX),"x"===r.axis&&(h=this.originalPageY)),{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}
},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(e,i,s){return s=s||this._uiHash(),t.ui.plugin.call(this,e,[i,s,this],!0),"drag"===e&&(this.positionAbs=this._convertPositionTo("absolute")),t.Widget.prototype._trigger.call(this,e,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,s){var n=s.options,o=t.extend({},i,{item:s.element});s.sortables=[],t(n.connectToSortable).each(function(){var i=t(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",e,o))})},stop:function(e,i,s){var n=t.extend({},i,{item:s.element});t.each(s.sortables,function(){this.instance.isOver?(this.instance.isOver=0,s.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"===s.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,n))})},drag:function(e,i,s){var n=this;t.each(s.sortables,function(){var o=!1,r=this;this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,t.each(s.sortables,function(){return this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this!==r&&this.instance._intersectsWith(this.instance.containerCache)&&t.contains(r.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=t(n).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=s.offset.click.top,this.instance.offset.click.left=s.offset.click.left,this.instance.offset.parent.left-=s.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=s.offset.parent.top-this.instance.offset.parent.top,s._trigger("toSortable",e),s.dropped=this.instance.element,s.currentItem=s.element,this.instance.fromOutside=s),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),s._trigger("fromSortable",e),s.dropped=!1)})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i,s){var n=t("body"),o=s.options;n.css("cursor")&&(o._cursor=n.css("cursor")),n.css("cursor",o.cursor)},stop:function(e,i,s){var n=s.options;n._cursor&&t("body").css("cursor",n._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i,s){var n=t(i.helper),o=s.options;n.css("opacity")&&(o._opacity=n.css("opacity")),n.css("opacity",o.opacity)},stop:function(e,i,s){var n=s.options;n._opacity&&t(i.helper).css("opacity",n._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,s){var n=s.options,o=!1,r=s.scrollParentNotHidden[0],a=s.document[0];r!==a&&"HTML"!==r.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+r.offsetHeight-e.pageY<n.scrollSensitivity?r.scrollTop=o=r.scrollTop+n.scrollSpeed:e.pageY-s.overflowOffset.top<n.scrollSensitivity&&(r.scrollTop=o=r.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+r.offsetWidth-e.pageX<n.scrollSensitivity?r.scrollLeft=o=r.scrollLeft+n.scrollSpeed:e.pageX-s.overflowOffset.left<n.scrollSensitivity&&(r.scrollLeft=o=r.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-t(a).scrollTop()<n.scrollSensitivity?o=t(a).scrollTop(t(a).scrollTop()-n.scrollSpeed):t(window).height()-(e.pageY-t(a).scrollTop())<n.scrollSensitivity&&(o=t(a).scrollTop(t(a).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-t(a).scrollLeft()<n.scrollSensitivity?o=t(a).scrollLeft(t(a).scrollLeft()-n.scrollSpeed):t(window).width()-(e.pageX-t(a).scrollLeft())<n.scrollSensitivity&&(o=t(a).scrollLeft(t(a).scrollLeft()+n.scrollSpeed)))),o!==!1&&t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(s,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i,s){var n=s.options;s.snapElements=[],t(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=t(this),i=e.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(e,i,s){var n,o,r,a,l,h,c,d,u,p,f=s.options,g=f.snapTolerance,m=i.offset.left,v=m+s.helperProportions.width,y=i.offset.top,b=y+s.helperProportions.height;for(u=s.snapElements.length-1;u>=0;u--)l=s.snapElements[u].left,h=l+s.snapElements[u].width,c=s.snapElements[u].top,d=c+s.snapElements[u].height,l-g>v||m>h+g||c-g>b||y>d+g||!t.contains(s.snapElements[u].item.ownerDocument,s.snapElements[u].item)?(s.snapElements[u].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[u].item})),s.snapElements[u].snapping=!1):("inner"!==f.snapMode&&(n=Math.abs(c-b)<=g,o=Math.abs(d-y)<=g,r=Math.abs(l-v)<=g,a=Math.abs(h-m)<=g,n&&(i.position.top=s._convertPositionTo("relative",{top:c-s.helperProportions.height,left:0}).top-s.margins.top),o&&(i.position.top=s._convertPositionTo("relative",{top:d,left:0}).top-s.margins.top),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left-s.margins.left),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left-s.margins.left)),p=n||o||r||a,"outer"!==f.snapMode&&(n=Math.abs(c-y)<=g,o=Math.abs(d-b)<=g,r=Math.abs(l-m)<=g,a=Math.abs(h-v)<=g,n&&(i.position.top=s._convertPositionTo("relative",{top:c,left:0}).top-s.margins.top),o&&(i.position.top=s._convertPositionTo("relative",{top:d-s.helperProportions.height,left:0}).top-s.margins.top),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left-s.margins.left),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left-s.margins.left)),!s.snapElements[u].snapping&&(n||o||r||a||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[u].item})),s.snapElements[u].snapping=n||o||r||a||p)}}),t.ui.plugin.add("draggable","stack",{start:function(e,i,s){var n,o=s.options,r=t.makeArray(t(o.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});r.length&&(n=parseInt(t(r[0]).css("zIndex"),10)||0,t(r).each(function(e){t(this).css("zIndex",n+e)}),this.css("zIndex",n+r.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i,s){var n=t(i.helper),o=s.options;n.css("zIndex")&&(o._zIndex=n.css("zIndex")),n.css("zIndex",o.zIndex)},stop:function(e,i,s){var n=s.options;n._zIndex&&t(i.helper).css("zIndex",n._zIndex)}}),t.ui.draggable}),define("modules/interactives/before-after",["jquery","underscore","pubsub","utils","baseview","modules/interactives/interactive-templates","libs/jqueryui/draggable"],function(t,e,i,s,n,o){var r=n.extend({events:function(){var t={"click .image-container":"handleClick"};return t[(Modernizr.touch?"touchstart":"click")+" .before-after-caption-toggle"]="toggleCaption",t},initialize:function(i){i=t.extend({animateIntro:!0,introDelay:1e3,introDuration:1500,introPosition:.5,cursor:"e-resize"},i),n.prototype.initialize.call(this,i),this.$el.length&&(this.subviews.template=new o({el:this.$el,interactiveType:"beforeandafter",isFramed:i.isFramed,standAlone:i.standAlone}),this.subviews.template.goTo(this.subviews.template.currentSlideIndex),Modernizr.touch?require(["touchpunch"],e.bind(this._setup,this)):this._setup())},destroy:function(){this.$(".before-after-drag-handle").draggable("destroy"),n.prototype.destroy.apply(this,arguments)},_setup:function(){this.destroyed||e.each(this.$(".image-container"),function(e,i){this._setupBeforeAfter(t(e),i)},this)},toggleCaption:function(e){var i=t(e.currentTarget),s=i.closest(".slide").find(".meta"),n=s.is(":visible");s.fadeToggle(function(){i.text(n?"Show Caption":"Hide Caption")}),this.options.isFramed||this.subviews.template.trackClick(n?"beforeandafter_caption_off":"beforeandafter_caption_on")},handleClick:function(e){var i=t(e.currentTarget),s=t(".before-after-drag-handle",i),n=s.width()/2;this.subviews.template.trackFirstClick();var o=e.pageX-i.offset().left;t(".before-after-drag-handle",i).stop().css("left",o-n+"px"),t(".before-after-before-wrapper",i).stop().width(o+"px")},_setupBeforeAfter:function(e,i){function s(){h.width(parseInt(t(this).css("left"),10)+a/2)}var n=e,o=this.options,r=t(".before-after-draw-handle-image",n),a=r.width(),l=t(".before-after-drag-handle",n),h=t(".before-after-before-wrapper",n),c=h.width(),d=h.height(),u=c*o.introPosition;r.css({cursor:o.cursor,top:d/2-r.height()/2+"px"}),l.draggable({containment:n,drag:s,stop:s,axis:"x"}),o.animateIntro&&0===i?this.animateIntro(h,l,c,u):(l.css({left:u-a/2+"px"}),h.width(u))},animateIntro:function(t,e,i,s){var n=this.options,o=e.width()/2;e.css("left",i-o+"px"),setTimeout(function(){e.animate({left:s-o+"px"},n.introDuration),t.animate({width:s+"px"},n.introDuration)},n.introDelay)}});return r}),define("modules/money/market-summary",["jquery","underscore","baseview","state","pubsub"],function(t,e,i,s,n){"use strict";var o=i.extend({events:{"click a":"triggerABTestingEvent"},initialize:function(t){i.prototype.initialize.call(this,t),this.interval="suspender"===t.layoutType?s.recurringFetchHtml("/services/markets/home-widget/",null,6e4,e.bind(function(t){this.$(".market-ss").html(t)},this)):s.recurringFetchHtml("/services/markets/default-quotes/",null,6e4,e.bind(function(t){this.$(".mmtdq").html(t)},this))},triggerABTestingEvent:function(){var t=s.getActivePageInfo();if(t.ab_test_id){var e=t.ab_test_id+"|"+t.ab_test_variant||"control";n.trigger("abtesttrack",e)}},destroy:function(){clearInterval(this.interval),i.prototype.destroy.apply(this,arguments)}});return o}),define("modules/money/market-summary-search",["jquery","underscore","baseview","state","pubsub","modules/money/market-summary","modules/money/market-symbol-search"],function(t,e,i,s,n,o,r){"use strict";var a=i.extend({events:{"click .mss-quote-item a":"triggerABTestingEvent"},initialize:function(t){i.prototype.initialize.call(this,t),this.subviews.stocks=new o({el:this.$(".mmtsi-wrap")}),this.subviews.marketsearch=new r({el:this.$(".markets-stock-search-wrap")})},triggerABTestingEvent:function(){var t=s.getActivePageInfo();if(t.ab_test_id){var e=t.ab_test_id+"|"+t.ab_test_variant||"control";n.trigger("abtesttrack",e)}}});return a}),define("modules/polldaddy-poll",["jquery","underscore","baseview","state"],function(t,e,i,s){"use strict";var n=i.extend({el:".polls-primary-wrapper",events:{"click .pmp-view-results":"toggleLink","click .pmp-answer-option":"submitVote"},initialize:function(t){i.prototype.initialize.call(this,t),this.$q_wrapper=this.$(".poll-question-wrapper"),this.$a_wrapper=this.$(".poll-answer-wrapper"),this.$question=this.$(".pmp-answer-option"),this.$toggle=this.$(".pmp-view-results"),this.$bars=this.$(".pmp-bar"),this.poll_id=this.$question.data("poll"),this.viewResults()},viewResults:function(){this.getVoteValue()===String(this.poll_id)&&(this.$a_wrapper.addClass("pmp-active"),this.$q_wrapper.remove(),this.$toggle.remove())},toggleLink:function(){this.$a_wrapper.hasClass("pmp-active")?(this.$a_wrapper.removeClass("pmp-active"),this.$q_wrapper.addClass("pmp-active")):(this.$q_wrapper.removeClass("pmp-active"),this.$a_wrapper.addClass("pmp-active"))},incBarWidths:function(i){var s=[],n=0;e.each(i.answers.answer,function(t){s.push(t.percent)}),t.each(this.$bars,function(){t(this).width(s[n]+"%"),n++})},submitVote:function(i){i.preventDefault();var n=t(i.target),o=n.data("vote"),r=n.data("poll"),a=this;this.getVoteValue()!==String(r)&&s.fetchData("/polls/post/"+r+"/"+o+"/").done(e.bind(function(t){this.setVoteValue(r),this.incBarWidths(t),a.viewResults()},this))},setVoteValue:function(t){localStorage.setItem("polldaddy_pollvote",t)},getVoteValue:function(){return localStorage.getItem("polldaddy_pollvote")}});return n}),function(t,e){var i,s;typeof exports!=e+""?i=exports:(s=t.L,i={},i.noConflict=function(){return t.L=s,this},t.L=i),i.version="0.4.4",i.Util={extend:function(t){for(var e,i=Array.prototype.slice.call(arguments,1),s=0,n=i.length;n>s;s++){e=i[s]||{};for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])}return t},bind:function(t,e){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,i||arguments)}},stamp:function(){var t=0,e="_leaflet_id";return function(i){return i[e]=i[e]||++t,i[e]}}(),limitExecByInterval:function(t,e,i){var s,n;return function o(){var r=arguments;return s?void(n=!0):(s=!0,setTimeout(function(){s=!1,n&&(o.apply(i,r),n=!1)},e),void t.apply(i,r))}},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},splitWords:function(t){return t.replace(/^\s+|\s+$/g,"").split(/\s+/)},setOptions:function(t,e){return t.options=i.Util.extend({},t.options,e),t.options},getParamString:function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i+"="+t[i]);return"?"+e.join("&")},template:function(t,e){return t.replace(/\{ *([\w_]+) *\}/g,function(t,i){var s=e[i];if(!e.hasOwnProperty(i))throw new Error("No value provided for variable "+t);return s})},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){var i,s,n=["webkit","moz","o","ms"];for(i=0;i<n.length&&!s;i++)s=t[n[i]+e];return s}function s(e){return t.setTimeout(e,1e3/60)}var n=t.requestAnimationFrame||e("RequestAnimationFrame")||s,o=t.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){t.clearTimeout(e)};i.Util.requestAnimFrame=function(e,o,r,a){return e=i.Util.bind(e,o),r&&n===s?void e():n.call(t,e,a)},i.Util.cancelAnimFrame=function(e){e&&o.call(t,e)}}(),i.Class=function(){},i.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments)},s=function(){};s.prototype=this.prototype;var n=new s;n.constructor=e,e.prototype=n;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&(e[o]=this[o]);return t.statics&&(i.Util.extend(e,t.statics),delete t.statics),t.includes&&(i.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),t.options&&n.options&&(t.options=i.Util.extend({},n.options,t.options)),i.Util.extend(n,t),e},i.Class.include=function(t){i.Util.extend(this.prototype,t)},i.Class.mergeOptions=function(t){i.Util.extend(this.prototype.options,t)};var n="_leaflet_events";i.Mixin={},i.Mixin.Events={addEventListener:function(t,e,s){var o,r,a,l=this[n]=this[n]||{};if("object"==typeof t){for(o in t)t.hasOwnProperty(o)&&this.addEventListener(o,t[o],e);return this}for(t=i.Util.splitWords(t),r=0,a=t.length;a>r;r++)l[t[r]]=l[t[r]]||[],l[t[r]].push({action:e,context:s||this});return this},hasEventListeners:function(t){return n in this&&t in this[n]&&this[n][t].length>0},removeEventListener:function(t,e,s){var o,r,a,l,h,c=this[n];if("object"==typeof t){for(o in t)t.hasOwnProperty(o)&&this.removeEventListener(o,t[o],e);return this}for(t=i.Util.splitWords(t),r=0,a=t.length;a>r;r++)if(this.hasEventListeners(t[r]))for(l=c[t[r]],h=l.length-1;h>=0;h--)e&&l[h].action!==e||s&&l[h].context!==s||l.splice(h,1);return this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;for(var s=i.Util.extend({type:t,target:this},e),o=this[n][t].slice(),r=0,a=o.length;a>r;r++)o[r].action.call(o[r].context||this,s);return this}},i.Mixin.Events.on=i.Mixin.Events.addEventListener,i.Mixin.Events.off=i.Mixin.Events.removeEventListener,i.Mixin.Events.fire=i.Mixin.Events.fireEvent,function(){var s=navigator.userAgent.toLowerCase(),n=!!t.ActiveXObject,o=n&&!t.XMLHttpRequest,r=-1!==s.indexOf("webkit"),a=-1!==s.indexOf("gecko"),l=-1!==s.indexOf("chrome"),h=t.opera,c=-1!==s.indexOf("android"),d=-1!==s.search("android [23]"),u=typeof orientation!=e+""?!0:!1,p=document.documentElement,f=n&&"transition"in p.style,g=r&&"WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix,m=a&&"MozPerspective"in p.style,v=h&&"OTransition"in p.style,y=!t.L_NO_TOUCH&&function(){var t="ontouchstart";if(t in p)return!0;var e=document.createElement("div"),i=!1;return e.setAttribute?(e.setAttribute(t,"return;"),"function"==typeof e[t]&&(i=!0),e.removeAttribute(t),e=null,i):!1}(),b="devicePixelRatio"in t&&t.devicePixelRatio>1||"matchMedia"in t&&t.matchMedia("(min-resolution:144dpi)").matches;i.Browser={ua:s,ie:n,ie6:o,webkit:r,gecko:a,opera:h,android:c,android23:d,chrome:l,ie3d:f,webkit3d:g,gecko3d:m,opera3d:v,any3d:!t.L_DISABLE_3D&&(f||g||m||v),mobile:u,mobileWebkit:u&&r,mobileWebkit3d:u&&g,mobileOpera:u&&h,touch:y,retina:b}}(),i.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},i.Point.prototype={add:function(t){return this.clone()._add(i.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(i.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t,e){return new i.Point(this.x/t,this.y/t,e)},multiplyBy:function(t,e){return new i.Point(this.x*t,this.y*t,e)},distanceTo:function(t){t=i.point(t);var e=t.x-this.x,s=t.y-this.y;return Math.sqrt(e*e+s*s)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},clone:function(){return new i.Point(this.x,this.y)},toString:function(){return"Point("+i.Util.formatNum(this.x)+", "+i.Util.formatNum(this.y)+")"}},i.point=function(t,e,s){return t instanceof i.Point?t:t instanceof Array?new i.Point(t[0],t[1]):isNaN(t)?t:new i.Point(t,e,s)},i.Bounds=i.Class.extend({initialize:function(t,e){if(t)for(var i=e?[t,e]:t,s=0,n=i.length;n>s;s++)this.extend(i[s])},extend:function(t){return t=i.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new i.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new i.Point(this.min.x,this.max.y)},getTopRight:function(){return new i.Point(this.max.x,this.min.y)},contains:function(t){var e,s;return t="number"==typeof t[0]||t instanceof i.Point?i.point(t):i.bounds(t),t instanceof i.Bounds?(e=t.min,s=t.max):e=s=t,e.x>=this.min.x&&s.x<=this.max.x&&e.y>=this.min.y&&s.y<=this.max.y},intersects:function(t){t=i.bounds(t);var e=this.min,s=this.max,n=t.min,o=t.max,r=o.x>=e.x&&n.x<=s.x,a=o.y>=e.y&&n.y<=s.y;return r&&a}}),i.bounds=function(t,e){return!t||t instanceof i.Bounds?t:new i.Bounds(t,e)},i.Transformation=i.Class.extend({initialize:function(t,e,i,s){this._a=t,this._b=e,this._c=i,this._d=s},transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new i.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}}),i.DomUtil={get:function(t){return"string"==typeof t?document.getElementById(t):t},getStyle:function(t,e){var i=t.style[e];if(!i&&t.currentStyle&&(i=t.currentStyle[e]),!i||"auto"===i){var s=document.defaultView.getComputedStyle(t,null);i=s?s[e]:null}return"auto"===i?null:i},getViewportOffset:function(t){var e=0,s=0,n=t,o=document.body;do{if(e+=n.offsetTop||0,s+=n.offsetLeft||0,n.offsetParent===o&&"absolute"===i.DomUtil.getStyle(n,"position"))break;if("fixed"===i.DomUtil.getStyle(n,"position")){e+=o.scrollTop||0,s+=o.scrollLeft||0;break}n=n.offsetParent}while(n);n=t;do{if(n===o)break;e-=n.scrollTop||0,s-=n.scrollLeft||0,n=n.parentNode}while(n);return new i.Point(s,e)},create:function(t,e,i){var s=document.createElement(t);return s.className=e,i&&i.appendChild(s),s},disableTextSelection:function(){document.selection&&document.selection.empty&&document.selection.empty(),this._onselectstart||(this._onselectstart=document.onselectstart,document.onselectstart=i.Util.falseFn)},enableTextSelection:function(){document.onselectstart=this._onselectstart,this._onselectstart=null},hasClass:function(t,e){return t.className.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(t.className)},addClass:function(t,e){i.DomUtil.hasClass(t,e)||(t.className+=(t.className?" ":"")+e)},removeClass:function(t,e){function i(t,i){return i===e?"":t}t.className=t.className.replace(/(\S+)\s*/g,i).replace(/(^\s+|\s+$)/,"")},setOpacity:function(t,e){"opacity"in t.style?t.style.opacity=e:i.Browser.ie&&(e=Math.round(100*e),t.style.filter="alpha(opacity="+e+")")},testProp:function(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1},getTranslateString:function(t){var e=i.Browser.webkit3d,s="translate"+(e?"3d":"")+"(",n=(e?",0":"")+")";return s+t.x+"px,"+t.y+"px"+n},getScaleString:function(t,e){var s=i.DomUtil.getTranslateString(e),n=" scale("+t+") ",o=i.DomUtil.getTranslateString(e.multiplyBy(-1));return s+n+o},setPosition:function(t,e,s){t._leaflet_pos=e,!s&&i.Browser.any3d?(t.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(e),i.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden")):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},i.Util.extend(i.DomUtil,{TRANSITION:i.DomUtil.testProp(["transition","webkitTransition","OTransition","MozTransition","msTransition"]),TRANSFORM:i.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"])}),i.LatLng=function(t,e,i){var s=parseFloat(t),n=parseFloat(e);if(isNaN(s)||isNaN(n))throw new Error("Invalid LatLng object: ("+t+", "+e+")");i!==!0&&(s=Math.max(Math.min(s,90),-90),n=(n+180)%360+(-180>n||180===n?180:-180)),this.lat=s,this.lng=n},i.Util.extend(i.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),i.LatLng.prototype={equals:function(t){if(!t)return!1;t=i.latLng(t);var e=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return e<=i.LatLng.MAX_MARGIN},toString:function(){return"LatLng("+i.Util.formatNum(this.lat)+", "+i.Util.formatNum(this.lng)+")"},distanceTo:function(t){t=i.latLng(t);var e=6378137,s=i.LatLng.DEG_TO_RAD,n=(t.lat-this.lat)*s,o=(t.lng-this.lng)*s,r=this.lat*s,a=t.lat*s,l=Math.sin(n/2),h=Math.sin(o/2),c=l*l+h*h*Math.cos(r)*Math.cos(a);return 2*e*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))}},i.latLng=function(t,e,s){return t instanceof i.LatLng?t:t instanceof Array?new i.LatLng(t[0],t[1]):isNaN(t)?t:new i.LatLng(t,e,s)},i.LatLngBounds=i.Class.extend({initialize:function(t,e){if(t)for(var i=e?[t,e]:t,s=0,n=i.length;n>s;s++)this.extend(i[s])},extend:function(t){return t="number"==typeof t[0]||t instanceof i.LatLng?i.latLng(t):i.latLngBounds(t),t instanceof i.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new i.LatLng(t.lat,t.lng,!0),this._northEast=new i.LatLng(t.lat,t.lng,!0)):t instanceof i.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,s=this._northEast,n=Math.abs(e.lat-s.lat)*t,o=Math.abs(e.lng-s.lng)*t;return new i.LatLngBounds(new i.LatLng(e.lat-n,e.lng-o),new i.LatLng(s.lat+n,s.lng+o))},getCenter:function(){return new i.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new i.LatLng(this._northEast.lat,this._southWest.lng,!0)},getSouthEast:function(){return new i.LatLng(this._southWest.lat,this._northEast.lng,!0)},contains:function(t){t="number"==typeof t[0]||t instanceof i.LatLng?i.latLng(t):i.latLngBounds(t);var e,s,n=this._southWest,o=this._northEast;return t instanceof i.LatLngBounds?(e=t.getSouthWest(),s=t.getNorthEast()):e=s=t,e.lat>=n.lat&&s.lat<=o.lat&&e.lng>=n.lng&&s.lng<=o.lng},intersects:function(t){t=i.latLngBounds(t);var e=this._southWest,s=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),r=o.lat>=e.lat&&n.lat<=s.lat,a=o.lng>=e.lng&&n.lng<=s.lng;return r&&a},toBBoxString:function(){var t=this._southWest,e=this._northEast;return[t.lng,t.lat,e.lng,e.lat].join(",")},equals:function(t){return t?(t=i.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1}}),i.latLngBounds=function(t,e){return!t||t instanceof i.LatLngBounds?t:new i.LatLngBounds(t,e)},i.Projection={},i.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){var e=i.LatLng.DEG_TO_RAD,s=this.MAX_LATITUDE,n=Math.max(Math.min(s,t.lat),-s),o=t.lng*e,r=n*e;return r=Math.log(Math.tan(Math.PI/4+r/2)),new i.Point(o,r)},unproject:function(t){var e=i.LatLng.RAD_TO_DEG,s=t.x*e,n=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new i.LatLng(n,s,!0)}},i.Projection.LonLat={project:function(t){return new i.Point(t.lng,t.lat)},unproject:function(t){return new i.LatLng(t.y,t.x,!0)}},i.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),s=this.scale(e);return this.transformation._transform(i,s)},pointToLatLng:function(t,e){var i=this.scale(e),s=this.transformation.untransform(t,i);return this.projection.unproject(s)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)}},i.CRS.EPSG3857=i.Util.extend({},i.CRS,{code:"EPSG:3857",projection:i.Projection.SphericalMercator,transformation:new i.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){var e=this.projection.project(t),i=6378137;return e.multiplyBy(i)}}),i.CRS.EPSG900913=i.Util.extend({},i.CRS.EPSG3857,{code:"EPSG:900913"}),i.CRS.EPSG4326=i.Util.extend({},i.CRS,{code:"EPSG:4326",projection:i.Projection.LonLat,transformation:new i.Transformation(1/360,.5,-1/360,.5)}),i.Map=i.Class.extend({includes:i.Mixin.Events,options:{crs:i.CRS.EPSG3857,fadeAnimation:i.DomUtil.TRANSITION&&!i.Browser.android23,trackResize:!0,markerZoomAnimation:i.DomUtil.TRANSITION&&i.Browser.any3d},initialize:function(t,s){s=i.Util.setOptions(this,s),this._initContainer(t),this._initLayout(),this._initHooks(),this._initEvents(),s.maxBounds&&this.setMaxBounds(s.maxBounds),s.center&&s.zoom!==e&&this.setView(i.latLng(s.center),s.zoom,!0),this._initLayers(s.layers)},setView:function(t,e){return this._resetView(i.latLng(t),this._limitZoom(e)),this},setZoom:function(t){return this.setView(this.getCenter(),t)},zoomIn:function(){return this.setZoom(this._zoom+1)},zoomOut:function(){return this.setZoom(this._zoom-1)},fitBounds:function(t){var e=this.getBoundsZoom(t);return this.setView(i.latLngBounds(t).getCenter(),e)},fitWorld:function(){var t=new i.LatLng(-60,-170),e=new i.LatLng(85,179);return this.fitBounds(new i.LatLngBounds(t,e))},panTo:function(t){return this.setView(t,this._zoom)},panBy:function(t){return this.fire("movestart"),this._rawPanBy(i.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){if(t=i.latLngBounds(t),this.options.maxBounds=t,!t)return this._boundsMinZoom=null,this;var e=this.getBoundsZoom(t,!0);return this._boundsMinZoom=e,this._loaded&&(this._zoom<e?this.setView(t.getCenter(),e):this.panInsideBounds(t)),this},panInsideBounds:function(t){t=i.latLngBounds(t);var e=this.getBounds(),s=this.project(e.getSouthWest()),n=this.project(e.getNorthEast()),o=this.project(t.getSouthWest()),r=this.project(t.getNorthEast()),a=0,l=0;return n.y<r.y&&(l=r.y-n.y),n.x>r.x&&(a=r.x-n.x),s.y>o.y&&(l=o.y-s.y),s.x<o.x&&(a=o.x-s.x),this.panBy(new i.Point(a,l,!0))},addLayer:function(t){var e=i.Util.stamp(t);if(this._layers[e])return this;this._layers[e]=t,t.options&&!isNaN(t.options.maxZoom)&&(this._layersMaxZoom=Math.max(this._layersMaxZoom||0,t.options.maxZoom)),t.options&&!isNaN(t.options.minZoom)&&(this._layersMinZoom=Math.min(this._layersMinZoom||1/0,t.options.minZoom)),this.options.zoomAnimation&&i.TileLayer&&t instanceof i.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this));var s=function(){t.onAdd(this),this.fire("layeradd",{layer:t})};return this._loaded?s.call(this):this.on("load",s,this),this},removeLayer:function(t){var e=i.Util.stamp(t);if(this._layers[e])return t.onRemove(this),delete this._layers[e],this.options.zoomAnimation&&i.TileLayer&&t instanceof i.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this)),this.fire("layerremove",{layer:t})},hasLayer:function(t){var e=i.Util.stamp(t);return this._layers.hasOwnProperty(e)},invalidateSize:function(t){var e=this.getSize();if(this._sizeChanged=!0,this.options.maxBounds&&this.setMaxBounds(this.options.maxBounds),!this._loaded)return this;var s=e.subtract(this.getSize()).divideBy(2,!0);return t===!0?this.panBy(s):(this._rawPanBy(s),this.fire("move"),clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(i.Util.bind(this.fire,this,"moveend"),200)),this},addHandler:function(t,e){return e?(this[t]=new e(this),this.options[t]&&this[t].enable(),this):void 0},getCenter:function(){return this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),s=this.unproject(t.getTopRight());return new i.LatLngBounds(e,s)},getMinZoom:function(){var t=this.options.minZoom||0,e=this._layersMinZoom||0,i=this._boundsMinZoom||0;return Math.max(t,e,i)},getMaxZoom:function(){var t=this.options.maxZoom===e?1/0:this.options.maxZoom,i=this._layersMaxZoom===e?1/0:this._layersMaxZoom;return Math.min(t,i)},getBoundsZoom:function(t,e){t=i.latLngBounds(t);var s,n,o,r=this.getSize(),a=this.options.minZoom||0,l=this.getMaxZoom(),h=t.getNorthEast(),c=t.getSouthWest(),d=!0;e&&a--;do a++,n=this.project(h,a),o=this.project(c,a),s=new i.Point(Math.abs(n.x-o.x),Math.abs(o.y-n.y)),d=e?s.x<r.x||s.y<r.y:s.x<=r.x&&s.y<=r.y;while(d&&l>=a);return d&&e?null:e?a:a-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new i.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size},getPixelBounds:function(){var t=this._getTopLeftPoint();return new i.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,s){return s=s===e?this._zoom:s,this.options.crs.latLngToPoint(i.latLng(t),s)
},unproject:function(t,s){return s=s===e?this._zoom:s,this.options.crs.pointToLatLng(i.point(t),s)},layerPointToLatLng:function(t){var e=i.point(t).add(this._initialTopLeftPoint);return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(i.latLng(t))._round();return e._subtract(this._initialTopLeftPoint)},containerPointToLayerPoint:function(t){return i.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return i.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(i.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(i.latLng(t)))},mouseEventToContainerPoint:function(t){return i.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=i.DomUtil.get(t);if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;t.innerHTML="",i.DomUtil.addClass(t,"leaflet-container"),i.Browser.touch&&i.DomUtil.addClass(t,"leaflet-touch"),this.options.fadeAnimation&&i.DomUtil.addClass(t,"leaflet-fade-anim");var e=i.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),this._objectsPane=t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(i.DomUtil.addClass(t.markerPane,e),i.DomUtil.addClass(t.shadowPane,e),i.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return i.DomUtil.create("div",t,e||this._objectsPane)},_initializers:[],_initHooks:function(){var t,e;for(t=0,e=this._initializers.length;e>t;t++)this._initializers[t].call(this)},_initLayers:function(t){t=t?t instanceof Array?t:[t]:[],this._layers={},this._tileLayersNum=0;var e,i;for(e=0,i=t.length;i>e;e++)this.addLayer(t[e])},_resetView:function(t,e,s,n){var o=this._zoom!==e;n||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=e,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),s?this._initialTopLeftPoint._add(this._getMapPanePos()):i.DomUtil.setPosition(this._mapPane,new i.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum,this.fire("viewreset",{hard:!s}),this.fire("move"),(o||n)&&this.fire("zoomend"),this.fire("moveend",{hard:!s}),this._loaded||(this._loaded=!0,this.fire("load"))},_rawPanBy:function(t){i.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_initEvents:function(){if(i.DomEvent){i.DomEvent.on(this._container,"click",this._onMouseClick,this);var e,s,n=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(e=0,s=n.length;s>e;e++)i.DomEvent.on(this._container,n[e],this._fireMouseEvent,this);this.options.trackResize&&i.DomEvent.on(t,"resize",this._onResize,this)}},_onResize:function(){i.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=i.Util.requestAnimFrame(this.invalidateSize,this,!1,this._container)},_onMouseClick:function(t){!this._loaded||this.dragging&&this.dragging.moved()||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&i.DomEvent.preventDefault(t);var s=this.mouseEventToContainerPoint(t),n=this.containerPointToLayerPoint(s),o=this.layerPointToLatLng(n);this.fire(e,{latlng:o,layerPoint:n,containerPoint:s,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this._tileBg&&(clearTimeout(this._clearTileBgTimer),this._clearTileBgTimer=setTimeout(i.Util.bind(this._clearTileBg,this),500))},_getMapPanePos:function(){return i.DomUtil.getPosition(this._mapPane)},_getTopLeftPoint:function(){if(!this._loaded)throw new Error("Set map center and zoom first.");return this._initialTopLeftPoint.subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var i=this.getSize().divideBy(2);return this.project(t,e)._subtract(i)._round()},_latLngToNewLayerPoint:function(t,e,i){var s=this._getNewTopLeftPoint(i,e).add(this._getMapPanePos());return this.project(t,e)._subtract(s)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize().divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom();return Math.max(e,Math.min(i,t))}}),i.Map.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initializers.push(i)},i.map=function(t,e){return new i.Map(t,e)},i.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.3142,R_MAJOR:6378137,project:function(t){var e=i.LatLng.DEG_TO_RAD,s=this.MAX_LATITUDE,n=Math.max(Math.min(s,t.lat),-s),o=this.R_MAJOR,r=this.R_MINOR,a=t.lng*e*o,l=n*e,h=r/o,c=Math.sqrt(1-h*h),d=c*Math.sin(l);d=Math.pow((1-d)/(1+d),.5*c);var u=Math.tan(.5*(.5*Math.PI-l))/d;return l=-r*Math.log(u),new i.Point(a,l)},unproject:function(t){for(var e,s=i.LatLng.RAD_TO_DEG,n=this.R_MAJOR,o=this.R_MINOR,r=t.x*s/n,a=o/n,l=Math.sqrt(1-a*a),h=Math.exp(-t.y/o),c=Math.PI/2-2*Math.atan(h),d=15,u=1e-7,p=d,f=.1;Math.abs(f)>u&&--p>0;)e=l*Math.sin(c),f=Math.PI/2-2*Math.atan(h*Math.pow((1-e)/(1+e),.5*l))-c,c+=f;return new i.LatLng(c*s,r,!0)}},i.CRS.EPSG3395=i.Util.extend({},i.CRS,{code:"EPSG:3395",projection:i.Projection.Mercator,transformation:function(){var t=i.Projection.Mercator,e=t.R_MAJOR,s=t.R_MINOR;return new i.Transformation(.5/(Math.PI*e),.5,-.5/(Math.PI*s),.5)}()}),i.TileLayer=i.Class.extend({includes:i.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:i.Browser.mobile,updateWhenIdle:i.Browser.mobile},initialize:function(t,e){e=i.Util.setOptions(this,e),e.detectRetina&&i.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom>0&&e.minZoom--,this.options.maxZoom--),this._url=t;var s=this.options.subdomains;"string"==typeof s&&(this.options.subdomains=s.split(""))},onAdd:function(t){this._map=t,this._initContainer(),this._createTileProto(),t.on({viewreset:this._resetCallback,moveend:this._update},this),this.options.updateWhenIdle||(this._limitedUpdate=i.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._panes.tilePane.removeChild(this._container),t.off({viewreset:this._resetCallback,moveend:this._update},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._map._panes.tilePane.empty=!1,this._reset(!0),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==e&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){for(var i,s=t.getElementsByClassName("leaflet-layer"),n=-e(1/0,-1/0),o=0,r=s.length;r>o;o++)s[o]!==this._container&&(i=parseInt(s[o].style.zIndex,10),isNaN(i)||(n=e(n,i)));this._container.style.zIndex=isFinite(n)?n+e(1,-1):""},_updateOpacity:function(){i.DomUtil.setOpacity(this._container,this.options.opacity);var t,e=this._tiles;if(i.Browser.webkit)for(t in e)e.hasOwnProperty(t)&&(e[t].style.webkitTransform+=" translate(0,0)")},_initContainer:function(){var t=this._map._panes.tilePane;(!this._container||t.empty)&&(this._container=i.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity())},_resetCallback:function(t){this._reset(t.hard)},_reset:function(t){var e,i=this._tiles;for(e in i)i.hasOwnProperty(e)&&this.fire("tileunload",{tile:i[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),t&&this._container&&(this._container.innerHTML=""),this._initContainer()},_update:function(){if(!this._map._panTransition||!this._map._panTransition._inProgress){var t=this._map.getPixelBounds(),e=this._map.getZoom(),s=this.options.tileSize;if(!(e>this.options.maxZoom||e<this.options.minZoom)){var n=new i.Point(Math.floor(t.min.x/s),Math.floor(t.min.y/s)),o=new i.Point(Math.floor(t.max.x/s),Math.floor(t.max.y/s)),r=new i.Bounds(n,o);this._addTilesFromCenterOut(r),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(r)}}},_addTilesFromCenterOut:function(t){var e,s,n,o=[],r=t.getCenter();for(e=t.min.y;e<=t.max.y;e++)for(s=t.min.x;s<=t.max.x;s++)n=new i.Point(s,e),this._tileShouldBeLoaded(n)&&o.push(n);var a=o.length;if(0!==a){o.sort(function(t,e){return t.distanceTo(r)-e.distanceTo(r)});var l=document.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=a,s=0;a>s;s++)this._addTile(o[s],l);this._container.appendChild(l)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;if(!this.options.continuousWorld){var e=this._getWrapTileNum();if(this.options.noWrap&&(t.x<0||t.x>=e)||t.y<0||t.y>=e)return!1}return!0},_removeOtherTiles:function(t){var e,i,s,n;for(n in this._tiles)this._tiles.hasOwnProperty(n)&&(e=n.split(":"),i=parseInt(e[0],10),s=parseInt(e[1],10),(i<t.min.x||i>t.max.x||s<t.min.y||s>t.max.y)&&this._removeTile(n))},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(i.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._container&&this._container.removeChild(e),i.Browser.android||(e.src=i.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var s=this._getTilePos(t),n=this._getTile();i.DomUtil.setPosition(n,s,i.Browser.chrome||i.Browser.android23),this._tiles[t.x+":"+t.y]=n,this._loadTile(n,t),n.parentNode!==this._container&&e.appendChild(n)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+t.zoomOffset},_getTilePos:function(t){var e=this._map.getPixelOrigin(),i=this.options.tileSize;return t.multiplyBy(i).subtract(e)},getTileUrl:function(t){return this._adjustTilePoint(t),i.Util.template(this._url,i.Util.extend({s:this._getSubdomain(t),z:this._getZoomForUrl(),x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){return Math.pow(2,this._getZoomForUrl())},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e+e)%e),this.options.tms&&(t.y=e-t.y-1)},_getSubdomain:function(t){var e=(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_createTileProto:function(){var t=this._tileImg=i.DomUtil.create("img","leaflet-tile");t.galleryimg="no";var e=this.options.tileSize;t.style.width=e+"px",t.style.height=e+"px"},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=this._tileImg.cloneNode(!1);return t.onselectstart=t.onmousemove=i.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,t.src=this.getTileUrl(e)},_tileLoaded:function(){this._tilesToLoad--,this._tilesToLoad||this.fire("load")},_tileOnLoad:function(){var t=this._layer;this.src!==i.Util.emptyImageUrl&&(i.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()}}),i.tileLayer=function(t,e){return new i.TileLayer(t,e)},i.TileLayer.WMS=i.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var s=i.Util.extend({},this.defaultWmsParams);s.width=s.height=e.detectRetina&&i.Browser.retina?2*this.options.tileSize:this.options.tileSize;for(var n in e)this.options.hasOwnProperty(n)||(s[n]=e[n]);this.wmsParams=s,i.Util.setOptions(this,e)},onAdd:function(t){var e=parseFloat(this.wmsParams.version)>=1.3?"crs":"srs";this.wmsParams[e]=t.options.crs.code,i.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t,e){var s=this._map,n=s.options.crs,o=this.options.tileSize,r=t.multiplyBy(o),a=r.add(new i.Point(o,o)),l=n.project(s.unproject(r,e)),h=n.project(s.unproject(a,e)),c=[l.x,h.y,h.x,l.y].join(","),d=i.Util.template(this._url,{s:this._getSubdomain(t)});return d+i.Util.getParamString(this.wmsParams)+"&bbox="+c},setParams:function(t,e){return i.Util.extend(this.wmsParams,t),e||this.redraw(),this}}),i.tileLayer.wms=function(t,e){return new i.TileLayer.WMS(t,e)},i.TileLayer.Canvas=i.TileLayer.extend({options:{async:!1},initialize:function(t){i.Util.setOptions(this,t)},redraw:function(){var t,e=this._tiles;for(t in e)e.hasOwnProperty(t)&&this._redrawTile(e[t])},_redrawTile:function(t){this.drawTile(t,t._tilePoint,t._zoom)},_createTileProto:function(){var t=this._canvasProto=i.DomUtil.create("canvas","leaflet-tile"),e=this.options.tileSize;t.width=e,t.height=e},_createTile:function(){var t=this._canvasProto.cloneNode(!1);return t.onselectstart=t.onmousemove=i.Util.falseFn,t},_loadTile:function(t,e,i){t._layer=this,t._tilePoint=e,t._zoom=i,this.drawTile(t,e,i),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),i.tileLayer.canvas=function(t){return new i.TileLayer.Canvas(t)},i.ImageOverlay=i.Class.extend({includes:i.Mixin.Events,options:{opacity:1},initialize:function(t,e,s){this._url=t,this._bounds=i.latLngBounds(e),i.Util.setOptions(this,s)},onAdd:function(t){this._map=t,this._image||this._initImage(),t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&i.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},_initImage:function(){this._image=i.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&i.Browser.any3d?i.DomUtil.addClass(this._image,"leaflet-zoom-animated"):i.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),i.Util.extend(this._image,{galleryimg:"no",onselectstart:i.Util.falseFn,onmousemove:i.Util.falseFn,onload:i.Util.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,s=this._image,n=e.getZoomScale(t.zoom),o=this._bounds.getNorthWest(),r=this._bounds.getSouthEast(),a=e._latLngToNewLayerPoint(o,t.zoom,t.center),l=e._latLngToNewLayerPoint(r,t.zoom,t.center).subtract(a),h=e.latLngToLayerPoint(r).subtract(e.latLngToLayerPoint(o)),c=a.add(l.subtract(h).divideBy(2));s.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(c)+" scale("+n+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),s=this._map.latLngToLayerPoint(this._bounds.getSouthEast()).subtract(e);i.DomUtil.setPosition(t,e),t.style.width=s.x+"px",t.style.height=s.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){i.DomUtil.setOpacity(this._image,this.options.opacity)}}),i.imageOverlay=function(t,e,s){return new i.ImageOverlay(t,e,s)},i.Icon=i.Class.extend({options:{className:""},initialize:function(t){i.Util.setOptions(this,t)},createIcon:function(){return this._createIcon("icon")},createShadow:function(){return this._createIcon("shadow")},_createIcon:function(t){var e=this._getIconUrl(t);if(!e){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(e);return this._setIconStyles(i,t),i},_setIconStyles:function(t,e){var s,n=this.options,o=i.point(n[e+"Size"]);s=i.point("shadow"===e?n.shadowAnchor||n.iconAnchor:n.iconAnchor),!s&&o&&(s=o.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+n.className,s&&(t.style.marginLeft=-s.x+"px",t.style.marginTop=-s.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t){var e;return i.Browser.ie6?e=document.createElement("div"):(e=document.createElement("img"),e.src=t),e},_getIconUrl:function(t){return this.options[t+"Url"]}}),i.icon=function(t){return new i.Icon(t)},i.Icon.Default=i.Icon.extend({options:{iconSize:new i.Point(25,41),iconAnchor:new i.Point(13,41),popupAnchor:new i.Point(1,-34),shadowSize:new i.Point(41,41)},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];var s=i.Icon.Default.imagePath;if(!s)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return s+"/marker-"+t+".png"}}),i.Icon.Default.imagePath=function(){var t,e,i,s,n=document.getElementsByTagName("script"),o=/\/?leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,e=n.length;e>t;t++)if(i=n[t].src,s=i.match(o))return i.split(o)[0]+"/images"}(),i.Marker=i.Class.extend({includes:i.Mixin.Events,options:{icon:new i.Icon.Default,title:"",clickable:!0,draggable:!1,zIndexOffset:0,opacity:1},initialize:function(t,e){i.Util.setOptions(this,e),this._latlng=i.latLng(t)},onAdd:function(t){this._map=t,t.on("viewreset",this.update,this),this._initIcon(),this.update(),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._removeIcon(),this.closePopup&&this.closePopup(),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){this._latlng=i.latLng(t),this.update(),this._popup&&this._popup.setLatLng(t)},setZIndexOffset:function(t){this.options.zIndexOffset=t,this.update()},setIcon:function(t){this._map&&this._removeIcon(),this.options.icon=t,this._map&&(this._initIcon(),this.update())},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}},_initIcon:function(){var t=this.options,e=this._map,s=e.options.zoomAnimation&&e.options.markerZoomAnimation,n=s?"leaflet-zoom-animated":"leaflet-zoom-hide",o=!1;this._icon||(this._icon=t.icon.createIcon(),t.title&&(this._icon.title=t.title),this._initInteraction(),o=this.options.opacity<1,i.DomUtil.addClass(this._icon,n)),this._shadow||(this._shadow=t.icon.createShadow(),this._shadow&&(i.DomUtil.addClass(this._shadow,n),o=this.options.opacity<1)),o&&this._updateOpacity();var r=this._map._panes;r.markerPane.appendChild(this._icon),this._shadow&&r.shadowPane.appendChild(this._shadow)},_removeIcon:function(){var t=this._map._panes;t.markerPane.removeChild(this._icon),this._shadow&&t.shadowPane.removeChild(this._shadow),this._icon=this._shadow=null},_setPos:function(t){i.DomUtil.setPosition(this._icon,t),this._shadow&&i.DomUtil.setPosition(this._shadow,t),this._icon.style.zIndex=t.y+this.options.zIndexOffset},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout"];i.DomUtil.addClass(t,"leaflet-clickable"),i.DomEvent.on(t,"click",this._onMouseClick,this);for(var s=0;s<e.length;s++)i.DomEvent.on(t,e[s],this._fireMouseEvent,this);i.Handler.MarkerDrag&&(this.dragging=new i.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){i.DomEvent.stopPropagation(t),this.dragging&&this.dragging.moved()||this._map.dragging&&this._map.dragging.moved()||this.fire(t.type,{originalEvent:t})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t}),"mousedown"!==t.type&&i.DomEvent.stopPropagation(t)},setOpacity:function(t){this.options.opacity=t,this._map&&this._updateOpacity()},_updateOpacity:function(){i.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&i.DomUtil.setOpacity(this._shadow,this.options.opacity)}}),i.marker=function(t,e){return new i.Marker(t,e)},i.DivIcon=i.Icon.extend({options:{iconSize:new i.Point(12,12),className:"leaflet-div-icon"},createIcon:function(){var t=document.createElement("div"),e=this.options;return e.html&&(t.innerHTML=e.html),e.bgPos&&(t.style.backgroundPosition=-e.bgPos.x+"px "+-e.bgPos.y+"px"),this._setIconStyles(t,"icon"),t},createShadow:function(){return null}}),i.divIcon=function(t){return new i.DivIcon(t)},i.Map.mergeOptions({closePopupOnClick:!0}),i.Popup=i.Class.extend({includes:i.Mixin.Events,options:{minWidth:50,maxWidth:300,maxHeight:null,autoPan:!0,closeButton:!0,offset:new i.Point(0,6),autoPanPadding:new i.Point(5,5),className:""},initialize:function(t,e){i.Util.setOptions(this,t),this._source=e},onAdd:function(t){this._map=t,this._container||this._initLayout(),this._updateContent();var e=t.options.fadeAnimation;e&&i.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on("viewreset",this._updatePosition,this),i.Browser.any3d&&t.on("zoomanim",this._zoomAnimation,this),t.options.closePopupOnClick&&t.on("preclick",this._close,this),this._update(),e&&i.DomUtil.setOpacity(this._container,1)},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),i.Util.falseFn(this._container.offsetWidth),t.off({viewreset:this._updatePosition,preclick:this._close,zoomanim:this._zoomAnimation},this),t.options.fadeAnimation&&i.DomUtil.setOpacity(this._container,0),this._map=null},setLatLng:function(t){return this._latlng=i.latLng(t),this._update(),this},setContent:function(t){return this._content=t,this._update(),this},_close:function(){var t=this._map;t&&(t._popup=null,t.removeLayer(this).fire("popupclose",{popup:this}))},_initLayout:function(){var t,e="leaflet-popup",s=this._container=i.DomUtil.create("div",e+" "+this.options.className+" leaflet-zoom-animated");this.options.closeButton&&(t=this._closeButton=i.DomUtil.create("a",e+"-close-button",s),t.href="#close",t.innerHTML="&#215;",i.DomEvent.on(t,"click",this._onCloseButtonClick,this));var n=this._wrapper=i.DomUtil.create("div",e+"-content-wrapper",s);i.DomEvent.disableClickPropagation(n),this._contentNode=i.DomUtil.create("div",e+"-content",n),i.DomEvent.on(this._contentNode,"mousewheel",i.DomEvent.stopPropagation),this._tipContainer=i.DomUtil.create("div",e+"-tip-container",s),this._tip=i.DomUtil.create("div",e+"-tip",this._tipContainer)},_update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var s=t.offsetWidth;s=Math.min(s,this.options.maxWidth),s=Math.max(s,this.options.minWidth),e.width=s+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,o=this.options.maxHeight,r="leaflet-popup-scrolled";o&&n>o?(e.height=o+"px",i.DomUtil.addClass(t,r)):i.DomUtil.removeClass(t,r),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng),e=i.Browser.any3d,s=this.options.offset;e&&i.DomUtil.setPosition(this._container,t),this._containerBottom=-s.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+s.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);i.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,s=this._containerWidth,n=new i.Point(this._containerLeft,-e-this._containerBottom);i.Browser.any3d&&n._add(i.DomUtil.getPosition(this._container));var o=t.layerPointToContainerPoint(n),r=this.options.autoPanPadding,a=t.getSize(),l=0,h=0;o.x<0&&(l=o.x-r.x),o.x+s>a.x&&(l=o.x+s-a.x+r.x),o.y<0&&(h=o.y-r.y),o.y+e>a.y&&(h=o.y+e-a.y+r.y),(l||h)&&t.panBy(new i.Point(l,h))}},_onCloseButtonClick:function(t){this._close(),i.DomEvent.stop(t)}}),i.popup=function(t,e){return new i.Popup(t,e)},i.Marker.include({openPopup:function(){return this._popup&&this._map&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},bindPopup:function(t,e){var s=i.point(this.options.icon.options.popupAnchor)||new i.Point(0,0);return s=s.add(i.Popup.prototype.options.offset),e&&e.offset&&(s=s.add(e.offset)),e=i.Util.extend({offset:s},e),this._popup||this.on("click",this.openPopup,this),this._popup=new i.Popup(e,this).setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.openPopup)),this}}),i.Map.include({openPopup:function(t){return this.closePopup(),this._popup=t,this.addLayer(t).fire("popupopen",{popup:this._popup})},closePopup:function(){return this._popup&&this._popup._close(),this}}),i.LayerGroup=i.Class.extend({initialize:function(t){this._layers={};var e,i;if(t)for(e=0,i=t.length;i>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=i.Util.stamp(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=i.Util.stamp(t);return delete this._layers[e],this._map&&this._map.removeLayer(t),this},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,i,s=Array.prototype.slice.call(arguments,1);for(e in this._layers)this._layers.hasOwnProperty(e)&&(i=this._layers[e],i[t]&&i[t].apply(i,s));return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var i in this._layers)this._layers.hasOwnProperty(i)&&t.call(e,this._layers[i])}}),i.layerGroup=function(t){return new i.LayerGroup(t)},i.FeatureGroup=i.LayerGroup.extend({includes:i.Mixin.Events,addLayer:function(t){return this._layers[i.Util.stamp(t)]?this:(t.on("click dblclick mouseover mouseout mousemove contextmenu",this._propagateEvent,this),i.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent),this)},removeLayer:function(t){return t.off("click dblclick mouseover mouseout mousemove contextmenu",this._propagateEvent,this),i.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent?this.invoke("unbindPopup"):this},bindPopup:function(t){return this._popupContent=t,this.invoke("bindPopup",t)},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new i.LatLngBounds;return this.eachLayer(function(e){t.extend(e instanceof i.Marker?e.getLatLng():e.getBounds())},this),t},_propagateEvent:function(t){t.layer=t.target,t.target=this,this.fire(t.type,t)}}),i.featureGroup=function(t){return new i.FeatureGroup(t)},i.Path=i.Class.extend({includes:[i.Mixin.Events],statics:{CLIP_PADDING:i.Browser.mobile?Math.max(0,Math.min(.5,(1280/Math.max(t.innerWidth,t.innerHeight)-1)/2)):.5},options:{stroke:!0,color:"#0033ff",dashArray:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){i.Util.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this._map=null,i.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return i.Util.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),i.Map.include({_updatePathViewport:function(){var t=i.Path.CLIP_PADDING,e=this.getSize(),s=i.DomUtil.getPosition(this._mapPane),n=s.multiplyBy(-1)._subtract(e.multiplyBy(t)),o=n.add(e.multiplyBy(1+2*t));this._pathViewport=new i.Bounds(n,o)}}),i.Path.SVG_NS="http://www.w3.org/2000/svg",i.Browser.svg=!(!document.createElementNS||!document.createElementNS(i.Path.SVG_NS,"svg").createSVGRect),i.Path=i.Path.extend({statics:{SVG:i.Browser.svg},bringToFront:function(){return this._container&&this._map._pathRoot.appendChild(this._container),this},bringToBack:function(){if(this._container){var t=this._map._pathRoot;t.insertBefore(this._container,t.firstChild)}return this},getPathString:function(){},_createElement:function(t){return document.createElementNS(i.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray")):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")
},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){(i.Browser.svg||!i.Browser.vml)&&this._path.setAttribute("class","leaflet-clickable"),i.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)i.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||(this._fireMouseEvent(t),i.DomEvent.stopPropagation(t))},_fireMouseEvent:function(t){if(this.hasEventListeners(t.type)){"contextmenu"===t.type&&i.DomEvent.preventDefault(t);var e=this._map,s=e.mouseEventToContainerPoint(t),n=e.containerPointToLayerPoint(s),o=e.layerPointToLatLng(n);this.fire(t.type,{latlng:o,layerPoint:n,containerPoint:s,originalEvent:t})}}}),i.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=i.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&i.Browser.any3d?(this._pathRoot.setAttribute("class"," leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):this._pathRoot.setAttribute("class"," leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),s=this._getCenterOffset(t.center).divideBy(1-1/e),n=this.containerPointToLayerPoint(this.getSize().multiplyBy(-i.Path.CLIP_PADDING)),o=n.add(s).round();this._pathRoot.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(o.multiplyBy(-1).add(i.DomUtil.getPosition(this._pathRoot)).multiplyBy(e).add(o))+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,s=t.max,n=s.x-e.x,o=s.y-e.y,r=this._pathRoot,a=this._panes.overlayPane;i.Browser.mobileWebkit&&a.removeChild(r),i.DomUtil.setPosition(r,e),r.setAttribute("width",n),r.setAttribute("height",o),r.setAttribute("viewBox",[e.x,e.y,n,o].join(" ")),i.Browser.mobileWebkit&&a.appendChild(r)}}}),i.Path.include({bindPopup:function(t,e){return this._popup&&this._popup.options===e||(this._popup=new i.Popup(e,this)),this._popup.setContent(t),this._openPopupAdded||(this.on("click",this._openPopup,this),this._openPopupAdded=!0),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),i.Browser.vml=function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(i){return!1}}(),i.Path=i.Browser.svg||!i.Browser.vml?i.Path:i.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");i.DomUtil.addClass(t,"leaflet-vml-shape"),this.options.clickable&&i.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,i=this.options,s=this._container;s.stroked=i.stroke,s.filled=i.fill,i.stroke?(t||(t=this._stroke=this._createElement("stroke"),t.endcap="round",s.appendChild(t)),t.weight=i.weight+"px",t.color=i.color,t.opacity=i.opacity,t.dashStyle=i.dashArray?i.dashArray.replace(/ *, */g," "):""):t&&(s.removeChild(t),this._stroke=null),i.fill?(e||(e=this._fill=this._createElement("fill"),s.appendChild(e)),e.color=i.fillColor||i.color,e.opacity=i.fillOpacity):e&&(s.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),i.Map.include(i.Browser.svg||!i.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=document.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),i.Browser.canvas=function(){return!!document.createElement("canvas").getContext}(),i.Path=i.Path.SVG&&!t.L_PREFER_CANVAS||!i.Browser.canvas?i.Path:i.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return i.Util.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this._requestUpdate(),this._map=null},_requestUpdate:function(){this._map&&(i.Util.cancelAnimFrame(this._fireMapMoveEnd),this._updateRequest=i.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color)},_drawPath:function(){var t,e,s,n,o,r;for(this._ctx.beginPath(),t=0,s=this._parts.length;s>t;t++){for(e=0,n=this._parts[t].length;n>e;e++)o=this._parts[t][e],r=(0===e?"move":"line")+"To",this._ctx[r](o.x,o.y);this instanceof i.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(e.fillOpacity<1&&(t.globalAlpha=e.fillOpacity),t.fill()),e.stroke&&(e.opacity<1&&(t.globalAlpha=e.opacity),t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&this._map.on("click",this._onClick,this)},_onClick:function(t){this._containsPoint(t.layerPoint)&&this.fire("click",t)}}),i.Map.include(i.Path.SVG&&!t.L_PREFER_CANVAS||!i.Browser.canvas?{}:{_initPathRoot:function(){var t,e=this._pathRoot;e||(e=this._pathRoot=document.createElement("canvas"),e.style.position="absolute",t=this._canvasCtx=e.getContext("2d"),t.lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(e),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,s=t.max.subtract(e),n=this._pathRoot;i.DomUtil.setPosition(n,e),n.width=s.x,n.height=s.y,n.getContext("2d").translate(-e.x,-e.y)}}}),i.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,i){var s=t.length,n=typeof Uint8Array!=e+""?Uint8Array:Array,o=new n(s);o[0]=o[s-1]=1,this._simplifyDPStep(t,o,i,0,s-1);var r,a=[];for(r=0;s>r;r++)o[r]&&a.push(t[r]);return a},_simplifyDPStep:function(t,e,i,s,n){var o,r,a,l=0;for(r=s+1;n-1>=r;r++)a=this._sqClosestPointOnSegment(t[r],t[s],t[n],!0),a>l&&(o=r,l=a);l>i&&(e[o]=1,this._simplifyDPStep(t,e,i,s,o),this._simplifyDPStep(t,e,i,o,n))},_reducePoints:function(t,e){for(var i=[t[0]],s=1,n=0,o=t.length;o>s;s++)this._sqDist(t[s],t[n])>e&&(i.push(t[s]),n=s);return o-1>n&&i.push(t[o-1]),i},clipSegment:function(t,e,i,s){var n=(i.min,i.max,s?this._lastCode:this._getBitCode(t,i)),o=this._getBitCode(e,i);for(this._lastCode=o;;){if(!(n|o))return[t,e];if(n&o)return!1;var r=n||o,a=this._getEdgeIntersection(t,e,r,i),l=this._getBitCode(a,i);r===n?(t=a,n=l):(e=a,o=l)}},_getEdgeIntersection:function(t,e,s,n){var o=e.x-t.x,r=e.y-t.y,a=n.min,l=n.max;return 8&s?new i.Point(t.x+o*(l.y-t.y)/r,l.y):4&s?new i.Point(t.x+o*(a.y-t.y)/r,a.y):2&s?new i.Point(l.x,t.y+r*(l.x-t.x)/o):1&s?new i.Point(a.x,t.y+r*(a.x-t.x)/o):void 0},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,s=e.y-t.y;return i*i+s*s},_sqClosestPointOnSegment:function(t,e,s,n){var o,r=e.x,a=e.y,l=s.x-r,h=s.y-a,c=l*l+h*h;return c>0&&(o=((t.x-r)*l+(t.y-a)*h)/c,o>1?(r=s.x,a=s.y):o>0&&(r+=l*o,a+=h*o)),l=t.x-r,h=t.y-a,n?l*l+h*h:new i.Point(r,a)}},i.Polyline=i.Path.extend({initialize:function(t,e){i.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t),i.Handler.PolyEdit&&(this.editing=new i.Handler.PolyEdit(this),this.options.editable&&this.editing.enable())},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;e>t;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,i="";e>t;t++)i+=this._getPathPartStr(this._parts[t]);return i},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(i.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs),this.redraw(),t},closestLayerPoint:function(t){for(var e,s,n=1/0,o=this._parts,r=null,a=0,l=o.length;l>a;a++)for(var h=o[a],c=1,d=h.length;d>c;c++){e=h[c-1],s=h[c];var u=i.LineUtil._sqClosestPointOnSegment(t,e,s,!0);n>u&&(n=u,r=i.LineUtil._sqClosestPointOnSegment(t,e,s))}return r&&(r.distance=Math.sqrt(n)),r},getBounds:function(){for(var t=new i.LatLngBounds,e=this.getLatLngs(),s=0,n=e.length;n>s;s++)t.extend(e[s]);return t},onAdd:function(t){i.Path.prototype.onAdd.call(this,t),this.editing&&this.editing.enabled()&&this.editing.addHooks()},onRemove:function(t){this.editing&&this.editing.enabled()&&this.editing.removeHooks(),i.Path.prototype.onRemove.call(this,t)},_convertLatLngs:function(t){var e,s;for(e=0,s=t.length;s>e;e++){if(t[e]instanceof Array&&"number"!=typeof t[e][0])return;t[e]=i.latLng(t[e])}return t},_initEvents:function(){i.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,s=i.Path.VML,n=0,o=t.length,r="";o>n;n++)e=t[n],s&&e._round(),r+=(n?"L":"M")+e.x+" "+e.y;return r},_clipPoints:function(){var t,e,s,n=this._originalPoints,o=n.length;if(this.options.noClip)return void(this._parts=[n]);this._parts=[];var r=this._parts,a=this._map._pathViewport,l=i.LineUtil;for(t=0,e=0;o-1>t;t++)s=l.clipSegment(n[t],n[t+1],a,t),s&&(r[e]=r[e]||[],r[e].push(s[0]),(s[1]!==n[t+1]||t===o-2)&&(r[e].push(s[1]),e++))},_simplifyPoints:function(){for(var t=this._parts,e=i.LineUtil,s=0,n=t.length;n>s;s++)t[s]=e.simplify(t[s],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),i.Path.prototype._updatePath.call(this))}}),i.polyline=function(t,e){return new i.Polyline(t,e)},i.PolyUtil={},i.PolyUtil.clipPolygon=function(t,e){var s,n,o,r,a,l,h,c,d,u=(e.min,e.max,[1,4,2,8]),p=i.LineUtil;for(n=0,h=t.length;h>n;n++)t[n]._code=p._getBitCode(t[n],e);for(r=0;4>r;r++){for(c=u[r],s=[],n=0,h=t.length,o=h-1;h>n;o=n++)a=t[n],l=t[o],a._code&c?l._code&c||(d=p._getEdgeIntersection(l,a,c,e),d._code=p._getBitCode(d,e),s.push(d)):(l._code&c&&(d=p._getEdgeIntersection(l,a,c,e),d._code=p._getBitCode(d,e),s.push(d)),s.push(a));t=s}return t},i.Polygon=i.Polyline.extend({options:{fill:!0},initialize:function(t,e){i.Polyline.prototype.initialize.call(this,t,e),t&&t[0]instanceof Array&&"number"!=typeof t[0][0]&&(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1))},projectLatlngs:function(){if(i.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes)for(var t=0,e=this._holes.length;e>t;t++){this._holePoints[t]=[];for(var s=0,n=this._holes[t].length;n>s;s++)this._holePoints[t][s]=this._map.latLngToLayerPoint(this._holes[t][s])}},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var s=0,n=this._parts.length;n>s;s++){var o=i.PolyUtil.clipPolygon(this._parts[s],this._map._pathViewport);o.length&&e.push(o)}this._parts=e}},_getPathPartStr:function(t){var e=i.Polyline.prototype._getPathPartStr.call(this,t);return e+(i.Browser.svg?"z":"x")}}),i.polygon=function(t,e){return new i.Polygon(t,e)},function(){function t(t){return i.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var i=0,s=e.length;for(this.eachLayer(function(t){s>i?t.setLatLngs(e[i++]):this.removeLayer(t)},this);s>i;)this.addLayer(new t(e[i++],this._options));return this}})}i.MultiPolyline=t(i.Polyline),i.MultiPolygon=t(i.Polygon),i.multiPolyline=function(t,e){return new i.MultiPolyline(t,e)},i.multiPolygon=function(t,e){return new i.MultiPolygon(t,e)}}(),i.Rectangle=i.Polygon.extend({initialize:function(t,e){i.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=i.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]}}),i.rectangle=function(t,e){return new i.Rectangle(t,e)},i.Circle=i.Path.extend({initialize:function(t,e,s){i.Path.prototype.initialize.call(this,s),this._latlng=i.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=i.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=new i.LatLng(this._latlng.lat,this._latlng.lng-t,!0),s=this._map.latLngToLayerPoint(e);this._point=this._map.latLngToLayerPoint(this._latlng),this._radius=Math.max(Math.round(this._point.x-s.x),1)},getBounds:function(){var t=this._map,e=this._radius*Math.cos(Math.PI/4),s=t.project(this._latlng),n=new i.Point(s.x-e,s.y+e),o=new i.Point(s.x+e,s.y-e),r=t.unproject(n),a=t.unproject(o);return new i.LatLngBounds(r,a)},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":i.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLngRadius:function(){var t=40075017,e=t*Math.cos(i.LatLng.DEG_TO_RAD*this._latlng.lat);return this._mRadius/e*360},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,i=this._point;return i.x-e>t.max.x||i.y-e>t.max.y||i.x+e<t.min.x||i.y+e<t.min.y}}),i.circle=function(t,e,s){return new i.Circle(t,e,s)},i.CircleMarker=i.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){i.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},setRadius:function(t){return this._radius=t,this.redraw()}}),i.circleMarker=function(t,e){return new i.CircleMarker(t,e)},i.Polyline.include(i.Path.CANVAS?{_containsPoint:function(t,e){var s,n,o,r,a,l,h,c=this.options.weight/2;for(i.Browser.touch&&(c+=10),s=0,r=this._parts.length;r>s;s++)for(h=this._parts[s],n=0,a=h.length,o=a-1;a>n;o=n++)if((e||0!==n)&&(l=i.LineUtil.pointToSegmentDistance(t,h[o],h[n]),c>=l))return!0;return!1}}:{}),i.Polygon.include(i.Path.CANVAS?{_containsPoint:function(t){var e,s,n,o,r,a,l,h,c=!1;if(i.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(o=0,l=this._parts.length;l>o;o++)for(e=this._parts[o],r=0,h=e.length,a=h-1;h>r;a=r++)s=e[r],n=e[a],s.y>t.y!=n.y>t.y&&t.x<(n.x-s.x)*(t.y-s.y)/(n.y-s.y)+s.x&&(c=!c);return c}}:{}),i.Circle.include(i.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,i=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+i}}:{}),i.GeoJSON=i.FeatureGroup.extend({initialize:function(t,e){i.Util.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,s,n=t instanceof Array?t:t.features;if(n){for(e=0,s=n.length;s>e;e++)this.addData(n[e]);return this}var o=this.options;if(!o.filter||o.filter(t)){var r=i.GeoJSON.geometryToLayer(t,o.pointToLayer);return r.feature=t,this.resetStyle(r),o.onEachFeature&&o.onEachFeature(t,r),this.addLayer(r)}},resetStyle:function(t){var e=this.options.style;e&&this._setLayerStyle(t,e)},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),i.Util.extend(i.GeoJSON,{geometryToLayer:function(t,e){var s,n,o,r,a,l="Feature"===t.type?t.geometry:t,h=l.coordinates,c=[];switch(l.type){case"Point":return s=this.coordsToLatLng(h),e?e(t,s):new i.Marker(s);case"MultiPoint":for(o=0,r=h.length;r>o;o++)s=this.coordsToLatLng(h[o]),a=e?e(t,s):new i.Marker(s),c.push(a);return new i.FeatureGroup(c);case"LineString":return n=this.coordsToLatLngs(h),new i.Polyline(n);case"Polygon":return n=this.coordsToLatLngs(h,1),new i.Polygon(n);case"MultiLineString":return n=this.coordsToLatLngs(h,1),new i.MultiPolyline(n);case"MultiPolygon":return n=this.coordsToLatLngs(h,2),new i.MultiPolygon(n);case"GeometryCollection":for(o=0,r=l.geometries.length;r>o;o++)a=this.geometryToLayer(l.geometries[o],e),c.push(a);return new i.FeatureGroup(c);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t,e){var s=parseFloat(t[e?0:1]),n=parseFloat(t[e?1:0]);return new i.LatLng(s,n,!0)},coordsToLatLngs:function(t,e,i){var s,n,o,r=[];for(n=0,o=t.length;o>n;n++)s=e?this.coordsToLatLngs(t[n],e-1,i):this.coordsToLatLng(t[n],i),r.push(s);return r}}),i.geoJson=function(t,e){return new i.GeoJSON(t,e)},i.DomEvent={addListener:function(t,e,s,n){var o,r,a,l=i.Util.stamp(s),h="_leaflet_"+e+l;return t[h]?this:(o=function(e){return s.call(n||t,e||i.DomEvent._getEvent())},i.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener?this.addDoubleTapListener(t,o,l):("addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",o,!1),t.addEventListener(e,o,!1)):"mouseenter"===e||"mouseleave"===e?(r=o,a="mouseenter"===e?"mouseover":"mouseout",o=function(e){return i.DomEvent._checkMouse(t,e)?r(e):void 0},t.addEventListener(a,o,!1)):t.addEventListener(e,o,!1):"attachEvent"in t&&t.attachEvent("on"+e,o),t[h]=o,this))},removeListener:function(t,e,s){var n=i.Util.stamp(s),o="_leaflet_"+e+n,r=t[o];if(r)return i.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,n):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",r,!1),t.removeEventListener(e,r,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",r,!1):t.removeEventListener(e,r,!1):"detachEvent"in t&&t.detachEvent("on"+e,r),t[o]=null,this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,this},disableClickPropagation:function(t){var e=i.DomEvent.stopPropagation;return i.DomEvent.addListener(t,i.Draggable.START,e).addListener(t,"click",e).addListener(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return i.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){var s=document.body,n=document.documentElement,o=t.pageX?t.pageX:t.clientX+s.scrollLeft+n.scrollLeft,r=t.pageY?t.pageY:t.clientY+s.scrollTop+n.scrollTop,a=new i.Point(o,r);return e?a._subtract(i.DomUtil.getViewportOffset(e)):a},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_checkMouse:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(s){return!1}return i!==t},_getEvent:function(){var e=t.event;if(!e)for(var i=arguments.callee.caller;i&&(e=i.arguments[0],!e||t.Event!==e.constructor);)i=i.caller;return e}},i.DomEvent.on=i.DomEvent.addListener,i.DomEvent.off=i.DomEvent.removeListener,i.Draggable=i.Class.extend({includes:i.Mixin.Events,statics:{START:i.Browser.touch?"touchstart":"mousedown",END:i.Browser.touch?"touchend":"mouseup",MOVE:i.Browser.touch?"touchmove":"mousemove",TAP_TOLERANCE:15},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){this._enabled||(i.DomEvent.on(this._dragStartTarget,i.Draggable.START,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(i.DomEvent.off(this._dragStartTarget,i.Draggable.START,this._onDown),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!(!i.Browser.touch&&t.shiftKey||1!==t.which&&1!==t.button&&!t.touches)){if(this._simulateClick=!0,t.touches&&t.touches.length>1)return void(this._simulateClick=!1);var e=t.touches&&1===t.touches.length?t.touches[0]:t,s=e.target;i.DomEvent.preventDefault(t),i.Browser.touch&&"a"===s.tagName.toLowerCase()&&i.DomUtil.addClass(s,"leaflet-active"),this._moved=!1,this._moving||(this._startPos=this._newPos=i.DomUtil.getPosition(this._element),this._startPoint=new i.Point(e.clientX,e.clientY),i.DomEvent.on(document,i.Draggable.MOVE,this._onMove,this),i.DomEvent.on(document,i.Draggable.END,this._onUp,this))}},_onMove:function(t){if(!(t.touches&&t.touches.length>1)){var e=t.touches&&1===t.touches.length?t.touches[0]:t,s=new i.Point(e.clientX,e.clientY),n=s.subtract(this._startPoint);(n.x||n.y)&&(i.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,i.Browser.touch||(i.DomUtil.disableTextSelection(),this._setMovingCursor())),this._newPos=this._startPos.add(n),this._moving=!0,i.Util.cancelAnimFrame(this._animRequest),this._animRequest=i.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget))}},_updatePosition:function(){this.fire("predrag"),i.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(t){if(this._simulateClick&&t.changedTouches){var e=t.changedTouches[0],s=e.target,n=this._newPos&&this._newPos.distanceTo(this._startPos)||0;"a"===s.tagName.toLowerCase()&&i.DomUtil.removeClass(s,"leaflet-active"),n<i.Draggable.TAP_TOLERANCE&&this._simulateEvent("click",e)}i.Browser.touch||(i.DomUtil.enableTextSelection(),this._restoreCursor()),i.DomEvent.off(document,i.Draggable.MOVE,this._onMove),i.DomEvent.off(document,i.Draggable.END,this._onUp),this._moved&&(i.Util.cancelAnimFrame(this._animRequest),this.fire("dragend")),this._moving=!1},_setMovingCursor:function(){i.DomUtil.addClass(document.body,"leaflet-dragging")},_restoreCursor:function(){i.DomUtil.removeClass(document.body,"leaflet-dragging")},_simulateEvent:function(e,i){var s=document.createEvent("MouseEvents");s.initMouseEvent(e,!0,!0,t,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),i.target.dispatchEvent(s)}}),i.Handler=i.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),i.Map.mergeOptions({dragging:!0,inertia:!i.Browser.android23,inertiaDeceleration:3e3,inertiaMaxSpeed:1500,inertiaThreshold:i.Browser.touch?32:14,worldCopyJump:!0}),i.Map.Drag=i.Handler.extend({addHooks:function(){if(!this._draggable){this._draggable=new i.Draggable(this._map._mapPane,this._map._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);var t=this._map.options;t.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),this._map.on("viewreset",this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t.fire("movestart").fire("dragstart"),t._panTransition&&t._panTransition._onTransitionEnd(!0),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint(new i.LatLng(0,0));this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project(new i.LatLng(0,180)).x},_onPreDrag:function(){var t=(this._map,this._worldWidth),e=Math.round(t/2),i=this._initialWorldOffset,s=this._draggable._newPos.x,n=(s-e+i)%t+e-i,o=(s+e+i)%t-e-i,r=Math.abs(n+i)<Math.abs(o+i)?n:o;this._draggable._newPos.x=r},_onDragEnd:function(){var t=this._map,s=t.options,n=+new Date-this._lastTime,o=!s.inertia||n>s.inertiaThreshold||this._positions[0]===e;if(o)t.fire("moveend");else{var r=this._lastPos.subtract(this._positions[0]),a=(this._lastTime+n-this._times[0])/1e3,l=r.multiplyBy(.58/a),h=l.distanceTo(new i.Point(0,0)),c=Math.min(s.inertiaMaxSpeed,h),d=l.multiplyBy(c/h),u=c/s.inertiaDeceleration,p=d.multiplyBy(-u/2).round(),f={duration:u,easing:"ease-out"};i.Util.requestAnimFrame(i.Util.bind(function(){this._map.panBy(p,f)},this))}t.fire("dragend"),s.maxBounds&&i.Util.requestAnimFrame(this._panInsideMaxBounds,t,!0,t._container)},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)}}),i.Map.addInitHook("addHandler","dragging",i.Map.Drag),i.Map.mergeOptions({doubleClickZoom:!0}),i.Map.DoubleClickZoom=i.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick)},_onDoubleClick:function(t){this.setView(t.latlng,this._zoom+1)}}),i.Map.addInitHook("addHandler","doubleClickZoom",i.Map.DoubleClickZoom),i.Map.mergeOptions({scrollWheelZoom:!i.Browser.touch}),i.Map.ScrollWheelZoom=i.Handler.extend({addHooks:function(){i.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){i.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll)},_onWheelScroll:function(t){var e=i.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),clearTimeout(this._timer),this._timer=setTimeout(i.Util.bind(this._performZoom,this),40),i.DomEvent.preventDefault(t)},_performZoom:function(){var t=this._map,e=Math.round(this._delta),i=t.getZoom();if(e=Math.max(Math.min(e,4),-4),e=t._limitZoom(i+e)-i,this._delta=0,e){var s=i+e,n=this._getCenterForScrollWheelZoom(this._lastMousePos,s);t.setView(n,s)}},_getCenterForScrollWheelZoom:function(t,e){var i=this._map,s=i.getZoomScale(e),n=i.getSize().divideBy(2),o=t.subtract(n).multiplyBy(1-1/s),r=i._getTopLeftPoint().add(n).add(o);return i.unproject(r)}}),i.Map.addInitHook("addHandler","scrollWheelZoom",i.Map.ScrollWheelZoom),i.Util.extend(i.DomEvent,{addDoubleTapListener:function(t,e,i){function s(t){if(1===t.touches.length){var e=Date.now(),i=e-(o||e);r=t.touches[0],a=i>0&&l>=i,o=e}}function n(){a&&(r.type="dblclick",e(r),o=null)}var o,r,a=!1,l=250,h="_leaflet_",c="touchstart",d="touchend";return t[h+c+i]=s,t[h+d+i]=n,t.addEventListener(c,s,!1),t.addEventListener(d,n,!1),this},removeDoubleTapListener:function(t,e){var i="_leaflet_";return t.removeEventListener(t,t[i+"touchstart"+e],!1),t.removeEventListener(t,t[i+"touchend"+e],!1),this}}),i.Map.mergeOptions({touchZoom:i.Browser.touch&&!i.Browser.android23}),i.Map.TouchZoom=i.Handler.extend({addHooks:function(){i.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){i.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var s=e.mouseEventToLayerPoint(t.touches[0]),n=e.mouseEventToLayerPoint(t.touches[1]),o=e._getCenterLayerPoint();this._startCenter=s.add(n).divideBy(2,!0),this._startDist=s.distanceTo(n),this._moved=!1,this._zooming=!0,this._centerOffset=o.subtract(this._startCenter),i.DomEvent.on(document,"touchmove",this._onTouchMove,this).on(document,"touchend",this._onTouchEnd,this),i.DomEvent.preventDefault(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length){var e=this._map,s=e.mouseEventToLayerPoint(t.touches[0]),n=e.mouseEventToLayerPoint(t.touches[1]);this._scale=s.distanceTo(n)/this._startDist,this._delta=s.add(n).divideBy(2,!0).subtract(this._startCenter),1!==this._scale&&(this._moved||(i.DomUtil.addClass(e._mapPane,"leaflet-zoom-anim leaflet-touching"),e.fire("movestart").fire("zoomstart")._prepareTileBg(),this._moved=!0),i.Util.cancelAnimFrame(this._animRequest),this._animRequest=i.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),i.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),s=t.layerPointToLatLng(e);t.fire("zoomanim",{center:s,zoom:t.getScaleZoom(this._scale)}),t._tileBg.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(this._delta)+" "+i.DomUtil.getScaleString(this._scale,this._startCenter)},_onTouchEnd:function(){if(this._moved&&this._zooming){var t=this._map;this._zooming=!1,i.DomUtil.removeClass(t._mapPane,"leaflet-touching"),i.DomEvent.off(document,"touchmove",this._onTouchMove).off(document,"touchend",this._onTouchEnd);var e=this._getScaleOrigin(),s=t.layerPointToLatLng(e),n=t.getZoom(),o=t.getScaleZoom(this._scale)-n,r=o>0?Math.ceil(o):Math.floor(o),a=t._limitZoom(n+r);t.fire("zoomanim",{center:s,zoom:a}),t._runAnimation(s,a,t.getZoomScale(a)/this._scale,e,!0)}},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),i.Map.addInitHook("addHandler","touchZoom",i.Map.TouchZoom),i.Map.mergeOptions({boxZoom:!0}),i.Map.BoxZoom=i.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){i.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){i.DomEvent.off(this._container,"mousedown",this._onMouseDown)},_onMouseDown:function(t){return!t.shiftKey||1!==t.which&&1!==t.button?!1:(i.DomUtil.disableTextSelection(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),this._box=i.DomUtil.create("div","leaflet-zoom-box",this._pane),i.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",i.DomEvent.on(document,"mousemove",this._onMouseMove,this).on(document,"mouseup",this._onMouseUp,this).preventDefault(t),void this._map.fire("boxzoomstart"))},_onMouseMove:function(t){var e=this._startLayerPoint,s=this._box,n=this._map.mouseEventToLayerPoint(t),o=n.subtract(e),r=new i.Point(Math.min(n.x,e.x),Math.min(n.y,e.y));i.DomUtil.setPosition(s,r),s.style.width=Math.abs(o.x)-4+"px",s.style.height=Math.abs(o.y)-4+"px"},_onMouseUp:function(t){this._pane.removeChild(this._box),this._container.style.cursor="",i.DomUtil.enableTextSelection(),i.DomEvent.off(document,"mousemove",this._onMouseMove).off(document,"mouseup",this._onMouseUp);var e=this._map,s=e.mouseEventToLayerPoint(t),n=new i.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(s));e.fitBounds(n),e.fire("boxzoomend",{boxZoomBounds:n})}}),i.Map.addInitHook("addHandler","boxZoom",i.Map.BoxZoom),i.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),i.Map.Keyboard=i.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61],zoomOut:[189,109]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)
},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),i.DomEvent.addListener(t,"focus",this._onFocus,this).addListener(t,"blur",this._onBlur,this).addListener(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;i.DomEvent.removeListener(t,"focus",this._onFocus,this).removeListener(t,"blur",this._onBlur,this).removeListener(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){this._focused||this._map._container.focus()},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,i,s=this._panKeys={},n=this.keyCodes;for(e=0,i=n.left.length;i>e;e++)s[n.left[e]]=[-1*t,0];for(e=0,i=n.right.length;i>e;e++)s[n.right[e]]=[t,0];for(e=0,i=n.down.length;i>e;e++)s[n.down[e]]=[0,t];for(e=0,i=n.up.length;i>e;e++)s[n.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,i,s=this._zoomKeys={},n=this.keyCodes;for(e=0,i=n.zoomIn.length;i>e;e++)s[n.zoomIn[e]]=t;for(e=0,i=n.zoomOut.length;i>e;e++)s[n.zoomOut[e]]=-t},_addHooks:function(){i.DomEvent.addListener(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){i.DomEvent.removeListener(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode;if(this._panKeys.hasOwnProperty(e))this._map.panBy(this._panKeys[e]);else{if(!this._zoomKeys.hasOwnProperty(e))return;this._map.setZoom(this._map.getZoom()+this._zoomKeys[e])}i.DomEvent.stop(t)}}),i.Map.addInitHook("addHandler","keyboard",i.Map.Keyboard),i.Handler.MarkerDrag=i.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new i.Draggable(t,t).on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this)),this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=i.DomUtil.getPosition(this._marker._icon);this._marker._shadow&&i.DomUtil.setPosition(this._marker._shadow,t),this._marker._latlng=this._marker._map.layerPointToLatLng(t),this._marker.fire("move").fire("drag")},_onDragEnd:function(){this._marker.fire("moveend").fire("dragend")}}),i.Handler.PolyEdit=i.Handler.extend({options:{icon:new i.DivIcon({iconSize:new i.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"})},initialize:function(t,e){this._poly=t,i.Util.setOptions(this,e)},addHooks:function(){this._poly._map&&(this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){this._poly._map&&(this._poly._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new i.LayerGroup),this._markers=[];var t,e,s,n,o=this._poly._latlngs;for(t=0,s=o.length;s>t;t++)n=this._createMarker(o[t],t),n.on("click",this._onMarkerClick,this),this._markers.push(n);var r,a;for(t=0,e=s-1;s>t;e=t++)(0!==t||i.Polygon&&this._poly instanceof i.Polygon)&&(r=this._markers[e],a=this._markers[t],this._createMiddleMarker(r,a),this._updatePrevNext(r,a))},_createMarker:function(t,e){var s=new i.Marker(t,{draggable:!0,icon:this.options.icon});return s._origLatLng=t,s._index=e,s.on("drag",this._onMarkerDrag,this),s.on("dragend",this._fireEdit,this),this._markerGroup.addLayer(s),s},_fireEdit:function(){this._poly.fire("edit")},_onMarkerDrag:function(t){var e=t.target;i.Util.extend(e._origLatLng,e._latlng),e._middleLeft&&e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&&e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),this._poly.redraw()},_onMarkerClick:function(t){if(!(this._poly._latlngs.length<3)){var e=t.target,i=e._index;e._prev&&e._next&&(this._createMiddleMarker(e._prev,e._next),this._updatePrevNext(e._prev,e._next)),this._markerGroup.removeLayer(e),e._middleLeft&&this._markerGroup.removeLayer(e._middleLeft),e._middleRight&&this._markerGroup.removeLayer(e._middleRight),this._markers.splice(i,1),this._poly.spliceLatLngs(i,1),this._updateIndexes(i,-1),this._poly.fire("edit")}},_updateIndexes:function(t,e){this._markerGroup.eachLayer(function(i){i._index>t&&(i._index+=e)})},_createMiddleMarker:function(t,e){var i,s,n,o=this._getMiddleLatLng(t,e),r=this._createMarker(o);r.setOpacity(.6),t._middleRight=e._middleLeft=r,s=function(){var s=e._index;r._index=s,r.off("click",i).on("click",this._onMarkerClick,this),o.lat=r.getLatLng().lat,o.lng=r.getLatLng().lng,this._poly.spliceLatLngs(s,0,o),this._markers.splice(s,0,r),r.setOpacity(1),this._updateIndexes(s,1),e._index++,this._updatePrevNext(t,r),this._updatePrevNext(r,e)},n=function(){r.off("dragstart",s,this),r.off("dragend",n,this),this._createMiddleMarker(t,r),this._createMiddleMarker(r,e)},i=function(){s.call(this),n.call(this),this._poly.fire("edit")},r.on("click",i,this).on("dragstart",s,this).on("dragend",n,this),this._markerGroup.addLayer(r)},_updatePrevNext:function(t,e){t._next=e,e._prev=t},_getMiddleLatLng:function(t,e){var i=this._poly._map,s=i.latLngToLayerPoint(t.getLatLng()),n=i.latLngToLayerPoint(e.getLatLng());return i.layerPointToLatLng(s._add(n).divideBy(2))}}),i.Control=i.Class.extend({options:{position:"topright"},initialize:function(t){i.Util.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),s=this.getPosition(),n=t._controlCorners[s];return i.DomUtil.addClass(e,"leaflet-control"),-1!==s.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},removeFrom:function(t){var e=this.getPosition(),i=t._controlCorners[e];return i.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this}}),i.control=function(t){return new i.Control(t)},i.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){function t(t,o){var r=s+t+" "+s+o;e[t+o]=i.DomUtil.create("div",r,n)}var e=this._controlCorners={},s="leaflet-",n=this._controlContainer=i.DomUtil.create("div",s+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")}}),i.Control.Zoom=i.Control.extend({options:{position:"topleft"},onAdd:function(t){var e="leaflet-control-zoom",s=i.DomUtil.create("div",e);return this._createButton("Zoom in",e+"-in",s,t.zoomIn,t),this._createButton("Zoom out",e+"-out",s,t.zoomOut,t),s},_createButton:function(t,e,s,n,o){var r=i.DomUtil.create("a",e,s);return r.href="#",r.title=t,i.DomEvent.on(r,"click",i.DomEvent.stopPropagation).on(r,"click",i.DomEvent.preventDefault).on(r,"click",n,o).on(r,"dblclick",i.DomEvent.stopPropagation),r}}),i.Map.mergeOptions({zoomControl:!0}),i.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new i.Control.Zoom,this.addControl(this.zoomControl))}),i.control.zoom=function(t){return new i.Control.Zoom(t)},i.Control.Attribution=i.Control.extend({options:{position:"bottomright",prefix:'Powered by <a href="http://leaflet.cloudmade.com">Leaflet</a>'},initialize:function(t){i.Util.setOptions(this,t),this._attributions={}},onAdd:function(t){return this._container=i.DomUtil.create("div","leaflet-control-attribution"),i.DomEvent.disableClickPropagation(this._container),t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]--,this._update(),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions.hasOwnProperty(e)&&this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" &#8212; ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),i.Map.mergeOptions({attributionControl:!0}),i.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new i.Control.Attribution).addTo(this))}),i.control.attribution=function(t){return new i.Control.Attribution(t)},i.Control.Scale=i.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e="leaflet-control-scale",s=i.DomUtil.create("div",e),n=this.options;return this._addScales(n,e,s),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),this._update(),s},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,s){t.metric&&(this._mScale=i.DomUtil.create("div",e+"-line",s)),t.imperial&&(this._iScale=i.DomUtil.create("div",e+"-line",s))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,i=6378137*Math.PI*Math.cos(e*Math.PI/180),s=i*(t.getNorthEast().lng-t.getSouthWest().lng)/180,n=this._map.getSize(),o=this.options,r=0;n.x>0&&(r=s*(o.maxWidth/n.x)),this._updateScales(o,r)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=1e3>e?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,i,s,n=3.2808399*t,o=this._iScale;n>5280?(e=n/5280,i=this._getRoundNum(e),o.style.width=this._getScaleWidth(i/e)+"px",o.innerHTML=i+" mi"):(s=this._getRoundNum(n),o.style.width=this._getScaleWidth(s/n)+"px",o.innerHTML=s+" ft")},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),i.control.scale=function(t){return new i.Control.Scale(t)},i.Control.Layers=i.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,s){i.Util.setOptions(this,s),this._layers={},this._lastZIndex=0;for(var n in t)t.hasOwnProperty(n)&&this._addLayer(t[n],n);for(n in e)e.hasOwnProperty(n)&&this._addLayer(e[n],n,!0)},onAdd:function(){return this._initLayout(),this._update(),this._container},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=i.Util.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=i.DomUtil.create("div",t);i.Browser.touch?i.DomEvent.on(e,"click",i.DomEvent.stopPropagation):i.DomEvent.disableClickPropagation(e);var s=this._form=i.DomUtil.create("form",t+"-list");if(this.options.collapsed){i.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var n=this._layersLink=i.DomUtil.create("a",t+"-toggle",e);n.href="#",n.title="Layers",i.Browser.touch?i.DomEvent.on(n,"click",i.DomEvent.stopPropagation).on(n,"click",i.DomEvent.preventDefault).on(n,"click",this._expand,this):i.DomEvent.on(n,"focus",this._expand,this),this._map.on("movestart",this._collapse,this)}else this._expand();this._baseLayersList=i.DomUtil.create("div",t+"-base",s),this._separator=i.DomUtil.create("div",t+"-separator",s),this._overlaysList=i.DomUtil.create("div",t+"-overlays",s),e.appendChild(s)},_addLayer:function(t,e,s){var n=i.Util.stamp(t);this._layers[n]={layer:t,name:e,overlay:s},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t=!1,e=!1;for(var i in this._layers)if(this._layers.hasOwnProperty(i)){var s=this._layers[i];this._addItem(s),e=e||s.overlay,t=t||!s.overlay}this._separator.style.display=e&&t?"":"none"}},_createRadioElement:function(t,e){var i='<input type="radio" name="'+t+'"';e&&(i+=' checked="checked"'),i+="/>";var s=document.createElement("div");return s.innerHTML=i,s.firstChild},_addItem:function(t){var e,s=document.createElement("label"),n=this._map.hasLayer(t.layer);t.overlay?(e=document.createElement("input"),e.type="checkbox",e.defaultChecked=n):e=this._createRadioElement("leaflet-base-layers",n),e.layerId=i.Util.stamp(t.layer),i.DomEvent.on(e,"click",this._onInputClick,this);var o=document.createTextNode(" "+t.name);s.appendChild(e),s.appendChild(o);var r=t.overlay?this._overlaysList:this._baseLayersList;r.appendChild(s)},_onInputClick:function(){var t,e,i,s=this._form.getElementsByTagName("input"),n=s.length;for(t=0;n>t;t++)e=s[t],i=this._layers[e.layerId],e.checked?this._map.addLayer(i.layer,!i.overlay):this._map.removeLayer(i.layer)},_expand:function(){i.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),i.control.layers=function(t,e,s){return new i.Control.Layers(t,e,s)},i.Transition=i.Class.extend({includes:i.Mixin.Events,statics:{CUSTOM_PROPS_SETTERS:{position:i.DomUtil.setPosition},implemented:function(){return i.Transition.NATIVE||i.Transition.TIMER}},options:{easing:"ease",duration:.5},_setProperty:function(t,e){var s=i.Transition.CUSTOM_PROPS_SETTERS;t in s?s[t](this._el,e):this._el.style[t]=e}}),i.Transition=i.Transition.extend({statics:function(){var t=i.DomUtil.TRANSITION,e="webkitTransition"===t||"OTransition"===t?t+"End":"transitionend";return{NATIVE:!!t,TRANSITION:t,PROPERTY:t+"Property",DURATION:t+"Duration",EASING:t+"TimingFunction",END:e,CUSTOM_PROPS_PROPERTIES:{position:i.Browser.any3d?i.DomUtil.TRANSFORM:"top, left"}}}(),options:{fakeStepInterval:100},initialize:function(t,e){this._el=t,i.Util.setOptions(this,e),i.DomEvent.on(t,i.Transition.END,this._onTransitionEnd,this),this._onFakeStep=i.Util.bind(this._onFakeStep,this)},run:function(t){var e,s=[],n=i.Transition.CUSTOM_PROPS_PROPERTIES;for(e in t)t.hasOwnProperty(e)&&(e=n[e]?n[e]:e,e=this._dasherize(e),s.push(e));this._el.style[i.Transition.DURATION]=this.options.duration+"s",this._el.style[i.Transition.EASING]=this.options.easing,this._el.style[i.Transition.PROPERTY]="all";for(e in t)t.hasOwnProperty(e)&&this._setProperty(e,t[e]);i.Util.falseFn(this._el.offsetWidth),this._inProgress=!0,i.Browser.mobileWebkit&&(this.backupEventFire=setTimeout(i.Util.bind(this._onBackupFireEnd,this),1.2*this.options.duration*1e3)),i.Transition.NATIVE?(clearInterval(this._timer),this._timer=setInterval(this._onFakeStep,this.options.fakeStepInterval)):this._onTransitionEnd()},_dasherize:function(){function t(t){return"-"+t.toLowerCase()}var e=/([A-Z])/g;return function(i){return i.replace(e,t)}}(),_onFakeStep:function(){this.fire("step")},_onTransitionEnd:function(t){this._inProgress&&(this._inProgress=!1,clearInterval(this._timer),this._el.style[i.Transition.TRANSITION]="",clearTimeout(this.backupEventFire),delete this.backupEventFire,this.fire("step"),t&&t.type&&this.fire("end"))},_onBackupFireEnd:function(){var t=document.createEvent("Event");t.initEvent(i.Transition.END,!0,!1),this._el.dispatchEvent(t)}}),i.Transition=i.Transition.NATIVE?i.Transition:i.Transition.extend({statics:{getTime:Date.now||function(){return+new Date},TIMER:!0,EASINGS:{linear:function(t){return t},"ease-out":function(t){return t*(2-t)}},CUSTOM_PROPS_GETTERS:{position:i.DomUtil.getPosition},UNIT_RE:/^[\d\.]+(\D*)$/},options:{fps:50},initialize:function(t,e){this._el=t,i.Util.extend(this.options,e),this._easing=i.Transition.EASINGS[this.options.easing]||i.Transition.EASINGS["ease-out"],this._step=i.Util.bind(this._step,this),this._interval=Math.round(1e3/this.options.fps)},run:function(t){this._props={};var e=i.Transition.CUSTOM_PROPS_GETTERS,s=i.Transition.UNIT_RE;this.fire("start");for(var n in t)if(t.hasOwnProperty(n)){var o={};if(n in e)o.from=e[n](this._el);else{var r=this._el.style[n].match(s);o.from=parseFloat(r[0]),o.unit=r[1]}o.to=t[n],this._props[n]=o}clearInterval(this._timer),this._timer=setInterval(this._step,this._interval),this._startTime=i.Transition.getTime()},_step:function(){var t=i.Transition.getTime(),e=t-this._startTime,s=1e3*this.options.duration;s>e?this._runFrame(this._easing(e/s)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e,s,n,o=i.Transition.CUSTOM_PROPS_SETTERS;for(e in this._props)this._props.hasOwnProperty(e)&&(s=this._props[e],e in o?(n=s.to.subtract(s.from).multiplyBy(t).add(s.from),o[e](this._el,n)):this._el.style[e]=(s.to-s.from)*t+s.from+s.unit);this.fire("step")},_complete:function(){clearInterval(this._timer),this.fire("end")}}),i.Map.include(i.Transition&&i.Transition.implemented()?{setView:function(t,e,i){e=this._limitZoom(e);var s=this._zoom!==e;if(this._loaded&&!i&&this._layers){var n=s?this._zoomToIfClose&&this._zoomToIfClose(t,e):this._panByIfClose(t);if(n)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){return t=i.point(t),t.x||t.y?(this._panTransition||(this._panTransition=new i.Transition(this._mapPane),this._panTransition.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),i.Util.setOptions(this._panTransition,i.Util.extend({duration:.25},e)),this.fire("movestart"),i.DomUtil.addClass(this._mapPane,"leaflet-pan-anim"),this._panTransition.run({position:i.DomUtil.getPosition(this._mapPane).subtract(t)}),this):this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){i.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_panByIfClose:function(t){var e=this._getCenterOffset(t)._floor();return this._offsetIsWithinView(e)?(this.panBy(e),!0):!1},_offsetIsWithinView:function(t,e){var i=e||1,s=this.getSize();return Math.abs(t.x)<=s.x*i&&Math.abs(t.y)<=s.y*i}}:{}),i.Map.mergeOptions({zoomAnimation:i.DomUtil.TRANSITION&&!i.Browser.android23&&!i.Browser.mobileOpera}),i.DomUtil.TRANSITION&&i.Map.addInitHook(function(){i.DomEvent.on(this._mapPane,i.Transition.END,this._catchTransitionEnd,this)}),i.Map.include(i.DomUtil.TRANSITION?{_zoomToIfClose:function(t,e){if(this._animatingZoom)return!0;if(!this.options.zoomAnimation)return!1;var s=this.getZoomScale(e),n=this._getCenterOffset(t).divideBy(1-1/s);if(!this._offsetIsWithinView(n,1))return!1;i.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this.fire("movestart").fire("zoomstart"),this.fire("zoomanim",{center:t,zoom:e});var o=this._getCenterLayerPoint().add(n);return this._prepareTileBg(),this._runAnimation(t,e,s,o),!0},_catchTransitionEnd:function(){this._animatingZoom&&this._onZoomTransitionEnd()},_runAnimation:function(e,s,n,o,r){this._animateToCenter=e,this._animateToZoom=s,this._animatingZoom=!0;var a=i.DomUtil.TRANSFORM,l=this._tileBg;clearTimeout(this._clearTileBgTimer),(i.Browser.gecko||t.opera)&&(l.style[a]+=" translate(0,0)"),i.Util.falseFn(l.offsetWidth);var h=i.DomUtil.getScaleString(n,o),c=l.style[a];l.style[a]=r?c+" "+h:h+" "+c},_prepareTileBg:function(){var t=this._tilePane,e=this._tileBg;if(e&&this._getLoadedTilesPercentage(e)>.5&&this._getLoadedTilesPercentage(t)<.5)return t.style.visibility="hidden",t.empty=!0,void this._stopLoadingImages(t);e||(e=this._tileBg=this._createPane("leaflet-tile-pane",this._mapPane),e.style.zIndex=1),e.style[i.DomUtil.TRANSFORM]="",e.style.visibility="hidden",e.empty=!0,t.empty=!1,this._tilePane=this._panes.tilePane=e;var s=this._tileBg=t;i.DomUtil.addClass(s,"leaflet-zoom-animated"),this._stopLoadingImages(s)},_getLoadedTilesPercentage:function(t){var e,i,s=t.getElementsByTagName("img"),n=0;for(e=0,i=s.length;i>e;e++)s[e].complete&&n++;return n/i},_stopLoadingImages:function(t){var e,s,n,o=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,s=o.length;s>e;e++)n=o[e],n.complete||(n.onload=i.Util.falseFn,n.onerror=i.Util.falseFn,n.src=i.Util.emptyImageUrl,n.parentNode.removeChild(n))},_onZoomTransitionEnd:function(){this._restoreTileFront(),i.Util.falseFn(this._tileBg.offsetWidth),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),i.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1},_restoreTileFront:function(){this._tilePane.innerHTML="",this._tilePane.style.visibility="",this._tilePane.style.zIndex=2,this._tileBg.style.zIndex=1},_clearTileBg:function(){this._animatingZoom||this.touchZoom._zooming||(this._tileBg.innerHTML="")}}:{}),i.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locationOptions=i.Util.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=i.Util.bind(this._handleGeolocationResponse,this),s=i.Util.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,s,t):navigator.geolocation.getCurrentPosition(e,s,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locationOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=180*t.coords.accuracy/4e7,s=2*e,n=t.coords.latitude,o=t.coords.longitude,r=new i.LatLng(n,o),a=new i.LatLng(n-e,o-s),l=new i.LatLng(n+e,o+s),h=new i.LatLngBounds(a,l),c=this._locationOptions;if(c.setView){var d=Math.min(this.getBoundsZoom(h),c.maxZoom);this.setView(r,d)}this.fire("locationfound",{latlng:r,bounds:h,accuracy:t.coords.accuracy})}})}(this),define("leaflet",function(){}),define("modules/map/map",["jquery","underscore","state","baseview","leaflet"],function(t,e,i,s){"use strict";var n=s.extend({initialize:function(i){i=t.extend(!0,{latitude:0,longitude:0,currentLocationMarker:!0,addMapLabel:!1,mapLabelClass:null,defaultZoom:null,mapUrl:null,mapOptions:{trackResize:!1,scrollWheelZoom:!1,zoomControl:!1,attributionControl:!1}},i),s.prototype.initialize.call(this,i),e.bindAll(this,"_onGetMapTilesSuccess"),this.createMap(i.latitude,i.longitude)},createMap:function(t,e){var i,s=this.$el.data()||{},n=s.attrMapurl||this.options.mapUrl,o=parseFloat(s.latitude)||t,r=parseFloat(s.longitude)||e;n&&(i=parseInt(s.attrZoom,10)||this.options.defaultZoom,"L"===s.attrSize&&(this.options.mapOptions.zoomControl=!0),this.map=this.buildMap(),this.setLocation(o,r,i),this.getMapTiles(n))},buildMap:function(){return this.$mapEl=t('<div class="standard-app-map"></div>'),this.$el.html(this.$mapEl),this.options.addMapLabel&&(this.$mapLabel=this.buildMapLabel(),this.$el.append(this.$mapLabel)),new L.Map(this.$mapEl[0],this.options.mapOptions)},buildMapLabel:function(){var e=t('<span class="standard-app-map-location-label">');return this.options.mapLabelClass&&e.addClass(this.options.mapLabelClass),e},setCurrentLocationMarker:function(t,e){if(this.options.currentLocationMarker){var i=new L.LatLng(t,e);if(this.currentLocationMarker)this.currentLocationMarker.setLatLng(i);else{var s=window.site_static_url,n=L.Icon.extend({options:{iconUrl:s+"/images/modules/maps/marker.png",shadowUrl:s+"/images/modules/maps/marker-shadow.png",iconSize:[25,41],shadowSize:[41,41],iconAnchor:[11,41],shadowAnchor:[11,41]}}),o=new n;this.currentLocationMarker=new L.Marker(i,{icon:o,zIndexOffset:1e3}),this.map.addLayer(this.currentLocationMarker)}}},removeCurrentLocationMarker:function(){this.currentLocationMarker&&(this.map.removeLayer(this.currentLocationMarker),this.currentLocationMarker=null)},setLocation:function(t,e,i){var s=new L.LatLng(t,e);i=i||this.map.getZoom(),this.map.setView(s,i,!0),this.setCurrentLocationMarker(t,e)},getMapTiles:function(t){i.fetchData(t,{dataType:"jsonp"}).done(this._onGetMapTilesSuccess)},_onGetMapTilesSuccess:function(t){var e=L.TileLayer.extend({initialize:function(t){t=t||{},t.minZoom=t.minzoom||0,t.maxZoom=t.maxzoom||22,L.TileLayer.prototype.initialize.call(this,t.tiles[0],t)}});this.tiles=new e(t),this.map.addLayer(this.tiles)},setMapLabel:function(t){this.$mapLabel&&this.$mapLabel.text(t)},destroy:function(t){this.tiles&&(this.map.removeLayer(this.tiles),this.tiles=null),this.$mapLabel&&this.$mapLabel.remove(),this.$mapEl&&this.$mapEl.remove(),this.map=null,s.prototype.destroy.call(this,t)}});return n}),define("modules/sports/sports-tickets",["jquery","underscore","pubsub","baseview"],function(t,e,i,s){"use strict";var n=s.extend({events:{"click .sports-tickets-submit":"triggerOmniture"},triggerOmniture:function(){i.trigger("uotrack","TicketCityModuleExit")},initialize:function(t){s.prototype.initialize.call(this,t),this.$el.width()>=240?this.$(".sports-tickets-sidebar-content").removeClass("sports-tickets-sidebar-content-override"):this.$(".sports-tickets-sidebar-content").addClass("sports-tickets-sidebar-content-override"),window.onresize=function(){this.$(".sports-tickets-sidebar-content").parent().width()>=240?this.$(".sports-tickets-sidebar-content").removeClass("sports-tickets-sidebar-content-override"):this.$(".sports-tickets-sidebar-content").addClass("sports-tickets-sidebar-content-override")}}});return n}),define("modules/travel/travel-experience-promo",["jquery","baseview","ui/dropdown"],function(t,e,i){"use strict";var s=e.extend({initialize:function(t){e.prototype.initialize.call(this,t),this.subviews.dropdown=new i({el:this.$(".tep-list")})}});return s}),define("modules/horoscope",["jquery","underscore","baseview","state","managers/routemanager","form/base-form","form/dropdown"],function(t,e,i,s,n,o,r){"use strict";var a=i.extend({el:".hpm-wrapper",events:{"submit #horo-form":"formSubmit"},initialize:function(t){e.bindAll(this,"monthSelect","daySelect"),i.prototype.initialize.call(this,t),this.dropdownMonth=this.$("#horo-month-select"),this.dropdownDay=this.$("#horo-day-select"),this.selectedMonth=0,this.selectedDay=0,this.errorMessage=this.$("#horo-error"),this.dateAmounts=[31,29,31,30,31,30,31,31,30,31,30,31],this.horoscopeSigns=[{title:"aries",range:{months:[3,4],days:[21,20]}},{title:"taurus",range:{months:[4,5],days:[21,20]}},{title:"gemini",range:{months:[5,6],days:[21,20]}},{title:"cancer",range:{months:[6,7],days:[21,22]}},{title:"leo",range:{months:[7,8],days:[23,23]}},{title:"virgo",range:{months:[8,9],days:[24,22]}},{title:"libra",range:{months:[9,10],days:[23,23]}},{title:"scorpio",range:{months:[10,11],days:[24,22]}},{title:"sagittarius",range:{months:[11,12],days:[23,21]}},{title:"capricorn",range:{months:[12,1],days:[22,19]}},{title:"aquarius",range:{months:[1,2],days:[20,18]}},{title:"pisces",range:{months:[2,3],days:[19,20]}}],this._setupForm()},_setupForm:function(){this.subviews.monthDropdown=new r({el:this.dropdownMonth,onSelect:this.monthSelect}),this.subviews.dayDropdown=new r({el:this.dropdownDay,onSelect:this.daySelect})},formSubmit:function(t){t.preventDefault(),0!==this.selectedMonth&&0!==this.selectedDay?this.dateAmounts[this.selectedMonth-1]>=this.selectedDay?this._determineSign(this.selectedMonth,this.selectedDay):this.errorMessage.removeClass("hidden"):this.errorMessage.removeClass("hidden")},monthSelect:function(t){this.selectedMonth=t},daySelect:function(t){this.selectedDay=t},_determineSign:function(e,i){this.errorMessage.addClass("hidden");var s;t.each(this.horoscopeSigns,function(){return e==this.range.months[0]&&i>=this.range.days[0]||e==this.range.months[1]&&i<=this.range.days[1]?(s=this.title,!1):void 0}),this.subviews.dayDropdown.reset(),this.subviews.monthDropdown.reset(),n.goTo("/horoscope/"+s+"/")}});return a}),define("modules/interactives/timeline",["jquery","underscore","pubsub","utils","baseview","modules/interactives/interactive-templates","libs/jqueryui/draggable","modules/global/brightcove-video","touchswipe"],function(t,e,i,s,n,o){var r=n.extend({events:{"click .interactive-timeline-marker":"goToMarker","click .slide-nav.prev, .slide-nav.next":"renderArrowClick"},initialize:function(t){n.prototype.initialize.call(this,t),e.bindAll(this,"snapToMarker"),this.subviews.template=new o({el:this.$el,interactiveType:"timeline",isFramed:t.isFramed,standAlone:t.standAlone}),this.$leftArrow=this.subviews.template.$leftArrow,this.$rightArrow=this.subviews.template.$rightArrow,this.$slideContainer=this.subviews.template.$slideContainer,this.$slides=this.subviews.template.$slides,this.$viewport=this.subviews.template.$viewport,this.$timeslider=this.$(".interactive-timeline-timeslider"),this.$timesliderBelt=this.$timeslider.find(".interactive-timeline-belt"),this.$timesliderBuckle=this.$timeslider.find(".interactive-timeline-buckle"),this.$timesliderLabelContainer=this.$timeslider.find(".interactive-timeline-labels"),this.$timesliderLabels=this.$timesliderLabelContainer.find(".interactive-timeline-label"),this.$contentBox=this.$slideContainer.find(".timeline-slide-content"),this.$gridLines=this.$viewport.find(".grid-line"),this.arrEventPositions=[],this.maxSlides=this.subviews.template.maxSlides,this.arrayPanelMax=850,this.numPanelMinLefts=6,this.numMarkerWidth=9,this.strDateBegin="",this.strDateEnd="",this.currentSlideIndex=this.subviews.template.currentSlideIndex;var i={containment:".buckle-box",cursor:"move",axis:"x",stop:this.snapToMarker};if(Modernizr.touch){i.delay=200,this.$(".stage").swipe({self:this,swipe:function(t,e,i,s,n,o){"right"===e||"down"===e?o.self.previousSlide():o.self.nextSlide()}});var s=this;require(["touchpunch"],function(){s.destroyed||s.setup(i)})}else this.setup(i)},destroy:function(){this.$timesliderBuckle.draggable("destroy"),n.prototype.destroy.apply(this,arguments)},setup:function(e){var i="",s=this.$viewport.data()||{},n=this;this.strDateBegin=s.graphstart,this.strDateEnd=s.graphend,this.$slides.each(function(e){var s=t(this).find(".timeline-slide-content").data().tlpercent,o=parseInt(n.arrayPanelMax,10),r=Math.round(s*o+27);n.arrEventPositions[e]=r,i+='<div class="interactive-timeline-marker" style="left:'+r+'px;"></div>'}),this.$timesliderBelt.append(i),this.maxEvents=this.arrEventPositions.length,this.setUpLabels(),this.goTo(0),this.$timesliderBuckle.draggable(e)},setUpLabels:function(){var e=this.strDateBegin,i=this.strDateEnd,s=i-e,n=this,o=n.arrayPanelMax;this.$timesliderLabels.each(function(){var i=t(this).data().labelms,n=Math.round((i-e)/s*o);t(this).css("left",n)}),this.$gridLines.each(function(e){var i=n.$timesliderLabels.eq(e).position().left+33+"px";t(this).css("left",i)}),this.$timesliderLabels.find(".interactive-timeline-time").fadeIn("slow")},goToMarker:function(t){var e=this.$timesliderBelt.children(".interactive-timeline-marker").index(t.currentTarget);this.goTo(e),this.options.isFramed!==!0&&this.subviews.template.trackPageView()},renderArrowClick:function(e){t(e.currentTarget).is(this.$leftArrow)?this.previousSlide():this.nextSlide(),this.options.isFramed!==!0&&this.subviews.template.trackPageView()},goTo:function(t){var e;this.currentSlideIndex=t;var i=parseInt(this.$contentBox.eq(t).width(),10),s=this.arrayPanelMax-i;this.$timesliderBuckle.css("left",(this.arrEventPositions[t]-19).toString()+"px"),e=Math.round(this.arrEventPositions[t]+this.numMarkerWidth/2-i/2),e>s?e=s:e<this.numPanelMinLefts&&(e=this.numPanelMinLefts),this.$slides.eq(t).find(".indicator").css("left",this.arrEventPositions[t]-8-e.toString()+"px"),this.$slides.removeClass("active").eq(t).css("left",e.toString()+"px").addClass("active"),this.$contentBox.find(".text a").attr("target","_blank"),this.subviews.template.goTo(t),this.currentSlideIndex=t
},previousSlide:function(){this.goTo(Math.max(this.currentSlideIndex-1,0))},nextSlide:function(){this.goTo(Math.min(this.currentSlideIndex+1,this.maxSlides-1))},snapToMarker:function(e){var i,s,n=850,o=t(e.target),r=parseInt(o.css("left"),10);for(s=0;s<this.arrEventPositions.length;s++)Math.abs(r+19-this.arrEventPositions[s])<n&&(i=s,n=Math.abs(r+19-this.arrEventPositions[s]));this.options.isFramed!==!0&&this.subviews.template.trackPageView(),this.goTo(i)}});return r}),define("modules/stories/oembed",["jquery","baseview","utils"],function(t,e,i){var s=e.extend({initialize:function(t){"rich"===this.$el.attr("data-oembed-type")&&"twitter"===this.$el.attr("data-oembed-provider")&&i.loadScript("http://platform.twitter.com/widgets.js","twttr",function(t){t.widgets.load()}),e.prototype.initialize.call(this,t)}});return s}),define("modules/stories/utility-bar-module-print",["jquery","underscore","backbone","pubsub","baseview"],function(t,e,i,s,n){var o=n.extend({initialize:function(t){n.prototype.initialize.call(this,t)},open:function(){s.trigger("uotrack","UtilityBarPrint"),window.print(),this.destroy()},close:function(){this.destroy()},destroy:function(t){n.prototype.destroy.call(this,t),this.options.onDestroy&&this.options.onDestroy(this)}});return o}),define("modules/videos/video-gallery",["jquery","underscore","baseview","pubsub","utils","state","modules/carousel/gallery","modules/videos/brightcove-video"],function(t,e,i,s,n,o,r,a){"use strict";var l=i.extend({events:{"click .carousel-prev":"onClickPrevArrow","click .carousel-next":"onClickNextArrow"},initialize:function(o){o=t.extend({viewportSelector:".gallery-viewport",slidesContainerSelector:".gallery-slides",slidesSelector:".gallery-slide"},o),e.bindAll(this,"_transitionSlides","_getOnStatusChangeMethod","_getOnClickPlayVideoMethod"),this.$viewport=this.$(o.viewportSelector),this.$slidesContainer=this.$viewport.find(o.slidesContainerSelector),this.$slides=this.$slidesContainer.find(o.slidesSelector),this.$arrows=this.$(".carousel-prev, .carousel-next");var a=t.extend(o,{animations:{useCSSTransitions:!1}});i.prototype.initialize.call(this,a),this.subviews.gallery=new r({el:this.$el,slideTransition:200,ads:!1,index:0,lookAheadAmount:3,transitionSlides:this._transitionSlides}),this.goTo(0).done(e.bind(function(){var t=n.getNested(this.getPlayerSubview(0),"player","autoplay");(void 0===t||t)&&(this.startVideo(0),s.trigger("uotrack","videocarousel|nextauto"))},this))},onVideoStatusChange:function(t,i){if("mediaComplete"===t.type){var n=i+1,o=this.$slides.length-1;o>=n&&this.goTo(n).done(e.bind(function(){this.startVideo(n),s.trigger("uotrack","videocarousel|nextauto")},this))}this.getActiveSlideIndex()===i||"mediaBegin"!==t.type&&"mediaPlay"!==t.type||this.enterBackgroundState(i)},onClickPrevArrow:function(t){t.preventDefault(),this.goTo(this.getActiveSlideIndex()-1).done(function(){s.trigger("uotrack","videocarousel|prev")})},onClickNextArrow:function(t){t.preventDefault();var e=this.getActiveSlideIndex()+1;this.goTo(e).done(function(){s.trigger("uotrack","videocarousel|next")})},startVideo:function(t){var i=this.getPlayerSubview(t);i&&(i.hideStill(),i.loadPlayer().then(e.bind(function(t){var e=i.getVideoData();e&&e.brightcove_id&&t.loadVideoByID(e.brightcove_id)},this)))},enterBackgroundState:function(t){var e=this.getPlayerSubview(t);e&&e.reset()},goTo:function(t){var i=this.getActiveSlideIndex();return this.updateArrows(t),this._activeSlide=t,this.subviews.gallery.goToSlide(t).done(e.bind(function(){var e=this.subviews["video"+t],s=this.$slides.eq(t).find(".ui-video");!e&&void 0!==t&&s.length&&(this.subviews["video"+t]=new a({el:s[0],onStatusChange:this._getOnStatusChangeMethod(t),onClickPlay:this._getOnClickPlayVideoMethod(t),autoPlay:!1})),void 0!==i&&this.enterBackgroundState(i)},this))},_transitionSlides:function(t){var e=this.$viewport.outerWidth(),i=e*t*-1,s=this.$slidesContainer;return this.animate(s,"left",i+"px",250,"easeInOutQuad")},getPlayerSubview:function(t){return this.subviews["video"+t]},_getOnClickPlayVideoMethod:function(t){return e.bind(function(e){this.onClickPlayVideo(e,t)},this)},onClickPlayVideo:function(t,e){this.startVideo(e)},_getOnStatusChangeMethod:function(t){return e.bind(function(e){this.onVideoStatusChange(e,t)},this)},getActiveSlideIndex:function(){return this._activeSlide},updateArrows:function(t){var e;this.$slides.length<=1||(this.$arrows.addClass("gallery-nav-active"),0===t?e="prev":t===this.$slides.length-1&&(e="next"),this.$arrows.filter(".carousel-"+e).removeClass("gallery-nav-active"))}});return l}),define("modules/fronts/super-hero",["jquery","underscore","baseview","state","managers/routemanager"],function(t,e,i,s,n){var o=i.extend({el:".super-hero-module-wrapper",events:{"click .super-hero":"open"},open:function(e){if("a"!=t(e.target).prop("tagName").toLowerCase()){var i=t(e.currentTarget);n.goTo(i.find(".hero-story > h1 > a").attr("href"))}}});return o}),define("modules/travel/travel-experience-featured",["jquery","underscore","baseview","state","utils","ui/generic-paginator"],function(t,e,i,s,n,o){var r=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer","click .travel-experience-featured-carousel-nav":"step"},initialize:function(s){s=t.extend({transition:{interval:15e3}},s),e.bindAll(this,"automate","goTo","step","toggleArrows"),this.subviews={},this.$moveMe=this.$(".travel-experienced-featured-wrapper"),this.$slides=this.$(".travel-experience-featured-link"),this.$navPrev=this.$(".travel-experience-featured-carousel-prev"),this.$navNext=this.$(".travel-experience-featured-carousel-next"),this.$viewport=this.$moveMe.parent(),this.indexActive=this.$moveMe.data("active")||0,this.$moveMe.width(this.$moveMe.width()*this.$moveMe.children().length),this.subviews.paginator=new o({el:this.$(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),this.toggleArrows(),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(t){this.stoptimer(),i.prototype.destroy.call(this,t)},goTo:function(t){var e=this.$viewport.outerWidth(),i=e*t;this.$moveMe.data("active",t),this.indexActive=t,this.animate(this.$moveMe,"left","-"+(i+1)+"px",450,"ease-in-out"),this.toggleArrows()},step:function(e){t(e.currentTarget).hasClass("prev")?this.subviews.paginator.goToPrevPage(!0):this.subviews.paginator.goToNextPage(!0)},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},toggleArrows:function(){this.$navPrev.fadeIn(),this.$navNext.fadeIn(),"0"==this.indexActive&&this.$navPrev.fadeOut(),this.indexActive==this.$slides.length-1&&this.$navNext.fadeOut()}});return r}),define("modules/book-reviews/booklist",["jquery","underscore","baseview","state","managers/routemanager","form/base-form","ui/dropdown"],function(t,e,i,s,n,o,r){"use strict";var a=i.extend({events:{"submit #ListFilter":"submitBooklistSearchForm"},initialize:function(s){i.prototype.initialize.call(this,s);var n=this._getMostRecentWeek();this.$searchForm=this.$("#ListFilter"),this.$searchTypes=this.$('input[name="search_type"]'),this.$searchField=this.$("#books-list-search"),this.$filterFields=this.$('select[name="sort"], select[name="genreId"], select[name="classId"]',this.$searchForm),this.$weekFilter=this.$("#booklist-datepicker"),this.searchBase=this.$searchForm.attr("action"),this.booklistBaseUrl="/life/books/best-selling/",this.subviews.baseform=new o({el:this.$("#ListFilter"),formOptions:[{el:this.$("#booklist-sortby"),onSelect:e.bind(this.filterBooklist,this)},{el:this.$("#booklist-classpicker"),onSelect:e.bind(this.filterBooklist,this)},{el:this.$("#booklist-genrepicker"),onSelect:e.bind(this.filterBooklist,this)},{el:this.$("#booklist-datepicker"),selectWeek:!0,showOtherMonths:!0,showMonthAfterYear:!0,changeMonth:!0,changeYear:!0,defaultDate:0,dateFormat:"mm/dd/yy",maxDate:n,onSelect:e.bind(this.changeWeek,this)}]}),this.$(".books-buy-button").each(e.bind(function(e,i){this.subviews["dropdown"+e]=new r({el:t(i)})},this))},submitBooklistSearchForm:function(t){t.preventDefault();var e=this.$(":checked",this.$searchTypes).val(),i=this.$searchField.val(),s=""!==i?this.searchBase+e+"/"+encodeURIComponent(i)+"/":this.booklistBaseUrl;n.goTo(s)},filterBooklist:function(){n.goTo(window.location.pathname+"?"+this.$filterFields.serialize())},changeWeek:function(t,e){var i=new Date(e.selectedYear,e.selectedMonth,e.selectedDay),s=this._getWeek(i);n.goTo(this.booklistBaseUrl+"week/"+e.selectedYear+"/"+s+"/")},_getWeek:function(t){var e=new Date(t.getFullYear(),0,1);return Math.ceil(((t-e)/864e5+e.getDay()+1)/7)},_getMostRecentWeek:function(){var t=new Date,e=t.getDay();return 4>e&&t.setDate(t.getDate()-7+(4-e)),t}});return a}),define("modules/interactives/line-chart",["jquery","underscore","baseview","utils","modules/interactives/interactive-base"],function(t,e,i,s,n){"use strict";var o=n.extend({getFlotData:function(t){return void 0===t?null:(e.isArray(t)||(t=[t]),e.map(t,function(t,i,s){var n=this.mainColor;return s.length>1&&(n=this.chartColors[i%this.chartColors.length]),{label:t.label||"",color:n,data:e.map(t.value,function(t,e){return[e,t]}),points:{fillColor:n}}},this))},_getMinValue:function(t){var i=Number.MAX_VALUE,s=Number.MIN_VALUE;if(e.each(t,function(t){e.each(t.data,function(t){t=parseFloat(t[1]),i>t&&(i=t),t>s&&(s=t)})}),i===Number.MAX_VALUE)i=s=0;else{i>0&&(i=0);var n=.1*(s-i);s+=n,0>i&&(i-=n)}return[i,s]},getFlotOptions:function(){var t=s.getNested(this.flotData,0,"data","length")||0,e=this._getMinValue(this.flotData),i=n.prototype.getFlotOptions.apply(this,arguments);return i.legend={show:!1,noColumns:1},i.xaxis={ticks:this._createTicks(this.chartData.xaxisvalues||""),autoscaleMargin:.03,position:"bottom",borderColor:"rgb(237,236,236)"},i.yaxis={position:"left",labelHeight:25,borderColor:"rgb(237,236,236)",min:e[0],max:e[1],tickFormatter:this.numberWithCommas},i.series={lines:{show:!0}},i.grid={borderWidth:1,borderColor:"rgb(237,236,236)",labelMargin:5,axisMargin:0,clickable:!0,hoverable:!0,autoHighlight:!0},i.colors=this.colors,13>t?i.series.points={show:!0,radius:5,fill:!0}:t>13&&(i.series.points={show:!1}),i},_getHoverBody:function(t){return[this.getHoverPrefix(),s.addCommas(s.getNested(t,"datapoint","1"))||"",this.getHoverSuffix()].join(" ")}});return o}),define("buildfiles/common",function(){}),define("framework-config",[],function(){return window.use_minified_css&&require.config({baseUrl:window.site_static_url+"jsb"}),{paths:{jquery:"libs/jquery/jquery.require",jquery_modern:"libs/jquery/jquery-2.1.1",jquery_legacy:"libs/jquery/jquery-1.11.1",underscore:"libs/underscore/underscore",backbone:"libs/backbone/backbone-dev",utils:"global/utils",baseview:"global/base-view","base-app":"apps/base-app",pubsub:"global/pubsub","site-manager":"managers/sitemanager",state:"managers/statemanager","user-manager":"managers/usermanager",raven:"libs/getsentry/raven","raven.setup":"libs/getsentry/raven.setup",cookie:"libs/jquery/plugins/jquery.cookie",easing:"libs/jquery/plugins/jquery.easing.1.3",animatecolors:"libs/jquery/plugins/jquery.animate-colors-min",mousewheel:"libs/jquery/plugins/jquery.mousewheel",uiPageTurn:"libs/jquery/plugins/jquery.ui-page-turn",uiFlip:"libs/jquery/plugins/jquery.ui-flip",transformSupport:"libs/jquery/plugins/jquery.transformSupport",facebook:"auth/facebook",googleplus:"auth/googleplus","user-auth":"auth/user-auth",touchpunch:"libs/jquery/plugins/jquery-ui.touch-punch.min",admanager:"managers/admanager",sharedAdPosition:"partner/shared-ad-position",meteredAdPosition:"partner/metered-ad-position",directAdPosition:"partner/direct-ad-position",leaflet:"libs/leaflet/leaflet-0.4.4",base64:"libs/base64/base64",mergedSiteConfig:"/services/config/site-config",adLogger:"partner/ad-logger"},shim:{jquery_modern:["console.setup"],jquery_legacy:["console.setup"],raven:["jquery"],easing:["jquery"],animatecolors:["jquery"],mousewheel:["jquery"],touchpunch:["libs/jqueryui/mouse"],backbone:["underscore","jquery"]}}}),require(["framework-config"],function(t){require.config(t),require(["site-manager","state","modules/global/header","third-party-apis/facebook/facebook","third-party-apis/google/google","user-accounts/facebook-user-account","user-accounts/googleplus-user-account","raven.setup","analytics/settealium"],function(t,e,i){t.start(!window.chromeless&&i,e)})}),define("main",function(){});
//# sourceMappingURL=main.min.js.map